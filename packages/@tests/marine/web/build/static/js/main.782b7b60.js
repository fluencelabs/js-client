/*! For license information please see main.782b7b60.js.LICENSE.txt */
!function(){var I={5558:function(I,g){"use strict";var C=this&&this.__awaiter||function(I,g,C,A){return new(C||(C=Promise))((function(i,c){function G(I){try{b(A.next(I))}catch(g){c(g)}}function l(I){try{b(A.throw(I))}catch(g){c(g)}}function b(I){var g;I.done?i(I.value):(g=I.value,g instanceof C?g:new C((function(I){I(g)}))).then(G,l)}b((A=A.apply(I,g||[])).next())}))},A=this&&this.__generator||function(I,g){var C,A,i,c,G={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return c={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function l(l){return function(b){return function(l){if(C)throw new TypeError("Generator is already executing.");for(;c&&(c=0,l[0]&&(G=0)),G;)try{if(C=1,A&&(i=2&l[0]?A.return:l[0]?A.throw||((i=A.return)&&i.call(A),0):A.next)&&!(i=i.call(A,l[1])).done)return i;switch(A=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return G.label++,{value:l[1],done:!1};case 5:G.label++,A=l[1],l=[0];continue;case 7:l=G.ops.pop(),G.trys.pop();continue;default:if(!(i=(i=G.trys).length>0&&i[i.length-1])&&(6===l[0]||2===l[0])){G=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3])){G.label=l[1];break}if(6===l[0]&&G.label<i[1]){G.label=i[1],i=l;break}if(i&&G.label<i[2]){G.label=i[2],G.ops.push(l);break}i[2]&&G.ops.pop(),G.trys.pop();continue}l=g.call(I,G)}catch(b){l=[6,b],A=0}finally{C=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,b])}}};Object.defineProperty(g,"__esModule",{value:!0}),g.callAvm=g.deserializeAvmResult=g.serializeAvmArgs=void 0;var i=new TextDecoder,c=new TextEncoder;function G(I,g,C,A,i){for(var G={},l=0,b=i;l<b.length;l++){var Z=b[l],t=Z[0],o=Z[1];G[t]={ret_code:o.retCode,result:o.result}}var n=c.encode(JSON.stringify(G));return[g,Array.from(C),Array.from(A),{init_peer_id:I.initPeerId,current_peer_id:I.currentPeerId,timestamp:I.timestamp,ttl:I.ttl},Array.from(n)]}function l(I){var g,C=i.decode(new Uint8Array(I.call_requests));try{g=0===C.length?{}:JSON.parse(C)}catch(Z){throw"Couldn't parse call requests: "+Z+". Original string is: "+C}var A=[];for(var c in g){var G=g[c],l=void 0,b=void 0;try{l=JSON.parse(G.arguments)}catch(Z){throw"Couldn't parse arguments: "+Z+". Original string is: "+l}try{b=JSON.parse(G.tetraplets)}catch(Z){throw"Couldn't parse tetraplets: "+Z+". Original string is: "+b}A.push([c,{serviceId:G.service_id,functionName:G.function_name,arguments:l,tetraplets:b}])}return{retCode:I.ret_code,errorMessage:I.error_message,data:I.data,nextPeerPks:I.next_peer_pks,callRequests:A}}g.serializeAvmArgs=G,g.deserializeAvmResult=l,g.callAvm=function(I,g,i,c,b,Z){return C(this,void 0,void 0,(function(){var C;return A(this,(function(A){switch(A.label){case 0:return C=G(g,i,c,b,Z),[4,I(C)];case 1:return[2,l(A.sent())]}}))}))}},6329:function(I,g,C){"use strict";var A=this&&this.__createBinding||(Object.create?function(I,g,C,A){void 0===A&&(A=C);var i=Object.getOwnPropertyDescriptor(g,C);i&&!("get"in i?!g.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return g[C]}}),Object.defineProperty(I,A,i)}:function(I,g,C,A){void 0===A&&(A=C),I[A]=g[C]}),i=this&&this.__exportStar||function(I,g){for(var C in I)"default"===C||Object.prototype.hasOwnProperty.call(g,C)||A(g,I,C)};Object.defineProperty(g,"__esModule",{value:!0}),i(C(956),g),i(C(5558),g)},956:function(I,g){"use strict";Object.defineProperty(g,"__esModule",{value:!0})},4753:function(I,g,C){"use strict";var A=this&&this.__assign||function(){return A=Object.assign||function(I){for(var g,C=1,A=arguments.length;C<A;C++)for(var i in g=arguments[C])Object.prototype.hasOwnProperty.call(g,i)&&(I[i]=g[i]);return I},A.apply(this,arguments)},i=this&&this.__awaiter||function(I,g,C,A){return new(C||(C=Promise))((function(i,c){function G(I){try{b(A.next(I))}catch(g){c(g)}}function l(I){try{b(A.throw(I))}catch(g){c(g)}}function b(I){var g;I.done?i(I.value):(g=I.value,g instanceof C?g:new C((function(I){I(g)}))).then(G,l)}b((A=A.apply(I,g||[])).next())}))},c=this&&this.__generator||function(I,g){var C,A,i,c,G={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return c={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function l(c){return function(l){return function(c){if(C)throw new TypeError("Generator is already executing.");for(;G;)try{if(C=1,A&&(i=2&c[0]?A.return:c[0]?A.throw||((i=A.return)&&i.call(A),0):A.next)&&!(i=i.call(A,c[1])).done)return i;switch(A=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return G.label++,{value:c[1],done:!1};case 5:G.label++,A=c[1],c=[0];continue;case 7:c=G.ops.pop(),G.trys.pop();continue;default:if(!(i=(i=G.trys).length>0&&i[i.length-1])&&(6===c[0]||2===c[0])){G=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){G.label=c[1];break}if(6===c[0]&&G.label<i[1]){G.label=i[1],i=c;break}if(i&&G.label<i[2]){G.label=i[2],G.ops.push(c);break}i[2]&&G.ops.pop(),G.trys.pop();continue}c=g.call(I,G)}catch(l){c=[6,l],A=0}finally{C=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},G=this&&this.__importDefault||function(I){return I&&I.__esModule?I:{default:I}};Object.defineProperty(g,"__esModule",{value:!0}),g.MarineService=void 0;var l=C(3962),b=G(C(5124)),Z=C(3903),t=C(3443),o=null;function n(I,g,C){return u.decode(function(I){return null!==o&&o.buffer===I.memory.buffer||(o=new Uint8Array(I.memory.buffer)),o}(I).subarray(g,g+C))}var u=new TextDecoder,d=function(){function I(I,g,C,i,c,G){this.controlModule=I,this.serviceModule=g,this.serviceId=C,this.logFunction=i,this.env={},this._controlModuleInstance="not-set",this.env=A({WASM_LOG:"off"},G)}return I.prototype.init=function(){return i(this,void 0,void 0,(function(){var I,g,C,i,G,o,u,d,e,B=this;return c(this,(function(c){switch(c.label){case 0:return I=new l.WASI({args:[],env:this.env,bindings:A(A({},b.default),{fs:(new Z.WasmFs).fs})}),g={exports:void 0},X=this.serviceModule,C=void 0!==WebAssembly.Module.imports(X).find((function(I){return"wasi_snapshot_preview1"===I.module||"wasi_unstable"===I.module}))?I.getImports(this.serviceModule):{},[4,WebAssembly.instantiate(this.serviceModule,A(A({},C),{host:{log_utf8_string:function(I,C,A,i){var c=g.exports,G=m(I);if(null!==G){var l=n(c,A,i);B.logFunction({service:B.serviceId,message:l,level:G})}}}}))];case 1:return i=c.sent(),I.start(i),g.exports=i.exports,[4,(0,t.init)(this.controlModule)];case 2:G=c.sent(),o=WebAssembly.Module.customSections(this.serviceModule,"interface-types"),u=new Uint8Array(o[0]),d=G.register_module(this.serviceId,u,i);try{return e=JSON.parse(d),this._controlModuleInstance=G,[2,e]}catch(y){throw"register_module result parsing error: "+y+", original text: "+d}return[2]}var X}))}))},I.prototype.terminate=function(){this._controlModuleInstance="not-set"},I.prototype.call=function(I,g,C){if("not-set"===this._controlModuleInstance)throw new Error("Not initialized");if("terminated"===this._controlModuleInstance)throw new Error("Terminated");var A=JSON.stringify(g),i=this._controlModuleInstance.call_module(this.serviceId,I,A),c=JSON.parse(i);if(c.error)throw new Error("marine-js failed with: ".concat(c.error));return c.result},I}();g.MarineService=d;var m=function(I){switch(I){case 1:return"error";case 2:return"warn";case 3:return"info";case 4:return"debug";case 5:return"trace"}return null}},697:function(I,g){"use strict";Object.defineProperty(g,"__esModule",{value:!0})},1901:function(I,g,C){"use strict";var A=this&&this.__createBinding||(Object.create?function(I,g,C,A){void 0===A&&(A=C);var i=Object.getOwnPropertyDescriptor(g,C);i&&!("get"in i?!g.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return g[C]}}),Object.defineProperty(I,A,i)}:function(I,g,C,A){void 0===A&&(A=C),I[A]=g[C]}),i=this&&this.__exportStar||function(I,g){for(var C in I)"default"===C||Object.prototype.hasOwnProperty.call(g,C)||A(g,I,C)};Object.defineProperty(g,"__esModule",{value:!0}),g.MarineService=void 0;var c=C(4753);Object.defineProperty(g,"MarineService",{enumerable:!0,get:function(){return c.MarineService}}),i(C(697),g),i(C(6701),g)},3443:function(I,g,C){"use strict";var A=this&&this.__awaiter||function(I,g,C,A){return new(C||(C=Promise))((function(i,c){function G(I){try{b(A.next(I))}catch(g){c(g)}}function l(I){try{b(A.throw(I))}catch(g){c(g)}}function b(I){var g;I.done?i(I.value):(g=I.value,g instanceof C?g:new C((function(I){I(g)}))).then(G,l)}b((A=A.apply(I,g||[])).next())}))},i=this&&this.__generator||function(I,g){var C,A,i,c,G={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return c={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function l(c){return function(l){return function(c){if(C)throw new TypeError("Generator is already executing.");for(;G;)try{if(C=1,A&&(i=2&c[0]?A.return:c[0]?A.throw||((i=A.return)&&i.call(A),0):A.next)&&!(i=i.call(A,c[1])).done)return i;switch(A=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return G.label++,{value:c[1],done:!1};case 5:G.label++,A=c[1],c=[0];continue;case 7:c=G.ops.pop(),G.trys.pop();continue;default:if(!(i=(i=G.trys).length>0&&i[i.length-1])&&(6===c[0]||2===c[0])){G=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){G.label=c[1];break}if(6===c[0]&&G.label<i[1]){G.label=i[1],i=c;break}if(i&&G.label<i[2]){G.label=i[2],G.ops.push(c);break}i[2]&&G.ops.pop(),G.trys.pop();continue}c=g.call(I,G)}catch(l){c=[6,l],A=0}finally{C=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}};Object.defineProperty(g,"__esModule",{value:!0}),g.init=void 0;var c=C(9410);g.init=function(I){return A(this,void 0,void 0,(function(){function g(I){return B[I]}function C(I){var C=g(I);return function(I){I<36||(B[I]=X,X=I)}(I),C}function G(){return 0===V.byteLength&&(V=new Uint8Array(e.memory.buffer)),V}function l(I,g){return y.decode(G().subarray(I,I+g))}function b(I){X===B.length&&B.push(B.length+1);var g=X;return X=B[g],B[g]=I,g}function Z(I,g,C){if(void 0===C){var A=a.encode(I),i=g(A.length);return G().subarray(i,i+A.length).set(A),h=A.length,i}for(var c=I.length,l=g(c),b=G(),Z=0;Z<c;Z++){var t=I.charCodeAt(Z);if(t>127)break;b[l+Z]=t}if(Z!==c){0!==Z&&(I=I.slice(Z)),l=C(l,c,c=Z+3*I.length);var o=G().subarray(l+Z,l+c);Z+=s(I,o).written}return h=Z,l}function t(){return 0===r.byteLength&&(r=new Int32Array(e.memory.buffer)),r}function o(I,g,C){try{var A=e.__wbindgen_add_to_stack_pointer(-16),i=Z(I,e.__wbindgen_malloc,e.__wbindgen_realloc),c=h,o=function(I,g){var C=g(1*I.length);return G().set(I,C/1),h=I.length,C}(g,e.__wbindgen_malloc),n=h;e.register_module(A,i,c,o,n,b(C));var u=t()[A/4+0],d=t()[A/4+1];return l(u,d)}finally{e.__wbindgen_add_to_stack_pointer(16),e.__wbindgen_free(u,d)}}function n(I,g,C){try{var A=e.__wbindgen_add_to_stack_pointer(-16),i=Z(I,e.__wbindgen_malloc,e.__wbindgen_realloc),c=h,G=Z(g,e.__wbindgen_malloc,e.__wbindgen_realloc),b=h,o=Z(C,e.__wbindgen_malloc,e.__wbindgen_realloc),n=h;e.call_module(A,i,c,G,b,o,n);var u=t()[A/4+0],d=t()[A/4+1];return l(u,d)}finally{e.__wbindgen_add_to_stack_pointer(16),e.__wbindgen_free(u,d)}}function u(I,g){return G().subarray(I/1,I/1+g)}function d(I,g){return e=I.exports,m.__wbindgen_wasm_module=g,r=new Int32Array,V=new Uint8Array,e.__wbindgen_start(),e}function m(G){return A(this,void 0,void 0,(function(){var A;return i(this,(function(i){switch(i.label){case 0:return A=function(){var I={wbg:{}};return I.wbg.__wbg_writebyterange_0c59aabc2aad1210=function(I,C,A,i){(0,c.write_byte_range)(g(I),C>>>0,u(A,i))},I.wbg.__wbg_readbyte_0b96cd62e4c1af25=function(I,C){return(0,c.read_byte)(g(I),C>>>0)},I.wbg.__wbg_readbyterange_6def5970b1aebf61=function(I,C,A,i){(0,c.read_byte_range)(g(I),C>>>0,u(A,i))},I.wbg.__wbg_getmemorysize_16d792c547469ba4=function(I){return(0,c.get_memory_size)(g(I))},I.wbg.__wbg_new_abda76e883ba8a5f=function(){return b(new Error)},I.wbg.__wbg_stack_658279fe44541cf6=function(I,C){var A=Z(g(C).stack,e.__wbindgen_malloc,e.__wbindgen_realloc),i=h;t()[I/4+1]=i,t()[I/4+0]=A},I.wbg.__wbg_error_f851667af71bcfc6=function(I,g){try{console.error(l(I,g))}finally{e.__wbindgen_free(I,g)}},I.wbg.__wbindgen_object_drop_ref=function(I){C(I)},I.wbg.__wbg_writebyte_111fe93c2b0126fe=function(I,C,A){(0,c.write_byte)(g(I),C>>>0,A)},I.wbg.__wbg_callexport_633630b9132e20a4=function(I,C,A,i,G,b){var o=Z((0,c.call_export)(g(C),l(A,i),l(G,b)),e.__wbindgen_malloc,e.__wbindgen_realloc),n=h;t()[I/4+1]=n,t()[I/4+0]=o},I}(),[4,WebAssembly.instantiate(G,A)];case 1:return[2,d(i.sent(),I)]}}))}))}var e,B,X,y,V,h,a,s,r;return i(this,(function(g){switch(g.label){case 0:return(B=new Array(32).fill(void 0)).push(void 0,null,!0,!1),X=B.length,(y=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0})).decode(),V=new Uint8Array,h=0,a=new TextEncoder("utf-8"),s="function"===typeof a.encodeInto?function(I,g){return a.encodeInto(I,g)}:function(I,g){var C=a.encode(I);return g.set(C),{read:I.length,written:C.length}},r=new Int32Array,[4,m(I)];case 1:return g.sent(),[2,{wasm:e,register_module:o,call_module:n}]}}))}))}},9410:function(I,g){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.read_byte_range=g.write_byte_range=g.write_byte=g.read_byte=g.get_memory_size=g.call_export=void 0,g.call_export=function(I,g,C){for(var A,i=JSON.parse(C),c=[],G=0;G<i.length;G++){var l=i[G];if(void 0!==l.I32&&c.push(l.I32),void 0!==l.I64){var b=BigInt(l.I64);c.push(b)}void 0!==l.F32&&c.push(l.F32),void 0!==l.F64&&c.push(l.F64)}var Z=(A=I.exports)[g].apply(A,c),t="[]";return void 0!==Z&&(t="bigint"==typeof Z?"["+Z.toString()+"]":"["+JSON.stringify(Z)+"]"),t},g.get_memory_size=function(I){return new Uint8Array(I.exports.memory.buffer).byteLength},g.read_byte=function(I,g){return new Uint8Array(I.exports.memory.buffer)[g]},g.write_byte=function(I,g,C){new Uint8Array(I.exports.memory.buffer)[g]=C},g.write_byte_range=function(I,g,C){for(var A=new Uint8Array(I.exports.memory.buffer),i=0;i<C.length;i++)A[g+i]=C[i]},g.read_byte_range=function(I,g,C){for(var A=new Uint8Array(I.exports.memory.buffer),i=0;i<C.length;i++)C[i]=A[g+i]}},6701:function(I,g){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.logLevelToEnv=g.isLogLevel=g.logLevels=void 0,g.logLevels=["trace","debug","info","warn","error"];g.isLogLevel=function(I){return g.logLevels.some((function(g){return I===g}))};g.logLevelToEnv=function(I){return{WASM_LOG:I}}},5124:function(I,g,C){"use strict";Object.defineProperty(g,"__esModule",{value:!0});var A=C(6641),i=C(9770),c=C(5360),G=C(4845),l={hrtime:C(9065).default(i.default),exit:function(I){throw new G.WASIExitError(I)},kill:function(I){throw new G.WASIKillError(I)},randomFillSync:A.randomFillSync,isTTY:function(){return!0},path:c,fs:null};g.default=l},8380:function(I,g,C){"use strict";var A,i=C(8726).default;Object.defineProperty(g,"__esModule",{value:!0});var c=C(104);g.WASI_ESUCCESS=0,g.WASI_E2BIG=1,g.WASI_EACCES=2,g.WASI_EADDRINUSE=3,g.WASI_EADDRNOTAVAIL=4,g.WASI_EAFNOSUPPORT=5,g.WASI_EAGAIN=6,g.WASI_EALREADY=7,g.WASI_EBADF=8,g.WASI_EBADMSG=9,g.WASI_EBUSY=10,g.WASI_ECANCELED=11,g.WASI_ECHILD=12,g.WASI_ECONNABORTED=13,g.WASI_ECONNREFUSED=14,g.WASI_ECONNRESET=15,g.WASI_EDEADLK=16,g.WASI_EDESTADDRREQ=17,g.WASI_EDOM=18,g.WASI_EDQUOT=19,g.WASI_EEXIST=20,g.WASI_EFAULT=21,g.WASI_EFBIG=22,g.WASI_EHOSTUNREACH=23,g.WASI_EIDRM=24,g.WASI_EILSEQ=25,g.WASI_EINPROGRESS=26,g.WASI_EINTR=27,g.WASI_EINVAL=28,g.WASI_EIO=29,g.WASI_EISCONN=30,g.WASI_EISDIR=31,g.WASI_ELOOP=32,g.WASI_EMFILE=33,g.WASI_EMLINK=34,g.WASI_EMSGSIZE=35,g.WASI_EMULTIHOP=36,g.WASI_ENAMETOOLONG=37,g.WASI_ENETDOWN=38,g.WASI_ENETRESET=39,g.WASI_ENETUNREACH=40,g.WASI_ENFILE=41,g.WASI_ENOBUFS=42,g.WASI_ENODEV=43,g.WASI_ENOENT=44,g.WASI_ENOEXEC=45,g.WASI_ENOLCK=46,g.WASI_ENOLINK=47,g.WASI_ENOMEM=48,g.WASI_ENOMSG=49,g.WASI_ENOPROTOOPT=50,g.WASI_ENOSPC=51,g.WASI_ENOSYS=52,g.WASI_ENOTCONN=53,g.WASI_ENOTDIR=54,g.WASI_ENOTEMPTY=55,g.WASI_ENOTRECOVERABLE=56,g.WASI_ENOTSOCK=57,g.WASI_ENOTSUP=58,g.WASI_ENOTTY=59,g.WASI_ENXIO=60,g.WASI_EOVERFLOW=61,g.WASI_EOWNERDEAD=62,g.WASI_EPERM=63,g.WASI_EPIPE=64,g.WASI_EPROTO=65,g.WASI_EPROTONOSUPPORT=66,g.WASI_EPROTOTYPE=67,g.WASI_ERANGE=68,g.WASI_EROFS=69,g.WASI_ESPIPE=70,g.WASI_ESRCH=71,g.WASI_ESTALE=72,g.WASI_ETIMEDOUT=73,g.WASI_ETXTBSY=74,g.WASI_EXDEV=75,g.WASI_ENOTCAPABLE=76,g.WASI_SIGABRT=0,g.WASI_SIGALRM=1,g.WASI_SIGBUS=2,g.WASI_SIGCHLD=3,g.WASI_SIGCONT=4,g.WASI_SIGFPE=5,g.WASI_SIGHUP=6,g.WASI_SIGILL=7,g.WASI_SIGINT=8,g.WASI_SIGKILL=9,g.WASI_SIGPIPE=10,g.WASI_SIGQUIT=11,g.WASI_SIGSEGV=12,g.WASI_SIGSTOP=13,g.WASI_SIGTERM=14,g.WASI_SIGTRAP=15,g.WASI_SIGTSTP=16,g.WASI_SIGTTIN=17,g.WASI_SIGTTOU=18,g.WASI_SIGURG=19,g.WASI_SIGUSR1=20,g.WASI_SIGUSR2=21,g.WASI_SIGVTALRM=22,g.WASI_SIGXCPU=23,g.WASI_SIGXFSZ=24,g.WASI_FILETYPE_UNKNOWN=0,g.WASI_FILETYPE_BLOCK_DEVICE=1,g.WASI_FILETYPE_CHARACTER_DEVICE=2,g.WASI_FILETYPE_DIRECTORY=3,g.WASI_FILETYPE_REGULAR_FILE=4,g.WASI_FILETYPE_SOCKET_DGRAM=5,g.WASI_FILETYPE_SOCKET_STREAM=6,g.WASI_FILETYPE_SYMBOLIC_LINK=7,g.WASI_FDFLAG_APPEND=1,g.WASI_FDFLAG_DSYNC=2,g.WASI_FDFLAG_NONBLOCK=4,g.WASI_FDFLAG_RSYNC=8,g.WASI_FDFLAG_SYNC=16,g.WASI_RIGHT_FD_DATASYNC=c.BigIntPolyfill(1),g.WASI_RIGHT_FD_READ=c.BigIntPolyfill(2),g.WASI_RIGHT_FD_SEEK=c.BigIntPolyfill(4),g.WASI_RIGHT_FD_FDSTAT_SET_FLAGS=c.BigIntPolyfill(8),g.WASI_RIGHT_FD_SYNC=c.BigIntPolyfill(16),g.WASI_RIGHT_FD_TELL=c.BigIntPolyfill(32),g.WASI_RIGHT_FD_WRITE=c.BigIntPolyfill(64),g.WASI_RIGHT_FD_ADVISE=c.BigIntPolyfill(128),g.WASI_RIGHT_FD_ALLOCATE=c.BigIntPolyfill(256),g.WASI_RIGHT_PATH_CREATE_DIRECTORY=c.BigIntPolyfill(512),g.WASI_RIGHT_PATH_CREATE_FILE=c.BigIntPolyfill(1024),g.WASI_RIGHT_PATH_LINK_SOURCE=c.BigIntPolyfill(2048),g.WASI_RIGHT_PATH_LINK_TARGET=c.BigIntPolyfill(4096),g.WASI_RIGHT_PATH_OPEN=c.BigIntPolyfill(8192),g.WASI_RIGHT_FD_READDIR=c.BigIntPolyfill(16384),g.WASI_RIGHT_PATH_READLINK=c.BigIntPolyfill(32768),g.WASI_RIGHT_PATH_RENAME_SOURCE=c.BigIntPolyfill(65536),g.WASI_RIGHT_PATH_RENAME_TARGET=c.BigIntPolyfill(131072),g.WASI_RIGHT_PATH_FILESTAT_GET=c.BigIntPolyfill(262144),g.WASI_RIGHT_PATH_FILESTAT_SET_SIZE=c.BigIntPolyfill(524288),g.WASI_RIGHT_PATH_FILESTAT_SET_TIMES=c.BigIntPolyfill(1048576),g.WASI_RIGHT_FD_FILESTAT_GET=c.BigIntPolyfill(2097152),g.WASI_RIGHT_FD_FILESTAT_SET_SIZE=c.BigIntPolyfill(4194304),g.WASI_RIGHT_FD_FILESTAT_SET_TIMES=c.BigIntPolyfill(8388608),g.WASI_RIGHT_PATH_SYMLINK=c.BigIntPolyfill(16777216),g.WASI_RIGHT_PATH_REMOVE_DIRECTORY=c.BigIntPolyfill(33554432),g.WASI_RIGHT_PATH_UNLINK_FILE=c.BigIntPolyfill(67108864),g.WASI_RIGHT_POLL_FD_READWRITE=c.BigIntPolyfill(134217728),g.WASI_RIGHT_SOCK_SHUTDOWN=c.BigIntPolyfill(268435456),g.RIGHTS_ALL=g.WASI_RIGHT_FD_DATASYNC|g.WASI_RIGHT_FD_READ|g.WASI_RIGHT_FD_SEEK|g.WASI_RIGHT_FD_FDSTAT_SET_FLAGS|g.WASI_RIGHT_FD_SYNC|g.WASI_RIGHT_FD_TELL|g.WASI_RIGHT_FD_WRITE|g.WASI_RIGHT_FD_ADVISE|g.WASI_RIGHT_FD_ALLOCATE|g.WASI_RIGHT_PATH_CREATE_DIRECTORY|g.WASI_RIGHT_PATH_CREATE_FILE|g.WASI_RIGHT_PATH_LINK_SOURCE|g.WASI_RIGHT_PATH_LINK_TARGET|g.WASI_RIGHT_PATH_OPEN|g.WASI_RIGHT_FD_READDIR|g.WASI_RIGHT_PATH_READLINK|g.WASI_RIGHT_PATH_RENAME_SOURCE|g.WASI_RIGHT_PATH_RENAME_TARGET|g.WASI_RIGHT_PATH_FILESTAT_GET|g.WASI_RIGHT_PATH_FILESTAT_SET_SIZE|g.WASI_RIGHT_PATH_FILESTAT_SET_TIMES|g.WASI_RIGHT_FD_FILESTAT_GET|g.WASI_RIGHT_FD_FILESTAT_SET_TIMES|g.WASI_RIGHT_FD_FILESTAT_SET_SIZE|g.WASI_RIGHT_PATH_SYMLINK|g.WASI_RIGHT_PATH_UNLINK_FILE|g.WASI_RIGHT_PATH_REMOVE_DIRECTORY|g.WASI_RIGHT_POLL_FD_READWRITE|g.WASI_RIGHT_SOCK_SHUTDOWN,g.RIGHTS_BLOCK_DEVICE_BASE=g.RIGHTS_ALL,g.RIGHTS_BLOCK_DEVICE_INHERITING=g.RIGHTS_ALL,g.RIGHTS_CHARACTER_DEVICE_BASE=g.RIGHTS_ALL,g.RIGHTS_CHARACTER_DEVICE_INHERITING=g.RIGHTS_ALL,g.RIGHTS_REGULAR_FILE_BASE=g.WASI_RIGHT_FD_DATASYNC|g.WASI_RIGHT_FD_READ|g.WASI_RIGHT_FD_SEEK|g.WASI_RIGHT_FD_FDSTAT_SET_FLAGS|g.WASI_RIGHT_FD_SYNC|g.WASI_RIGHT_FD_TELL|g.WASI_RIGHT_FD_WRITE|g.WASI_RIGHT_FD_ADVISE|g.WASI_RIGHT_FD_ALLOCATE|g.WASI_RIGHT_FD_FILESTAT_GET|g.WASI_RIGHT_FD_FILESTAT_SET_SIZE|g.WASI_RIGHT_FD_FILESTAT_SET_TIMES|g.WASI_RIGHT_POLL_FD_READWRITE,g.RIGHTS_REGULAR_FILE_INHERITING=c.BigIntPolyfill(0),g.RIGHTS_DIRECTORY_BASE=g.WASI_RIGHT_FD_FDSTAT_SET_FLAGS|g.WASI_RIGHT_FD_SYNC|g.WASI_RIGHT_FD_ADVISE|g.WASI_RIGHT_PATH_CREATE_DIRECTORY|g.WASI_RIGHT_PATH_CREATE_FILE|g.WASI_RIGHT_PATH_LINK_SOURCE|g.WASI_RIGHT_PATH_LINK_TARGET|g.WASI_RIGHT_PATH_OPEN|g.WASI_RIGHT_FD_READDIR|g.WASI_RIGHT_PATH_READLINK|g.WASI_RIGHT_PATH_RENAME_SOURCE|g.WASI_RIGHT_PATH_RENAME_TARGET|g.WASI_RIGHT_PATH_FILESTAT_GET|g.WASI_RIGHT_PATH_FILESTAT_SET_SIZE|g.WASI_RIGHT_PATH_FILESTAT_SET_TIMES|g.WASI_RIGHT_FD_FILESTAT_GET|g.WASI_RIGHT_FD_FILESTAT_SET_TIMES|g.WASI_RIGHT_PATH_SYMLINK|g.WASI_RIGHT_PATH_UNLINK_FILE|g.WASI_RIGHT_PATH_REMOVE_DIRECTORY|g.WASI_RIGHT_POLL_FD_READWRITE,g.RIGHTS_DIRECTORY_INHERITING=g.RIGHTS_DIRECTORY_BASE|g.RIGHTS_REGULAR_FILE_BASE,g.RIGHTS_SOCKET_BASE=g.WASI_RIGHT_FD_READ|g.WASI_RIGHT_FD_FDSTAT_SET_FLAGS|g.WASI_RIGHT_FD_WRITE|g.WASI_RIGHT_FD_FILESTAT_GET|g.WASI_RIGHT_POLL_FD_READWRITE|g.WASI_RIGHT_SOCK_SHUTDOWN,g.RIGHTS_SOCKET_INHERITING=g.RIGHTS_ALL,g.RIGHTS_TTY_BASE=g.WASI_RIGHT_FD_READ|g.WASI_RIGHT_FD_FDSTAT_SET_FLAGS|g.WASI_RIGHT_FD_WRITE|g.WASI_RIGHT_FD_FILESTAT_GET|g.WASI_RIGHT_POLL_FD_READWRITE,g.RIGHTS_TTY_INHERITING=c.BigIntPolyfill(0),g.WASI_CLOCK_REALTIME=0,g.WASI_CLOCK_MONOTONIC=1,g.WASI_CLOCK_PROCESS_CPUTIME_ID=2,g.WASI_CLOCK_THREAD_CPUTIME_ID=3,g.WASI_EVENTTYPE_CLOCK=0,g.WASI_EVENTTYPE_FD_READ=1,g.WASI_EVENTTYPE_FD_WRITE=2,g.WASI_FILESTAT_SET_ATIM=1,g.WASI_FILESTAT_SET_ATIM_NOW=2,g.WASI_FILESTAT_SET_MTIM=4,g.WASI_FILESTAT_SET_MTIM_NOW=8,g.WASI_O_CREAT=1,g.WASI_O_DIRECTORY=2,g.WASI_O_EXCL=4,g.WASI_O_TRUNC=8,g.WASI_PREOPENTYPE_DIR=0,g.WASI_DIRCOOKIE_START=0,g.WASI_STDIN_FILENO=0,g.WASI_STDOUT_FILENO=1,g.WASI_STDERR_FILENO=2,g.WASI_WHENCE_SET=0,g.WASI_WHENCE_CUR=1,g.WASI_WHENCE_END=2,g.ERROR_MAP={E2BIG:g.WASI_E2BIG,EACCES:g.WASI_EACCES,EADDRINUSE:g.WASI_EADDRINUSE,EADDRNOTAVAIL:g.WASI_EADDRNOTAVAIL,EAFNOSUPPORT:g.WASI_EAFNOSUPPORT,EALREADY:g.WASI_EALREADY,EAGAIN:g.WASI_EAGAIN,EBADF:g.WASI_EBADF,EBADMSG:g.WASI_EBADMSG,EBUSY:g.WASI_EBUSY,ECANCELED:g.WASI_ECANCELED,ECHILD:g.WASI_ECHILD,ECONNABORTED:g.WASI_ECONNABORTED,ECONNREFUSED:g.WASI_ECONNREFUSED,ECONNRESET:g.WASI_ECONNRESET,EDEADLOCK:g.WASI_EDEADLK,EDESTADDRREQ:g.WASI_EDESTADDRREQ,EDOM:g.WASI_EDOM,EDQUOT:g.WASI_EDQUOT,EEXIST:g.WASI_EEXIST,EFAULT:g.WASI_EFAULT,EFBIG:g.WASI_EFBIG,EHOSTDOWN:g.WASI_EHOSTUNREACH,EHOSTUNREACH:g.WASI_EHOSTUNREACH,EIDRM:g.WASI_EIDRM,EILSEQ:g.WASI_EILSEQ,EINPROGRESS:g.WASI_EINPROGRESS,EINTR:g.WASI_EINTR,EINVAL:g.WASI_EINVAL,EIO:g.WASI_EIO,EISCONN:g.WASI_EISCONN,EISDIR:g.WASI_EISDIR,ELOOP:g.WASI_ELOOP,EMFILE:g.WASI_EMFILE,EMLINK:g.WASI_EMLINK,EMSGSIZE:g.WASI_EMSGSIZE,EMULTIHOP:g.WASI_EMULTIHOP,ENAMETOOLONG:g.WASI_ENAMETOOLONG,ENETDOWN:g.WASI_ENETDOWN,ENETRESET:g.WASI_ENETRESET,ENETUNREACH:g.WASI_ENETUNREACH,ENFILE:g.WASI_ENFILE,ENOBUFS:g.WASI_ENOBUFS,ENODEV:g.WASI_ENODEV,ENOENT:g.WASI_ENOENT,ENOEXEC:g.WASI_ENOEXEC,ENOLCK:g.WASI_ENOLCK,ENOLINK:g.WASI_ENOLINK,ENOMEM:g.WASI_ENOMEM,ENOMSG:g.WASI_ENOMSG,ENOPROTOOPT:g.WASI_ENOPROTOOPT,ENOSPC:g.WASI_ENOSPC,ENOSYS:g.WASI_ENOSYS,ENOTCONN:g.WASI_ENOTCONN,ENOTDIR:g.WASI_ENOTDIR,ENOTEMPTY:g.WASI_ENOTEMPTY,ENOTRECOVERABLE:g.WASI_ENOTRECOVERABLE,ENOTSOCK:g.WASI_ENOTSOCK,ENOTTY:g.WASI_ENOTTY,ENXIO:g.WASI_ENXIO,EOVERFLOW:g.WASI_EOVERFLOW,EOWNERDEAD:g.WASI_EOWNERDEAD,EPERM:g.WASI_EPERM,EPIPE:g.WASI_EPIPE,EPROTO:g.WASI_EPROTO,EPROTONOSUPPORT:g.WASI_EPROTONOSUPPORT,EPROTOTYPE:g.WASI_EPROTOTYPE,ERANGE:g.WASI_ERANGE,EROFS:g.WASI_EROFS,ESPIPE:g.WASI_ESPIPE,ESRCH:g.WASI_ESRCH,ESTALE:g.WASI_ESTALE,ETIMEDOUT:g.WASI_ETIMEDOUT,ETXTBSY:g.WASI_ETXTBSY,EXDEV:g.WASI_EXDEV},g.SIGNAL_MAP=(i(A={},g.WASI_SIGHUP,"SIGHUP"),i(A,g.WASI_SIGINT,"SIGINT"),i(A,g.WASI_SIGQUIT,"SIGQUIT"),i(A,g.WASI_SIGILL,"SIGILL"),i(A,g.WASI_SIGTRAP,"SIGTRAP"),i(A,g.WASI_SIGABRT,"SIGABRT"),i(A,g.WASI_SIGBUS,"SIGBUS"),i(A,g.WASI_SIGFPE,"SIGFPE"),i(A,g.WASI_SIGKILL,"SIGKILL"),i(A,g.WASI_SIGUSR1,"SIGUSR1"),i(A,g.WASI_SIGSEGV,"SIGSEGV"),i(A,g.WASI_SIGUSR2,"SIGUSR2"),i(A,g.WASI_SIGPIPE,"SIGPIPE"),i(A,g.WASI_SIGALRM,"SIGALRM"),i(A,g.WASI_SIGTERM,"SIGTERM"),i(A,g.WASI_SIGCHLD,"SIGCHLD"),i(A,g.WASI_SIGCONT,"SIGCONT"),i(A,g.WASI_SIGSTOP,"SIGSTOP"),i(A,g.WASI_SIGTSTP,"SIGTSTP"),i(A,g.WASI_SIGTTIN,"SIGTTIN"),i(A,g.WASI_SIGTTOU,"SIGTTOU"),i(A,g.WASI_SIGURG,"SIGURG"),i(A,g.WASI_SIGXCPU,"SIGXCPU"),i(A,g.WASI_SIGXFSZ,"SIGXFSZ"),i(A,g.WASI_SIGVTALRM,"SIGVTALRM"),A)},3962:function(I,g,C){"use strict";function A(I,g){return A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,g){I.__proto__=g}||function(I,g){for(var C in g)g.hasOwnProperty(C)&&(I[C]=g[C])},A(I,g)}function i(I,g){function C(){this.constructor=I}A(I,g),I.prototype=null===g?Object.create(g):(C.prototype=g.prototype,new C)}function c(I){var g="function"===typeof Symbol&&I[Symbol.iterator],C=0;return g?g.call(I):{next:function(){return I&&C>=I.length&&(I=void 0),{value:I&&I[C++],done:!I}}}}function G(I,g){var C="function"===typeof Symbol&&I[Symbol.iterator];if(!C)return I;I=C.call(I);var A,i=[];try{for(;(void 0===g||0<g--)&&!(A=I.next()).done;)i.push(A.value)}catch(G){var c={error:G}}finally{try{A&&!A.done&&(C=I.return)&&C.call(I)}finally{if(c)throw c.error}}return i}function l(){for(var I=[],g=0;g<arguments.length;g++)I=I.concat(G(arguments[g]));return I}C.r(g),C.d(g,{WASI:function(){return hg},WASIError:function(){return Xg},WASIExitError:function(){return yg},WASIKillError:function(){return Vg}});var b="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof C.g?C.g:{},Z="undefined"!==typeof BigInt?BigInt:b.BigInt||Number,t=DataView;t.prototype.setBigUint64||(t.prototype.setBigUint64=function(I,g,C){if(g<Math.pow(2,32)){g=Number(g);var A=0}else{A=g.toString(2),g="";for(var i=0;i<64-A.length;i++)g+="0";g+=A,A=parseInt(g.substring(0,32),2),g=parseInt(g.substring(32),2)}this.setUint32(I+(C?0:4),g,C),this.setUint32(I+(C?4:0),A,C)},t.prototype.getBigUint64=function(I,g){var C=this.getUint32(I+(g?0:4),g);I=this.getUint32(I+(g?4:0),g),C=C.toString(2),I=I.toString(2),g="";for(var A=0;A<32-C.length;A++)g+="0";return Z("0b"+I+(g+C))});var o="undefined"!==typeof C.g?C.g:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{},n=[],u=[],d="undefined"!==typeof Uint8Array?Uint8Array:Array,m=!1;function e(){m=!0;for(var I=0;64>I;++I)n[I]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[I],u["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(I)]=I;u[45]=62,u[95]=63}function B(I,g,C){for(var A=[],i=g;i<C;i+=3)g=(I[i]<<16)+(I[i+1]<<8)+I[i+2],A.push(n[g>>18&63]+n[g>>12&63]+n[g>>6&63]+n[63&g]);return A.join("")}function X(I){m||e();for(var g=I.length,C=g%3,A="",i=[],c=0,G=g-C;c<G;c+=16383)i.push(B(I,c,c+16383>G?G:c+16383));return 1===C?(I=I[g-1],A+=n[I>>2],A+=n[I<<4&63],A+="=="):2===C&&(I=(I[g-2]<<8)+I[g-1],A+=n[I>>10],A+=n[I>>4&63],A+=n[I<<2&63],A+="="),i.push(A),i.join("")}function y(I,g,C,A,i){var c=8*i-A-1,G=(1<<c)-1,l=G>>1,b=-7,Z=C?-1:1,t=I[g+(i=C?i-1:0)];for(i+=Z,C=t&(1<<-b)-1,t>>=-b,b+=c;0<b;C=256*C+I[g+i],i+=Z,b-=8);for(c=C&(1<<-b)-1,C>>=-b,b+=A;0<b;c=256*c+I[g+i],i+=Z,b-=8);if(0===C)C=1-l;else{if(C===G)return c?NaN:1/0*(t?-1:1);c+=Math.pow(2,A),C-=l}return(t?-1:1)*c*Math.pow(2,C-A)}function V(I,g,C,A,i,c){var G,l=8*c-i-1,b=(1<<l)-1,Z=b>>1,t=23===i?Math.pow(2,-24)-Math.pow(2,-77):0;c=A?0:c-1;var o=A?1:-1,n=0>g||0===g&&0>1/g?1:0;for(g=Math.abs(g),isNaN(g)||1/0===g?(g=isNaN(g)?1:0,A=b):(A=Math.floor(Math.log(g)/Math.LN2),1>g*(G=Math.pow(2,-A))&&(A--,G*=2),2<=(g=1<=A+Z?g+t/G:g+t*Math.pow(2,1-Z))*G&&(A++,G/=2),A+Z>=b?(g=0,A=b):1<=A+Z?(g=(g*G-1)*Math.pow(2,i),A+=Z):(g=g*Math.pow(2,Z-1)*Math.pow(2,i),A=0));8<=i;I[C+c]=255&g,c+=o,g/=256,i-=8);for(A=A<<i|g,l+=i;0<l;I[C+c]=255&A,c+=o,A/=256,l-=8);I[C+c-o]|=128*n}var h={}.toString,a=Array.isArray||function(I){return"[object Array]"==h.call(I)};Y.TYPED_ARRAY_SUPPORT=void 0===o.TYPED_ARRAY_SUPPORT||o.TYPED_ARRAY_SUPPORT;var s=Y.TYPED_ARRAY_SUPPORT?2147483647:1073741823;function r(I,g){if((Y.TYPED_ARRAY_SUPPORT?2147483647:1073741823)<g)throw new RangeError("Invalid typed array length");return Y.TYPED_ARRAY_SUPPORT?(I=new Uint8Array(g)).__proto__=Y.prototype:(null===I&&(I=new Y(g)),I.length=g),I}function Y(I,g,C){if(!(Y.TYPED_ARRAY_SUPPORT||this instanceof Y))return new Y(I,g,C);if("number"===typeof I){if("string"===typeof g)throw Error("If encoding is specified then the first argument must be a string");return p(this,I)}return W(this,I,g,C)}function W(I,g,C,A){if("number"===typeof g)throw new TypeError('"value" argument must not be a number');if("undefined"!==typeof ArrayBuffer&&g instanceof ArrayBuffer){if(g.byteLength,0>C||g.byteLength<C)throw new RangeError("'offset' is out of bounds");if(g.byteLength<C+(A||0))throw new RangeError("'length' is out of bounds");return g=void 0===C&&void 0===A?new Uint8Array(g):void 0===A?new Uint8Array(g,C):new Uint8Array(g,C,A),Y.TYPED_ARRAY_SUPPORT?(I=g).__proto__=Y.prototype:I=K(I,g),I}if("string"===typeof g){if(A=I,"string"===typeof(I=C)&&""!==I||(I="utf8"),!Y.isEncoding(I))throw new TypeError('"encoding" must be a valid string encoding');return(g=(A=r(A,C=0|J(g,I))).write(g,I))!==C&&(A=A.slice(0,g)),A}return function(I,g){if(H(g)){var C=0|R(g.length);return 0===(I=r(I,C)).length||g.copy(I,0,0,C),I}if(g){if("undefined"!==typeof ArrayBuffer&&g.buffer instanceof ArrayBuffer||"length"in g)return(C="number"!==typeof g.length)||(C=(C=g.length)!==C),C?r(I,0):K(I,g);if("Buffer"===g.type&&a(g.data))return K(I,g.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(I,g)}function S(I){if("number"!==typeof I)throw new TypeError('"size" argument must be a number');if(0>I)throw new RangeError('"size" argument must not be negative')}function p(I,g){if(S(g),I=r(I,0>g?0:0|R(g)),!Y.TYPED_ARRAY_SUPPORT)for(var C=0;C<g;++C)I[C]=0;return I}function K(I,g){var C=0>g.length?0:0|R(g.length);I=r(I,C);for(var A=0;A<C;A+=1)I[A]=255&g[A];return I}function R(I){if(I>=(Y.TYPED_ARRAY_SUPPORT?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(Y.TYPED_ARRAY_SUPPORT?2147483647:1073741823).toString(16)+" bytes");return 0|I}function H(I){return!(null==I||!I._isBuffer)}function J(I,g){if(H(I))return I.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(I)||I instanceof ArrayBuffer))return I.byteLength;"string"!==typeof I&&(I=""+I);var C=I.length;if(0===C)return 0;for(var A=!1;;)switch(g){case"ascii":case"latin1":case"binary":return C;case"utf8":case"utf-8":case void 0:return M(I).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*C;case"hex":return C>>>1;case"base64":return O(I).length;default:if(A)return M(I).length;g=(""+g).toLowerCase(),A=!0}}function F(I,g,C){var A=!1;if((void 0===g||0>g)&&(g=0),g>this.length)return"";if((void 0===C||C>this.length)&&(C=this.length),0>=C)return"";if((C>>>=0)<=(g>>>=0))return"";for(I||(I="utf8");;)switch(I){case"hex":for(I=g,g=C,C=this.length,(!I||0>I)&&(I=0),(!g||0>g||g>C)&&(g=C),A="",C=I;C<g;++C)A=(I=A)+(A=16>(A=this[C])?"0"+A.toString(16):A.toString(16));return A;case"utf8":case"utf-8":return x(this,g,C);case"ascii":for(I="",C=Math.min(this.length,C);g<C;++g)I+=String.fromCharCode(127&this[g]);return I;case"latin1":case"binary":for(I="",C=Math.min(this.length,C);g<C;++g)I+=String.fromCharCode(this[g]);return I;case"base64":return g=0===g&&C===this.length?X(this):X(this.slice(g,C));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":for(g=this.slice(g,C),C="",I=0;I<g.length;I+=2)C+=String.fromCharCode(g[I]+256*g[I+1]);return C;default:if(A)throw new TypeError("Unknown encoding: "+I);I=(I+"").toLowerCase(),A=!0}}function w(I,g,C){var A=I[g];I[g]=I[C],I[C]=A}function f(I,g,C,A,i){if(0===I.length)return-1;if("string"===typeof C?(A=C,C=0):2147483647<C?C=2147483647:-2147483648>C&&(C=-2147483648),C=+C,isNaN(C)&&(C=i?0:I.length-1),0>C&&(C=I.length+C),C>=I.length){if(i)return-1;C=I.length-1}else if(0>C){if(!i)return-1;C=0}if("string"===typeof g&&(g=Y.from(g,A)),H(g))return 0===g.length?-1:v(I,g,C,A,i);if("number"===typeof g)return g&=255,Y.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(I,g,C):Uint8Array.prototype.lastIndexOf.call(I,g,C):v(I,[g],C,A,i);throw new TypeError("val must be string, number or Buffer")}function v(I,g,C,A,i){function c(I,g){return 1===G?I[g]:I.readUInt16BE(g*G)}var G=1,l=I.length,b=g.length;if(void 0!==A&&("ucs2"===(A=String(A).toLowerCase())||"ucs-2"===A||"utf16le"===A||"utf-16le"===A)){if(2>I.length||2>g.length)return-1;G=2,l/=2,b/=2,C/=2}if(i)for(A=-1;C<l;C++)if(c(I,C)===c(g,-1===A?0:C-A)){if(-1===A&&(A=C),C-A+1===b)return A*G}else-1!==A&&(C-=C-A),A=-1;else for(C+b>l&&(C=l-b);0<=C;C--){for(l=!0,A=0;A<b;A++)if(c(I,C+A)!==c(g,A)){l=!1;break}if(l)return C}return-1}function x(I,g,C){C=Math.min(I.length,C);for(var A=[];g<C;){var i=I[g],c=null,G=239<i?4:223<i?3:191<i?2:1;if(g+G<=C)switch(G){case 1:128>i&&(c=i);break;case 2:var l=I[g+1];128===(192&l)&&(127<(i=(31&i)<<6|63&l)&&(c=i));break;case 3:l=I[g+1];var b=I[g+2];128===(192&l)&&128===(192&b)&&(2047<(i=(15&i)<<12|(63&l)<<6|63&b)&&(55296>i||57343<i)&&(c=i));break;case 4:l=I[g+1],b=I[g+2];var Z=I[g+3];128===(192&l)&&128===(192&b)&&128===(192&Z)&&(65535<(i=(15&i)<<18|(63&l)<<12|(63&b)<<6|63&Z)&&1114112>i&&(c=i))}null===c?(c=65533,G=1):65535<c&&(c-=65536,A.push(c>>>10&1023|55296),c=56320|1023&c),A.push(c),g+=G}if((I=A.length)<=N)A=String.fromCharCode.apply(String,A);else{for(C="",g=0;g<I;)C+=String.fromCharCode.apply(String,A.slice(g,g+=N));A=C}return A}Y.poolSize=8192,Y._augment=function(I){return I.__proto__=Y.prototype,I},Y.from=function(I,g,C){return W(null,I,g,C)},Y.TYPED_ARRAY_SUPPORT&&(Y.prototype.__proto__=Uint8Array.prototype,Y.__proto__=Uint8Array),Y.alloc=function(I,g,C){return S(I),I=0>=I?r(null,I):void 0!==g?"string"===typeof C?r(null,I).fill(g,C):r(null,I).fill(g):r(null,I)},Y.allocUnsafe=function(I){return p(null,I)},Y.allocUnsafeSlow=function(I){return p(null,I)},Y.isBuffer=q,Y.compare=function(I,g){if(!H(I)||!H(g))throw new TypeError("Arguments must be Buffers");if(I===g)return 0;for(var C=I.length,A=g.length,i=0,c=Math.min(C,A);i<c;++i)if(I[i]!==g[i]){C=I[i],A=g[i];break}return C<A?-1:A<C?1:0},Y.isEncoding=function(I){switch(String(I).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Y.concat=function(I,g){if(!a(I))throw new TypeError('"list" argument must be an Array of Buffers');if(0===I.length)return Y.alloc(0);var C;if(void 0===g)for(C=g=0;C<I.length;++C)g+=I[C].length;g=Y.allocUnsafe(g);var A=0;for(C=0;C<I.length;++C){var i=I[C];if(!H(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(g,A),A+=i.length}return g},Y.byteLength=J,Y.prototype._isBuffer=!0,Y.prototype.swap16=function(){var I=this.length;if(0!==I%2)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var g=0;g<I;g+=2)w(this,g,g+1);return this},Y.prototype.swap32=function(){var I=this.length;if(0!==I%4)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var g=0;g<I;g+=4)w(this,g,g+3),w(this,g+1,g+2);return this},Y.prototype.swap64=function(){var I=this.length;if(0!==I%8)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var g=0;g<I;g+=8)w(this,g,g+7),w(this,g+1,g+6),w(this,g+2,g+5),w(this,g+3,g+4);return this},Y.prototype.toString=function(){var I=0|this.length;return 0===I?"":0===arguments.length?x(this,0,I):F.apply(this,arguments)},Y.prototype.equals=function(I){if(!H(I))throw new TypeError("Argument must be a Buffer");return this===I||0===Y.compare(this,I)},Y.prototype.inspect=function(){var I="";return 0<this.length&&(I=this.toString("hex",0,50).match(/.{2}/g).join(" "),50<this.length&&(I+=" ... ")),"<Buffer "+I+">"},Y.prototype.compare=function(I,g,C,A,i){if(!H(I))throw new TypeError("Argument must be a Buffer");if(void 0===g&&(g=0),void 0===C&&(C=I?I.length:0),void 0===A&&(A=0),void 0===i&&(i=this.length),0>g||C>I.length||0>A||i>this.length)throw new RangeError("out of range index");if(A>=i&&g>=C)return 0;if(A>=i)return-1;if(g>=C)return 1;if(this===I)return 0;var c=(i>>>=0)-(A>>>=0),G=(C>>>=0)-(g>>>=0),l=Math.min(c,G);for(A=this.slice(A,i),I=I.slice(g,C),g=0;g<l;++g)if(A[g]!==I[g]){c=A[g],G=I[g];break}return c<G?-1:G<c?1:0},Y.prototype.includes=function(I,g,C){return-1!==this.indexOf(I,g,C)},Y.prototype.indexOf=function(I,g,C){return f(this,I,g,C,!0)},Y.prototype.lastIndexOf=function(I,g,C){return f(this,I,g,C,!1)},Y.prototype.write=function(I,g,C,A){if(void 0===g)A="utf8",C=this.length,g=0;else if(void 0===C&&"string"===typeof g)A=g,C=this.length,g=0;else{if(!isFinite(g))throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");g|=0,isFinite(C)?(C|=0,void 0===A&&(A="utf8")):(A=C,C=void 0)}var i=this.length-g;if((void 0===C||C>i)&&(C=i),0<I.length&&(0>C||0>g)||g>this.length)throw new RangeError("Attempt to write outside buffer bounds");for(A||(A="utf8"),i=!1;;)switch(A){case"hex":I:{if(g=Number(g)||0,A=this.length-g,C?(C=Number(C))>A&&(C=A):C=A,0!==(A=I.length)%2)throw new TypeError("Invalid hex string");for(C>A/2&&(C=A/2),A=0;A<C;++A){if(i=parseInt(I.substr(2*A,2),16),isNaN(i)){I=A;break I}this[g+A]=i}I=A}return I;case"utf8":case"utf-8":return P(M(I,this.length-g),this,g,C);case"ascii":case"latin1":case"binary":return P(D(I),this,g,C);case"base64":return P(O(I),this,g,C);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":A=I,i=this.length-g;for(var c=[],G=0;G<A.length&&!(0>(i-=2));++G){var l=A.charCodeAt(G);I=l>>8,l%=256,c.push(l),c.push(I)}return P(c,this,g,C);default:if(i)throw new TypeError("Unknown encoding: "+A);A=(""+A).toLowerCase(),i=!0}},Y.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var N=4096;function L(I,g,C){if(0!==I%1||0>I)throw new RangeError("offset is not uint");if(I+g>C)throw new RangeError("Trying to access beyond buffer length")}function k(I,g,C,A,i,c){if(!H(I))throw new TypeError('"buffer" argument must be a Buffer instance');if(g>i||g<c)throw new RangeError('"value" argument is out of bounds');if(C+A>I.length)throw new RangeError("Index out of range")}function T(I,g,C,A){0>g&&(g=65535+g+1);for(var i=0,c=Math.min(I.length-C,2);i<c;++i)I[C+i]=(g&255<<8*(A?i:1-i))>>>8*(A?i:1-i)}function U(I,g,C,A){0>g&&(g=4294967295+g+1);for(var i=0,c=Math.min(I.length-C,4);i<c;++i)I[C+i]=g>>>8*(A?i:3-i)&255}function z(I,g,C,A){if(C+A>I.length)throw new RangeError("Index out of range");if(0>C)throw new RangeError("Index out of range")}Y.prototype.slice=function(I,g){var C=this.length;if(0>(I=~~I)?0>(I+=C)&&(I=0):I>C&&(I=C),0>(g=void 0===g?C:~~g)?0>(g+=C)&&(g=0):g>C&&(g=C),g<I&&(g=I),Y.TYPED_ARRAY_SUPPORT)(g=this.subarray(I,g)).__proto__=Y.prototype;else{g=new Y(C=g-I,void 0);for(var A=0;A<C;++A)g[A]=this[A+I]}return g},Y.prototype.readUIntLE=function(I,g,C){I|=0,g|=0,C||L(I,g,this.length),C=this[I];for(var A=1,i=0;++i<g&&(A*=256);)C+=this[I+i]*A;return C},Y.prototype.readUIntBE=function(I,g,C){I|=0,g|=0,C||L(I,g,this.length),C=this[I+--g];for(var A=1;0<g&&(A*=256);)C+=this[I+--g]*A;return C},Y.prototype.readUInt8=function(I,g){return g||L(I,1,this.length),this[I]},Y.prototype.readUInt16LE=function(I,g){return g||L(I,2,this.length),this[I]|this[I+1]<<8},Y.prototype.readUInt16BE=function(I,g){return g||L(I,2,this.length),this[I]<<8|this[I+1]},Y.prototype.readUInt32LE=function(I,g){return g||L(I,4,this.length),(this[I]|this[I+1]<<8|this[I+2]<<16)+16777216*this[I+3]},Y.prototype.readUInt32BE=function(I,g){return g||L(I,4,this.length),16777216*this[I]+(this[I+1]<<16|this[I+2]<<8|this[I+3])},Y.prototype.readIntLE=function(I,g,C){I|=0,g|=0,C||L(I,g,this.length),C=this[I];for(var A=1,i=0;++i<g&&(A*=256);)C+=this[I+i]*A;return C>=128*A&&(C-=Math.pow(2,8*g)),C},Y.prototype.readIntBE=function(I,g,C){I|=0,g|=0,C||L(I,g,this.length),C=g;for(var A=1,i=this[I+--C];0<C&&(A*=256);)i+=this[I+--C]*A;return i>=128*A&&(i-=Math.pow(2,8*g)),i},Y.prototype.readInt8=function(I,g){return g||L(I,1,this.length),128&this[I]?-1*(255-this[I]+1):this[I]},Y.prototype.readInt16LE=function(I,g){return g||L(I,2,this.length),32768&(I=this[I]|this[I+1]<<8)?4294901760|I:I},Y.prototype.readInt16BE=function(I,g){return g||L(I,2,this.length),32768&(I=this[I+1]|this[I]<<8)?4294901760|I:I},Y.prototype.readInt32LE=function(I,g){return g||L(I,4,this.length),this[I]|this[I+1]<<8|this[I+2]<<16|this[I+3]<<24},Y.prototype.readInt32BE=function(I,g){return g||L(I,4,this.length),this[I]<<24|this[I+1]<<16|this[I+2]<<8|this[I+3]},Y.prototype.readFloatLE=function(I,g){return g||L(I,4,this.length),y(this,I,!0,23,4)},Y.prototype.readFloatBE=function(I,g){return g||L(I,4,this.length),y(this,I,!1,23,4)},Y.prototype.readDoubleLE=function(I,g){return g||L(I,8,this.length),y(this,I,!0,52,8)},Y.prototype.readDoubleBE=function(I,g){return g||L(I,8,this.length),y(this,I,!1,52,8)},Y.prototype.writeUIntLE=function(I,g,C,A){I=+I,g|=0,C|=0,A||k(this,I,g,C,Math.pow(2,8*C)-1,0),A=1;var i=0;for(this[g]=255&I;++i<C&&(A*=256);)this[g+i]=I/A&255;return g+C},Y.prototype.writeUIntBE=function(I,g,C,A){I=+I,g|=0,C|=0,A||k(this,I,g,C,Math.pow(2,8*C)-1,0);var i=1;for(this[g+(A=C-1)]=255&I;0<=--A&&(i*=256);)this[g+A]=I/i&255;return g+C},Y.prototype.writeUInt8=function(I,g,C){return I=+I,g|=0,C||k(this,I,g,1,255,0),Y.TYPED_ARRAY_SUPPORT||(I=Math.floor(I)),this[g]=255&I,g+1},Y.prototype.writeUInt16LE=function(I,g,C){return I=+I,g|=0,C||k(this,I,g,2,65535,0),Y.TYPED_ARRAY_SUPPORT?(this[g]=255&I,this[g+1]=I>>>8):T(this,I,g,!0),g+2},Y.prototype.writeUInt16BE=function(I,g,C){return I=+I,g|=0,C||k(this,I,g,2,65535,0),Y.TYPED_ARRAY_SUPPORT?(this[g]=I>>>8,this[g+1]=255&I):T(this,I,g,!1),g+2},Y.prototype.writeUInt32LE=function(I,g,C){return I=+I,g|=0,C||k(this,I,g,4,4294967295,0),Y.TYPED_ARRAY_SUPPORT?(this[g+3]=I>>>24,this[g+2]=I>>>16,this[g+1]=I>>>8,this[g]=255&I):U(this,I,g,!0),g+4},Y.prototype.writeUInt32BE=function(I,g,C){return I=+I,g|=0,C||k(this,I,g,4,4294967295,0),Y.TYPED_ARRAY_SUPPORT?(this[g]=I>>>24,this[g+1]=I>>>16,this[g+2]=I>>>8,this[g+3]=255&I):U(this,I,g,!1),g+4},Y.prototype.writeIntLE=function(I,g,C,A){I=+I,g|=0,A||k(this,I,g,C,(A=Math.pow(2,8*C-1))-1,-A),A=0;var i=1,c=0;for(this[g]=255&I;++A<C&&(i*=256);)0>I&&0===c&&0!==this[g+A-1]&&(c=1),this[g+A]=(I/i>>0)-c&255;return g+C},Y.prototype.writeIntBE=function(I,g,C,A){I=+I,g|=0,A||k(this,I,g,C,(A=Math.pow(2,8*C-1))-1,-A);var i=1,c=0;for(this[g+(A=C-1)]=255&I;0<=--A&&(i*=256);)0>I&&0===c&&0!==this[g+A+1]&&(c=1),this[g+A]=(I/i>>0)-c&255;return g+C},Y.prototype.writeInt8=function(I,g,C){return I=+I,g|=0,C||k(this,I,g,1,127,-128),Y.TYPED_ARRAY_SUPPORT||(I=Math.floor(I)),0>I&&(I=255+I+1),this[g]=255&I,g+1},Y.prototype.writeInt16LE=function(I,g,C){return I=+I,g|=0,C||k(this,I,g,2,32767,-32768),Y.TYPED_ARRAY_SUPPORT?(this[g]=255&I,this[g+1]=I>>>8):T(this,I,g,!0),g+2},Y.prototype.writeInt16BE=function(I,g,C){return I=+I,g|=0,C||k(this,I,g,2,32767,-32768),Y.TYPED_ARRAY_SUPPORT?(this[g]=I>>>8,this[g+1]=255&I):T(this,I,g,!1),g+2},Y.prototype.writeInt32LE=function(I,g,C){return I=+I,g|=0,C||k(this,I,g,4,2147483647,-2147483648),Y.TYPED_ARRAY_SUPPORT?(this[g]=255&I,this[g+1]=I>>>8,this[g+2]=I>>>16,this[g+3]=I>>>24):U(this,I,g,!0),g+4},Y.prototype.writeInt32BE=function(I,g,C){return I=+I,g|=0,C||k(this,I,g,4,2147483647,-2147483648),0>I&&(I=4294967295+I+1),Y.TYPED_ARRAY_SUPPORT?(this[g]=I>>>24,this[g+1]=I>>>16,this[g+2]=I>>>8,this[g+3]=255&I):U(this,I,g,!1),g+4},Y.prototype.writeFloatLE=function(I,g,C){return C||z(this,0,g,4),V(this,I,g,!0,23,4),g+4},Y.prototype.writeFloatBE=function(I,g,C){return C||z(this,0,g,4),V(this,I,g,!1,23,4),g+4},Y.prototype.writeDoubleLE=function(I,g,C){return C||z(this,0,g,8),V(this,I,g,!0,52,8),g+8},Y.prototype.writeDoubleBE=function(I,g,C){return C||z(this,0,g,8),V(this,I,g,!1,52,8),g+8},Y.prototype.copy=function(I,g,C,A){if(C||(C=0),A||0===A||(A=this.length),g>=I.length&&(g=I.length),g||(g=0),0<A&&A<C&&(A=C),A===C||0===I.length||0===this.length)return 0;if(0>g)throw new RangeError("targetStart out of bounds");if(0>C||C>=this.length)throw new RangeError("sourceStart out of bounds");if(0>A)throw new RangeError("sourceEnd out of bounds");A>this.length&&(A=this.length),I.length-g<A-C&&(A=I.length-g+C);var i=A-C;if(this===I&&C<g&&g<A)for(A=i-1;0<=A;--A)I[A+g]=this[A+C];else if(1e3>i||!Y.TYPED_ARRAY_SUPPORT)for(A=0;A<i;++A)I[A+g]=this[A+C];else Uint8Array.prototype.set.call(I,this.subarray(C,C+i),g);return i},Y.prototype.fill=function(I,g,C,A){if("string"===typeof I){if("string"===typeof g?(A=g,g=0,C=this.length):"string"===typeof C&&(A=C,C=this.length),1===I.length){var i=I.charCodeAt(0);256>i&&(I=i)}if(void 0!==A&&"string"!==typeof A)throw new TypeError("encoding must be a string");if("string"===typeof A&&!Y.isEncoding(A))throw new TypeError("Unknown encoding: "+A)}else"number"===typeof I&&(I&=255);if(0>g||this.length<g||this.length<C)throw new RangeError("Out of range index");if(C<=g)return this;if(g>>>=0,C=void 0===C?this.length:C>>>0,I||(I=0),"number"===typeof I)for(A=g;A<C;++A)this[A]=I;else for(i=(I=H(I)?I:M(new Y(I,A).toString())).length,A=0;A<C-g;++A)this[A+g]=I[A%i];return this};var E=/[^+\/0-9A-Za-z-_]/g;function M(I,g){g=g||1/0;for(var C,A=I.length,i=null,c=[],G=0;G<A;++G){if(55295<(C=I.charCodeAt(G))&&57344>C){if(!i){if(56319<C){-1<(g-=3)&&c.push(239,191,189);continue}if(G+1===A){-1<(g-=3)&&c.push(239,191,189);continue}i=C;continue}if(56320>C){-1<(g-=3)&&c.push(239,191,189),i=C;continue}C=65536+(i-55296<<10|C-56320)}else i&&-1<(g-=3)&&c.push(239,191,189);if(i=null,128>C){if(0>--g)break;c.push(C)}else if(2048>C){if(0>(g-=2))break;c.push(C>>6|192,63&C|128)}else if(65536>C){if(0>(g-=3))break;c.push(C>>12|224,C>>6&63|128,63&C|128)}else{if(!(1114112>C))throw Error("Invalid code point");if(0>(g-=4))break;c.push(C>>18|240,C>>12&63|128,C>>6&63|128,63&C|128)}}return c}function D(I){for(var g=[],C=0;C<I.length;++C)g.push(255&I.charCodeAt(C));return g}function O(I){if(2>(I=(I.trim?I.trim():I.replace(/^\s+|\s+$/g,"")).replace(E,"")).length)I="";else for(;0!==I.length%4;)I+="=";m||e();var g=I.length;if(0<g%4)throw Error("Invalid string. Length must be a multiple of 4");var C="="===I[g-2]?2:"="===I[g-1]?1:0,A=new d(3*g/4-C),i=0<C?g-4:g,c=0;for(g=0;g<i;g+=4){var G=u[I.charCodeAt(g)]<<18|u[I.charCodeAt(g+1)]<<12|u[I.charCodeAt(g+2)]<<6|u[I.charCodeAt(g+3)];A[c++]=G>>16&255,A[c++]=G>>8&255,A[c++]=255&G}return 2===C?(G=u[I.charCodeAt(g)]<<2|u[I.charCodeAt(g+1)]>>4,A[c++]=255&G):1===C&&(G=u[I.charCodeAt(g)]<<10|u[I.charCodeAt(g+1)]<<4|u[I.charCodeAt(g+2)]>>2,A[c++]=G>>8&255,A[c++]=255&G),A}function P(I,g,C,A){for(var i=0;i<A&&!(i+C>=g.length||i>=I.length);++i)g[i+C]=I[i];return i}function q(I){return null!=I&&(!!I._isBuffer||j(I)||"function"===typeof I.readFloatLE&&"function"===typeof I.slice&&j(I.slice(0,0)))}function j(I){return!!I.constructor&&"function"===typeof I.constructor.isBuffer&&I.constructor.isBuffer(I)}var Q=Object.freeze({__proto__:null,INSPECT_MAX_BYTES:50,kMaxLength:s,Buffer:Y,SlowBuffer:function(I){return+I!=I&&(I=0),Y.alloc(+I)},isBuffer:q}),_=Y,$="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof C.g?C.g:"undefined"!==typeof self?self:{};function II(I,g){return I(g={exports:{}},g.exports),g.exports}function gI(){throw Error("setTimeout has not been defined")}function CI(){throw Error("clearTimeout has not been defined")}var AI=gI,iI=CI;function cI(I){if(AI===setTimeout)return setTimeout(I,0);if((AI===gI||!AI)&&setTimeout)return AI=setTimeout,setTimeout(I,0);try{return AI(I,0)}catch(g){try{return AI.call(null,I,0)}catch(C){return AI.call(this,I,0)}}}"function"===typeof o.setTimeout&&(AI=setTimeout),"function"===typeof o.clearTimeout&&(iI=clearTimeout);var GI,lI=[],bI=!1,ZI=-1;function tI(){bI&&GI&&(bI=!1,GI.length?lI=GI.concat(lI):ZI=-1,lI.length&&oI())}function oI(){if(!bI){var I=cI(tI);bI=!0;for(var g=lI.length;g;){for(GI=lI,lI=[];++ZI<g;)GI&&GI[ZI].run();ZI=-1,g=lI.length}GI=null,bI=!1,function(I){if(iI===clearTimeout)return clearTimeout(I);if((iI===CI||!iI)&&clearTimeout)return iI=clearTimeout,clearTimeout(I);try{iI(I)}catch(g){try{return iI.call(null,I)}catch(C){return iI.call(this,I)}}}(I)}}function nI(I){var g=Array(arguments.length-1);if(1<arguments.length)for(var C=1;C<arguments.length;C++)g[C-1]=arguments[C];lI.push(new uI(I,g)),1!==lI.length||bI||cI(oI)}function uI(I,g){this.fun=I,this.array=g}uI.prototype.run=function(){this.fun.apply(null,this.array)};var dI=o.performance||{},mI=(dI.now||dI.mozNow||dI.msNow||dI.oNow||dI.webkitNow,new Date,function(){return"/"}),eI=II((function(I,g){function C(I,g){for(var C in I)g[C]=I[C]}function A(I,g,C){return i(I,g,C)}var i=Q.Buffer;i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?I.exports=Q:(C(Q,g),g.Buffer=A),A.prototype=Object.create(i.prototype),C(i,A),A.from=function(I,g,C){if("number"===typeof I)throw new TypeError("Argument must not be a number");return i(I,g,C)},A.alloc=function(I,g,C){if("number"!==typeof I)throw new TypeError("Argument must be a number");return I=i(I),void 0!==g?"string"===typeof C?I.fill(g,C):I.fill(g):I.fill(0),I},A.allocUnsafe=function(I){if("number"!==typeof I)throw new TypeError("Argument must be a number");return i(I)},A.allocUnsafeSlow=function(I){if("number"!==typeof I)throw new TypeError("Argument must be a number");return Q.SlowBuffer(I)}})),BI=II((function(I,g){function C(){throw Error("secure random number generation not supported by this browser\nuse chrome, FireFox or Internet Explorer 11")}function A(I,g){if("number"!==typeof I||I!==I)throw new TypeError("offset must be a number");if(I>Z||0>I)throw new TypeError("offset must be a uint32");if(I>l||I>g)throw new RangeError("offset out of range")}function i(I,g,C){if("number"!==typeof I||I!==I)throw new TypeError("size must be a number");if(I>Z||0>I)throw new TypeError("size must be a uint32");if(I+g>C||I>l)throw new RangeError("buffer too small")}function c(I,g,C,A){if(g=new Uint8Array(I.buffer,g,C),b.getRandomValues(g),!A)return I;nI((function(){A(null,I)}))}var G=eI.Buffer,l=eI.kMaxLength,b=$.crypto||$.msCrypto,Z=Math.pow(2,32)-1;b&&b.getRandomValues?(g.randomFill=function(I,g,C,l){if(!(G.isBuffer(I)||I instanceof $.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');if("function"===typeof g)l=g,g=0,C=I.length;else if("function"===typeof C)l=C,C=I.length-g;else if("function"!==typeof l)throw new TypeError('"cb" argument must be a function');return A(g,I.length),i(C,g,I.length),c(I,g,C,l)},g.randomFillSync=function(I,g,C){if("undefined"===typeof g&&(g=0),!(G.isBuffer(I)||I instanceof $.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');return A(g,I.length),void 0===C&&(C=I.length-g),i(C,g,I.length),c(I,g,C)}):(g.randomFill=C,g.randomFillSync=C)})),XI=II((function(I){I.exports=BI})).randomFillSync,yI=Math.floor(.001*(Date.now()-performance.now()));function VI(I){if("string"!==typeof I)throw new TypeError("Path must be a string. Received "+JSON.stringify(I))}function hI(I,g){for(var C,A="",i=0,c=-1,G=0,l=0;l<=I.length;++l){if(l<I.length)C=I.charCodeAt(l);else{if(47===C)break;C=47}if(47===C){if(c!==l-1&&1!==G)if(c!==l-1&&2===G){if(2>A.length||2!==i||46!==A.charCodeAt(A.length-1)||46!==A.charCodeAt(A.length-2))if(2<A.length){if((c=A.lastIndexOf("/"))!==A.length-1){-1===c?(A="",i=0):i=(A=A.slice(0,c)).length-1-A.lastIndexOf("/"),c=l,G=0;continue}}else if(2===A.length||1===A.length){A="",i=0,c=l,G=0;continue}g&&(A=0<A.length?A+"/..":"..",i=2)}else A=0<A.length?A+"/"+I.slice(c+1,l):I.slice(c+1,l),i=l-c-1;c=l,G=0}else 46===C&&-1!==G?++G:G=-1}return A}var aI,sI={resolve:function(){for(var I,g="",C=!1,A=arguments.length-1;-1<=A&&!C;A--){if(0<=A)var i=arguments[A];else void 0===I&&(I=mI()),i=I;VI(i),0!==i.length&&(g=i+"/"+g,C=47===i.charCodeAt(0))}return g=hI(g,!C),C?0<g.length?"/"+g:"/":0<g.length?g:"."},normalize:function(I){if(VI(I),0===I.length)return".";var g=47===I.charCodeAt(0),C=47===I.charCodeAt(I.length-1);return 0!==(I=hI(I,!g)).length||g||(I="."),0<I.length&&C&&(I+="/"),g?"/"+I:I},isAbsolute:function(I){return VI(I),0<I.length&&47===I.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var I,g=0;g<arguments.length;++g){var C=arguments[g];VI(C),0<C.length&&(I=void 0===I?C:I+"/"+C)}return void 0===I?".":sI.normalize(I)},relative:function(I,g){if(VI(I),VI(g),I===g)return"";if((I=sI.resolve(I))===(g=sI.resolve(g)))return"";for(var C=1;C<I.length&&47===I.charCodeAt(C);++C);for(var A=I.length,i=A-C,c=1;c<g.length&&47===g.charCodeAt(c);++c);for(var G=g.length-c,l=i<G?i:G,b=-1,Z=0;Z<=l;++Z){if(Z===l){if(G>l){if(47===g.charCodeAt(c+Z))return g.slice(c+Z+1);if(0===Z)return g.slice(c+Z)}else i>l&&(47===I.charCodeAt(C+Z)?b=Z:0===Z&&(b=0));break}var t=I.charCodeAt(C+Z);if(t!==g.charCodeAt(c+Z))break;47===t&&(b=Z)}for(i="",Z=C+b+1;Z<=A;++Z)Z!==A&&47!==I.charCodeAt(Z)||(i=0===i.length?i+"..":i+"/..");return 0<i.length?i+g.slice(c+b):(c+=b,47===g.charCodeAt(c)&&++c,g.slice(c))},_makeLong:function(I){return I},dirname:function(I){if(VI(I),0===I.length)return".";for(var g=I.charCodeAt(0),C=47===g,A=-1,i=!0,c=I.length-1;1<=c;--c)if(47===(g=I.charCodeAt(c))){if(!i){A=c;break}}else i=!1;return-1===A?C?"/":".":C&&1===A?"//":I.slice(0,A)},basename:function(I,g){if(void 0!==g&&"string"!==typeof g)throw new TypeError('"ext" argument must be a string');VI(I);var C,A=0,i=-1,c=!0;if(void 0!==g&&0<g.length&&g.length<=I.length){if(g.length===I.length&&g===I)return"";var G=g.length-1,l=-1;for(C=I.length-1;0<=C;--C){var b=I.charCodeAt(C);if(47===b){if(!c){A=C+1;break}}else-1===l&&(c=!1,l=C+1),0<=G&&(b===g.charCodeAt(G)?-1===--G&&(i=C):(G=-1,i=l))}return A===i?i=l:-1===i&&(i=I.length),I.slice(A,i)}for(C=I.length-1;0<=C;--C)if(47===I.charCodeAt(C)){if(!c){A=C+1;break}}else-1===i&&(c=!1,i=C+1);return-1===i?"":I.slice(A,i)},extname:function(I){VI(I);for(var g=-1,C=0,A=-1,i=!0,c=0,G=I.length-1;0<=G;--G){var l=I.charCodeAt(G);if(47===l){if(!i){C=G+1;break}}else-1===A&&(i=!1,A=G+1),46===l?-1===g?g=G:1!==c&&(c=1):-1!==g&&(c=-1)}return-1===g||-1===A||0===c||1===c&&g===A-1&&g===C+1?"":I.slice(g,A)},format:function(I){if(null===I||"object"!==typeof I)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof I);var g=I.dir||I.root,C=I.base||(I.name||"")+(I.ext||"");return I=g?g===I.root?g+C:g+"/"+C:C},parse:function(I){VI(I);var g={root:"",dir:"",base:"",ext:"",name:""};if(0===I.length)return g;var C=I.charCodeAt(0),A=47===C;if(A){g.root="/";var i=1}else i=0;for(var c=-1,G=0,l=-1,b=!0,Z=I.length-1,t=0;Z>=i;--Z)if(47===(C=I.charCodeAt(Z))){if(!b){G=Z+1;break}}else-1===l&&(b=!1,l=Z+1),46===C?-1===c?c=Z:1!==t&&(t=1):-1!==c&&(t=-1);return-1===c||-1===l||0===t||1===t&&c===l-1&&c===G+1?-1!==l&&(g.base=g.name=0===G&&A?I.slice(1,l):I.slice(G,l)):(0===G&&A?(g.name=I.slice(1,c),g.base=I.slice(1,l)):(g.name=I.slice(G,c),g.base=I.slice(G,l)),g.ext=I.slice(c,l)),0<G?g.dir=I.slice(0,G-1):A&&(g.dir="/"),g},sep:"/",delimiter:":",win32:null,posix:null},rI=sI.posix=sI,YI={hrtime:function(I){return 1e9*(I=function(I){var g=.001*performance.now(),C=Math.floor(g)+yI;return g=Math.floor(g%1*1e9),I&&(C-=I[0],0>(g-=I[1])&&(C--,g+=1e9)),[C,g]}(I))[0]+I[1]},exit:function(I){throw new yg(I)},kill:function(I){throw new Vg(I)},randomFillSync:XI,isTTY:function(){return!0},path:Object.freeze({__proto__:null,default:rI,__moduleExports:rI}),fs:null},WI=Z(1),SI=Z(2),pI=Z(4),KI=Z(8),RI=Z(16),HI=Z(32),JI=Z(64),FI=Z(128),wI=Z(256),fI=Z(512),vI=Z(1024),xI=Z(2048),NI=Z(4096),LI=Z(8192),kI=Z(16384),TI=Z(32768),UI=Z(65536),zI=Z(131072),EI=Z(262144),MI=Z(524288),DI=Z(1048576),OI=Z(2097152),PI=Z(4194304),qI=Z(8388608),jI=Z(16777216),QI=Z(33554432),_I=Z(67108864),$I=Z(134217728),Ig=Z(268435456),gg=WI|SI|pI|KI|RI|HI|JI|FI|wI|fI|vI|xI|NI|LI|kI|TI|UI|zI|EI|MI|DI|OI|qI|PI|jI|_I|QI|$I|Ig,Cg=WI|SI|pI|KI|RI|HI|JI|FI|wI|OI|PI|qI|$I,Ag=Z(0),ig=KI|RI|FI|fI|vI|xI|NI|LI|kI|TI|UI|zI|EI|MI|DI|OI|qI|jI|_I|QI|$I,cg=ig|Cg,Gg=SI|KI|JI|OI|$I|Ig,lg=SI|KI|JI|OI|$I,bg=Z(0),Zg={E2BIG:1,EACCES:2,EADDRINUSE:3,EADDRNOTAVAIL:4,EAFNOSUPPORT:5,EALREADY:7,EAGAIN:6,EBADF:8,EBADMSG:9,EBUSY:10,ECANCELED:11,ECHILD:12,ECONNABORTED:13,ECONNREFUSED:14,ECONNRESET:15,EDEADLOCK:16,EDESTADDRREQ:17,EDOM:18,EDQUOT:19,EEXIST:20,EFAULT:21,EFBIG:22,EHOSTDOWN:23,EHOSTUNREACH:23,EIDRM:24,EILSEQ:25,EINPROGRESS:26,EINTR:27,EINVAL:28,EIO:29,EISCONN:30,EISDIR:31,ELOOP:32,EMFILE:33,EMLINK:34,EMSGSIZE:35,EMULTIHOP:36,ENAMETOOLONG:37,ENETDOWN:38,ENETRESET:39,ENETUNREACH:40,ENFILE:41,ENOBUFS:42,ENODEV:43,ENOENT:44,ENOEXEC:45,ENOLCK:46,ENOLINK:47,ENOMEM:48,ENOMSG:49,ENOPROTOOPT:50,ENOSPC:51,ENOSYS:52,ENOTCONN:53,ENOTDIR:54,ENOTEMPTY:55,ENOTRECOVERABLE:56,ENOTSOCK:57,ENOTTY:59,ENXIO:60,EOVERFLOW:61,EOWNERDEAD:62,EPERM:63,EPIPE:64,EPROTO:65,EPROTONOSUPPORT:66,EPROTOTYPE:67,ERANGE:68,EROFS:69,ESPIPE:70,ESRCH:71,ESTALE:72,ETIMEDOUT:73,ETXTBSY:74,EXDEV:75},tg=((aI={})[6]="SIGHUP",aI[8]="SIGINT",aI[11]="SIGQUIT",aI[7]="SIGILL",aI[15]="SIGTRAP",aI[0]="SIGABRT",aI[2]="SIGBUS",aI[5]="SIGFPE",aI[9]="SIGKILL",aI[20]="SIGUSR1",aI[12]="SIGSEGV",aI[21]="SIGUSR2",aI[10]="SIGPIPE",aI[1]="SIGALRM",aI[14]="SIGTERM",aI[3]="SIGCHLD",aI[4]="SIGCONT",aI[13]="SIGSTOP",aI[16]="SIGTSTP",aI[17]="SIGTTIN",aI[18]="SIGTTOU",aI[19]="SIGURG",aI[23]="SIGXCPU",aI[24]="SIGXFSZ",aI[22]="SIGVTALRM",aI),og=WI|SI|RI|FI|OI|$I,ng=WI|JI|RI|FI|OI|$I;function ug(I){var g=Math.trunc(I);return I=Z(Math.round(1e6*(I-g))),Z(g)*Z(1e6)+I}function dg(I){return"number"===typeof I&&(I=Math.trunc(I)),I=Z(I),Number(I/Z(1e6))}function mg(I){return function(){for(var g=[],C=0;C<arguments.length;C++)g[C]=arguments[C];try{return I.apply(void 0,l(g))}catch(A){if(A&&A.code&&"string"===typeof A.code)return Zg[A.code]||28;if(A instanceof Xg)return A.errno;throw A}}}function eg(I,g){var C=I.FD_MAP.get(g);if(!C)throw new Xg(8);if(void 0===C.filetype){var A=I.bindings.fs.fstatSync(C.real);g=(I=Bg(I,g,A)).rightsBase,A=I.rightsInheriting,C.filetype=I.filetype,C.rights||(C.rights={base:g,inheriting:A})}return C}function Bg(I,g,C){switch(!0){case C.isBlockDevice():return{filetype:1,rightsBase:gg,rightsInheriting:gg};case C.isCharacterDevice():return void 0!==g&&I.bindings.isTTY(g)?{filetype:2,rightsBase:lg,rightsInheriting:bg}:{filetype:2,rightsBase:gg,rightsInheriting:gg};case C.isDirectory():return{filetype:3,rightsBase:ig,rightsInheriting:cg};case C.isFIFO():return{filetype:6,rightsBase:Gg,rightsInheriting:gg};case C.isFile():return{filetype:4,rightsBase:Cg,rightsInheriting:Ag};case C.isSocket():return{filetype:6,rightsBase:Gg,rightsInheriting:gg};case C.isSymbolicLink():return{filetype:7,rightsBase:Z(0),rightsInheriting:Z(0)};default:return{filetype:0,rightsBase:Z(0),rightsInheriting:Z(0)}}}var Xg=function(I){function g(C){var A=I.call(this)||this;return A.errno=C,Object.setPrototypeOf(A,g.prototype),A}return i(g,I),g}(Error),yg=function(I){function g(C){var A=I.call(this,"WASI Exit error: "+C)||this;return A.code=C,Object.setPrototypeOf(A,g.prototype),A}return i(g,I),g}(Error),Vg=function(I){function g(C){var A=I.call(this,"WASI Kill signal: "+C)||this;return A.signal=C,Object.setPrototypeOf(A,g.prototype),A}return i(g,I),g}(Error),hg=function(){function I(I){function g(I){switch(I){case 1:return u.hrtime();case 0:return ug(Date.now());case 2:case 3:return u.hrtime()-r;default:return null}}function C(I,g){if(I=eg(b,I),g!==Z(0)&&(I.rights.base&g)===Z(0))throw new Xg(63);return I}function A(I,g){return b.refreshMemory(),Array.from({length:g},(function(g,C){return C=I+8*C,g=b.view.getUint32(C,!0),C=b.view.getUint32(C+4,!0),new Uint8Array(b.memory.buffer,g,C)}))}var i,b=this,t={};I&&I.preopens?t=I.preopens:I&&I.preopenDirectories&&(t=I.preopenDirectories);var o={};I&&I.env&&(o=I.env);var n=[];I&&I.args&&(n=I.args);var u=YI;I&&I.bindings&&(u=I.bindings),this.view=this.memory=void 0,this.bindings=u,this.FD_MAP=new Map([[0,{real:0,filetype:2,rights:{base:og,inheriting:Z(0)},path:void 0}],[1,{real:1,filetype:2,rights:{base:ng,inheriting:Z(0)},path:void 0}],[2,{real:2,filetype:2,rights:{base:ng,inheriting:Z(0)},path:void 0}]]);var d=this.bindings.fs,m=this.bindings.path;try{for(var e=c(Object.entries(t)),B=e.next();!B.done;B=e.next()){var X=G(B.value,2),y=X[0],V=X[1],h=d.openSync(V,d.constants.O_RDONLY),a=l(this.FD_MAP.keys()).reverse()[0]+1;this.FD_MAP.set(a,{real:h,filetype:3,rights:{base:ig,inheriting:cg},fakePath:y,path:V})}}catch(Y){var s={error:Y}}finally{try{B&&!B.done&&(i=e.return)&&i.call(e)}finally{if(s)throw s.error}}var r=u.hrtime();this.wasiImport={args_get:function(I,g){b.refreshMemory();var C=I,A=g;return n.forEach((function(I){b.view.setUint32(C,A,!0),C+=4,A+=_.from(b.memory.buffer).write(I+"\0",A)})),0},args_sizes_get:function(I,g){return b.refreshMemory(),b.view.setUint32(I,n.length,!0),I=n.reduce((function(I,g){return I+_.byteLength(g)+1}),0),b.view.setUint32(g,I,!0),0},environ_get:function(I,g){b.refreshMemory();var C=I,A=g;return Object.entries(o).forEach((function(I){var g=G(I,2);I=g[0],g=g[1],b.view.setUint32(C,A,!0),C+=4,A+=_.from(b.memory.buffer).write(I+"="+g+"\0",A)})),0},environ_sizes_get:function(I,g){b.refreshMemory();var C=Object.entries(o).map((function(I){return(I=G(I,2))[0]+"="+I[1]+"\0"})),A=C.reduce((function(I,g){return I+_.byteLength(g)}),0);return b.view.setUint32(I,C.length,!0),b.view.setUint32(g,A,!0),0},clock_res_get:function(I,g){switch(I){case 1:case 2:case 3:var C=Z(1);break;case 0:C=Z(1e3)}return b.view.setBigUint64(g,C),0},clock_time_get:function(I,C,A){return b.refreshMemory(),null===(I=g(I))?28:(b.view.setBigUint64(A,Z(I),!0),0)},fd_advise:mg((function(I){return C(I,FI),52})),fd_allocate:mg((function(I){return C(I,wI),52})),fd_close:mg((function(I){var g=C(I,Z(0));return d.closeSync(g.real),b.FD_MAP.delete(I),0})),fd_datasync:mg((function(I){return I=C(I,WI),d.fdatasyncSync(I.real),0})),fd_fdstat_get:mg((function(I,g){return I=C(I,Z(0)),b.refreshMemory(),b.view.setUint8(g,I.filetype),b.view.setUint16(g+2,0,!0),b.view.setUint16(g+4,0,!0),b.view.setBigUint64(g+8,Z(I.rights.base),!0),b.view.setBigUint64(g+8+8,Z(I.rights.inheriting),!0),0})),fd_fdstat_set_flags:mg((function(I){return C(I,KI),52})),fd_fdstat_set_rights:mg((function(I,g,A){return((I=C(I,Z(0))).rights.base|g)>I.rights.base||(I.rights.inheriting|A)>I.rights.inheriting?63:(I.rights.base=g,I.rights.inheriting=A,0)})),fd_filestat_get:mg((function(I,g){I=C(I,OI);var A=d.fstatSync(I.real);return b.refreshMemory(),b.view.setBigUint64(g,Z(A.dev),!0),g+=8,b.view.setBigUint64(g,Z(A.ino),!0),g+=8,b.view.setUint8(g,I.filetype),g+=8,b.view.setBigUint64(g,Z(A.nlink),!0),g+=8,b.view.setBigUint64(g,Z(A.size),!0),g+=8,b.view.setBigUint64(g,ug(A.atimeMs),!0),g+=8,b.view.setBigUint64(g,ug(A.mtimeMs),!0),b.view.setBigUint64(g+8,ug(A.ctimeMs),!0),0})),fd_filestat_set_size:mg((function(I,g){return I=C(I,PI),d.ftruncateSync(I.real,Number(g)),0})),fd_filestat_set_times:mg((function(I,A,i,c){I=C(I,qI);var G=d.fstatSync(I.real),l=G.atime;G=G.mtime;var b=dg(g(0));return 3===(3&c)||12===(12&c)?28:(1===(1&c)?l=dg(A):2===(2&c)&&(l=b),4===(4&c)?G=dg(i):8===(8&c)&&(G=b),d.futimesSync(I.real,new Date(l),new Date(G)),0)})),fd_prestat_get:mg((function(I,g){return(I=C(I,Z(0))).path?(b.refreshMemory(),b.view.setUint8(g,0),b.view.setUint32(g+4,_.byteLength(I.fakePath),!0),0):28})),fd_prestat_dir_name:mg((function(I,g,A){return(I=C(I,Z(0))).path?(b.refreshMemory(),_.from(b.memory.buffer).write(I.fakePath,g,A,"utf8"),0):28})),fd_pwrite:mg((function(I,g,i,c,G){var l=C(I,JI|pI),Z=0;return A(g,i).forEach((function(I){for(var g=0;g<I.byteLength;)g+=d.writeSync(l.real,I,g,I.byteLength-g,Number(c)+Z+g);Z+=g})),b.view.setUint32(G,Z,!0),0})),fd_write:mg((function(I,g,i,c){var G=C(I,JI),l=0;return A(g,i).forEach((function(I){for(var g=0;g<I.byteLength;){var C=d.writeSync(G.real,I,g,I.byteLength-g,G.offset?Number(G.offset):null);G.offset&&(G.offset+=Z(C)),g+=C}l+=g})),b.view.setUint32(c,l,!0),0})),fd_pread:mg((function(I,g,i,G,l){var Z;I=C(I,SI|pI);var t=0;try{var o=c(A(g,i)),n=o.next();I:for(;!n.done;n=o.next()){var u=n.value;for(g=0;g<u.byteLength;){var m=u.byteLength-g,e=d.readSync(I.real,u,g,u.byteLength-g,Number(G)+t+g);if(g+=e,t+=e,0===e||e<m)break I}t+=g}}catch(X){var B={error:X}}finally{try{n&&!n.done&&(Z=o.return)&&Z.call(o)}finally{if(B)throw B.error}}return b.view.setUint32(l,t,!0),0})),fd_read:mg((function(I,g,i,G){var l,t=0===(I=C(I,SI)).real,o=0;try{var n=c(A(g,i)),u=n.next();I:for(;!u.done;u=n.next()){var m=u.value;for(g=0;g<m.byteLength;){var e=m.byteLength-g,B=d.readSync(I.real,m,g,e,t||void 0===I.offset?null:Number(I.offset));if(t||(I.offset=(I.offset?I.offset:Z(0))+Z(B)),g+=B,o+=B,0===B||B<e)break I}}}catch(y){var X={error:y}}finally{try{u&&!u.done&&(l=n.return)&&l.call(n)}finally{if(X)throw X.error}}return b.view.setUint32(G,o,!0),0})),fd_readdir:mg((function(I,g,A,i,c){I=C(I,kI),b.refreshMemory();var G=d.readdirSync(I.path,{withFileTypes:!0}),l=g;for(i=Number(i);i<G.length;i+=1){var t=G[i],o=_.byteLength(t.name);if(g-l>A)break;if(b.view.setBigUint64(g,Z(i+1),!0),(g+=8)-l>A)break;var n=d.statSync(m.resolve(I.path,t.name));if(b.view.setBigUint64(g,Z(n.ino),!0),(g+=8)-l>A)break;if(b.view.setUint32(g,o,!0),(g+=4)-l>A)break;switch(!0){case n.isBlockDevice():n=1;break;case n.isCharacterDevice():n=2;break;case n.isDirectory():n=3;break;case n.isFIFO():n=6;break;case n.isFile():n=4;break;case n.isSocket():n=6;break;case n.isSymbolicLink():n=7;break;default:n=0}if(b.view.setUint8(g,n),g+=1,(g+=3)+o>=l+A)break;_.from(b.memory.buffer).write(t.name,g),g+=o}return b.view.setUint32(c,Math.min(g-l,A),!0),0})),fd_renumber:mg((function(I,g){return C(I,Z(0)),C(g,Z(0)),d.closeSync(b.FD_MAP.get(I).real),b.FD_MAP.set(I,b.FD_MAP.get(g)),b.FD_MAP.delete(g),0})),fd_seek:mg((function(I,g,A,i){switch(I=C(I,pI),b.refreshMemory(),A){case 1:I.offset=(I.offset?I.offset:Z(0))+Z(g);break;case 2:A=d.fstatSync(I.real).size,I.offset=Z(A)+Z(g);break;case 0:I.offset=Z(g)}return b.view.setBigUint64(i,I.offset,!0),0})),fd_tell:mg((function(I,g){return I=C(I,HI),b.refreshMemory(),I.offset||(I.offset=Z(0)),b.view.setBigUint64(g,I.offset,!0),0})),fd_sync:mg((function(I){return I=C(I,RI),d.fsyncSync(I.real),0})),path_create_directory:mg((function(I,g,A){return(I=C(I,fI)).path?(b.refreshMemory(),g=_.from(b.memory.buffer,g,A).toString(),d.mkdirSync(m.resolve(I.path,g)),0):28})),path_filestat_get:mg((function(I,g,A,i,c){return(I=C(I,EI)).path?(b.refreshMemory(),A=_.from(b.memory.buffer,A,i).toString(),A=d.statSync(m.resolve(I.path,A)),b.view.setBigUint64(c,Z(A.dev),!0),c+=8,b.view.setBigUint64(c,Z(A.ino),!0),c+=8,b.view.setUint8(c,Bg(b,void 0,A).filetype),c+=8,b.view.setBigUint64(c,Z(A.nlink),!0),c+=8,b.view.setBigUint64(c,Z(A.size),!0),c+=8,b.view.setBigUint64(c,ug(A.atimeMs),!0),c+=8,b.view.setBigUint64(c,ug(A.mtimeMs),!0),b.view.setBigUint64(c+8,ug(A.ctimeMs),!0),0):28})),path_filestat_set_times:mg((function(I,A,i,c,G,l,Z){if(!(I=C(I,DI)).path)return 28;b.refreshMemory();var t=d.fstatSync(I.real);A=t.atime,t=t.mtime;var o=dg(g(0));return 3===(3&Z)||12===(12&Z)?28:(1===(1&Z)?A=dg(G):2===(2&Z)&&(A=o),4===(4&Z)?t=dg(l):8===(8&Z)&&(t=o),i=_.from(b.memory.buffer,i,c).toString(),d.utimesSync(m.resolve(I.path,i),new Date(A),new Date(t)),0)})),path_link:mg((function(I,g,A,i,c,G,l){return I=C(I,xI),c=C(c,NI),I.path&&c.path?(b.refreshMemory(),A=_.from(b.memory.buffer,A,i).toString(),G=_.from(b.memory.buffer,G,l).toString(),d.linkSync(m.resolve(I.path,A),m.resolve(c.path,G)),0):28})),path_open:mg((function(I,g,A,i,c,G,t,o,n){g=C(I,LI),G=Z(G),t=Z(t),I=(G&(SI|kI))!==Z(0);var u=(G&(WI|JI|wI|PI))!==Z(0);if(u&&I)var e=d.constants.O_RDWR;else I?e=d.constants.O_RDONLY:u&&(e=d.constants.O_WRONLY);if(I=G|LI,G|=t,0!==(1&c)&&(e|=d.constants.O_CREAT,I|=vI),0!==(2&c)&&(e|=d.constants.O_DIRECTORY),0!==(4&c)&&(e|=d.constants.O_EXCL),0!==(8&c)&&(e|=d.constants.O_TRUNC,I|=MI),0!==(1&o)&&(e|=d.constants.O_APPEND),0!==(2&o)&&(e=d.constants.O_DSYNC?e|d.constants.O_DSYNC:e|d.constants.O_SYNC,G|=WI),0!==(4&o)&&(e|=d.constants.O_NONBLOCK),0!==(8&o)&&(e=d.constants.O_RSYNC?e|d.constants.O_RSYNC:e|d.constants.O_SYNC,G|=RI),0!==(16&o)&&(e|=d.constants.O_SYNC,G|=RI),u&&0===(e&(d.constants.O_APPEND|d.constants.O_TRUNC))&&(G|=pI),b.refreshMemory(),A=_.from(b.memory.buffer,A,i).toString(),A=m.resolve(g.path,A),m.relative(g.path,A).startsWith(".."))return 76;try{var B=d.realpathSync(A);if(m.relative(g.path,B).startsWith(".."))return 76}catch(y){if("ENOENT"!==y.code)throw y;B=A}try{var X=d.statSync(B).isDirectory()}catch(y){}return e=!u&&X?d.openSync(B,d.constants.O_RDONLY):d.openSync(B,e),X=l(b.FD_MAP.keys()).reverse()[0]+1,b.FD_MAP.set(X,{real:e,filetype:void 0,rights:{base:I,inheriting:G},path:B}),eg(b,X),b.view.setUint32(n,X,!0),0})),path_readlink:mg((function(I,g,A,i,c,G){return(I=C(I,TI)).path?(b.refreshMemory(),g=_.from(b.memory.buffer,g,A).toString(),g=m.resolve(I.path,g),g=d.readlinkSync(g),i=_.from(b.memory.buffer).write(g,i,c),b.view.setUint32(G,i,!0),0):28})),path_remove_directory:mg((function(I,g,A){return(I=C(I,QI)).path?(b.refreshMemory(),g=_.from(b.memory.buffer,g,A).toString(),d.rmdirSync(m.resolve(I.path,g)),0):28})),path_rename:mg((function(I,g,A,i,c,G){return I=C(I,UI),i=C(i,zI),I.path&&i.path?(b.refreshMemory(),g=_.from(b.memory.buffer,g,A).toString(),c=_.from(b.memory.buffer,c,G).toString(),d.renameSync(m.resolve(I.path,g),m.resolve(i.path,c)),0):28})),path_symlink:mg((function(I,g,A,i,c){return(A=C(A,jI)).path?(b.refreshMemory(),I=_.from(b.memory.buffer,I,g).toString(),i=_.from(b.memory.buffer,i,c).toString(),d.symlinkSync(I,m.resolve(A.path,i)),0):28})),path_unlink_file:mg((function(I,g,A){return(I=C(I,_I)).path?(b.refreshMemory(),g=_.from(b.memory.buffer,g,A).toString(),d.unlinkSync(m.resolve(I.path,g)),0):28})),poll_oneoff:function(I,C,A,i){var c=0,G=0;b.refreshMemory();for(var l=0;l<A;l+=1){var t=b.view.getBigUint64(I,!0);I+=8;var o=b.view.getUint8(I);switch(I+=1,o){case 0:I+=7,b.view.getBigUint64(I,!0),I+=8;var n=b.view.getUint32(I,!0);I+=4,I+=4,o=b.view.getBigUint64(I,!0),I+=8,b.view.getBigUint64(I,!0),I+=8;var d=b.view.getUint16(I,!0);I+=2,I+=6;var m=1===d;d=0,null===(n=Z(g(n)))?d=28:G=(o=m?o:n+o)>G?o:G,b.view.setBigUint64(C,t,!0),C+=8,b.view.setUint16(C,d,!0),C+=2,b.view.setUint8(C,0),C+=1,C+=5,c+=1;break;case 1:case 2:I+=3,b.view.getUint32(I,!0),I+=4,b.view.setBigUint64(C,t,!0),C+=8,b.view.setUint16(C,52,!0),C+=2,b.view.setUint8(C,o),C+=1,C+=5,c+=1;break;default:return 28}}for(b.view.setUint32(i,c,!0);u.hrtime()<G;);return 0},proc_exit:function(I){return u.exit(I),0},proc_raise:function(I){return I in tg?(u.kill(tg[I]),0):28},random_get:function(I,g){return b.refreshMemory(),u.randomFillSync(new Uint8Array(b.memory.buffer),I,g),0},sched_yield:function(){return 0},sock_recv:function(){return 52},sock_send:function(){return 52},sock_shutdown:function(){return 52}},I.traceSyscalls&&Object.keys(this.wasiImport).forEach((function(I){var g=b.wasiImport[I];b.wasiImport[I]=function(){for(var C=[],A=0;A<arguments.length;A++)C[A]=arguments[A];console.log("WASI: wasiImport called: "+I+" ("+C+")");try{var i=g.apply(void 0,l(C));return console.log("WASI:  => "+i),i}catch(c){throw console.log("Catched error: "+c),c}}}))}return I.prototype.refreshMemory=function(){this.view&&0!==this.view.buffer.byteLength||(this.view=new t(this.memory.buffer))},I.prototype.setMemory=function(I){this.memory=I},I.prototype.start=function(I){if(null===(I=I.exports)||"object"!==typeof I)throw Error("instance.exports must be an Object. Received "+I+".");var g=I.memory;if(!(g instanceof WebAssembly.Memory))throw Error("instance.exports.memory must be a WebAssembly.Memory. Recceived "+g+".");this.setMemory(g),I._start&&I._start()},I.prototype.getImportNamespace=function(I){var g,C=null;try{for(var A=c(WebAssembly.Module.imports(I)),i=A.next();!i.done;i=A.next()){var G=i.value;if("function"===G.kind&&G.module.startsWith("wasi_"))if(C){if(C!==G.module)throw Error("Multiple namespaces detected.")}else C=G.module}}catch(b){var l={error:b}}finally{try{i&&!i.done&&(g=A.return)&&g.call(A)}finally{if(l)throw l.error}}return C},I.prototype.getImports=function(I){switch(this.getImportNamespace(I)){case"wasi_unstable":return{wasi_unstable:this.wasiImport};case"wasi_snapshot_preview1":return{wasi_snapshot_preview1:this.wasiImport};default:throw Error("Can't detect a WASI namespace for the WebAssembly Module")}},I.defaultBindings=YI,I}();g.default=hg},4845:function(I,g,C){"use strict";var A=C(1187).default,i=C(7329).default,c=C(6843).default,G=C(7868).default,l=C(4837).default,b=C(36).default,Z=C(9823).default,t=C(6982).default,o=C(2975).default;Object.defineProperty(g,"__esModule",{value:!0});var n,u=C(104),d=C(2399),m=C(4343),e=C(8380),B=e.WASI_RIGHT_FD_DATASYNC|e.WASI_RIGHT_FD_READ|e.WASI_RIGHT_FD_SYNC|e.WASI_RIGHT_FD_ADVISE|e.WASI_RIGHT_FD_FILESTAT_GET|e.WASI_RIGHT_POLL_FD_READWRITE,X=e.WASI_RIGHT_FD_DATASYNC|e.WASI_RIGHT_FD_WRITE|e.WASI_RIGHT_FD_SYNC|e.WASI_RIGHT_FD_ADVISE|e.WASI_RIGHT_FD_FILESTAT_GET|e.WASI_RIGHT_POLL_FD_READWRITE,y=X,V=function(I){var g=Math.trunc(I),C=u.BigIntPolyfill(Math.round(1e6*(I-g)));return u.BigIntPolyfill(g)*u.BigIntPolyfill(1e6)+C},h=function(I){"number"===typeof I&&(I=Math.trunc(I));var g=u.BigIntPolyfill(I);return Number(g/u.BigIntPolyfill(1e6))},a=function(I){return function(){try{return I.apply(void 0,arguments)}catch(g){if(g&&g.code&&"string"===typeof g.code)return e.ERROR_MAP[g.code]||e.WASI_EINVAL;if(g instanceof Y)return g.errno;throw g}}},s=function(I,g){var C=I.FD_MAP.get(g);if(!C)throw new Y(e.WASI_EBADF);if(void 0===C.filetype){var A=I.bindings.fs.fstatSync(C.real),i=r(I,g,A),c=i.filetype,G=i.rightsBase,l=i.rightsInheriting;C.filetype=c,C.rights||(C.rights={base:G,inheriting:l})}return C},r=function(I,g,C){switch(!0){case C.isBlockDevice():return{filetype:e.WASI_FILETYPE_BLOCK_DEVICE,rightsBase:e.RIGHTS_BLOCK_DEVICE_BASE,rightsInheriting:e.RIGHTS_BLOCK_DEVICE_INHERITING};case C.isCharacterDevice():var A=e.WASI_FILETYPE_CHARACTER_DEVICE;return void 0!==g&&I.bindings.isTTY(g)?{filetype:A,rightsBase:e.RIGHTS_TTY_BASE,rightsInheriting:e.RIGHTS_TTY_INHERITING}:{filetype:A,rightsBase:e.RIGHTS_CHARACTER_DEVICE_BASE,rightsInheriting:e.RIGHTS_CHARACTER_DEVICE_INHERITING};case C.isDirectory():return{filetype:e.WASI_FILETYPE_DIRECTORY,rightsBase:e.RIGHTS_DIRECTORY_BASE,rightsInheriting:e.RIGHTS_DIRECTORY_INHERITING};case C.isFIFO():return{filetype:e.WASI_FILETYPE_SOCKET_STREAM,rightsBase:e.RIGHTS_SOCKET_BASE,rightsInheriting:e.RIGHTS_SOCKET_INHERITING};case C.isFile():return{filetype:e.WASI_FILETYPE_REGULAR_FILE,rightsBase:e.RIGHTS_REGULAR_FILE_BASE,rightsInheriting:e.RIGHTS_REGULAR_FILE_INHERITING};case C.isSocket():return{filetype:e.WASI_FILETYPE_SOCKET_STREAM,rightsBase:e.RIGHTS_SOCKET_BASE,rightsInheriting:e.RIGHTS_SOCKET_INHERITING};case C.isSymbolicLink():return{filetype:e.WASI_FILETYPE_SYMBOLIC_LINK,rightsBase:u.BigIntPolyfill(0),rightsInheriting:u.BigIntPolyfill(0)};default:return{filetype:e.WASI_FILETYPE_UNKNOWN,rightsBase:u.BigIntPolyfill(0),rightsInheriting:u.BigIntPolyfill(0)}}},Y=function(I){Z(C,I);var g=t(C);function C(I){var A;return l(this,C),(A=g.call(this)).errno=I,Object.setPrototypeOf(b(A),C.prototype),A}return G(C)}(o(Error));g.WASIError=Y;var W=function(I){Z(C,I);var g=t(C);function C(I){var A;return l(this,C),(A=g.call(this,"WASI Exit error: ".concat(I))).code=I,Object.setPrototypeOf(b(A),C.prototype),A}return G(C)}(o(Error));g.WASIExitError=W;var S=function(I){Z(C,I);var g=t(C);function C(I){var A;return l(this,C),(A=g.call(this,"WASI Kill signal: ".concat(I))).signal=I,Object.setPrototypeOf(b(A),C.prototype),A}return G(C)}(o(Error));g.WASIKillError=S;var p=function(){function I(g){var C=this;l(this,I);var G={};g&&g.preopens?G=g.preopens:g&&g.preopenDirectories&&(G=g.preopenDirectories);var b={};g&&g.env&&(b=g.env);var Z=[];g&&g.args&&(Z=g.args);var t=n;g&&g.bindings&&(t=g.bindings),this.memory=void 0,this.view=void 0,this.bindings=t,this.FD_MAP=new Map([[e.WASI_STDIN_FILENO,{real:0,filetype:e.WASI_FILETYPE_CHARACTER_DEVICE,rights:{base:B,inheriting:u.BigIntPolyfill(0)},path:void 0}],[e.WASI_STDOUT_FILENO,{real:1,filetype:e.WASI_FILETYPE_CHARACTER_DEVICE,rights:{base:X,inheriting:u.BigIntPolyfill(0)},path:void 0}],[e.WASI_STDERR_FILENO,{real:2,filetype:e.WASI_FILETYPE_CHARACTER_DEVICE,rights:{base:y,inheriting:u.BigIntPolyfill(0)},path:void 0}]]);for(var o=this.bindings.fs,d=this.bindings.path,W=0,S=Object.entries(G);W<S.length;W++){var p=c(S[W],2),K=p[0],R=p[1],H=o.openSync(R,o.constants.O_RDONLY),J=i(this.FD_MAP.keys()).reverse()[0]+1;this.FD_MAP.set(J,{real:H,filetype:e.WASI_FILETYPE_DIRECTORY,rights:{base:e.RIGHTS_DIRECTORY_BASE,inheriting:e.RIGHTS_DIRECTORY_INHERITING},fakePath:K,path:R})}var F=function(I,g){return C.refreshMemory(),Array.from({length:g},(function(g,A){var i=I+8*A,c=C.view.getUint32(i,!0),G=C.view.getUint32(i+4,!0);return new Uint8Array(C.memory.buffer,c,G)}))},w=function(I,g){var A=s(C,I);if(g!==u.BigIntPolyfill(0)&&(A.rights.base&g)===u.BigIntPolyfill(0))throw new Y(e.WASI_EPERM);return A},f=t.hrtime(),v=function(I){switch(I){case e.WASI_CLOCK_MONOTONIC:return t.hrtime();case e.WASI_CLOCK_REALTIME:return V(Date.now());case e.WASI_CLOCK_PROCESS_CPUTIME_ID:case e.WASI_CLOCK_THREAD_CPUTIME_ID:return t.hrtime()-f;default:return null}};this.wasiImport={args_get:function(I,g){C.refreshMemory();var A=I,i=g;return Z.forEach((function(I){C.view.setUint32(A,i,!0),A+=4,i+=m.default.from(C.memory.buffer).write("".concat(I,"\0"),i)})),e.WASI_ESUCCESS},args_sizes_get:function(I,g){C.refreshMemory(),C.view.setUint32(I,Z.length,!0);var A=Z.reduce((function(I,g){return I+m.default.byteLength(g)+1}),0);return C.view.setUint32(g,A,!0),e.WASI_ESUCCESS},environ_get:function(I,g){C.refreshMemory();var A=I,i=g;return Object.entries(b).forEach((function(I){var g=c(I,2),G=g[0],l=g[1];C.view.setUint32(A,i,!0),A+=4,i+=m.default.from(C.memory.buffer).write("".concat(G,"=").concat(l,"\0"),i)})),e.WASI_ESUCCESS},environ_sizes_get:function(I,g){C.refreshMemory();var A=Object.entries(b).map((function(I){var g=c(I,2),C=g[0],A=g[1];return"".concat(C,"=").concat(A,"\0")})),i=A.reduce((function(I,g){return I+m.default.byteLength(g)}),0);return C.view.setUint32(I,A.length,!0),C.view.setUint32(g,i,!0),e.WASI_ESUCCESS},clock_res_get:function(I,g){var A;switch(I){case e.WASI_CLOCK_MONOTONIC:case e.WASI_CLOCK_PROCESS_CPUTIME_ID:case e.WASI_CLOCK_THREAD_CPUTIME_ID:A=u.BigIntPolyfill(1);break;case e.WASI_CLOCK_REALTIME:A=u.BigIntPolyfill(1e3)}return C.view.setBigUint64(g,A),e.WASI_ESUCCESS},clock_time_get:function(I,g,A){C.refreshMemory();var i=v(I);return null===i?e.WASI_EINVAL:(C.view.setBigUint64(A,u.BigIntPolyfill(i),!0),e.WASI_ESUCCESS)},fd_advise:a((function(I,g,C,A){return w(I,e.WASI_RIGHT_FD_ADVISE),e.WASI_ENOSYS})),fd_allocate:a((function(I,g,C){return w(I,e.WASI_RIGHT_FD_ALLOCATE),e.WASI_ENOSYS})),fd_close:a((function(I){var g=w(I,u.BigIntPolyfill(0));return o.closeSync(g.real),C.FD_MAP.delete(I),e.WASI_ESUCCESS})),fd_datasync:a((function(I){var g=w(I,e.WASI_RIGHT_FD_DATASYNC);return o.fdatasyncSync(g.real),e.WASI_ESUCCESS})),fd_fdstat_get:a((function(I,g){var A=w(I,u.BigIntPolyfill(0));return C.refreshMemory(),C.view.setUint8(g,A.filetype),C.view.setUint16(g+2,0,!0),C.view.setUint16(g+4,0,!0),C.view.setBigUint64(g+8,u.BigIntPolyfill(A.rights.base),!0),C.view.setBigUint64(g+8+8,u.BigIntPolyfill(A.rights.inheriting),!0),e.WASI_ESUCCESS})),fd_fdstat_set_flags:a((function(I,g){return w(I,e.WASI_RIGHT_FD_FDSTAT_SET_FLAGS),e.WASI_ENOSYS})),fd_fdstat_set_rights:a((function(I,g,C){var A=w(I,u.BigIntPolyfill(0));return(A.rights.base|g)>A.rights.base||(A.rights.inheriting|C)>A.rights.inheriting?e.WASI_EPERM:(A.rights.base=g,A.rights.inheriting=C,e.WASI_ESUCCESS)})),fd_filestat_get:a((function(I,g){var A=w(I,e.WASI_RIGHT_FD_FILESTAT_GET),i=o.fstatSync(A.real);return C.refreshMemory(),C.view.setBigUint64(g,u.BigIntPolyfill(i.dev),!0),g+=8,C.view.setBigUint64(g,u.BigIntPolyfill(i.ino),!0),g+=8,C.view.setUint8(g,A.filetype),g+=8,C.view.setBigUint64(g,u.BigIntPolyfill(i.nlink),!0),g+=8,C.view.setBigUint64(g,u.BigIntPolyfill(i.size),!0),g+=8,C.view.setBigUint64(g,V(i.atimeMs),!0),g+=8,C.view.setBigUint64(g,V(i.mtimeMs),!0),g+=8,C.view.setBigUint64(g,V(i.ctimeMs),!0),e.WASI_ESUCCESS})),fd_filestat_set_size:a((function(I,g){var C=w(I,e.WASI_RIGHT_FD_FILESTAT_SET_SIZE);return o.ftruncateSync(C.real,Number(g)),e.WASI_ESUCCESS})),fd_filestat_set_times:a((function(I,g,C,A){var i=w(I,e.WASI_RIGHT_FD_FILESTAT_SET_TIMES),c=o.fstatSync(i.real),G=c.atime,l=c.mtime,b=h(v(e.WASI_CLOCK_REALTIME)),Z=e.WASI_FILESTAT_SET_ATIM|e.WASI_FILESTAT_SET_ATIM_NOW;if((A&Z)===Z)return e.WASI_EINVAL;var t=e.WASI_FILESTAT_SET_MTIM|e.WASI_FILESTAT_SET_MTIM_NOW;return(A&t)===t?e.WASI_EINVAL:((A&e.WASI_FILESTAT_SET_ATIM)===e.WASI_FILESTAT_SET_ATIM?G=h(g):(A&e.WASI_FILESTAT_SET_ATIM_NOW)===e.WASI_FILESTAT_SET_ATIM_NOW&&(G=b),(A&e.WASI_FILESTAT_SET_MTIM)===e.WASI_FILESTAT_SET_MTIM?l=h(C):(A&e.WASI_FILESTAT_SET_MTIM_NOW)===e.WASI_FILESTAT_SET_MTIM_NOW&&(l=b),o.futimesSync(i.real,new Date(G),new Date(l)),e.WASI_ESUCCESS)})),fd_prestat_get:a((function(I,g){var A=w(I,u.BigIntPolyfill(0));return A.path?(C.refreshMemory(),C.view.setUint8(g,e.WASI_PREOPENTYPE_DIR),C.view.setUint32(g+4,m.default.byteLength(A.fakePath),!0),e.WASI_ESUCCESS):e.WASI_EINVAL})),fd_prestat_dir_name:a((function(I,g,A){var i=w(I,u.BigIntPolyfill(0));return i.path?(C.refreshMemory(),m.default.from(C.memory.buffer).write(i.fakePath,g,A,"utf8"),e.WASI_ESUCCESS):e.WASI_EINVAL})),fd_pwrite:a((function(I,g,A,i,c){var G=w(I,e.WASI_RIGHT_FD_WRITE|e.WASI_RIGHT_FD_SEEK),l=0;return F(g,A).forEach((function(I){for(var g=0;g<I.byteLength;)g+=o.writeSync(G.real,I,g,I.byteLength-g,Number(i)+l+g);l+=g})),C.view.setUint32(c,l,!0),e.WASI_ESUCCESS})),fd_write:a((function(I,g,A,i){var c=w(I,e.WASI_RIGHT_FD_WRITE),G=0;return F(g,A).forEach((function(I){for(var g=0;g<I.byteLength;){var C=o.writeSync(c.real,I,g,I.byteLength-g,c.offset?Number(c.offset):null);c.offset&&(c.offset+=u.BigIntPolyfill(C)),g+=C}G+=g})),C.view.setUint32(i,G,!0),e.WASI_ESUCCESS})),fd_pread:a((function(I,g,i,c,G){var l,b=w(I,e.WASI_RIGHT_FD_READ|e.WASI_RIGHT_FD_SEEK),Z=0,t=A(F(g,i));try{I:for(t.s();!(l=t.n()).done;){for(var n=l.value,u=0;u<n.byteLength;){var d=n.byteLength-u,m=o.readSync(b.real,n,u,n.byteLength-u,Number(c)+Z+u);if(u+=m,Z+=m,0===m||m<d)break I}Z+=u}}catch(B){t.e(B)}finally{t.f()}return C.view.setUint32(G,Z,!0),e.WASI_ESUCCESS})),fd_read:a((function(I,g,i,c){var G,l=w(I,e.WASI_RIGHT_FD_READ),b=0===l.real,Z=0,t=A(F(g,i));try{I:for(t.s();!(G=t.n()).done;)for(var n=G.value,d=0;d<n.byteLength;){var m=n.byteLength-d,B=b||void 0===l.offset?null:Number(l.offset),X=o.readSync(l.real,n,d,m,B);if(b||(l.offset=(l.offset?l.offset:u.BigIntPolyfill(0))+u.BigIntPolyfill(X)),d+=X,Z+=X,0===X||X<m)break I}}catch(y){t.e(y)}finally{t.f()}return C.view.setUint32(c,Z,!0),e.WASI_ESUCCESS})),fd_readdir:a((function(I,g,A,i,c){var G=w(I,e.WASI_RIGHT_FD_READDIR);C.refreshMemory();for(var l=o.readdirSync(G.path,{withFileTypes:!0}),b=g,Z=Number(i);Z<l.length;Z+=1){var t=l[Z],n=m.default.byteLength(t.name);if(g-b>A)break;if(C.view.setBigUint64(g,u.BigIntPolyfill(Z+1),!0),(g+=8)-b>A)break;var B=o.statSync(d.resolve(G.path,t.name));if(C.view.setBigUint64(g,u.BigIntPolyfill(B.ino),!0),(g+=8)-b>A)break;if(C.view.setUint32(g,n,!0),(g+=4)-b>A)break;var X=void 0;switch(!0){case B.isBlockDevice():X=e.WASI_FILETYPE_BLOCK_DEVICE;break;case B.isCharacterDevice():X=e.WASI_FILETYPE_CHARACTER_DEVICE;break;case B.isDirectory():X=e.WASI_FILETYPE_DIRECTORY;break;case B.isFIFO():X=e.WASI_FILETYPE_SOCKET_STREAM;break;case B.isFile():X=e.WASI_FILETYPE_REGULAR_FILE;break;case B.isSocket():X=e.WASI_FILETYPE_SOCKET_STREAM;break;case B.isSymbolicLink():X=e.WASI_FILETYPE_SYMBOLIC_LINK;break;default:X=e.WASI_FILETYPE_UNKNOWN}if(C.view.setUint8(g,X),g+=1,(g+=3)+n>=b+A)break;m.default.from(C.memory.buffer).write(t.name,g),g+=n}var y=g-b;return C.view.setUint32(c,Math.min(y,A),!0),e.WASI_ESUCCESS})),fd_renumber:a((function(I,g){return w(I,u.BigIntPolyfill(0)),w(g,u.BigIntPolyfill(0)),o.closeSync(C.FD_MAP.get(I).real),C.FD_MAP.set(I,C.FD_MAP.get(g)),C.FD_MAP.delete(g),e.WASI_ESUCCESS})),fd_seek:a((function(I,g,A,i){var c=w(I,e.WASI_RIGHT_FD_SEEK);switch(C.refreshMemory(),A){case e.WASI_WHENCE_CUR:c.offset=(c.offset?c.offset:u.BigIntPolyfill(0))+u.BigIntPolyfill(g);break;case e.WASI_WHENCE_END:var G=o.fstatSync(c.real).size;c.offset=u.BigIntPolyfill(G)+u.BigIntPolyfill(g);break;case e.WASI_WHENCE_SET:c.offset=u.BigIntPolyfill(g)}return C.view.setBigUint64(i,c.offset,!0),e.WASI_ESUCCESS})),fd_tell:a((function(I,g){var A=w(I,e.WASI_RIGHT_FD_TELL);return C.refreshMemory(),A.offset||(A.offset=u.BigIntPolyfill(0)),C.view.setBigUint64(g,A.offset,!0),e.WASI_ESUCCESS})),fd_sync:a((function(I){var g=w(I,e.WASI_RIGHT_FD_SYNC);return o.fsyncSync(g.real),e.WASI_ESUCCESS})),path_create_directory:a((function(I,g,A){var i=w(I,e.WASI_RIGHT_PATH_CREATE_DIRECTORY);if(!i.path)return e.WASI_EINVAL;C.refreshMemory();var c=m.default.from(C.memory.buffer,g,A).toString();return o.mkdirSync(d.resolve(i.path,c)),e.WASI_ESUCCESS})),path_filestat_get:a((function(I,g,A,i,c){var G=w(I,e.WASI_RIGHT_PATH_FILESTAT_GET);if(!G.path)return e.WASI_EINVAL;C.refreshMemory();var l=m.default.from(C.memory.buffer,A,i).toString(),b=o.statSync(d.resolve(G.path,l));return C.view.setBigUint64(c,u.BigIntPolyfill(b.dev),!0),c+=8,C.view.setBigUint64(c,u.BigIntPolyfill(b.ino),!0),c+=8,C.view.setUint8(c,r(C,void 0,b).filetype),c+=8,C.view.setBigUint64(c,u.BigIntPolyfill(b.nlink),!0),c+=8,C.view.setBigUint64(c,u.BigIntPolyfill(b.size),!0),c+=8,C.view.setBigUint64(c,V(b.atimeMs),!0),c+=8,C.view.setBigUint64(c,V(b.mtimeMs),!0),c+=8,C.view.setBigUint64(c,V(b.ctimeMs),!0),e.WASI_ESUCCESS})),path_filestat_set_times:a((function(I,g,A,i,c,G,l){var b=w(I,e.WASI_RIGHT_PATH_FILESTAT_SET_TIMES);if(!b.path)return e.WASI_EINVAL;C.refreshMemory();var Z=o.fstatSync(b.real),t=Z.atime,n=Z.mtime,u=h(v(e.WASI_CLOCK_REALTIME)),B=e.WASI_FILESTAT_SET_ATIM|e.WASI_FILESTAT_SET_ATIM_NOW;if((l&B)===B)return e.WASI_EINVAL;var X=e.WASI_FILESTAT_SET_MTIM|e.WASI_FILESTAT_SET_MTIM_NOW;if((l&X)===X)return e.WASI_EINVAL;(l&e.WASI_FILESTAT_SET_ATIM)===e.WASI_FILESTAT_SET_ATIM?t=h(c):(l&e.WASI_FILESTAT_SET_ATIM_NOW)===e.WASI_FILESTAT_SET_ATIM_NOW&&(t=u),(l&e.WASI_FILESTAT_SET_MTIM)===e.WASI_FILESTAT_SET_MTIM?n=h(G):(l&e.WASI_FILESTAT_SET_MTIM_NOW)===e.WASI_FILESTAT_SET_MTIM_NOW&&(n=u);var y=m.default.from(C.memory.buffer,A,i).toString();return o.utimesSync(d.resolve(b.path,y),new Date(t),new Date(n)),e.WASI_ESUCCESS})),path_link:a((function(I,g,A,i,c,G,l){var b=w(I,e.WASI_RIGHT_PATH_LINK_SOURCE),Z=w(c,e.WASI_RIGHT_PATH_LINK_TARGET);if(!b.path||!Z.path)return e.WASI_EINVAL;C.refreshMemory();var t=m.default.from(C.memory.buffer,A,i).toString(),n=m.default.from(C.memory.buffer,G,l).toString();return o.linkSync(d.resolve(b.path,t),d.resolve(Z.path,n)),e.WASI_ESUCCESS})),path_open:a((function(I,g,A,c,G,l,b,Z,t){var n=w(I,e.WASI_RIGHT_PATH_OPEN);l=u.BigIntPolyfill(l),b=u.BigIntPolyfill(b);var B,X=(l&(e.WASI_RIGHT_FD_READ|e.WASI_RIGHT_FD_READDIR))!==u.BigIntPolyfill(0),y=(l&(e.WASI_RIGHT_FD_DATASYNC|e.WASI_RIGHT_FD_WRITE|e.WASI_RIGHT_FD_ALLOCATE|e.WASI_RIGHT_FD_FILESTAT_SET_SIZE))!==u.BigIntPolyfill(0);y&&X?B=o.constants.O_RDWR:X?B=o.constants.O_RDONLY:y&&(B=o.constants.O_WRONLY);var V=l|e.WASI_RIGHT_PATH_OPEN,h=l|b;0!==(G&e.WASI_O_CREAT)&&(B|=o.constants.O_CREAT,V|=e.WASI_RIGHT_PATH_CREATE_FILE),0!==(G&e.WASI_O_DIRECTORY)&&(B|=o.constants.O_DIRECTORY),0!==(G&e.WASI_O_EXCL)&&(B|=o.constants.O_EXCL),0!==(G&e.WASI_O_TRUNC)&&(B|=o.constants.O_TRUNC,V|=e.WASI_RIGHT_PATH_FILESTAT_SET_SIZE),0!==(Z&e.WASI_FDFLAG_APPEND)&&(B|=o.constants.O_APPEND),0!==(Z&e.WASI_FDFLAG_DSYNC)&&(o.constants.O_DSYNC?B|=o.constants.O_DSYNC:B|=o.constants.O_SYNC,h|=e.WASI_RIGHT_FD_DATASYNC),0!==(Z&e.WASI_FDFLAG_NONBLOCK)&&(B|=o.constants.O_NONBLOCK),0!==(Z&e.WASI_FDFLAG_RSYNC)&&(o.constants.O_RSYNC?B|=o.constants.O_RSYNC:B|=o.constants.O_SYNC,h|=e.WASI_RIGHT_FD_SYNC),0!==(Z&e.WASI_FDFLAG_SYNC)&&(B|=o.constants.O_SYNC,h|=e.WASI_RIGHT_FD_SYNC),y&&0===(B&(o.constants.O_APPEND|o.constants.O_TRUNC))&&(h|=e.WASI_RIGHT_FD_SEEK),C.refreshMemory();var a,r,Y,W=m.default.from(C.memory.buffer,A,c).toString(),S=d.resolve(n.path,W);if(d.relative(n.path,S).startsWith(".."))return e.WASI_ENOTCAPABLE;try{if(a=o.realpathSync(S),d.relative(n.path,a).startsWith(".."))return e.WASI_ENOTCAPABLE}catch(K){if("ENOENT"!==K.code)throw K;a=S}try{r=o.statSync(a).isDirectory()}catch(K){}Y=!y&&r?o.openSync(a,o.constants.O_RDONLY):o.openSync(a,B);var p=i(C.FD_MAP.keys()).reverse()[0]+1;return C.FD_MAP.set(p,{real:Y,filetype:void 0,rights:{base:V,inheriting:h},path:a}),s(C,p),C.view.setUint32(t,p,!0),e.WASI_ESUCCESS})),path_readlink:a((function(I,g,A,i,c,G){var l=w(I,e.WASI_RIGHT_PATH_READLINK);if(!l.path)return e.WASI_EINVAL;C.refreshMemory();var b=m.default.from(C.memory.buffer,g,A).toString(),Z=d.resolve(l.path,b),t=o.readlinkSync(Z),n=m.default.from(C.memory.buffer).write(t,i,c);return C.view.setUint32(G,n,!0),e.WASI_ESUCCESS})),path_remove_directory:a((function(I,g,A){var i=w(I,e.WASI_RIGHT_PATH_REMOVE_DIRECTORY);if(!i.path)return e.WASI_EINVAL;C.refreshMemory();var c=m.default.from(C.memory.buffer,g,A).toString();return o.rmdirSync(d.resolve(i.path,c)),e.WASI_ESUCCESS})),path_rename:a((function(I,g,A,i,c,G){var l=w(I,e.WASI_RIGHT_PATH_RENAME_SOURCE),b=w(i,e.WASI_RIGHT_PATH_RENAME_TARGET);if(!l.path||!b.path)return e.WASI_EINVAL;C.refreshMemory();var Z=m.default.from(C.memory.buffer,g,A).toString(),t=m.default.from(C.memory.buffer,c,G).toString();return o.renameSync(d.resolve(l.path,Z),d.resolve(b.path,t)),e.WASI_ESUCCESS})),path_symlink:a((function(I,g,A,i,c){var G=w(A,e.WASI_RIGHT_PATH_SYMLINK);if(!G.path)return e.WASI_EINVAL;C.refreshMemory();var l=m.default.from(C.memory.buffer,I,g).toString(),b=m.default.from(C.memory.buffer,i,c).toString();return o.symlinkSync(l,d.resolve(G.path,b)),e.WASI_ESUCCESS})),path_unlink_file:a((function(I,g,A){var i=w(I,e.WASI_RIGHT_PATH_UNLINK_FILE);if(!i.path)return e.WASI_EINVAL;C.refreshMemory();var c=m.default.from(C.memory.buffer,g,A).toString();return o.unlinkSync(d.resolve(i.path,c)),e.WASI_ESUCCESS})),poll_oneoff:function(I,g,A,i){var c=0,G=0;C.refreshMemory();for(var l=0;l<A;l+=1){var b=C.view.getBigUint64(I,!0);I+=8;var Z=C.view.getUint8(I);switch(I+=1,Z){case e.WASI_EVENTTYPE_CLOCK:I+=7;C.view.getBigUint64(I,!0);I+=8;var o=C.view.getUint32(I,!0);I+=4,I+=4;var n=C.view.getBigUint64(I,!0);I+=8;C.view.getBigUint64(I,!0);I+=8;var d=C.view.getUint16(I,!0);I+=2,I+=6;var m=1===d,B=e.WASI_ESUCCESS,X=u.BigIntPolyfill(v(o));if(null===X)B=e.WASI_EINVAL;else{var y=m?n:X+n;G=y>G?y:G}C.view.setBigUint64(g,b,!0),g+=8,C.view.setUint16(g,B,!0),g+=2,C.view.setUint8(g,e.WASI_EVENTTYPE_CLOCK),g+=1,g+=5,c+=1;break;case e.WASI_EVENTTYPE_FD_READ:case e.WASI_EVENTTYPE_FD_WRITE:I+=3;C.view.getUint32(I,!0);I+=4,C.view.setBigUint64(g,b,!0),g+=8,C.view.setUint16(g,e.WASI_ENOSYS,!0),g+=2,C.view.setUint8(g,Z),g+=1,g+=5,c+=1;break;default:return e.WASI_EINVAL}}for(C.view.setUint32(i,c,!0);t.hrtime()<G;);return e.WASI_ESUCCESS},proc_exit:function(I){return t.exit(I),e.WASI_ESUCCESS},proc_raise:function(I){return I in e.SIGNAL_MAP?(t.kill(e.SIGNAL_MAP[I]),e.WASI_ESUCCESS):e.WASI_EINVAL},random_get:function(I,g){return C.refreshMemory(),t.randomFillSync(new Uint8Array(C.memory.buffer),I,g),e.WASI_ESUCCESS},sched_yield:function(){return e.WASI_ESUCCESS},sock_recv:function(){return e.WASI_ENOSYS},sock_send:function(){return e.WASI_ENOSYS},sock_shutdown:function(){return e.WASI_ENOSYS}},g.traceSyscalls&&Object.keys(this.wasiImport).forEach((function(I){var g=C.wasiImport[I];C.wasiImport[I]=function(){for(var C=arguments.length,A=new Array(C),i=0;i<C;i++)A[i]=arguments[i];console.log("WASI: wasiImport called: ".concat(I," (").concat(A,")"));try{var c=g.apply(void 0,A);return console.log("WASI:  => ".concat(c)),c}catch(G){throw console.log("Catched error: ".concat(G)),G}}}))}return G(I,[{key:"refreshMemory",value:function(){this.view&&0!==this.view.buffer.byteLength||(this.view=new d.DataViewPolyfill(this.memory.buffer))}},{key:"setMemory",value:function(I){this.memory=I}},{key:"start",value:function(I){var g=I.exports;if(null===g||"object"!==typeof g)throw new Error("instance.exports must be an Object. Received ".concat(g,"."));var C=g.memory;if(!(C instanceof WebAssembly.Memory))throw new Error("instance.exports.memory must be a WebAssembly.Memory. Recceived ".concat(C,"."));this.setMemory(C),g._start&&g._start()}},{key:"getImportNamespace",value:function(I){var g,C=null,i=A(WebAssembly.Module.imports(I));try{for(i.s();!(g=i.n()).done;){var c=g.value;if("function"===c.kind&&c.module.startsWith("wasi_"))if(C){if(C!==c.module)throw new Error("Multiple namespaces detected.")}else C=c.module}}catch(G){i.e(G)}finally{i.f()}return C}},{key:"getImports",value:function(I){switch(this.getImportNamespace(I)){case"wasi_unstable":return{wasi_unstable:this.wasiImport};case"wasi_snapshot_preview1":return{wasi_snapshot_preview1:this.wasiImport};default:throw new Error("Can't detect a WASI namespace for the WebAssembly Module")}}}]),I}();g.default=p,p.defaultBindings=n,g.WASI=p},104:function(I,g,C){"use strict";Object.defineProperty(g,"__esModule",{value:!0});var A="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof C.g?C.g:{};g.BigIntPolyfill="undefined"!==typeof BigInt?BigInt:A.BigInt||Number},9770:function(I,g){"use strict";Object.defineProperty(g,"__esModule",{value:!0});var C=Math.floor(.001*(Date.now()-performance.now()));g.default=function(I){var g=.001*performance.now(),A=Math.floor(g)+C,i=Math.floor(g%1*1e9);return I&&(A-=I[0],(i-=I[1])<0&&(A--,i+=1e9)),[A,i]}},4343:function(I,g){"use strict";Object.defineProperty(g,"__esModule",{value:!0});var C=Buffer;g.default=C},2399:function(I,g,C){"use strict";Object.defineProperty(g,"__esModule",{value:!0});var A=C(104),i=DataView;i.prototype.setBigUint64||(i.prototype.setBigUint64=function(I,g,C){var A,i;if(g<Math.pow(2,32))A=Number(g),i=0;else{for(var c=g.toString(2),G="",l=0;l<64-c.length;l++)G+="0";G+=c,i=parseInt(G.substring(0,32),2),A=parseInt(G.substring(32),2)}this.setUint32(I+(C?0:4),A,C),this.setUint32(I+(C?4:0),i,C)},i.prototype.getBigUint64=function(I,g){for(var C=this.getUint32(I+(g?0:4),g),i=this.getUint32(I+(g?4:0),g),c=C.toString(2),G=i.toString(2),l="",b=0;b<32-c.length;b++)l+="0";return l+=c,A.BigIntPolyfill("0b"+G+l)}),g.DataViewPolyfill=i},9065:function(I,g){"use strict";Object.defineProperty(g,"__esModule",{value:!0});g.default=function(I){return function(g){var C=I(g);return 1e9*C[0]+C[1]}}},3903:function(I,g,C){"use strict";function A(I){var g="function"===typeof Symbol&&I[Symbol.iterator],C=0;return g?g.call(I):{next:function(){return I&&C>=I.length&&(I=void 0),{value:I&&I[C++],done:!I}}}}function i(I,g){var C="function"===typeof Symbol&&I[Symbol.iterator];if(!C)return I;I=C.call(I);var A,i=[];try{for(;(void 0===g||0<g--)&&!(A=I.next()).done;)i.push(A.value)}catch(G){var c={error:G}}finally{try{A&&!A.done&&(C=I.return)&&C.call(I)}finally{if(c)throw c.error}}return i}function c(){for(var I=[],g=0;g<arguments.length;g++)I=I.concat(i(arguments[g]));return I}C.r(g),C.d(g,{WasmFs:function(){return bA}});var G="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof C.g?C.g:"undefined"!==typeof self?self:{};function l(I){return I&&I.__esModule&&Object.prototype.hasOwnProperty.call(I,"default")?I.default:I}function b(I,g){return I(g={exports:{}},g.exports),g.exports}var Z=b((function(I,g){Object.defineProperty(g,"__esModule",{value:!0}),g.constants={O_RDONLY:0,O_WRONLY:1,O_RDWR:2,S_IFMT:61440,S_IFREG:32768,S_IFDIR:16384,S_IFCHR:8192,S_IFBLK:24576,S_IFIFO:4096,S_IFLNK:40960,S_IFSOCK:49152,O_CREAT:64,O_EXCL:128,O_NOCTTY:256,O_TRUNC:512,O_APPEND:1024,O_DIRECTORY:65536,O_NOATIME:262144,O_NOFOLLOW:131072,O_SYNC:1052672,O_DIRECT:16384,O_NONBLOCK:2048,S_IRWXU:448,S_IRUSR:256,S_IWUSR:128,S_IXUSR:64,S_IRWXG:56,S_IRGRP:32,S_IWGRP:16,S_IXGRP:8,S_IRWXO:7,S_IROTH:4,S_IWOTH:2,S_IXOTH:1,F_OK:0,R_OK:4,W_OK:2,X_OK:1,UV_FS_SYMLINK_DIR:1,UV_FS_SYMLINK_JUNCTION:2,UV_FS_COPYFILE_EXCL:1,UV_FS_COPYFILE_FICLONE:2,UV_FS_COPYFILE_FICLONE_FORCE:4,COPYFILE_EXCL:1,COPYFILE_FICLONE:2,COPYFILE_FICLONE_FORCE:4}}));l(Z);var t=b((function(I,g){g.default="function"===typeof BigInt?BigInt:function(){throw Error("BigInt is not supported in this environment.")}})),o=b((function(I,g){Object.defineProperty(g,"__esModule",{value:!0});var C=Z.constants.S_IFMT,A=Z.constants.S_IFDIR,i=Z.constants.S_IFREG,c=Z.constants.S_IFBLK,G=Z.constants.S_IFCHR,l=Z.constants.S_IFLNK,b=Z.constants.S_IFIFO,o=Z.constants.S_IFSOCK;I=function(){function I(){}return I.build=function(g,C){void 0===C&&(C=!1);var A=new I,i=g.gid,c=g.atime,G=g.mtime,l=g.ctime;return C=C?t.default:function(I){return I},A.uid=C(g.uid),A.gid=C(i),A.rdev=C(0),A.blksize=C(4096),A.ino=C(g.ino),A.size=C(g.getSize()),A.blocks=C(1),A.atime=c,A.mtime=G,A.ctime=l,A.birthtime=l,A.atimeMs=C(c.getTime()),A.mtimeMs=C(G.getTime()),i=C(l.getTime()),A.ctimeMs=i,A.birthtimeMs=i,A.dev=C(0),A.mode=C(g.mode),A.nlink=C(g.nlink),A},I.prototype._checkModeProperty=function(I){return(Number(this.mode)&C)===I},I.prototype.isDirectory=function(){return this._checkModeProperty(A)},I.prototype.isFile=function(){return this._checkModeProperty(i)},I.prototype.isBlockDevice=function(){return this._checkModeProperty(c)},I.prototype.isCharacterDevice=function(){return this._checkModeProperty(G)},I.prototype.isSymbolicLink=function(){return this._checkModeProperty(l)},I.prototype.isFIFO=function(){return this._checkModeProperty(b)},I.prototype.isSocket=function(){return this._checkModeProperty(o)},I}(),g.Stats=I,g.default=I}));l(o);var n="undefined"!==typeof C.g?C.g:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{},u=[],d=[],m="undefined"!==typeof Uint8Array?Uint8Array:Array,e=!1;function B(){e=!0;for(var I=0;64>I;++I)u[I]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[I],d["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(I)]=I;d[45]=62,d[95]=63}function X(I,g,C){for(var A=[],i=g;i<C;i+=3)g=(I[i]<<16)+(I[i+1]<<8)+I[i+2],A.push(u[g>>18&63]+u[g>>12&63]+u[g>>6&63]+u[63&g]);return A.join("")}function y(I){e||B();for(var g=I.length,C=g%3,A="",i=[],c=0,G=g-C;c<G;c+=16383)i.push(X(I,c,c+16383>G?G:c+16383));return 1===C?(I=I[g-1],A+=u[I>>2],A+=u[I<<4&63],A+="=="):2===C&&(I=(I[g-2]<<8)+I[g-1],A+=u[I>>10],A+=u[I>>4&63],A+=u[I<<2&63],A+="="),i.push(A),i.join("")}function V(I,g,C,A,i){var c=8*i-A-1,G=(1<<c)-1,l=G>>1,b=-7,Z=C?-1:1,t=I[g+(i=C?i-1:0)];for(i+=Z,C=t&(1<<-b)-1,t>>=-b,b+=c;0<b;C=256*C+I[g+i],i+=Z,b-=8);for(c=C&(1<<-b)-1,C>>=-b,b+=A;0<b;c=256*c+I[g+i],i+=Z,b-=8);if(0===C)C=1-l;else{if(C===G)return c?NaN:1/0*(t?-1:1);c+=Math.pow(2,A),C-=l}return(t?-1:1)*c*Math.pow(2,C-A)}function h(I,g,C,A,i,c){var G,l=8*c-i-1,b=(1<<l)-1,Z=b>>1,t=23===i?Math.pow(2,-24)-Math.pow(2,-77):0;c=A?0:c-1;var o=A?1:-1,n=0>g||0===g&&0>1/g?1:0;for(g=Math.abs(g),isNaN(g)||1/0===g?(g=isNaN(g)?1:0,A=b):(A=Math.floor(Math.log(g)/Math.LN2),1>g*(G=Math.pow(2,-A))&&(A--,G*=2),2<=(g=1<=A+Z?g+t/G:g+t*Math.pow(2,1-Z))*G&&(A++,G/=2),A+Z>=b?(g=0,A=b):1<=A+Z?(g=(g*G-1)*Math.pow(2,i),A+=Z):(g=g*Math.pow(2,Z-1)*Math.pow(2,i),A=0));8<=i;I[C+c]=255&g,c+=o,g/=256,i-=8);for(A=A<<i|g,l+=i;0<l;I[C+c]=255&A,c+=o,A/=256,l-=8);I[C+c-o]|=128*n}var a={}.toString,s=Array.isArray||function(I){return"[object Array]"==a.call(I)};W.TYPED_ARRAY_SUPPORT=void 0===n.TYPED_ARRAY_SUPPORT||n.TYPED_ARRAY_SUPPORT;var r=W.TYPED_ARRAY_SUPPORT?2147483647:1073741823;function Y(I,g){if((W.TYPED_ARRAY_SUPPORT?2147483647:1073741823)<g)throw new RangeError("Invalid typed array length");return W.TYPED_ARRAY_SUPPORT?(I=new Uint8Array(g)).__proto__=W.prototype:(null===I&&(I=new W(g)),I.length=g),I}function W(I,g,C){if(!(W.TYPED_ARRAY_SUPPORT||this instanceof W))return new W(I,g,C);if("number"===typeof I){if("string"===typeof g)throw Error("If encoding is specified then the first argument must be a string");return K(this,I)}return S(this,I,g,C)}function S(I,g,C,A){if("number"===typeof g)throw new TypeError('"value" argument must not be a number');if("undefined"!==typeof ArrayBuffer&&g instanceof ArrayBuffer){if(g.byteLength,0>C||g.byteLength<C)throw new RangeError("'offset' is out of bounds");if(g.byteLength<C+(A||0))throw new RangeError("'length' is out of bounds");return g=void 0===C&&void 0===A?new Uint8Array(g):void 0===A?new Uint8Array(g,C):new Uint8Array(g,C,A),W.TYPED_ARRAY_SUPPORT?(I=g).__proto__=W.prototype:I=R(I,g),I}if("string"===typeof g){if(A=I,"string"===typeof(I=C)&&""!==I||(I="utf8"),!W.isEncoding(I))throw new TypeError('"encoding" must be a valid string encoding');return(g=(A=Y(A,C=0|F(g,I))).write(g,I))!==C&&(A=A.slice(0,g)),A}return function(I,g){if(J(g)){var C=0|H(g.length);return 0===(I=Y(I,C)).length||g.copy(I,0,0,C),I}if(g){if("undefined"!==typeof ArrayBuffer&&g.buffer instanceof ArrayBuffer||"length"in g)return(C="number"!==typeof g.length)||(C=(C=g.length)!==C),C?Y(I,0):R(I,g);if("Buffer"===g.type&&s(g.data))return R(I,g.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(I,g)}function p(I){if("number"!==typeof I)throw new TypeError('"size" argument must be a number');if(0>I)throw new RangeError('"size" argument must not be negative')}function K(I,g){if(p(g),I=Y(I,0>g?0:0|H(g)),!W.TYPED_ARRAY_SUPPORT)for(var C=0;C<g;++C)I[C]=0;return I}function R(I,g){var C=0>g.length?0:0|H(g.length);I=Y(I,C);for(var A=0;A<C;A+=1)I[A]=255&g[A];return I}function H(I){if(I>=(W.TYPED_ARRAY_SUPPORT?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(W.TYPED_ARRAY_SUPPORT?2147483647:1073741823).toString(16)+" bytes");return 0|I}function J(I){return!(null==I||!I._isBuffer)}function F(I,g){if(J(I))return I.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(I)||I instanceof ArrayBuffer))return I.byteLength;"string"!==typeof I&&(I=""+I);var C=I.length;if(0===C)return 0;for(var A=!1;;)switch(g){case"ascii":case"latin1":case"binary":return C;case"utf8":case"utf-8":case void 0:return D(I).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*C;case"hex":return C>>>1;case"base64":return P(I).length;default:if(A)return D(I).length;g=(""+g).toLowerCase(),A=!0}}function w(I,g,C){var A=!1;if((void 0===g||0>g)&&(g=0),g>this.length)return"";if((void 0===C||C>this.length)&&(C=this.length),0>=C)return"";if((C>>>=0)<=(g>>>=0))return"";for(I||(I="utf8");;)switch(I){case"hex":for(I=g,g=C,C=this.length,(!I||0>I)&&(I=0),(!g||0>g||g>C)&&(g=C),A="",C=I;C<g;++C)A=(I=A)+(A=16>(A=this[C])?"0"+A.toString(16):A.toString(16));return A;case"utf8":case"utf-8":return N(this,g,C);case"ascii":for(I="",C=Math.min(this.length,C);g<C;++g)I+=String.fromCharCode(127&this[g]);return I;case"latin1":case"binary":for(I="",C=Math.min(this.length,C);g<C;++g)I+=String.fromCharCode(this[g]);return I;case"base64":return g=0===g&&C===this.length?y(this):y(this.slice(g,C));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":for(g=this.slice(g,C),C="",I=0;I<g.length;I+=2)C+=String.fromCharCode(g[I]+256*g[I+1]);return C;default:if(A)throw new TypeError("Unknown encoding: "+I);I=(I+"").toLowerCase(),A=!0}}function f(I,g,C){var A=I[g];I[g]=I[C],I[C]=A}function v(I,g,C,A,i){if(0===I.length)return-1;if("string"===typeof C?(A=C,C=0):2147483647<C?C=2147483647:-2147483648>C&&(C=-2147483648),C=+C,isNaN(C)&&(C=i?0:I.length-1),0>C&&(C=I.length+C),C>=I.length){if(i)return-1;C=I.length-1}else if(0>C){if(!i)return-1;C=0}if("string"===typeof g&&(g=W.from(g,A)),J(g))return 0===g.length?-1:x(I,g,C,A,i);if("number"===typeof g)return g&=255,W.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(I,g,C):Uint8Array.prototype.lastIndexOf.call(I,g,C):x(I,[g],C,A,i);throw new TypeError("val must be string, number or Buffer")}function x(I,g,C,A,i){function c(I,g){return 1===G?I[g]:I.readUInt16BE(g*G)}var G=1,l=I.length,b=g.length;if(void 0!==A&&("ucs2"===(A=String(A).toLowerCase())||"ucs-2"===A||"utf16le"===A||"utf-16le"===A)){if(2>I.length||2>g.length)return-1;G=2,l/=2,b/=2,C/=2}if(i)for(A=-1;C<l;C++)if(c(I,C)===c(g,-1===A?0:C-A)){if(-1===A&&(A=C),C-A+1===b)return A*G}else-1!==A&&(C-=C-A),A=-1;else for(C+b>l&&(C=l-b);0<=C;C--){for(l=!0,A=0;A<b;A++)if(c(I,C+A)!==c(g,A)){l=!1;break}if(l)return C}return-1}function N(I,g,C){C=Math.min(I.length,C);for(var A=[];g<C;){var i=I[g],c=null,G=239<i?4:223<i?3:191<i?2:1;if(g+G<=C)switch(G){case 1:128>i&&(c=i);break;case 2:var l=I[g+1];128===(192&l)&&(127<(i=(31&i)<<6|63&l)&&(c=i));break;case 3:l=I[g+1];var b=I[g+2];128===(192&l)&&128===(192&b)&&(2047<(i=(15&i)<<12|(63&l)<<6|63&b)&&(55296>i||57343<i)&&(c=i));break;case 4:l=I[g+1],b=I[g+2];var Z=I[g+3];128===(192&l)&&128===(192&b)&&128===(192&Z)&&(65535<(i=(15&i)<<18|(63&l)<<12|(63&b)<<6|63&Z)&&1114112>i&&(c=i))}null===c?(c=65533,G=1):65535<c&&(c-=65536,A.push(c>>>10&1023|55296),c=56320|1023&c),A.push(c),g+=G}if((I=A.length)<=L)A=String.fromCharCode.apply(String,A);else{for(C="",g=0;g<I;)C+=String.fromCharCode.apply(String,A.slice(g,g+=L));A=C}return A}W.poolSize=8192,W._augment=function(I){return I.__proto__=W.prototype,I},W.from=function(I,g,C){return S(null,I,g,C)},W.TYPED_ARRAY_SUPPORT&&(W.prototype.__proto__=Uint8Array.prototype,W.__proto__=Uint8Array),W.alloc=function(I,g,C){return p(I),I=0>=I?Y(null,I):void 0!==g?"string"===typeof C?Y(null,I).fill(g,C):Y(null,I).fill(g):Y(null,I)},W.allocUnsafe=function(I){return K(null,I)},W.allocUnsafeSlow=function(I){return K(null,I)},W.isBuffer=j,W.compare=function(I,g){if(!J(I)||!J(g))throw new TypeError("Arguments must be Buffers");if(I===g)return 0;for(var C=I.length,A=g.length,i=0,c=Math.min(C,A);i<c;++i)if(I[i]!==g[i]){C=I[i],A=g[i];break}return C<A?-1:A<C?1:0},W.isEncoding=function(I){switch(String(I).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},W.concat=function(I,g){if(!s(I))throw new TypeError('"list" argument must be an Array of Buffers');if(0===I.length)return W.alloc(0);var C;if(void 0===g)for(C=g=0;C<I.length;++C)g+=I[C].length;g=W.allocUnsafe(g);var A=0;for(C=0;C<I.length;++C){var i=I[C];if(!J(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(g,A),A+=i.length}return g},W.byteLength=F,W.prototype._isBuffer=!0,W.prototype.swap16=function(){var I=this.length;if(0!==I%2)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var g=0;g<I;g+=2)f(this,g,g+1);return this},W.prototype.swap32=function(){var I=this.length;if(0!==I%4)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var g=0;g<I;g+=4)f(this,g,g+3),f(this,g+1,g+2);return this},W.prototype.swap64=function(){var I=this.length;if(0!==I%8)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var g=0;g<I;g+=8)f(this,g,g+7),f(this,g+1,g+6),f(this,g+2,g+5),f(this,g+3,g+4);return this},W.prototype.toString=function(){var I=0|this.length;return 0===I?"":0===arguments.length?N(this,0,I):w.apply(this,arguments)},W.prototype.equals=function(I){if(!J(I))throw new TypeError("Argument must be a Buffer");return this===I||0===W.compare(this,I)},W.prototype.inspect=function(){var I="";return 0<this.length&&(I=this.toString("hex",0,50).match(/.{2}/g).join(" "),50<this.length&&(I+=" ... ")),"<Buffer "+I+">"},W.prototype.compare=function(I,g,C,A,i){if(!J(I))throw new TypeError("Argument must be a Buffer");if(void 0===g&&(g=0),void 0===C&&(C=I?I.length:0),void 0===A&&(A=0),void 0===i&&(i=this.length),0>g||C>I.length||0>A||i>this.length)throw new RangeError("out of range index");if(A>=i&&g>=C)return 0;if(A>=i)return-1;if(g>=C)return 1;if(this===I)return 0;var c=(i>>>=0)-(A>>>=0),G=(C>>>=0)-(g>>>=0),l=Math.min(c,G);for(A=this.slice(A,i),I=I.slice(g,C),g=0;g<l;++g)if(A[g]!==I[g]){c=A[g],G=I[g];break}return c<G?-1:G<c?1:0},W.prototype.includes=function(I,g,C){return-1!==this.indexOf(I,g,C)},W.prototype.indexOf=function(I,g,C){return v(this,I,g,C,!0)},W.prototype.lastIndexOf=function(I,g,C){return v(this,I,g,C,!1)},W.prototype.write=function(I,g,C,A){if(void 0===g)A="utf8",C=this.length,g=0;else if(void 0===C&&"string"===typeof g)A=g,C=this.length,g=0;else{if(!isFinite(g))throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");g|=0,isFinite(C)?(C|=0,void 0===A&&(A="utf8")):(A=C,C=void 0)}var i=this.length-g;if((void 0===C||C>i)&&(C=i),0<I.length&&(0>C||0>g)||g>this.length)throw new RangeError("Attempt to write outside buffer bounds");for(A||(A="utf8"),i=!1;;)switch(A){case"hex":I:{if(g=Number(g)||0,A=this.length-g,C?(C=Number(C))>A&&(C=A):C=A,0!==(A=I.length)%2)throw new TypeError("Invalid hex string");for(C>A/2&&(C=A/2),A=0;A<C;++A){if(i=parseInt(I.substr(2*A,2),16),isNaN(i)){I=A;break I}this[g+A]=i}I=A}return I;case"utf8":case"utf-8":return q(D(I,this.length-g),this,g,C);case"ascii":case"latin1":case"binary":return q(O(I),this,g,C);case"base64":return q(P(I),this,g,C);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":A=I,i=this.length-g;for(var c=[],G=0;G<A.length&&!(0>(i-=2));++G){var l=A.charCodeAt(G);I=l>>8,l%=256,c.push(l),c.push(I)}return q(c,this,g,C);default:if(i)throw new TypeError("Unknown encoding: "+A);A=(""+A).toLowerCase(),i=!0}},W.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var L=4096;function k(I,g,C){if(0!==I%1||0>I)throw new RangeError("offset is not uint");if(I+g>C)throw new RangeError("Trying to access beyond buffer length")}function T(I,g,C,A,i,c){if(!J(I))throw new TypeError('"buffer" argument must be a Buffer instance');if(g>i||g<c)throw new RangeError('"value" argument is out of bounds');if(C+A>I.length)throw new RangeError("Index out of range")}function U(I,g,C,A){0>g&&(g=65535+g+1);for(var i=0,c=Math.min(I.length-C,2);i<c;++i)I[C+i]=(g&255<<8*(A?i:1-i))>>>8*(A?i:1-i)}function z(I,g,C,A){0>g&&(g=4294967295+g+1);for(var i=0,c=Math.min(I.length-C,4);i<c;++i)I[C+i]=g>>>8*(A?i:3-i)&255}function E(I,g,C,A){if(C+A>I.length)throw new RangeError("Index out of range");if(0>C)throw new RangeError("Index out of range")}W.prototype.slice=function(I,g){var C=this.length;if(0>(I=~~I)?0>(I+=C)&&(I=0):I>C&&(I=C),0>(g=void 0===g?C:~~g)?0>(g+=C)&&(g=0):g>C&&(g=C),g<I&&(g=I),W.TYPED_ARRAY_SUPPORT)(g=this.subarray(I,g)).__proto__=W.prototype;else{g=new W(C=g-I,void 0);for(var A=0;A<C;++A)g[A]=this[A+I]}return g},W.prototype.readUIntLE=function(I,g,C){I|=0,g|=0,C||k(I,g,this.length),C=this[I];for(var A=1,i=0;++i<g&&(A*=256);)C+=this[I+i]*A;return C},W.prototype.readUIntBE=function(I,g,C){I|=0,g|=0,C||k(I,g,this.length),C=this[I+--g];for(var A=1;0<g&&(A*=256);)C+=this[I+--g]*A;return C},W.prototype.readUInt8=function(I,g){return g||k(I,1,this.length),this[I]},W.prototype.readUInt16LE=function(I,g){return g||k(I,2,this.length),this[I]|this[I+1]<<8},W.prototype.readUInt16BE=function(I,g){return g||k(I,2,this.length),this[I]<<8|this[I+1]},W.prototype.readUInt32LE=function(I,g){return g||k(I,4,this.length),(this[I]|this[I+1]<<8|this[I+2]<<16)+16777216*this[I+3]},W.prototype.readUInt32BE=function(I,g){return g||k(I,4,this.length),16777216*this[I]+(this[I+1]<<16|this[I+2]<<8|this[I+3])},W.prototype.readIntLE=function(I,g,C){I|=0,g|=0,C||k(I,g,this.length),C=this[I];for(var A=1,i=0;++i<g&&(A*=256);)C+=this[I+i]*A;return C>=128*A&&(C-=Math.pow(2,8*g)),C},W.prototype.readIntBE=function(I,g,C){I|=0,g|=0,C||k(I,g,this.length),C=g;for(var A=1,i=this[I+--C];0<C&&(A*=256);)i+=this[I+--C]*A;return i>=128*A&&(i-=Math.pow(2,8*g)),i},W.prototype.readInt8=function(I,g){return g||k(I,1,this.length),128&this[I]?-1*(255-this[I]+1):this[I]},W.prototype.readInt16LE=function(I,g){return g||k(I,2,this.length),32768&(I=this[I]|this[I+1]<<8)?4294901760|I:I},W.prototype.readInt16BE=function(I,g){return g||k(I,2,this.length),32768&(I=this[I+1]|this[I]<<8)?4294901760|I:I},W.prototype.readInt32LE=function(I,g){return g||k(I,4,this.length),this[I]|this[I+1]<<8|this[I+2]<<16|this[I+3]<<24},W.prototype.readInt32BE=function(I,g){return g||k(I,4,this.length),this[I]<<24|this[I+1]<<16|this[I+2]<<8|this[I+3]},W.prototype.readFloatLE=function(I,g){return g||k(I,4,this.length),V(this,I,!0,23,4)},W.prototype.readFloatBE=function(I,g){return g||k(I,4,this.length),V(this,I,!1,23,4)},W.prototype.readDoubleLE=function(I,g){return g||k(I,8,this.length),V(this,I,!0,52,8)},W.prototype.readDoubleBE=function(I,g){return g||k(I,8,this.length),V(this,I,!1,52,8)},W.prototype.writeUIntLE=function(I,g,C,A){I=+I,g|=0,C|=0,A||T(this,I,g,C,Math.pow(2,8*C)-1,0),A=1;var i=0;for(this[g]=255&I;++i<C&&(A*=256);)this[g+i]=I/A&255;return g+C},W.prototype.writeUIntBE=function(I,g,C,A){I=+I,g|=0,C|=0,A||T(this,I,g,C,Math.pow(2,8*C)-1,0);var i=1;for(this[g+(A=C-1)]=255&I;0<=--A&&(i*=256);)this[g+A]=I/i&255;return g+C},W.prototype.writeUInt8=function(I,g,C){return I=+I,g|=0,C||T(this,I,g,1,255,0),W.TYPED_ARRAY_SUPPORT||(I=Math.floor(I)),this[g]=255&I,g+1},W.prototype.writeUInt16LE=function(I,g,C){return I=+I,g|=0,C||T(this,I,g,2,65535,0),W.TYPED_ARRAY_SUPPORT?(this[g]=255&I,this[g+1]=I>>>8):U(this,I,g,!0),g+2},W.prototype.writeUInt16BE=function(I,g,C){return I=+I,g|=0,C||T(this,I,g,2,65535,0),W.TYPED_ARRAY_SUPPORT?(this[g]=I>>>8,this[g+1]=255&I):U(this,I,g,!1),g+2},W.prototype.writeUInt32LE=function(I,g,C){return I=+I,g|=0,C||T(this,I,g,4,4294967295,0),W.TYPED_ARRAY_SUPPORT?(this[g+3]=I>>>24,this[g+2]=I>>>16,this[g+1]=I>>>8,this[g]=255&I):z(this,I,g,!0),g+4},W.prototype.writeUInt32BE=function(I,g,C){return I=+I,g|=0,C||T(this,I,g,4,4294967295,0),W.TYPED_ARRAY_SUPPORT?(this[g]=I>>>24,this[g+1]=I>>>16,this[g+2]=I>>>8,this[g+3]=255&I):z(this,I,g,!1),g+4},W.prototype.writeIntLE=function(I,g,C,A){I=+I,g|=0,A||T(this,I,g,C,(A=Math.pow(2,8*C-1))-1,-A),A=0;var i=1,c=0;for(this[g]=255&I;++A<C&&(i*=256);)0>I&&0===c&&0!==this[g+A-1]&&(c=1),this[g+A]=(I/i>>0)-c&255;return g+C},W.prototype.writeIntBE=function(I,g,C,A){I=+I,g|=0,A||T(this,I,g,C,(A=Math.pow(2,8*C-1))-1,-A);var i=1,c=0;for(this[g+(A=C-1)]=255&I;0<=--A&&(i*=256);)0>I&&0===c&&0!==this[g+A+1]&&(c=1),this[g+A]=(I/i>>0)-c&255;return g+C},W.prototype.writeInt8=function(I,g,C){return I=+I,g|=0,C||T(this,I,g,1,127,-128),W.TYPED_ARRAY_SUPPORT||(I=Math.floor(I)),0>I&&(I=255+I+1),this[g]=255&I,g+1},W.prototype.writeInt16LE=function(I,g,C){return I=+I,g|=0,C||T(this,I,g,2,32767,-32768),W.TYPED_ARRAY_SUPPORT?(this[g]=255&I,this[g+1]=I>>>8):U(this,I,g,!0),g+2},W.prototype.writeInt16BE=function(I,g,C){return I=+I,g|=0,C||T(this,I,g,2,32767,-32768),W.TYPED_ARRAY_SUPPORT?(this[g]=I>>>8,this[g+1]=255&I):U(this,I,g,!1),g+2},W.prototype.writeInt32LE=function(I,g,C){return I=+I,g|=0,C||T(this,I,g,4,2147483647,-2147483648),W.TYPED_ARRAY_SUPPORT?(this[g]=255&I,this[g+1]=I>>>8,this[g+2]=I>>>16,this[g+3]=I>>>24):z(this,I,g,!0),g+4},W.prototype.writeInt32BE=function(I,g,C){return I=+I,g|=0,C||T(this,I,g,4,2147483647,-2147483648),0>I&&(I=4294967295+I+1),W.TYPED_ARRAY_SUPPORT?(this[g]=I>>>24,this[g+1]=I>>>16,this[g+2]=I>>>8,this[g+3]=255&I):z(this,I,g,!1),g+4},W.prototype.writeFloatLE=function(I,g,C){return C||E(this,0,g,4),h(this,I,g,!0,23,4),g+4},W.prototype.writeFloatBE=function(I,g,C){return C||E(this,0,g,4),h(this,I,g,!1,23,4),g+4},W.prototype.writeDoubleLE=function(I,g,C){return C||E(this,0,g,8),h(this,I,g,!0,52,8),g+8},W.prototype.writeDoubleBE=function(I,g,C){return C||E(this,0,g,8),h(this,I,g,!1,52,8),g+8},W.prototype.copy=function(I,g,C,A){if(C||(C=0),A||0===A||(A=this.length),g>=I.length&&(g=I.length),g||(g=0),0<A&&A<C&&(A=C),A===C||0===I.length||0===this.length)return 0;if(0>g)throw new RangeError("targetStart out of bounds");if(0>C||C>=this.length)throw new RangeError("sourceStart out of bounds");if(0>A)throw new RangeError("sourceEnd out of bounds");A>this.length&&(A=this.length),I.length-g<A-C&&(A=I.length-g+C);var i=A-C;if(this===I&&C<g&&g<A)for(A=i-1;0<=A;--A)I[A+g]=this[A+C];else if(1e3>i||!W.TYPED_ARRAY_SUPPORT)for(A=0;A<i;++A)I[A+g]=this[A+C];else Uint8Array.prototype.set.call(I,this.subarray(C,C+i),g);return i},W.prototype.fill=function(I,g,C,A){if("string"===typeof I){if("string"===typeof g?(A=g,g=0,C=this.length):"string"===typeof C&&(A=C,C=this.length),1===I.length){var i=I.charCodeAt(0);256>i&&(I=i)}if(void 0!==A&&"string"!==typeof A)throw new TypeError("encoding must be a string");if("string"===typeof A&&!W.isEncoding(A))throw new TypeError("Unknown encoding: "+A)}else"number"===typeof I&&(I&=255);if(0>g||this.length<g||this.length<C)throw new RangeError("Out of range index");if(C<=g)return this;if(g>>>=0,C=void 0===C?this.length:C>>>0,I||(I=0),"number"===typeof I)for(A=g;A<C;++A)this[A]=I;else for(i=(I=J(I)?I:D(new W(I,A).toString())).length,A=0;A<C-g;++A)this[A+g]=I[A%i];return this};var M=/[^+\/0-9A-Za-z-_]/g;function D(I,g){g=g||1/0;for(var C,A=I.length,i=null,c=[],G=0;G<A;++G){if(55295<(C=I.charCodeAt(G))&&57344>C){if(!i){if(56319<C){-1<(g-=3)&&c.push(239,191,189);continue}if(G+1===A){-1<(g-=3)&&c.push(239,191,189);continue}i=C;continue}if(56320>C){-1<(g-=3)&&c.push(239,191,189),i=C;continue}C=65536+(i-55296<<10|C-56320)}else i&&-1<(g-=3)&&c.push(239,191,189);if(i=null,128>C){if(0>--g)break;c.push(C)}else if(2048>C){if(0>(g-=2))break;c.push(C>>6|192,63&C|128)}else if(65536>C){if(0>(g-=3))break;c.push(C>>12|224,C>>6&63|128,63&C|128)}else{if(!(1114112>C))throw Error("Invalid code point");if(0>(g-=4))break;c.push(C>>18|240,C>>12&63|128,C>>6&63|128,63&C|128)}}return c}function O(I){for(var g=[],C=0;C<I.length;++C)g.push(255&I.charCodeAt(C));return g}function P(I){if(2>(I=(I.trim?I.trim():I.replace(/^\s+|\s+$/g,"")).replace(M,"")).length)I="";else for(;0!==I.length%4;)I+="=";e||B();var g=I.length;if(0<g%4)throw Error("Invalid string. Length must be a multiple of 4");var C="="===I[g-2]?2:"="===I[g-1]?1:0,A=new m(3*g/4-C),i=0<C?g-4:g,c=0;for(g=0;g<i;g+=4){var G=d[I.charCodeAt(g)]<<18|d[I.charCodeAt(g+1)]<<12|d[I.charCodeAt(g+2)]<<6|d[I.charCodeAt(g+3)];A[c++]=G>>16&255,A[c++]=G>>8&255,A[c++]=255&G}return 2===C?(G=d[I.charCodeAt(g)]<<2|d[I.charCodeAt(g+1)]>>4,A[c++]=255&G):1===C&&(G=d[I.charCodeAt(g)]<<10|d[I.charCodeAt(g+1)]<<4|d[I.charCodeAt(g+2)]>>2,A[c++]=G>>8&255,A[c++]=255&G),A}function q(I,g,C,A){for(var i=0;i<A&&!(i+C>=g.length||i>=I.length);++i)g[i+C]=I[i];return i}function j(I){return null!=I&&(!!I._isBuffer||Q(I)||"function"===typeof I.readFloatLE&&"function"===typeof I.slice&&Q(I.slice(0,0)))}function Q(I){return!!I.constructor&&"function"===typeof I.constructor.isBuffer&&I.constructor.isBuffer(I)}var _=Object.freeze({__proto__:null,INSPECT_MAX_BYTES:50,kMaxLength:r,Buffer:W,SlowBuffer:function(I){return+I!=I&&(I=0),W.alloc(+I)},isBuffer:j}),$=b((function(I,g){function C(I){for(var g=[],C=1;C<arguments.length;C++)g[C-1]=arguments[C];return new(_.Buffer.bind.apply(_.Buffer,A([void 0,I],g)))}var A=G&&G.__spreadArrays||function(){for(var I=0,g=0,C=arguments.length;g<C;g++)I+=arguments[g].length;I=Array(I);var A=0;for(g=0;g<C;g++)for(var i=arguments[g],c=0,G=i.length;c<G;c++,A++)I[A]=i[c];return I};Object.defineProperty(g,"__esModule",{value:!0}),g.Buffer=_.Buffer,g.bufferAllocUnsafe=_.Buffer.allocUnsafe||C,g.bufferFrom=_.Buffer.from||C}));function II(){throw Error("setTimeout has not been defined")}function gI(){throw Error("clearTimeout has not been defined")}l($);var CI=II,AI=gI;function iI(I){if(CI===setTimeout)return setTimeout(I,0);if((CI===II||!CI)&&setTimeout)return CI=setTimeout,setTimeout(I,0);try{return CI(I,0)}catch(g){try{return CI.call(null,I,0)}catch(C){return CI.call(this,I,0)}}}"function"===typeof n.setTimeout&&(CI=setTimeout),"function"===typeof n.clearTimeout&&(AI=clearTimeout);var cI,GI=[],lI=!1,bI=-1;function ZI(){lI&&cI&&(lI=!1,cI.length?GI=cI.concat(GI):bI=-1,GI.length&&tI())}function tI(){if(!lI){var I=iI(ZI);lI=!0;for(var g=GI.length;g;){for(cI=GI,GI=[];++bI<g;)cI&&cI[bI].run();bI=-1,g=GI.length}cI=null,lI=!1,function(I){if(AI===clearTimeout)return clearTimeout(I);if((AI===gI||!AI)&&clearTimeout)return AI=clearTimeout,clearTimeout(I);try{AI(I)}catch(g){try{return AI.call(null,I)}catch(C){return AI.call(this,I)}}}(I)}}function oI(I){var g=Array(arguments.length-1);if(1<arguments.length)for(var C=1;C<arguments.length;C++)g[C-1]=arguments[C];GI.push(new nI(I,g)),1!==GI.length||lI||iI(tI)}function nI(I,g){this.fun=I,this.array=g}function uI(){}nI.prototype.run=function(){this.fun.apply(null,this.array)};var dI=n.performance||{},mI=dI.now||dI.mozNow||dI.msNow||dI.oNow||dI.webkitNow||function(){return(new Date).getTime()},eI=new Date,BI={nextTick:oI,title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:uI,addListener:uI,once:uI,off:uI,removeListener:uI,removeAllListeners:uI,emit:uI,binding:function(){throw Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(){throw Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(I){var g=.001*mI.call(dI),C=Math.floor(g);return g=Math.floor(g%1*1e9),I&&(C-=I[0],0>(g-=I[1])&&(C--,g+=1e9)),[C,g]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-eI)/1e3}},XI="function"===typeof Object.create?function(I,g){I.super_=g,I.prototype=Object.create(g.prototype,{constructor:{value:I,enumerable:!1,writable:!0,configurable:!0}})}:function(I,g){function C(){}I.super_=g,C.prototype=g.prototype,I.prototype=new C,I.prototype.constructor=I},yI=/%[sdj%]/g;function VI(I){if(!wI(I)){for(var g=[],C=0;C<arguments.length;C++)g.push(YI(arguments[C]));return g.join(" ")}C=1;var A=arguments,i=A.length;g=String(I).replace(yI,(function(I){if("%%"===I)return"%";if(C>=i)return I;switch(I){case"%s":return String(A[C++]);case"%d":return Number(A[C++]);case"%j":try{return JSON.stringify(A[C++])}catch(g){return"[Circular]"}default:return I}}));for(var c=A[C];C<i;c=A[++C])g=null!==c&&xI(c)?g+" "+YI(c):g+" "+c;return g}function hI(I,g){if(fI(n.process))return function(){return hI(I,g).apply(this,arguments)};if(!0===BI.noDeprecation)return I;var C=!1;return function(){if(!C){if(BI.throwDeprecation)throw Error(g);BI.traceDeprecation?console.trace(g):console.error(g),C=!0}return I.apply(this,arguments)}}var aI,sI={};function rI(I){return fI(aI)&&(aI=BI.env.NODE_DEBUG||""),I=I.toUpperCase(),sI[I]||(new RegExp("\\b"+I+"\\b","i").test(aI)?sI[I]=function(){var g=VI.apply(null,arguments);console.error("%s %d: %s",I,0,g)}:sI[I]=function(){}),sI[I]}function YI(I,g){var C={seen:[],stylize:SI};return 3<=arguments.length&&(C.depth=arguments[2]),4<=arguments.length&&(C.colors=arguments[3]),JI(g)?C.showHidden=g:g&&MI(C,g),fI(C.showHidden)&&(C.showHidden=!1),fI(C.depth)&&(C.depth=2),fI(C.colors)&&(C.colors=!1),fI(C.customInspect)&&(C.customInspect=!0),C.colors&&(C.stylize=WI),pI(C,I,C.depth)}function WI(I,g){return(g=YI.styles[g])?"\x1b["+YI.colors[g][0]+"m"+I+"\x1b["+YI.colors[g][1]+"m":I}function SI(I){return I}function pI(I,g,C){if(I.customInspect&&g&&kI(g.inspect)&&g.inspect!==YI&&(!g.constructor||g.constructor.prototype!==g)){var A=g.inspect(C,I);return wI(A)||(A=pI(I,A,C)),A}if(A=function(I,g){if(fI(g))return I.stylize("undefined","undefined");if(wI(g))return g="'"+JSON.stringify(g).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'",I.stylize(g,"string");if(FI(g))return I.stylize(""+g,"number");if(JI(g))return I.stylize(""+g,"boolean");if(null===g)return I.stylize("null","null")}(I,g))return A;var i=Object.keys(g),c=function(I){var g={};return I.forEach((function(I){g[I]=!0})),g}(i);if(I.showHidden&&(i=Object.getOwnPropertyNames(g)),LI(g)&&(0<=i.indexOf("message")||0<=i.indexOf("description")))return KI(g);if(0===i.length){if(kI(g))return I.stylize("[Function"+(g.name?": "+g.name:"")+"]","special");if(vI(g))return I.stylize(RegExp.prototype.toString.call(g),"regexp");if(NI(g))return I.stylize(Date.prototype.toString.call(g),"date");if(LI(g))return KI(g)}A="";var G=!1,l=["{","}"];return HI(g)&&(G=!0,l=["[","]"]),kI(g)&&(A=" [Function"+(g.name?": "+g.name:"")+"]"),vI(g)&&(A=" "+RegExp.prototype.toString.call(g)),NI(g)&&(A=" "+Date.prototype.toUTCString.call(g)),LI(g)&&(A=" "+KI(g)),0!==i.length||G&&0!=g.length?0>C?vI(g)?I.stylize(RegExp.prototype.toString.call(g),"regexp"):I.stylize("[Object]","special"):(I.seen.push(g),i=G?function(I,g,C,A,i){for(var c=[],G=0,l=g.length;G<l;++G)Object.prototype.hasOwnProperty.call(g,String(G))?c.push(RI(I,g,C,A,String(G),!0)):c.push("");return i.forEach((function(i){i.match(/^\d+$/)||c.push(RI(I,g,C,A,i,!0))})),c}(I,g,C,c,i):i.map((function(A){return RI(I,g,C,c,A,G)})),I.seen.pop(),function(I,g,C){return 60<I.reduce((function(I,g){return g.indexOf("\n"),I+g.replace(/\u001b\[\d\d?m/g,"").length+1}),0)?C[0]+(""===g?"":g+"\n ")+" "+I.join(",\n  ")+" "+C[1]:C[0]+g+" "+I.join(", ")+" "+C[1]}(i,A,l)):l[0]+A+l[1]}function KI(I){return"["+Error.prototype.toString.call(I)+"]"}function RI(I,g,C,A,i,c){var G,l;if((g=Object.getOwnPropertyDescriptor(g,i)||{value:g[i]}).get?l=g.set?I.stylize("[Getter/Setter]","special"):I.stylize("[Getter]","special"):g.set&&(l=I.stylize("[Setter]","special")),Object.prototype.hasOwnProperty.call(A,i)||(G="["+i+"]"),l||(0>I.seen.indexOf(g.value)?-1<(l=pI(I,g.value,null===C?null:C-1)).indexOf("\n")&&(l=c?l.split("\n").map((function(I){return"  "+I})).join("\n").substr(2):"\n"+l.split("\n").map((function(I){return"   "+I})).join("\n")):l=I.stylize("[Circular]","special")),fI(G)){if(c&&i.match(/^\d+$/))return l;(G=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(G=G.substr(1,G.length-2),G=I.stylize(G,"name")):(G=G.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),G=I.stylize(G,"string"))}return G+": "+l}function HI(I){return Array.isArray(I)}function JI(I){return"boolean"===typeof I}function FI(I){return"number"===typeof I}function wI(I){return"string"===typeof I}function fI(I){return void 0===I}function vI(I){return xI(I)&&"[object RegExp]"===Object.prototype.toString.call(I)}function xI(I){return"object"===typeof I&&null!==I}function NI(I){return xI(I)&&"[object Date]"===Object.prototype.toString.call(I)}function LI(I){return xI(I)&&("[object Error]"===Object.prototype.toString.call(I)||I instanceof Error)}function kI(I){return"function"===typeof I}function TI(I){return null===I||"boolean"===typeof I||"number"===typeof I||"string"===typeof I||"symbol"===typeof I||"undefined"===typeof I}function UI(I){return 10>I?"0"+I.toString(10):I.toString(10)}YI.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},YI.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};var zI="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");function EI(){var I=new Date,g=[UI(I.getHours()),UI(I.getMinutes()),UI(I.getSeconds())].join(":");return[I.getDate(),zI[I.getMonth()],g].join(" ")}function MI(I,g){if(!g||!xI(g))return I;for(var C=Object.keys(g),A=C.length;A--;)I[C[A]]=g[C[A]];return I}var DI={inherits:XI,_extend:MI,log:function(){console.log("%s - %s",EI(),VI.apply(null,arguments))},isBuffer:function(I){return j(I)},isPrimitive:TI,isFunction:kI,isError:LI,isDate:NI,isObject:xI,isRegExp:vI,isUndefined:fI,isSymbol:function(I){return"symbol"===typeof I},isString:wI,isNumber:FI,isNullOrUndefined:function(I){return null==I},isNull:function(I){return null===I},isBoolean:JI,isArray:HI,inspect:YI,deprecate:hI,format:VI,debuglog:rI};function OI(I,g){if(I===g)return 0;for(var C=I.length,A=g.length,i=0,c=Math.min(C,A);i<c;++i)if(I[i]!==g[i]){C=I[i],A=g[i];break}return C<A?-1:A<C?1:0}var PI,qI=Object.prototype.hasOwnProperty,jI=Object.keys||function(I){var g,C=[];for(g in I)qI.call(I,g)&&C.push(g);return C},QI=Array.prototype.slice;function _I(){return"undefined"!==typeof PI?PI:PI="foo"===function(){}.name}function $I(I){return!j(I)&&"function"===typeof n.ArrayBuffer&&("function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(I):!!I&&!!(I instanceof DataView||I.buffer&&I.buffer instanceof ArrayBuffer))}function Ig(I,g){I||Gg(I,!0,g,"==",lg)}var gg=/\s*function\s+([^\(\s]*)\s*/;function Cg(I){if(kI(I))return _I()?I.name:(I=I.toString().match(gg))&&I[1]}function Ag(I){this.name="AssertionError",this.actual=I.actual,this.expected=I.expected,this.operator=I.operator,I.message?(this.message=I.message,this.generatedMessage=!1):(this.message=ig(cg(this.actual),128)+" "+this.operator+" "+ig(cg(this.expected),128),this.generatedMessage=!0);var g=I.stackStartFunction||Gg;Error.captureStackTrace?Error.captureStackTrace(this,g):(I=Error()).stack&&(I=I.stack,g=Cg(g),0<=(g=I.indexOf("\n"+g))&&(g=I.indexOf("\n",g+1),I=I.substring(g+1)),this.stack=I)}function ig(I,g){return"string"===typeof I?I.length<g?I:I.slice(0,g):I}function cg(I){return _I()||!kI(I)?YI(I):"[Function"+((I=Cg(I))?": "+I:"")+"]"}function Gg(I,g,C,A,i){throw new Ag({message:C,actual:I,expected:g,operator:A,stackStartFunction:i})}function lg(I,g){I||Gg(I,!0,g,"==",lg)}function bg(I,g,C,A){if(I===g)return!0;if(j(I)&&j(g))return 0===OI(I,g);if(NI(I)&&NI(g))return I.getTime()===g.getTime();if(vI(I)&&vI(g))return I.source===g.source&&I.global===g.global&&I.multiline===g.multiline&&I.lastIndex===g.lastIndex&&I.ignoreCase===g.ignoreCase;if(null!==I&&"object"===typeof I||null!==g&&"object"===typeof g){if(!$I(I)||!$I(g)||Object.prototype.toString.call(I)!==Object.prototype.toString.call(g)||I instanceof Float32Array||I instanceof Float64Array){if(j(I)!==j(g))return!1;var i=(A=A||{actual:[],expected:[]}).actual.indexOf(I);return-1!==i&&i===A.expected.indexOf(g)||(A.actual.push(I),A.expected.push(g),function(I,g,C,A){if(null===I||void 0===I||null===g||void 0===g)return!1;if(TI(I)||TI(g))return I===g;if(C&&Object.getPrototypeOf(I)!==Object.getPrototypeOf(g))return!1;var i=Zg(I),c=Zg(g);if(i&&!c||!i&&c)return!1;if(i)return I=QI.call(I),g=QI.call(g),bg(I,g,C);i=jI(I);var G=jI(g);if(i.length!==G.length)return!1;for(i.sort(),G.sort(),c=i.length-1;0<=c;c--)if(i[c]!==G[c])return!1;for(c=i.length-1;0<=c;c--)if(G=i[c],!bg(I[G],g[G],C,A))return!1;return!0}(I,g,C,A))}return 0===OI(new Uint8Array(I.buffer),new Uint8Array(g.buffer))}return C?I===g:I==g}function Zg(I){return"[object Arguments]"==Object.prototype.toString.call(I)}function tg(I,g){if(!I||!g)return!1;if("[object RegExp]"==Object.prototype.toString.call(g))return g.test(I);try{if(I instanceof g)return!0}catch(C){}return!Error.isPrototypeOf(g)&&!0===g.call({},I)}function og(I,g,C,A){if("function"!==typeof g)throw new TypeError('"block" argument must be a function');"string"===typeof C&&(A=C,C=null);try{g()}catch(G){var i=G}g=i,A=(C&&C.name?" ("+C.name+").":".")+(A?" "+A:"."),I&&!g&&Gg(g,C,"Missing expected exception"+A),i="string"===typeof A;var c=!I&&g&&!C;if((!I&&LI(g)&&i&&tg(g,C)||c)&&Gg(g,C,"Got unwanted exception"+A),I&&g&&C&&!tg(g,C)||!I&&g)throw g}Ig.AssertionError=Ag,XI(Ag,Error),Ig.fail=Gg,Ig.ok=lg,Ig.equal=function I(g,C,A){g!=C&&Gg(g,C,A,"==",I)},Ig.notEqual=function I(g,C,A){g==C&&Gg(g,C,A,"!=",I)},Ig.deepEqual=function I(g,C,A){bg(g,C,!1)||Gg(g,C,A,"deepEqual",I)},Ig.deepStrictEqual=function I(g,C,A){bg(g,C,!0)||Gg(g,C,A,"deepStrictEqual",I)},Ig.notDeepEqual=function I(g,C,A){bg(g,C,!1)&&Gg(g,C,A,"notDeepEqual",I)},Ig.notDeepStrictEqual=function I(g,C,A){bg(g,C,!0)&&Gg(g,C,A,"notDeepStrictEqual",I)},Ig.strictEqual=function I(g,C,A){g!==C&&Gg(g,C,A,"===",I)},Ig.notStrictEqual=function I(g,C,A){g===C&&Gg(g,C,A,"!==",I)},Ig.throws=function(I,g,C){og(!0,I,g,C)},Ig.doesNotThrow=function(I,g,C){og(!1,I,g,C)},Ig.ifError=function(I){if(I)throw I};var ng=b((function(I,g){function C(I){return function(I){function g(g){for(var C=[],i=1;i<arguments.length;i++)C[i-1]=arguments[i];return(C=I.call(this,A(g,C))||this).code=g,C[b]=g,C.name=I.prototype.name+" ["+C[b]+"]",C}return l(g,I),g}(I)}function A(I,g){Ig.strictEqual(typeof I,"string");var C=Z[I];if(Ig(C,"An invalid error message key was used: "+I+"."),"function"===typeof C)I=C;else{if(I=DI.format,void 0===g||0===g.length)return C;g.unshift(C)}return String(I.apply(null,g))}function i(I,g){Z[I]="function"===typeof g?g:String(g)}function c(I,g){if(Ig(I,"expected is required"),Ig("string"===typeof g,"thing is required"),Array.isArray(I)){var C=I.length;return Ig(0<C,"At least one expected value needs to be specified"),I=I.map((function(I){return String(I)})),2<C?"one of "+g+" "+I.slice(0,C-1).join(", ")+", or "+I[C-1]:2===C?"one of "+g+" "+I[0]+" or "+I[1]:"of "+g+" "+I[0]}return"of "+g+" "+String(I)}var l=G&&G.__extends||function(){function I(g,C){return I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,g){I.__proto__=g}||function(I,g){for(var C in g)g.hasOwnProperty(C)&&(I[C]=g[C])},I(g,C)}return function(g,C){function A(){this.constructor=g}I(g,C),g.prototype=null===C?Object.create(C):(A.prototype=C.prototype,new A)}}();Object.defineProperty(g,"__esModule",{value:!0});var b="undefined"===typeof Symbol?"_kCode":Symbol("code"),Z={};I=function(I){function C(C){if("object"!==typeof C||null===C)throw new g.TypeError("ERR_INVALID_ARG_TYPE","options","object");var A=C.message?I.call(this,C.message)||this:I.call(this,DI.inspect(C.actual).slice(0,128)+" "+C.operator+" "+DI.inspect(C.expected).slice(0,128))||this;return A.generatedMessage=!C.message,A.name="AssertionError [ERR_ASSERTION]",A.code="ERR_ASSERTION",A.actual=C.actual,A.expected=C.expected,A.operator=C.operator,g.Error.captureStackTrace(A,C.stackStartFunction),A}return l(C,I),C}(G.Error),g.AssertionError=I,g.message=A,g.E=i,g.Error=C(G.Error),g.TypeError=C(G.TypeError),g.RangeError=C(G.RangeError),i("ERR_ARG_NOT_ITERABLE","%s must be iterable"),i("ERR_ASSERTION","%s"),i("ERR_BUFFER_OUT_OF_BOUNDS",(function(I,g){return g?"Attempt to write outside buffer bounds":'"'+I+'" is outside of buffer bounds'})),i("ERR_CHILD_CLOSED_BEFORE_REPLY","Child closed before reply received"),i("ERR_CONSOLE_WRITABLE_STREAM","Console expects a writable stream instance for %s"),i("ERR_CPU_USAGE","Unable to obtain cpu usage %s"),i("ERR_DNS_SET_SERVERS_FAILED",(function(I,g){return'c-ares failed to set servers: "'+I+'" ['+g+"]"})),i("ERR_FALSY_VALUE_REJECTION","Promise was rejected with falsy value"),i("ERR_ENCODING_NOT_SUPPORTED",(function(I){return'The "'+I+'" encoding is not supported'})),i("ERR_ENCODING_INVALID_ENCODED_DATA",(function(I){return"The encoded data was not valid for encoding "+I})),i("ERR_HTTP_HEADERS_SENT","Cannot render headers after they are sent to the client"),i("ERR_HTTP_INVALID_STATUS_CODE","Invalid status code: %s"),i("ERR_HTTP_TRAILER_INVALID","Trailers are invalid with this transfer encoding"),i("ERR_INDEX_OUT_OF_RANGE","Index out of range"),i("ERR_INVALID_ARG_TYPE",(function(I,g,C){if(Ig(I,"name is required"),g.includes("not ")){var A="must not be";g=g.split("not ")[1]}else A="must be";if(Array.isArray(I))A="The "+I.map((function(I){return'"'+I+'"'})).join(", ")+" arguments "+A+" "+c(g,"type");else if(I.includes(" argument"))A="The "+I+" "+A+" "+c(g,"type");else{var i=I.includes(".")?"property":"argument";A='The "'+I+'" '+i+" "+A+" "+c(g,"type")}return 3<=arguments.length&&(A+=". Received type "+(null!==C?typeof C:"null")),A})),i("ERR_INVALID_ARRAY_LENGTH",(function(I,g,C){return Ig.strictEqual(typeof C,"number"),'The array "'+I+'" (length '+C+") must be of length "+g+"."})),i("ERR_INVALID_BUFFER_SIZE","Buffer size must be a multiple of %s"),i("ERR_INVALID_CALLBACK","Callback must be a function"),i("ERR_INVALID_CHAR","Invalid character in %s"),i("ERR_INVALID_CURSOR_POS","Cannot set cursor row without setting its column"),i("ERR_INVALID_FD",'"fd" must be a positive integer: %s'),i("ERR_INVALID_FILE_URL_HOST",'File URL host must be "localhost" or empty on %s'),i("ERR_INVALID_FILE_URL_PATH","File URL path %s"),i("ERR_INVALID_HANDLE_TYPE","This handle type cannot be sent"),i("ERR_INVALID_IP_ADDRESS","Invalid IP address: %s"),i("ERR_INVALID_OPT_VALUE",(function(I,g){return'The value "'+String(g)+'" is invalid for option "'+I+'"'})),i("ERR_INVALID_OPT_VALUE_ENCODING",(function(I){return'The value "'+String(I)+'" is invalid for option "encoding"'})),i("ERR_INVALID_REPL_EVAL_CONFIG",'Cannot specify both "breakEvalOnSigint" and "eval" for REPL'),i("ERR_INVALID_SYNC_FORK_INPUT","Asynchronous forks do not support Buffer, Uint8Array or string input: %s"),i("ERR_INVALID_THIS",'Value of "this" must be of type %s'),i("ERR_INVALID_TUPLE","%s must be an iterable %s tuple"),i("ERR_INVALID_URL","Invalid URL: %s"),i("ERR_INVALID_URL_SCHEME",(function(I){return"The URL must be "+c(I,"scheme")})),i("ERR_IPC_CHANNEL_CLOSED","Channel closed"),i("ERR_IPC_DISCONNECTED","IPC channel is already disconnected"),i("ERR_IPC_ONE_PIPE","Child process can have only one IPC pipe"),i("ERR_IPC_SYNC_FORK","IPC cannot be used with synchronous forks"),i("ERR_MISSING_ARGS",(function(){for(var I=[],g=0;g<arguments.length;g++)I[g]=arguments[g];Ig(0<I.length,"At least one arg needs to be specified"),g="The ";var C=I.length;switch(I=I.map((function(I){return'"'+I+'"'})),C){case 1:g+=I[0]+" argument";break;case 2:g+=I[0]+" and "+I[1]+" arguments";break;default:g+=I.slice(0,C-1).join(", "),g+=", and "+I[C-1]+" arguments"}return g+" must be specified"})),i("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),i("ERR_NAPI_CONS_FUNCTION","Constructor must be a function"),i("ERR_NAPI_CONS_PROTOTYPE_OBJECT","Constructor.prototype must be an object"),i("ERR_NO_CRYPTO","Node.js is not compiled with OpenSSL crypto support"),i("ERR_NO_LONGER_SUPPORTED","%s is no longer supported"),i("ERR_PARSE_HISTORY_DATA","Could not parse history data in %s"),i("ERR_SOCKET_ALREADY_BOUND","Socket is already bound"),i("ERR_SOCKET_BAD_PORT","Port should be > 0 and < 65536"),i("ERR_SOCKET_BAD_TYPE","Bad socket type specified. Valid types are: udp4, udp6"),i("ERR_SOCKET_CANNOT_SEND","Unable to send data"),i("ERR_SOCKET_CLOSED","Socket is closed"),i("ERR_SOCKET_DGRAM_NOT_RUNNING","Not running"),i("ERR_STDERR_CLOSE","process.stderr cannot be closed"),i("ERR_STDOUT_CLOSE","process.stdout cannot be closed"),i("ERR_STREAM_WRAP","Stream has StringDecoder set or is in objectMode"),i("ERR_TLS_CERT_ALTNAME_INVALID","Hostname/IP does not match certificate's altnames: %s"),i("ERR_TLS_DH_PARAM_SIZE",(function(I){return"DH parameter size "+I+" is less than 2048"})),i("ERR_TLS_HANDSHAKE_TIMEOUT","TLS handshake timeout"),i("ERR_TLS_RENEGOTIATION_FAILED","Failed to renegotiate"),i("ERR_TLS_REQUIRED_SERVER_NAME",'"servername" is required parameter for Server.addContext'),i("ERR_TLS_SESSION_ATTACK","TSL session renegotiation attack detected"),i("ERR_TRANSFORM_ALREADY_TRANSFORMING","Calling transform done when still transforming"),i("ERR_TRANSFORM_WITH_LENGTH_0","Calling transform done when writableState.length != 0"),i("ERR_UNKNOWN_ENCODING","Unknown encoding: %s"),i("ERR_UNKNOWN_SIGNAL","Unknown signal: %s"),i("ERR_UNKNOWN_STDIN_TYPE","Unknown stdin file type"),i("ERR_UNKNOWN_STREAM_TYPE","Unknown stream file type"),i("ERR_V8BREAKITERATOR","Full ICU data not installed. See https://github.com/nodejs/node/wiki/Intl")}));l(ng);var ug=b((function(I,g){Object.defineProperty(g,"__esModule",{value:!0}),g.ENCODING_UTF8="utf8",g.assertEncoding=function(I){if(I&&!$.Buffer.isEncoding(I))throw new ng.TypeError("ERR_INVALID_OPT_VALUE_ENCODING",I)},g.strToEncoding=function(I,C){return C&&C!==g.ENCODING_UTF8?"buffer"===C?new $.Buffer(I):new $.Buffer(I).toString(C):I}}));l(ug);var dg=b((function(I,g){Object.defineProperty(g,"__esModule",{value:!0});var C=Z.constants.S_IFMT,A=Z.constants.S_IFDIR,i=Z.constants.S_IFREG,c=Z.constants.S_IFBLK,G=Z.constants.S_IFCHR,l=Z.constants.S_IFLNK,b=Z.constants.S_IFIFO,t=Z.constants.S_IFSOCK;I=function(){function I(){this.name="",this.mode=0}return I.build=function(g,C){var A=new I,i=g.getNode().mode;return A.name=ug.strToEncoding(g.getName(),C),A.mode=i,A},I.prototype._checkModeProperty=function(I){return(this.mode&C)===I},I.prototype.isDirectory=function(){return this._checkModeProperty(A)},I.prototype.isFile=function(){return this._checkModeProperty(i)},I.prototype.isBlockDevice=function(){return this._checkModeProperty(c)},I.prototype.isCharacterDevice=function(){return this._checkModeProperty(G)},I.prototype.isSymbolicLink=function(){return this._checkModeProperty(l)},I.prototype.isFIFO=function(){return this._checkModeProperty(b)},I.prototype.isSocket=function(){return this._checkModeProperty(t)},I}(),g.Dirent=I,g.default=I}));function mg(I,g){for(var C=0,A=I.length-1;0<=A;A--){var i=I[A];"."===i?I.splice(A,1):".."===i?(I.splice(A,1),C++):C&&(I.splice(A,1),C--)}if(g)for(;C--;C)I.unshift("..");return I}l(dg);function eg(){for(var I="",g=!1,C=arguments.length-1;-1<=C&&!g;C--){var A=0<=C?arguments[C]:"/";if("string"!==typeof A)throw new TypeError("Arguments to path.resolve must be strings");A&&(I=A+"/"+I,g="/"===A.charAt(0))}return(g?"/":"")+(I=mg(hg(I.split("/"),(function(I){return!!I})),!g).join("/"))||"."}function Bg(I,g){function C(I){for(var g=0;g<I.length&&""===I[g];g++);for(var C=I.length-1;0<=C&&""===I[C];C--);return g>C?[]:I.slice(g,C-g+1)}I=eg(I).substr(1),g=eg(g).substr(1),I=C(I.split("/")),g=C(g.split("/"));for(var A=Math.min(I.length,g.length),i=A,c=0;c<A;c++)if(I[c]!==g[c]){i=c;break}for(A=[],c=i;c<I.length;c++)A.push("..");return(A=A.concat(g.slice(i))).join("/")}var Xg="/",yg=Bg,Vg=eg;function hg(I,g){if(I.filter)return I.filter(g);for(var C=[],A=0;A<I.length;A++)g(I[A],A,I)&&C.push(I[A]);return C}var ag=b((function(I,g){Object.defineProperty(g,"__esModule",{value:!0}),I="function"===typeof setImmediate?setImmediate.bind(G):setTimeout.bind(G),g.default=I}));l(ag);var sg=b((function(I,g){function C(){var I=BI||{};return I.getuid||(I.getuid=function(){return 0}),I.getgid||(I.getgid=function(){return 0}),I.cwd||(I.cwd=function(){return"/"}),I.nextTick||(I.nextTick=ag.default),I.emitWarning||(I.emitWarning=function(I,g){console.warn(g+(g?": ":"")+I)}),I.env||(I.env={}),I}Object.defineProperty(g,"__esModule",{value:!0}),g.createProcess=C,g.default=C()}));function rg(){}function Yg(){Yg.init.call(this)}function Wg(I,g,C,A){var i;if("function"!==typeof C)throw new TypeError('"listener" argument must be a function');if(i=I._events){i.newListener&&(I.emit("newListener",g,C.listener?C.listener:C),i=I._events);var c=i[g]}else i=I._events=new rg,I._eventsCount=0;return c?("function"===typeof c?c=i[g]=A?[C,c]:[c,C]:A?c.unshift(C):c.push(C),c.warned||(C=void 0===I._maxListeners?Yg.defaultMaxListeners:I._maxListeners)&&0<C&&c.length>C&&(c.warned=!0,(C=Error("Possible EventEmitter memory leak detected. "+c.length+" "+g+" listeners added. Use emitter.setMaxListeners() to increase limit")).name="MaxListenersExceededWarning",C.emitter=I,C.type=g,C.count=c.length,"function"===typeof console.warn?console.warn(C):console.log(C))):(i[g]=C,++I._eventsCount),I}function Sg(I,g,C){function A(){I.removeListener(g,A),i||(i=!0,C.apply(I,arguments))}var i=!1;return A.listener=C,A}function pg(I){var g=this._events;if(g){if("function"===typeof(I=g[I]))return 1;if(I)return I.length}return 0}function Kg(I,g){for(var C=Array(g);g--;)C[g]=I[g];return C}l(sg),rg.prototype=Object.create(null),Yg.EventEmitter=Yg,Yg.usingDomains=!1,Yg.prototype.domain=void 0,Yg.prototype._events=void 0,Yg.prototype._maxListeners=void 0,Yg.defaultMaxListeners=10,Yg.init=function(){this.domain=null,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new rg,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Yg.prototype.setMaxListeners=function(I){if("number"!==typeof I||0>I||isNaN(I))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=I,this},Yg.prototype.getMaxListeners=function(){return void 0===this._maxListeners?Yg.defaultMaxListeners:this._maxListeners},Yg.prototype.emit=function(I){var g,C,A="error"===I;if(g=this._events)A=A&&null==g.error;else if(!A)return!1;var i=this.domain;if(A){if(g=arguments[1],!i){if(g instanceof Error)throw g;throw(i=Error('Uncaught, unspecified "error" event. ('+g+")")).context=g,i}return g||(g=Error('Uncaught, unspecified "error" event')),g.domainEmitter=this,g.domain=i,g.domainThrown=!1,i.emit("error",g),!1}if(!(i=g[I]))return!1;g="function"===typeof i;var c=arguments.length;switch(c){case 1:if(g)i.call(this);else for(i=Kg(i,g=i.length),A=0;A<g;++A)i[A].call(this);break;case 2:if(A=arguments[1],g)i.call(this,A);else for(i=Kg(i,g=i.length),c=0;c<g;++c)i[c].call(this,A);break;case 3:if(A=arguments[1],c=arguments[2],g)i.call(this,A,c);else for(i=Kg(i,g=i.length),C=0;C<g;++C)i[C].call(this,A,c);break;case 4:if(A=arguments[1],c=arguments[2],C=arguments[3],g)i.call(this,A,c,C);else{i=Kg(i,g=i.length);for(var G=0;G<g;++G)i[G].call(this,A,c,C)}break;default:for(A=Array(c-1),C=1;C<c;C++)A[C-1]=arguments[C];if(g)i.apply(this,A);else for(i=Kg(i,g=i.length),c=0;c<g;++c)i[c].apply(this,A)}return!0},Yg.prototype.addListener=function(I,g){return Wg(this,I,g,!1)},Yg.prototype.on=Yg.prototype.addListener,Yg.prototype.prependListener=function(I,g){return Wg(this,I,g,!0)},Yg.prototype.once=function(I,g){if("function"!==typeof g)throw new TypeError('"listener" argument must be a function');return this.on(I,Sg(this,I,g)),this},Yg.prototype.prependOnceListener=function(I,g){if("function"!==typeof g)throw new TypeError('"listener" argument must be a function');return this.prependListener(I,Sg(this,I,g)),this},Yg.prototype.removeListener=function(I,g){var C;if("function"!==typeof g)throw new TypeError('"listener" argument must be a function');var A=this._events;if(!A)return this;var i=A[I];if(!i)return this;if(i===g||i.listener&&i.listener===g)0===--this._eventsCount?this._events=new rg:(delete A[I],A.removeListener&&this.emit("removeListener",I,i.listener||g));else if("function"!==typeof i){var c=-1;for(C=i.length;0<C--;)if(i[C]===g||i[C].listener&&i[C].listener===g){var G=i[C].listener;c=C;break}if(0>c)return this;if(1===i.length){if(i[0]=void 0,0===--this._eventsCount)return this._events=new rg,this;delete A[I]}else{C=c+1;for(var l=i.length;C<l;c+=1,C+=1)i[c]=i[C];i.pop()}A.removeListener&&this.emit("removeListener",I,G||g)}return this},Yg.prototype.removeAllListeners=function(I){var g=this._events;if(!g)return this;if(!g.removeListener)return 0===arguments.length?(this._events=new rg,this._eventsCount=0):g[I]&&(0===--this._eventsCount?this._events=new rg:delete g[I]),this;if(0===arguments.length){g=Object.keys(g);for(var C,A=0;A<g.length;++A)"removeListener"!==(C=g[A])&&this.removeAllListeners(C);return this.removeAllListeners("removeListener"),this._events=new rg,this._eventsCount=0,this}if("function"===typeof(g=g[I]))this.removeListener(I,g);else if(g)do{this.removeListener(I,g[g.length-1])}while(g[0]);return this},Yg.prototype.listeners=function(I){var g=this._events;if(g)if(I=g[I])if("function"===typeof I)I=[I.listener||I];else{g=Array(I.length);for(var C=0;C<g.length;++C)g[C]=I[C].listener||I[C];I=g}else I=[];else I=[];return I},Yg.listenerCount=function(I,g){return"function"===typeof I.listenerCount?I.listenerCount(g):pg.call(I,g)},Yg.prototype.listenerCount=pg,Yg.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]};var Rg=b((function(I,g){var C=G&&G.__extends||function(){function I(g,C){return I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,g){I.__proto__=g}||function(I,g){for(var C in g)g.hasOwnProperty(C)&&(I[C]=g[C])},I(g,C)}return function(g,C){function A(){this.constructor=g}I(g,C),g.prototype=null===C?Object.create(C):(A.prototype=C.prototype,new A)}}();Object.defineProperty(g,"__esModule",{value:!0});var A=Z.constants.S_IFMT,i=Z.constants.S_IFDIR,c=Z.constants.S_IFREG,l=Z.constants.S_IFLNK,b=Z.constants.O_APPEND;g.SEP="/",I=function(I){function g(g,C){void 0===C&&(C=438);var A=I.call(this)||this;return A.uid=sg.default.getuid(),A.gid=sg.default.getgid(),A.atime=new Date,A.mtime=new Date,A.ctime=new Date,A.perm=438,A.mode=c,A.nlink=1,A.perm=C,A.mode|=C,A.ino=g,A}return C(g,I),g.prototype.getString=function(I){return void 0===I&&(I="utf8"),this.getBuffer().toString(I)},g.prototype.setString=function(I){this.buf=$.bufferFrom(I,"utf8"),this.touch()},g.prototype.getBuffer=function(){return this.buf||this.setBuffer($.bufferAllocUnsafe(0)),$.bufferFrom(this.buf)},g.prototype.setBuffer=function(I){this.buf=$.bufferFrom(I),this.touch()},g.prototype.getSize=function(){return this.buf?this.buf.length:0},g.prototype.setModeProperty=function(I){this.mode=this.mode&~A|I},g.prototype.setIsFile=function(){this.setModeProperty(c)},g.prototype.setIsDirectory=function(){this.setModeProperty(i)},g.prototype.setIsSymlink=function(){this.setModeProperty(l)},g.prototype.isFile=function(){return(this.mode&A)===c},g.prototype.isDirectory=function(){return(this.mode&A)===i},g.prototype.isSymlink=function(){return(this.mode&A)===l},g.prototype.makeSymlink=function(I){this.symlink=I,this.setIsSymlink()},g.prototype.write=function(I,g,C,A){if(void 0===g&&(g=0),void 0===C&&(C=I.length),void 0===A&&(A=0),this.buf||(this.buf=$.bufferAllocUnsafe(0)),A+C>this.buf.length){var i=$.bufferAllocUnsafe(A+C);this.buf.copy(i,0,0,this.buf.length),this.buf=i}return I.copy(this.buf,A,g,g+C),this.touch(),C},g.prototype.read=function(I,g,C,A){return void 0===g&&(g=0),void 0===C&&(C=I.byteLength),void 0===A&&(A=0),this.buf||(this.buf=$.bufferAllocUnsafe(0)),C>I.byteLength&&(C=I.byteLength),C+A>this.buf.length&&(C=this.buf.length-A),this.buf.copy(I,g,A,A+C),C},g.prototype.truncate=function(I){if(void 0===I&&(I=0),I)if(this.buf||(this.buf=$.bufferAllocUnsafe(0)),I<=this.buf.length)this.buf=this.buf.slice(0,I);else{var g=$.bufferAllocUnsafe(0);this.buf.copy(g),g.fill(0,I)}else this.buf=$.bufferAllocUnsafe(0);this.touch()},g.prototype.chmod=function(I){this.perm=I,this.mode=-512&this.mode|I,this.touch()},g.prototype.chown=function(I,g){this.uid=I,this.gid=g,this.touch()},g.prototype.touch=function(){this.mtime=new Date,this.emit("change",this)},g.prototype.canRead=function(I,g){return void 0===I&&(I=sg.default.getuid()),void 0===g&&(g=sg.default.getgid()),!!(4&this.perm||g===this.gid&&32&this.perm||I===this.uid&&256&this.perm)},g.prototype.canWrite=function(I,g){return void 0===I&&(I=sg.default.getuid()),void 0===g&&(g=sg.default.getgid()),!!(2&this.perm||g===this.gid&&16&this.perm||I===this.uid&&128&this.perm)},g.prototype.del=function(){this.emit("delete",this)},g.prototype.toJSON=function(){return{ino:this.ino,uid:this.uid,gid:this.gid,atime:this.atime.getTime(),mtime:this.mtime.getTime(),ctime:this.ctime.getTime(),perm:this.perm,mode:this.mode,nlink:this.nlink,symlink:this.symlink,data:this.getString()}},g}(Yg.EventEmitter),g.Node=I,I=function(I){function A(g,C,A){var i=I.call(this)||this;return i.children={},i.steps=[],i.ino=0,i.length=0,i.vol=g,i.parent=C,i.steps=C?C.steps.concat([A]):[A],i}return C(A,I),A.prototype.setNode=function(I){this.node=I,this.ino=I.ino},A.prototype.getNode=function(){return this.node},A.prototype.createChild=function(I,g){void 0===g&&(g=this.vol.createNode());var C=new A(this.vol,this,I);return C.setNode(g),g.isDirectory(),this.setChild(I,C),C},A.prototype.setChild=function(I,g){return void 0===g&&(g=new A(this.vol,this,I)),this.children[I]=g,g.parent=this,this.length++,this.emit("child:add",g,this),g},A.prototype.deleteChild=function(I){delete this.children[I.getName()],this.length--,this.emit("child:delete",I,this)},A.prototype.getChild=function(I){if(Object.hasOwnProperty.call(this.children,I))return this.children[I]},A.prototype.getPath=function(){return this.steps.join(g.SEP)},A.prototype.getName=function(){return this.steps[this.steps.length-1]},A.prototype.walk=function(I,g,C){if(void 0===g&&(g=I.length),void 0===C&&(C=0),C>=I.length||C>=g)return this;var A=this.getChild(I[C]);return A?A.walk(I,g,C+1):null},A.prototype.toJSON=function(){return{steps:this.steps,ino:this.ino,children:Object.keys(this.children)}},A}(Yg.EventEmitter),g.Link=I,I=function(){function I(I,g,C,A){this.position=0,this.link=I,this.node=g,this.flags=C,this.fd=A}return I.prototype.getString=function(){return this.node.getString()},I.prototype.setString=function(I){this.node.setString(I)},I.prototype.getBuffer=function(){return this.node.getBuffer()},I.prototype.setBuffer=function(I){this.node.setBuffer(I)},I.prototype.getSize=function(){return this.node.getSize()},I.prototype.truncate=function(I){this.node.truncate(I)},I.prototype.seekTo=function(I){this.position=I},I.prototype.stats=function(){return o.default.build(this.node)},I.prototype.write=function(I,g,C,A){return void 0===g&&(g=0),void 0===C&&(C=I.length),"number"!==typeof A&&(A=this.position),this.flags&b&&(A=this.getSize()),I=this.node.write(I,g,C,A),this.position=A+I,I},I.prototype.read=function(I,g,C,A){return void 0===g&&(g=0),void 0===C&&(C=I.byteLength),"number"!==typeof A&&(A=this.position),I=this.node.read(I,g,C,A),this.position=A+I,I},I.prototype.chmod=function(I){this.node.chmod(I)},I.prototype.chown=function(I,g){this.node.chown(I,g)},I}(),g.File=I}));l(Rg);var Hg=Rg.Node,Jg=b((function(I,g){Object.defineProperty(g,"__esModule",{value:!0}),g.default=function(I,g,C){var A=setTimeout.apply(null,arguments);return A&&"object"===typeof A&&"function"===typeof A.unref&&A.unref(),A}}));function Fg(){this.tail=this.head=null,this.length=0}l(Jg),Fg.prototype.push=function(I){I={data:I,next:null},0<this.length?this.tail.next=I:this.head=I,this.tail=I,++this.length},Fg.prototype.unshift=function(I){I={data:I,next:this.head},0===this.length&&(this.tail=I),this.head=I,++this.length},Fg.prototype.shift=function(){if(0!==this.length){var I=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,I}},Fg.prototype.clear=function(){this.head=this.tail=null,this.length=0},Fg.prototype.join=function(I){if(0===this.length)return"";for(var g=this.head,C=""+g.data;g=g.next;)C+=I+g.data;return C},Fg.prototype.concat=function(I){if(0===this.length)return W.alloc(0);if(1===this.length)return this.head.data;I=W.allocUnsafe(I>>>0);for(var g=this.head,C=0;g;)g.data.copy(I,C),C+=g.data.length,g=g.next;return I};var wg=W.isEncoding||function(I){switch(I&&I.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function fg(I){if(this.encoding=(I||"utf8").toLowerCase().replace(/[-_]/,""),I&&!wg(I))throw Error("Unknown encoding: "+I);switch(this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=xg;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=Ng;break;default:return void(this.write=vg)}this.charBuffer=new W(6),this.charLength=this.charReceived=0}function vg(I){return I.toString(this.encoding)}function xg(I){this.charLength=(this.charReceived=I.length%2)?2:0}function Ng(I){this.charLength=(this.charReceived=I.length%3)?3:0}fg.prototype.write=function(I){for(var g="";this.charLength;){if(g=I.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:I.length,I.copy(this.charBuffer,this.charReceived,0,g),this.charReceived+=g,this.charReceived<this.charLength)return"";I=I.slice(g,I.length);var C=(g=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(g.length-1);if(!(55296<=C&&56319>=C)){if(this.charReceived=this.charLength=0,0===I.length)return g;break}this.charLength+=this.surrogateSize,g=""}this.detectIncompleteChar(I);var A=I.length;return this.charLength&&(I.copy(this.charBuffer,0,I.length-this.charReceived,A),A-=this.charReceived),A=(g+=I.toString(this.encoding,0,A)).length-1,55296<=(C=g.charCodeAt(A))&&56319>=C?(C=this.surrogateSize,this.charLength+=C,this.charReceived+=C,this.charBuffer.copy(this.charBuffer,C,0,C),I.copy(this.charBuffer,0,0,C),g.substring(0,A)):g},fg.prototype.detectIncompleteChar=function(I){for(var g=3<=I.length?3:I.length;0<g;g--){var C=I[I.length-g];if(1==g&&6==C>>5){this.charLength=2;break}if(2>=g&&14==C>>4){this.charLength=3;break}if(3>=g&&30==C>>3){this.charLength=4;break}}this.charReceived=g},fg.prototype.end=function(I){var g="";return I&&I.length&&(g=this.write(I)),this.charReceived&&(I=this.encoding,g+=this.charBuffer.slice(0,this.charReceived).toString(I)),g},Tg.ReadableState=kg;var Lg=rI("stream");function kg(I,g){I=I||{},this.objectMode=!!I.objectMode,g instanceof uC&&(this.objectMode=this.objectMode||!!I.readableObjectMode),g=I.highWaterMark;var C=this.objectMode?16:16384;this.highWaterMark=g||0===g?g:C,this.highWaterMark=~~this.highWaterMark,this.buffer=new Fg,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.reading=this.endEmitted=this.ended=!1,this.sync=!0,this.resumeScheduled=this.readableListening=this.emittedReadable=this.needReadable=!1,this.defaultEncoding=I.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.encoding=this.decoder=null,I.encoding&&(this.decoder=new fg(I.encoding),this.encoding=I.encoding)}function Tg(I){if(!(this instanceof Tg))return new Tg(I);this._readableState=new kg(I,this),this.readable=!0,I&&"function"===typeof I.read&&(this._read=I.read),Yg.call(this)}function Ug(I,g,C,A,i){var c=C,G=null;if(j(c)||"string"===typeof c||null===c||void 0===c||g.objectMode||(G=new TypeError("Invalid non-string/buffer chunk")),c=G)I.emit("error",c);else if(null===C)g.reading=!1,g.ended||(g.decoder&&(C=g.decoder.end())&&C.length&&(g.buffer.push(C),g.length+=g.objectMode?1:C.length),g.ended=!0,Eg(I));else if(g.objectMode||C&&0<C.length)if(g.ended&&!i)I.emit("error",Error("stream.push() after EOF"));else if(g.endEmitted&&i)I.emit("error",Error("stream.unshift() after end event"));else{if(g.decoder&&!i&&!A){C=g.decoder.write(C);var l=!g.objectMode&&0===C.length}i||(g.reading=!1),l||(g.flowing&&0===g.length&&!g.sync?(I.emit("data",C),I.read(0)):(g.length+=g.objectMode?1:C.length,i?g.buffer.unshift(C):g.buffer.push(C),g.needReadable&&Eg(I))),g.readingMore||(g.readingMore=!0,oI(Dg,I,g))}else i||(g.reading=!1);return!g.ended&&(g.needReadable||g.length<g.highWaterMark||0===g.length)}function zg(I,g){if(0>=I||0===g.length&&g.ended)return 0;if(g.objectMode)return 1;if(I!==I)return g.flowing&&g.length?g.buffer.head.data.length:g.length;if(I>g.highWaterMark){var C=I;8388608<=C?C=8388608:(C--,C|=C>>>1,C|=C>>>2,C|=C>>>4,C|=C>>>8,C|=C>>>16,C++),g.highWaterMark=C}return I<=g.length?I:g.ended?g.length:(g.needReadable=!0,0)}function Eg(I){var g=I._readableState;g.needReadable=!1,g.emittedReadable||(Lg("emitReadable",g.flowing),g.emittedReadable=!0,g.sync?oI(Mg,I):Mg(I))}function Mg(I){Lg("emit readable"),I.emit("readable"),qg(I)}function Dg(I,g){for(var C=g.length;!g.reading&&!g.flowing&&!g.ended&&g.length<g.highWaterMark&&(Lg("maybeReadMore read 0"),I.read(0),C!==g.length);)C=g.length;g.readingMore=!1}function Og(I){Lg("readable nexttick read 0"),I.read(0)}function Pg(I,g){g.reading||(Lg("resume read 0"),I.read(0)),g.resumeScheduled=!1,g.awaitDrain=0,I.emit("resume"),qg(I),g.flowing&&!g.reading&&I.read(0)}function qg(I){var g=I._readableState;for(Lg("flow",g.flowing);g.flowing&&null!==I.read(););}function jg(I,g){if(0===g.length)return null;if(g.objectMode)var C=g.buffer.shift();else if(!I||I>=g.length)C=g.decoder?g.buffer.join(""):1===g.buffer.length?g.buffer.head.data:g.buffer.concat(g.length),g.buffer.clear();else{if(C=g.buffer,g=g.decoder,I<C.head.data.length)g=C.head.data.slice(0,I),C.head.data=C.head.data.slice(I);else{if(I===C.head.data.length)C=C.shift();else if(g){var A=1,i=(g=C.head).data;for(I-=i.length;g=g.next;){var c=g.data,G=I>c.length?c.length:I;if(i=G===c.length?i+c:i+c.slice(0,I),0===(I-=G)){G===c.length?(++A,C.head=g.next?g.next:C.tail=null):(C.head=g,g.data=c.slice(G));break}++A}C.length-=A,C=i}else{for(g=W.allocUnsafe(I),i=1,(A=C.head).data.copy(g),I-=A.data.length;A=A.next;){if(G=I>(c=A.data).length?c.length:I,c.copy(g,g.length-I,0,G),0===(I-=G)){G===c.length?(++i,C.head=A.next?A.next:C.tail=null):(C.head=A,A.data=c.slice(G));break}++i}C.length-=i,C=g}g=C}C=g}return C}function Qg(I){var g=I._readableState;if(0<g.length)throw Error('"endReadable()" called on non-empty stream');g.endEmitted||(g.ended=!0,oI(_g,g,I))}function _g(I,g){I.endEmitted||0!==I.length||(I.endEmitted=!0,g.readable=!1,g.emit("end"))}function $g(I,g){for(var C=0,A=I.length;C<A;C++)if(I[C]===g)return C;return-1}function IC(){}function gC(I,g,C){this.chunk=I,this.encoding=g,this.callback=C,this.next=null}function CC(I,g){Object.defineProperty(this,"buffer",{get:hI((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")}),I=I||{},this.objectMode=!!I.objectMode,g instanceof uC&&(this.objectMode=this.objectMode||!!I.writableObjectMode);var C=I.highWaterMark,A=this.objectMode?16:16384;this.highWaterMark=C||0===C?C:A,this.highWaterMark=~~this.highWaterMark,this.finished=this.ended=this.ending=this.needDrain=!1,this.decodeStrings=!1!==I.decodeStrings,this.defaultEncoding=I.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(I){var C=g._writableState,A=C.sync,i=C.writecb;C.writing=!1,C.writecb=null,C.length-=C.writelen,C.writelen=0,I?(--C.pendingcb,A?oI(i,I):i(I),g._writableState.errorEmitted=!0,g.emit("error",I)):((I=lC(C))||C.corked||C.bufferProcessing||!C.bufferedRequest||GC(g,C),A?oI(cC,g,C,I,i):cC(g,C,I,i))},this.writecb=null,this.writelen=0,this.lastBufferedRequest=this.bufferedRequest=null,this.pendingcb=0,this.errorEmitted=this.prefinished=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new ZC(this)}function AC(I){if(!(this instanceof AC||this instanceof uC))return new AC(I);this._writableState=new CC(I,this),this.writable=!0,I&&("function"===typeof I.write&&(this._write=I.write),"function"===typeof I.writev&&(this._writev=I.writev)),Yg.call(this)}function iC(I,g,C,A,i,c,G){g.writelen=A,g.writecb=G,g.writing=!0,g.sync=!0,C?I._writev(i,g.onwrite):I._write(i,c,g.onwrite),g.sync=!1}function cC(I,g,C,A){!C&&0===g.length&&g.needDrain&&(g.needDrain=!1,I.emit("drain")),g.pendingcb--,A(),bC(I,g)}function GC(I,g){g.bufferProcessing=!0;var C=g.bufferedRequest;if(I._writev&&C&&C.next){var A=Array(g.bufferedRequestCount),i=g.corkedRequestsFree;i.entry=C;for(var c=0;C;)A[c]=C,C=C.next,c+=1;iC(I,g,!0,g.length,A,"",i.finish),g.pendingcb++,g.lastBufferedRequest=null,i.next?(g.corkedRequestsFree=i.next,i.next=null):g.corkedRequestsFree=new ZC(g)}else{for(;C&&(A=C.chunk,iC(I,g,!1,g.objectMode?1:A.length,A,C.encoding,C.callback),C=C.next,!g.writing););null===C&&(g.lastBufferedRequest=null)}g.bufferedRequestCount=0,g.bufferedRequest=C,g.bufferProcessing=!1}function lC(I){return I.ending&&0===I.length&&null===I.bufferedRequest&&!I.finished&&!I.writing}function bC(I,g){var C=lC(g);return C&&(0===g.pendingcb?(g.prefinished||(g.prefinished=!0,I.emit("prefinish")),g.finished=!0,I.emit("finish")):g.prefinished||(g.prefinished=!0,I.emit("prefinish"))),C}function ZC(I){var g=this;this.entry=this.next=null,this.finish=function(C){var A=g.entry;for(g.entry=null;A;){var i=A.callback;I.pendingcb--,i(C),A=A.next}I.corkedRequestsFree?I.corkedRequestsFree.next=g:I.corkedRequestsFree=g}}XI(Tg,Yg),Tg.prototype.push=function(I,g){var C=this._readableState;return C.objectMode||"string"!==typeof I||(g=g||C.defaultEncoding)!==C.encoding&&(I=W.from(I,g),g=""),Ug(this,C,I,g,!1)},Tg.prototype.unshift=function(I){return Ug(this,this._readableState,I,"",!0)},Tg.prototype.isPaused=function(){return!1===this._readableState.flowing},Tg.prototype.setEncoding=function(I){return this._readableState.decoder=new fg(I),this._readableState.encoding=I,this},Tg.prototype.read=function(I){Lg("read",I),I=parseInt(I,10);var g=this._readableState,C=I;if(0!==I&&(g.emittedReadable=!1),0===I&&g.needReadable&&(g.length>=g.highWaterMark||g.ended))return Lg("read: emitReadable",g.length,g.ended),0===g.length&&g.ended?Qg(this):Eg(this),null;if(0===(I=zg(I,g))&&g.ended)return 0===g.length&&Qg(this),null;var A=g.needReadable;return Lg("need readable",A),(0===g.length||g.length-I<g.highWaterMark)&&Lg("length less than watermark",A=!0),g.ended||g.reading?Lg("reading or ended",!1):A&&(Lg("do read"),g.reading=!0,g.sync=!0,0===g.length&&(g.needReadable=!0),this._read(g.highWaterMark),g.sync=!1,g.reading||(I=zg(C,g))),null===(A=0<I?jg(I,g):null)?(g.needReadable=!0,I=0):g.length-=I,0===g.length&&(g.ended||(g.needReadable=!0),C!==I&&g.ended&&Qg(this)),null!==A&&this.emit("data",A),A},Tg.prototype._read=function(){this.emit("error",Error("not implemented"))},Tg.prototype.pipe=function(I,g){function C(I){Lg("onunpipe"),I===t&&i()}function A(){Lg("onend"),I.end()}function i(){Lg("cleanup"),I.removeListener("close",l),I.removeListener("finish",b),I.removeListener("drain",n),I.removeListener("error",G),I.removeListener("unpipe",C),t.removeListener("end",A),t.removeListener("end",i),t.removeListener("data",c),u=!0,!o.awaitDrain||I._writableState&&!I._writableState.needDrain||n()}function c(g){Lg("ondata"),d=!1,!1!==I.write(g)||d||((1===o.pipesCount&&o.pipes===I||1<o.pipesCount&&-1!==$g(o.pipes,I))&&!u&&(Lg("false write response, pause",t._readableState.awaitDrain),t._readableState.awaitDrain++,d=!0),t.pause())}function G(g){Lg("onerror",g),Z(),I.removeListener("error",G),0===I.listeners("error").length&&I.emit("error",g)}function l(){I.removeListener("finish",b),Z()}function b(){Lg("onfinish"),I.removeListener("close",l),Z()}function Z(){Lg("unpipe"),t.unpipe(I)}var t=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=I;break;case 1:o.pipes=[o.pipes,I];break;default:o.pipes.push(I)}o.pipesCount+=1,Lg("pipe count=%d opts=%j",o.pipesCount,g),g=g&&!1===g.end?i:A,o.endEmitted?oI(g):t.once("end",g),I.on("unpipe",C);var n=function(I){return function(){var g=I._readableState;Lg("pipeOnDrain",g.awaitDrain),g.awaitDrain&&g.awaitDrain--,0===g.awaitDrain&&I.listeners("data").length&&(g.flowing=!0,qg(I))}}(t);I.on("drain",n);var u=!1,d=!1;return t.on("data",c),function(I,g,C){if("function"===typeof I.prependListener)return I.prependListener(g,C);I._events&&I._events[g]?Array.isArray(I._events[g])?I._events[g].unshift(C):I._events[g]=[C,I._events[g]]:I.on(g,C)}(I,"error",G),I.once("close",l),I.once("finish",b),I.emit("pipe",t),o.flowing||(Lg("pipe resume"),t.resume()),I},Tg.prototype.unpipe=function(I){var g=this._readableState;if(0===g.pipesCount)return this;if(1===g.pipesCount)return I&&I!==g.pipes||(I||(I=g.pipes),g.pipes=null,g.pipesCount=0,g.flowing=!1,I&&I.emit("unpipe",this)),this;if(!I){I=g.pipes;var C=g.pipesCount;for(g.pipes=null,g.pipesCount=0,g.flowing=!1,g=0;g<C;g++)I[g].emit("unpipe",this);return this}return-1===(C=$g(g.pipes,I))||(g.pipes.splice(C,1),--g.pipesCount,1===g.pipesCount&&(g.pipes=g.pipes[0]),I.emit("unpipe",this)),this},Tg.prototype.on=function(I,g){return g=Yg.prototype.on.call(this,I,g),"data"===I?!1!==this._readableState.flowing&&this.resume():"readable"===I&&((I=this._readableState).endEmitted||I.readableListening||(I.readableListening=I.needReadable=!0,I.emittedReadable=!1,I.reading?I.length&&Eg(this):oI(Og,this))),g},Tg.prototype.addListener=Tg.prototype.on,Tg.prototype.resume=function(){var I=this._readableState;return I.flowing||(Lg("resume"),I.flowing=!0,I.resumeScheduled||(I.resumeScheduled=!0,oI(Pg,this,I))),this},Tg.prototype.pause=function(){return Lg("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(Lg("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Tg.prototype.wrap=function(I){var g=this._readableState,C=!1,A=this;for(var i in I.on("end",(function(){if(Lg("wrapped end"),g.decoder&&!g.ended){var I=g.decoder.end();I&&I.length&&A.push(I)}A.push(null)})),I.on("data",(function(i){Lg("wrapped data"),g.decoder&&(i=g.decoder.write(i)),g.objectMode&&(null===i||void 0===i)||!(g.objectMode||i&&i.length)||A.push(i)||(C=!0,I.pause())})),I)void 0===this[i]&&"function"===typeof I[i]&&(this[i]=function(g){return function(){return I[g].apply(I,arguments)}}(i));return function(I,g){for(var C=0,A=I.length;C<A;C++)g(I[C],C)}(["error","close","destroy","pause","resume"],(function(g){I.on(g,A.emit.bind(A,g))})),A._read=function(g){Lg("wrapped _read",g),C&&(C=!1,I.resume())},A},Tg._fromList=jg,AC.WritableState=CC,XI(AC,Yg),CC.prototype.getBuffer=function(){for(var I=this.bufferedRequest,g=[];I;)g.push(I),I=I.next;return g},AC.prototype.pipe=function(){this.emit("error",Error("Cannot pipe, not readable"))},AC.prototype.write=function(I,g,C){var A=this._writableState,i=!1;if("function"===typeof g&&(C=g,g=null),W.isBuffer(I)?g="buffer":g||(g=A.defaultEncoding),"function"!==typeof C&&(C=IC),A.ended)A=C,I=Error("write after end"),this.emit("error",I),oI(A,I);else{var c=C,G=!0,l=!1;null===I?l=new TypeError("May not write null values to stream"):W.isBuffer(I)||"string"===typeof I||void 0===I||A.objectMode||(l=new TypeError("Invalid non-string/buffer chunk")),l&&(this.emit("error",l),oI(c,l),G=!1),G&&(A.pendingcb++,i=g,A.objectMode||!1===A.decodeStrings||"string"!==typeof I||(I=W.from(I,i)),W.isBuffer(I)&&(i="buffer"),c=A.objectMode?1:I.length,A.length+=c,(g=A.length<A.highWaterMark)||(A.needDrain=!0),A.writing||A.corked?(c=A.lastBufferedRequest,A.lastBufferedRequest=new gC(I,i,C),c?c.next=A.lastBufferedRequest:A.bufferedRequest=A.lastBufferedRequest,A.bufferedRequestCount+=1):iC(this,A,!1,c,I,i,C),i=g)}return i},AC.prototype.cork=function(){this._writableState.corked++},AC.prototype.uncork=function(){var I=this._writableState;I.corked&&(I.corked--,I.writing||I.corked||I.finished||I.bufferProcessing||!I.bufferedRequest||GC(this,I))},AC.prototype.setDefaultEncoding=function(I){if("string"===typeof I&&(I=I.toLowerCase()),!(-1<"hex utf8 utf-8 ascii binary base64 ucs2 ucs-2 utf16le utf-16le raw".split(" ").indexOf((I+"").toLowerCase())))throw new TypeError("Unknown encoding: "+I);return this._writableState.defaultEncoding=I,this},AC.prototype._write=function(I,g,C){C(Error("not implemented"))},AC.prototype._writev=null,AC.prototype.end=function(I,g,C){var A=this._writableState;"function"===typeof I?(C=I,g=I=null):"function"===typeof g&&(C=g,g=null),null!==I&&void 0!==I&&this.write(I,g),A.corked&&(A.corked=1,this.uncork()),A.ending||A.finished||(I=C,A.ending=!0,bC(this,A),I&&(A.finished?oI(I):this.once("finish",I)),A.ended=!0,this.writable=!1)},XI(uC,Tg);for(var tC=Object.keys(AC.prototype),oC=0;oC<tC.length;oC++){var nC=tC[oC];uC.prototype[nC]||(uC.prototype[nC]=AC.prototype[nC])}function uC(I){if(!(this instanceof uC))return new uC(I);Tg.call(this,I),AC.call(this,I),I&&!1===I.readable&&(this.readable=!1),I&&!1===I.writable&&(this.writable=!1),this.allowHalfOpen=!0,I&&!1===I.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",dC)}function dC(){this.allowHalfOpen||this._writableState.ended||oI(mC,this)}function mC(I){I.end()}function eC(I){this.afterTransform=function(g,C){var A=I._transformState;A.transforming=!1;var i=A.writecb;return i?(A.writechunk=null,A.writecb=null,null!==C&&void 0!==C&&I.push(C),i(g),(g=I._readableState).reading=!1,(g.needReadable||g.length<g.highWaterMark)&&I._read(g.highWaterMark),g=void 0):g=I.emit("error",Error("no writecb in Transform class")),g},this.transforming=this.needTransform=!1,this.writeencoding=this.writechunk=this.writecb=null}function BC(I){if(!(this instanceof BC))return new BC(I);uC.call(this,I),this._transformState=new eC(this);var g=this;this._readableState.needReadable=!0,this._readableState.sync=!1,I&&("function"===typeof I.transform&&(this._transform=I.transform),"function"===typeof I.flush&&(this._flush=I.flush)),this.once("prefinish",(function(){"function"===typeof this._flush?this._flush((function(I){XC(g,I)})):XC(g)}))}function XC(I,g){if(g)return I.emit("error",g);if(g=I._transformState,I._writableState.length)throw Error("Calling transform done when ws.length != 0");if(g.transforming)throw Error("Calling transform done when still transforming");return I.push(null)}function yC(I){if(!(this instanceof yC))return new yC(I);BC.call(this,I)}function VC(){Yg.call(this)}XI(BC,uC),BC.prototype.push=function(I,g){return this._transformState.needTransform=!1,uC.prototype.push.call(this,I,g)},BC.prototype._transform=function(){throw Error("Not implemented")},BC.prototype._write=function(I,g,C){var A=this._transformState;A.writecb=C,A.writechunk=I,A.writeencoding=g,A.transforming||(I=this._readableState,(A.needTransform||I.needReadable||I.length<I.highWaterMark)&&this._read(I.highWaterMark))},BC.prototype._read=function(){var I=this._transformState;null!==I.writechunk&&I.writecb&&!I.transforming?(I.transforming=!0,this._transform(I.writechunk,I.writeencoding,I.afterTransform)):I.needTransform=!0},XI(yC,BC),yC.prototype._transform=function(I,g,C){C(null,I)},XI(VC,Yg),VC.Readable=Tg,VC.Writable=AC,VC.Duplex=uC,VC.Transform=BC,VC.PassThrough=yC,VC.Stream=VC,VC.prototype.pipe=function(I,g){function C(g){I.writable&&!1===I.write(g)&&b.pause&&b.pause()}function A(){b.readable&&b.resume&&b.resume()}function i(){Z||(Z=!0,I.end())}function c(){Z||(Z=!0,"function"===typeof I.destroy&&I.destroy())}function G(I){if(l(),0===Yg.listenerCount(this,"error"))throw I}function l(){b.removeListener("data",C),I.removeListener("drain",A),b.removeListener("end",i),b.removeListener("close",c),b.removeListener("error",G),I.removeListener("error",G),b.removeListener("end",l),b.removeListener("close",l),I.removeListener("close",l)}var b=this;b.on("data",C),I.on("drain",A),I._isStdio||g&&!1===g.end||(b.on("end",i),b.on("close",c));var Z=!1;return b.on("error",G),I.on("error",G),b.on("end",l),b.on("close",l),I.on("close",l),I.emit("pipe",b),I};var hC=Array.prototype.slice,aC=function I(g,C){for(var A in C)g[A]=C[A];return 3>arguments.length?g:I.apply(null,[g].concat(hC.call(arguments,2)))},sC=b((function(I,g){function C(I,g,C){return void 0===C&&(C=function(I){return I}),function(){for(var i=[],c=0;c<arguments.length;c++)i[c]=arguments[c];return new Promise((function(c,G){I[g].bind(I).apply(void 0,A(i,[function(I,g){return I?G(I):c(C(g))}]))}))}}var A=G&&G.__spreadArrays||function(){for(var I=0,g=0,C=arguments.length;g<C;g++)I+=arguments[g].length;I=Array(I);var A=0;for(g=0;g<C;g++)for(var i=arguments[g],c=0,G=i.length;c<G;c++,A++)I[A]=i[c];return I};Object.defineProperty(g,"__esModule",{value:!0});var i=function(){function I(I,g){this.vol=I,this.fd=g}return I.prototype.appendFile=function(I,g){return C(this.vol,"appendFile")(this.fd,I,g)},I.prototype.chmod=function(I){return C(this.vol,"fchmod")(this.fd,I)},I.prototype.chown=function(I,g){return C(this.vol,"fchown")(this.fd,I,g)},I.prototype.close=function(){return C(this.vol,"close")(this.fd)},I.prototype.datasync=function(){return C(this.vol,"fdatasync")(this.fd)},I.prototype.read=function(I,g,A,i){return C(this.vol,"read",(function(g){return{bytesRead:g,buffer:I}}))(this.fd,I,g,A,i)},I.prototype.readFile=function(I){return C(this.vol,"readFile")(this.fd,I)},I.prototype.stat=function(I){return C(this.vol,"fstat")(this.fd,I)},I.prototype.sync=function(){return C(this.vol,"fsync")(this.fd)},I.prototype.truncate=function(I){return C(this.vol,"ftruncate")(this.fd,I)},I.prototype.utimes=function(I,g){return C(this.vol,"futimes")(this.fd,I,g)},I.prototype.write=function(I,g,A,i){return C(this.vol,"write",(function(g){return{bytesWritten:g,buffer:I}}))(this.fd,I,g,A,i)},I.prototype.writeFile=function(I,g){return C(this.vol,"writeFile")(this.fd,I,g)},I}();g.FileHandle=i,g.default=function(I){return"undefined"===typeof Promise?null:{FileHandle:i,access:function(g,A){return C(I,"access")(g,A)},appendFile:function(g,A,c){return C(I,"appendFile")(g instanceof i?g.fd:g,A,c)},chmod:function(g,A){return C(I,"chmod")(g,A)},chown:function(g,A,i){return C(I,"chown")(g,A,i)},copyFile:function(g,A,i){return C(I,"copyFile")(g,A,i)},lchmod:function(g,A){return C(I,"lchmod")(g,A)},lchown:function(g,A,i){return C(I,"lchown")(g,A,i)},link:function(g,A){return C(I,"link")(g,A)},lstat:function(g,A){return C(I,"lstat")(g,A)},mkdir:function(g,A){return C(I,"mkdir")(g,A)},mkdtemp:function(g,A){return C(I,"mkdtemp")(g,A)},open:function(g,A,c){return C(I,"open",(function(g){return new i(I,g)}))(g,A,c)},readdir:function(g,A){return C(I,"readdir")(g,A)},readFile:function(g,A){return C(I,"readFile")(g instanceof i?g.fd:g,A)},readlink:function(g,A){return C(I,"readlink")(g,A)},realpath:function(g,A){return C(I,"realpath")(g,A)},rename:function(g,A){return C(I,"rename")(g,A)},rmdir:function(g){return C(I,"rmdir")(g)},stat:function(g,A){return C(I,"stat")(g,A)},symlink:function(g,A,i){return C(I,"symlink")(g,A,i)},truncate:function(g,A){return C(I,"truncate")(g,A)},unlink:function(g){return C(I,"unlink")(g)},utimes:function(g,A,i){return C(I,"utimes")(g,A,i)},writeFile:function(g,A,c){return C(I,"writeFile")(g instanceof i?g.fd:g,A,c)}}}}));l(sC);var rC=/[^\x20-\x7E]/,YC=/[\x2E\u3002\uFF0E\uFF61]/g,WC="Overflow: input needs wider integers to process",SC=Math.floor,pC=String.fromCharCode;function KC(I,g){return I+22+75*(26>I)-((0!=g)<<5)}function RC(I){return function(I,g){var C=I.split("@"),A="";1<C.length&&(A=C[0]+"@",I=C[1]),C=(I=(I=I.replace(YC,".")).split(".")).length;for(var i=[];C--;)i[C]=g(I[C]);return A+i.join(".")}(I,(function(I){if(rC.test(I)){var g,C=[],A=[],i=0;for(g=I.length;i<g;){var c=I.charCodeAt(i++);if(55296<=c&&56319>=c&&i<g){var G=I.charCodeAt(i++);56320==(64512&G)?A.push(((1023&c)<<10)+(1023&G)+65536):(A.push(c),i--)}else A.push(c)}G=(I=A).length,A=128;var l=0,b=72;for(c=0;c<G;++c){var Z=I[c];128>Z&&C.push(pC(Z))}for((i=g=C.length)&&C.push("-");i<G;){var t=2147483647;for(c=0;c<G;++c)(Z=I[c])>=A&&Z<t&&(t=Z);var o=i+1;if(t-A>SC((2147483647-l)/o))throw new RangeError(WC);for(l+=(t-A)*o,A=t,c=0;c<G;++c){if((Z=I[c])<A&&2147483647<++l)throw new RangeError(WC);if(Z==A){var n=l;for(t=36;!(n<(Z=t<=b?1:t>=b+26?26:t-b));t+=36){var u=n-Z;n=36-Z,C.push(pC(KC(Z+u%n,0))),n=SC(u/n)}for(C.push(pC(KC(n,0))),b=o,t=0,l=i==g?SC(l/700):l>>1,l+=SC(l/b);455<l;t+=36)l=SC(l/35);b=SC(t+36*l/(l+38)),l=0,++i}}++l,++A}C="xn--"+C.join("")}else C=I;return C}))}var HC=Array.isArray||function(I){return"[object Array]"===Object.prototype.toString.call(I)};function JC(I){switch(typeof I){case"string":return I;case"boolean":return I?"true":"false";case"number":return isFinite(I)?I:"";default:return""}}function FC(I,g){if(I.map)return I.map(g);for(var C=[],A=0;A<I.length;A++)C.push(g(I[A],A));return C}var wC=Object.keys||function(I){var g,C=[];for(g in I)Object.prototype.hasOwnProperty.call(I,g)&&C.push(g);return C};function fC(I,g,C,A){C=C||"=";var i={};if("string"!==typeof I||0===I.length)return i;var c=/\+/g;for(I=I.split(g||"&"),g=1e3,A&&"number"===typeof A.maxKeys&&(g=A.maxKeys),A=I.length,0<g&&A>g&&(A=g),g=0;g<A;++g){var G=I[g].replace(c,"%20"),l=G.indexOf(C);if(0<=l){var b=G.substr(0,l);G=G.substr(l+1)}else b=G,G="";b=decodeURIComponent(b),G=decodeURIComponent(G),Object.prototype.hasOwnProperty.call(i,b)?HC(i[b])?i[b].push(G):i[b]=[i[b],G]:i[b]=G}return i}var vC={parse:jC,resolve:function(I,g){return jC(I,!1,!0).resolve(g)},resolveObject:function(I,g){return I?jC(I,!1,!0).resolveObject(g):g},format:function(I){return wI(I)&&(I=QC({},I)),_C(I)},Url:xC};function xC(){this.href=this.path=this.pathname=this.query=this.search=this.hash=this.hostname=this.port=this.host=this.auth=this.slashes=this.protocol=null}var NC=/^([a-z0-9.+-]+:)/i,LC=/:[0-9]*$/,kC=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,TC="{}|\\^`".split("").concat('<>"` \r\n\t'.split("")),UC=["'"].concat(TC),zC=["%","/","?",";","#"].concat(UC),EC=["/","?","#"],MC=/^[+a-z0-9A-Z_-]{0,63}$/,DC=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,OC={javascript:!0,"javascript:":!0},PC={javascript:!0,"javascript:":!0},qC={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function jC(I,g,C){if(I&&xI(I)&&I instanceof xC)return I;var A=new xC;return A.parse(I,g,C),A}function QC(I,g,C,A){if(!wI(g))throw new TypeError("Parameter 'url' must be a string, not "+typeof g);var i=g.indexOf("?");if(i=-1!==i&&i<g.indexOf("#")?"?":"#",(g=g.split(i))[0]=g[0].replace(/\\/g,"/"),i=(g=g.join(i)).trim(),!A&&1===g.split("#").length&&(g=kC.exec(i)))return I.path=i,I.href=i,I.pathname=g[1],g[2]?(I.search=g[2],I.query=C?fC(I.search.substr(1)):I.search.substr(1)):C&&(I.search="",I.query={}),I;if(g=NC.exec(i)){var c=(g=g[0]).toLowerCase();I.protocol=c,i=i.substr(g.length)}if(A||g||i.match(/^\/\/[^@\/]+@[^@\/]+/)){var G="//"===i.substr(0,2);!G||g&&PC[g]||(i=i.substr(2),I.slashes=!0)}if(!PC[g]&&(G||g&&!qC[g])){for(g=-1,A=0;A<EC.length;A++)-1!==(G=i.indexOf(EC[A]))&&(-1===g||G<g)&&(g=G);for(-1!==(G=-1===g?i.lastIndexOf("@"):i.lastIndexOf("@",g))&&(A=i.slice(0,G),i=i.slice(G+1),I.auth=decodeURIComponent(A)),g=-1,A=0;A<zC.length;A++)-1!==(G=i.indexOf(zC[A]))&&(-1===g||G<g)&&(g=G);if(-1===g&&(g=i.length),I.host=i.slice(0,g),i=i.slice(g),$C(I),I.hostname=I.hostname||"",!(G="["===I.hostname[0]&&"]"===I.hostname[I.hostname.length-1])){var l=I.hostname.split(/\./);for(A=0,g=l.length;A<g;A++){var b=l[A];if(b&&!b.match(MC)){for(var Z="",t=0,o=b.length;t<o;t++)Z=127<b.charCodeAt(t)?Z+"x":Z+b[t];if(!Z.match(MC)){g=l.slice(0,A),A=l.slice(A+1),(b=b.match(DC))&&(g.push(b[1]),A.unshift(b[2])),A.length&&(i="/"+A.join(".")+i),I.hostname=g.join(".");break}}}}I.hostname=I.hostname.length>255?"":I.hostname.toLowerCase(),G||(I.hostname=RC(I.hostname)),A=I.port?":"+I.port:"",I.host=(I.hostname||"")+A,I.href+=I.host,G&&(I.hostname=I.hostname.substr(1,I.hostname.length-2),"/"!==i[0]&&(i="/"+i))}if(!OC[c])for(A=0,g=UC.length;A<g;A++)G=UC[A],-1!==i.indexOf(G)&&((b=encodeURIComponent(G))===G&&(b=escape(G)),i=i.split(G).join(b));return-1!==(A=i.indexOf("#"))&&(I.hash=i.substr(A),i=i.slice(0,A)),-1!==(A=i.indexOf("?"))?(I.search=i.substr(A),I.query=i.substr(A+1),C&&(I.query=fC(I.query)),i=i.slice(0,A)):C&&(I.search="",I.query={}),i&&(I.pathname=i),qC[c]&&I.hostname&&!I.pathname&&(I.pathname="/"),(I.pathname||I.search)&&(A=I.pathname||"",I.path=A+(I.search||"")),I.href=_C(I),I}function _C(I){var g=I.auth||"";g&&(g=(g=encodeURIComponent(g)).replace(/%3A/i,":"),g+="@");var C=I.protocol||"",A=I.pathname||"",i=I.hash||"",c=!1,G="";return I.host?c=g+I.host:I.hostname&&(c=g+(-1===I.hostname.indexOf(":")?I.hostname:"["+this.hostname+"]"),I.port&&(c+=":"+I.port)),I.query&&xI(I.query)&&Object.keys(I.query).length&&(G=function(I,g,C,A){return g=g||"&",C=C||"=",null===I&&(I=void 0),"object"===typeof I?FC(wC(I),(function(A){var i=encodeURIComponent(JC(A))+C;return HC(I[A])?FC(I[A],(function(I){return i+encodeURIComponent(JC(I))})).join(g):i+encodeURIComponent(JC(I[A]))})).join(g):A?encodeURIComponent(JC(A))+C+encodeURIComponent(JC(I)):""}(I.query)),g=I.search||G&&"?"+G||"",C&&":"!==C.substr(-1)&&(C+=":"),I.slashes||(!C||qC[C])&&!1!==c?(c="//"+(c||""),A&&"/"!==A.charAt(0)&&(A="/"+A)):c||(c=""),i&&"#"!==i.charAt(0)&&(i="#"+i),g&&"?"!==g.charAt(0)&&(g="?"+g),A=A.replace(/[?#]/g,(function(I){return encodeURIComponent(I)})),C+c+A+(g=g.replace("#","%23"))+i}function $C(I){var g=I.host,C=LC.exec(g);C&&(":"!==(C=C[0])&&(I.port=C.substr(1)),g=g.substr(0,g.length-C.length)),g&&(I.hostname=g)}xC.prototype.parse=function(I,g,C){return QC(this,I,g,C)},xC.prototype.format=function(){return _C(this)},xC.prototype.resolve=function(I){return this.resolveObject(jC(I,!1,!0)).format()},xC.prototype.resolveObject=function(I){if(wI(I)){var g=new xC;g.parse(I,!1,!0),I=g}g=new xC;for(var C=Object.keys(this),A=0;A<C.length;A++){var i=C[A];g[i]=this[i]}if(g.hash=I.hash,""===I.href)return g.href=g.format(),g;if(I.slashes&&!I.protocol){for(C=Object.keys(I),A=0;A<C.length;A++)"protocol"!==(i=C[A])&&(g[i]=I[i]);return qC[g.protocol]&&g.hostname&&!g.pathname&&(g.path=g.pathname="/"),g.href=g.format(),g}var c;if(I.protocol&&I.protocol!==g.protocol){if(!qC[I.protocol]){for(C=Object.keys(I),A=0;A<C.length;A++)g[i=C[A]]=I[i];return g.href=g.format(),g}if(g.protocol=I.protocol,I.host||PC[I.protocol])g.pathname=I.pathname;else{for(c=(I.pathname||"").split("/");c.length&&!(I.host=c.shift()););I.host||(I.host=""),I.hostname||(I.hostname=""),""!==c[0]&&c.unshift(""),2>c.length&&c.unshift(""),g.pathname=c.join("/")}return g.search=I.search,g.query=I.query,g.host=I.host||"",g.auth=I.auth,g.hostname=I.hostname||I.host,g.port=I.port,(g.pathname||g.search)&&(g.path=(g.pathname||"")+(g.search||"")),g.slashes=g.slashes||I.slashes,g.href=g.format(),g}C=g.pathname&&"/"===g.pathname.charAt(0);var G=I.host||I.pathname&&"/"===I.pathname.charAt(0),l=C=G||C||g.host&&I.pathname;if(A=g.pathname&&g.pathname.split("/")||[],i=g.protocol&&!qC[g.protocol],c=I.pathname&&I.pathname.split("/")||[],i&&(g.hostname="",g.port=null,g.host&&(""===A[0]?A[0]=g.host:A.unshift(g.host)),g.host="",I.protocol&&(I.hostname=null,I.port=null,I.host&&(""===c[0]?c[0]=I.host:c.unshift(I.host)),I.host=null),C=C&&(""===c[0]||""===A[0])),G)g.host=I.host||""===I.host?I.host:g.host,g.hostname=I.hostname||""===I.hostname?I.hostname:g.hostname,g.search=I.search,g.query=I.query,A=c;else if(c.length)A||(A=[]),A.pop(),A=A.concat(c),g.search=I.search,g.query=I.query;else if(null!=I.search)return i&&(g.hostname=g.host=A.shift(),i=!!(g.host&&0<g.host.indexOf("@"))&&g.host.split("@"))&&(g.auth=i.shift(),g.host=g.hostname=i.shift()),g.search=I.search,g.query=I.query,null===g.pathname&&null===g.search||(g.path=(g.pathname?g.pathname:"")+(g.search?g.search:"")),g.href=g.format(),g;if(!A.length)return g.pathname=null,g.path=g.search?"/"+g.search:null,g.href=g.format(),g;G=A.slice(-1)[0],c=(g.host||I.host||1<A.length)&&("."===G||".."===G)||""===G;for(var b=0,Z=A.length;0<=Z;Z--)"."===(G=A[Z])?A.splice(Z,1):".."===G?(A.splice(Z,1),b++):b&&(A.splice(Z,1),b--);if(!C&&!l)for(;b--;b)A.unshift("..");return!C||""===A[0]||A[0]&&"/"===A[0].charAt(0)||A.unshift(""),c&&"/"!==A.join("/").substr(-1)&&A.push(""),l=""===A[0]||A[0]&&"/"===A[0].charAt(0),i&&(g.hostname=g.host=l?"":A.length?A.shift():"",i=!!(g.host&&0<g.host.indexOf("@"))&&g.host.split("@"))&&(g.auth=i.shift(),g.host=g.hostname=i.shift()),(C=C||g.host&&A.length)&&!l&&A.unshift(""),A.length?g.pathname=A.join("/"):(g.pathname=null,g.path=null),null===g.pathname&&null===g.search||(g.path=(g.pathname?g.pathname:"")+(g.search?g.search:"")),g.auth=I.auth||g.auth,g.slashes=g.slashes||I.slashes,g.href=g.format(),g},xC.prototype.parseHost=function(){return $C(this)};var IA=b((function(I,g){function C(I,g){return I=I[g],0<g&&("/"===I||i&&"\\"===I)}function A(I){var g=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];if(i){var A=I;if("string"!==typeof A)throw new TypeError("expected a string");if(A=A.replace(/[\\\/]+/g,"/"),!1!==g)if(2>(A=(g=A).length-1))A=g;else{for(;C(g,A);)A--;A=g.substr(0,A+1)}return A.replace(/^([a-zA-Z]+:|\.\/)/,"")}return I}Object.defineProperty(g,"__esModule",{value:!0}),g.unixify=A,g.correctPath=function(I){return A(I.replace(/^\\\\\?\\.:\\/,"\\"))};var i="win32"===BI.platform}));l(IA);var gA=b((function(I,g){function C(I,g){return void 0===g&&(g=sg.default.cwd()),w(g,I)}function A(I,g){return"function"===typeof I?[i(),I]:[i(I),u(g)]}function i(I){return void 0===I&&(I={}),F({},nI,I)}function c(I){return F({},bI,"number"===typeof I?{mode:I}:I)}function l(I,g,C,A,i){return void 0===g&&(g=""),void 0===C&&(C=""),void 0===A&&(A=""),void 0===i&&(i=Error),g=new i(function(I,g,C,A){void 0===g&&(g=""),void 0===C&&(C=""),void 0===A&&(A="");var i="";switch(C&&(i=" '"+C+"'"),A&&(i+=" -> '"+A+"'"),I){case"ENOENT":return"ENOENT: no such file or directory, "+g+i;case"EBADF":return"EBADF: bad file descriptor, "+g+i;case"EINVAL":return"EINVAL: invalid argument, "+g+i;case"EPERM":return"EPERM: operation not permitted, "+g+i;case"EPROTO":return"EPROTO: protocol error, "+g+i;case"EEXIST":return"EEXIST: file already exists, "+g+i;case"ENOTDIR":return"ENOTDIR: not a directory, "+g+i;case"EISDIR":return"EISDIR: illegal operation on a directory, "+g+i;case"EACCES":return"EACCES: permission denied, "+g+i;case"ENOTEMPTY":return"ENOTEMPTY: directory not empty, "+g+i;case"EMFILE":return"EMFILE: too many open files, "+g+i;case"ENOSYS":return"ENOSYS: function not implemented, "+g+i;default:return I+": error occurred, "+g+i}}(I,g,C,A)),g.code=I,g}function b(I){if("number"===typeof I)return I;if("string"===typeof I){var g=J[I];if("undefined"!==typeof g)return g}throw new ng.TypeError("ERR_INVALID_OPT_VALUE","flags",I)}function t(I,g){if(!g)return I;var C=typeof g;switch(C){case"string":I=F({},I,{encoding:g});break;case"object":I=F({},I,g);break;default:throw TypeError("Expected options to be either an object or a string, but got "+C+" instead")}return"buffer"!==I.encoding&&ug.assertEncoding(I.encoding),I}function n(I){return function(g){return t(I,g)}}function u(I){if("function"!==typeof I)throw TypeError(j.CB);return I}function d(I){return function(g,C){return"function"===typeof g?[I(),g]:[I(g),u(C)]}}function m(I){if("string"!==typeof I&&!$.Buffer.isBuffer(I)){try{if(!(I instanceof vC.URL))throw new TypeError(j.PATH_STR)}catch(A){throw new TypeError(j.PATH_STR)}if(""!==I.hostname)throw new ng.TypeError("ERR_INVALID_FILE_URL_HOST",sg.default.platform);I=I.pathname;for(var g=0;g<I.length;g++)if("%"===I[g]){var C=32|I.codePointAt(g+2);if("2"===I[g+1]&&102===C)throw new ng.TypeError("ERR_INVALID_FILE_URL_PATH","must not include encoded / characters")}I=decodeURIComponent(I)}return V(I=String(I)),I}function e(I,g){return(I=C(I,g).substr(1))?I.split(O):[]}function B(I){return e(m(I))}function X(I,g){return void 0===g&&(g=ug.ENCODING_UTF8),$.Buffer.isBuffer(I)?I:I instanceof Uint8Array?$.bufferFrom(I):$.bufferFrom(String(I),g)}function y(I,g){return g&&"buffer"!==g?I.toString(g):I}function V(I,g){if(-1!==(""+I).indexOf("\0")){if((I=Error("Path must be a string without null bytes")).code="ENOENT","function"!==typeof g)throw I;return sg.default.nextTick(g,I),!1}return!0}function h(I,g){if("number"!==typeof(I="number"===typeof I?I:"string"===typeof I?parseInt(I,8):g?h(g):void 0)||isNaN(I))throw new TypeError(j.MODE_INT);return I}function a(I){if(I>>>0!==I)throw TypeError(j.FD)}function s(I){if("string"===typeof I&&+I==I)return+I;if(I instanceof Date)return I.getTime()/1e3;if(isFinite(I))return 0>I?Date.now()/1e3:I;throw Error("Cannot parse time: "+I)}function r(I){if("number"!==typeof I)throw TypeError(j.UID)}function Y(I){if("number"!==typeof I)throw TypeError(j.GID)}function W(I){I.emit("stop")}function S(I,g,C){if(!(this instanceof S))return new S(I,g,C);if(this._vol=I,void 0===(C=F({},t(C,{}))).highWaterMark&&(C.highWaterMark=65536),VC.Readable.call(this,C),this.path=m(g),this.fd=void 0===C.fd?null:C.fd,this.flags=void 0===C.flags?"r":C.flags,this.mode=void 0===C.mode?438:C.mode,this.start=C.start,this.end=C.end,this.autoClose=void 0===C.autoClose||C.autoClose,this.pos=void 0,this.bytesRead=0,void 0!==this.start){if("number"!==typeof this.start)throw new TypeError('"start" option must be a Number');if(void 0===this.end)this.end=1/0;else if("number"!==typeof this.end)throw new TypeError('"end" option must be a Number');if(this.start>this.end)throw Error('"start" option must be <= "end" option');this.pos=this.start}"number"!==typeof this.fd&&this.open(),this.on("end",(function(){this.autoClose&&this.destroy&&this.destroy()}))}function p(){this.close()}function K(I,g,C){if(!(this instanceof K))return new K(I,g,C);if(this._vol=I,C=F({},t(C,{})),VC.Writable.call(this,C),this.path=m(g),this.fd=void 0===C.fd?null:C.fd,this.flags=void 0===C.flags?"w":C.flags,this.mode=void 0===C.mode?438:C.mode,this.start=C.start,this.autoClose=void 0===C.autoClose||!!C.autoClose,this.pos=void 0,this.bytesWritten=0,void 0!==this.start){if("number"!==typeof this.start)throw new TypeError('"start" option must be a Number');if(0>this.start)throw Error('"start" must be >= zero');this.pos=this.start}C.encoding&&this.setDefaultEncoding(C.encoding),"number"!==typeof this.fd&&this.open(),this.once("finish",(function(){this.autoClose&&this.close()}))}var R=G&&G.__extends||function(){function I(g,C){return I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,g){I.__proto__=g}||function(I,g){for(var C in g)g.hasOwnProperty(C)&&(I[C]=g[C])},I(g,C)}return function(g,C){function A(){this.constructor=g}I(g,C),g.prototype=null===C?Object.create(C):(A.prototype=C.prototype,new A)}}(),H=G&&G.__spreadArrays||function(){for(var I=0,g=0,C=arguments.length;g<C;g++)I+=arguments[g].length;I=Array(I);var A=0;for(g=0;g<C;g++)for(var i=arguments[g],c=0,G=i.length;c<G;c++,A++)I[A]=i[c];return I};Object.defineProperty(g,"__esModule",{value:!0});var J,F=aC,w=Vg,f=Z.constants.O_RDONLY,v=Z.constants.O_WRONLY,x=Z.constants.O_RDWR,N=Z.constants.O_CREAT,L=Z.constants.O_EXCL,k=Z.constants.O_TRUNC,T=Z.constants.O_APPEND,U=Z.constants.O_SYNC,z=Z.constants.O_DIRECTORY,E=Z.constants.F_OK,M=Z.constants.COPYFILE_EXCL,D=Z.constants.COPYFILE_FICLONE_FORCE,O=Xg,P=yg,q="win32"===sg.default.platform,j={PATH_STR:"path must be a string or Buffer",FD:"fd must be a file descriptor",MODE_INT:"mode must be an int",CB:"callback must be a function",UID:"uid must be an unsigned int",GID:"gid must be an unsigned int",LEN:"len must be an integer",ATIME:"atime must be an integer",MTIME:"mtime must be an integer",PREFIX:"filename prefix is required",BUFFER:"buffer must be an instance of Buffer or StaticBuffer",OFFSET:"offset must be an integer",LENGTH:"length must be an integer",POSITION:"position must be an integer"};!function(I){I[I.r=f]="r",I[I["r+"]=x]="r+",I[I.rs=f|U]="rs",I[I.sr=I.rs]="sr",I[I["rs+"]=x|U]="rs+",I[I["sr+"]=I["rs+"]]="sr+",I[I.w=v|N|k]="w",I[I.wx=v|N|k|L]="wx",I[I.xw=I.wx]="xw",I[I["w+"]=x|N|k]="w+",I[I["wx+"]=x|N|k|L]="wx+",I[I["xw+"]=I["wx+"]]="xw+",I[I.a=v|T|N]="a",I[I.ax=v|T|N|L]="ax",I[I.xa=I.ax]="xa",I[I["a+"]=x|T|N]="a+",I[I["ax+"]=x|T|N|L]="ax+",I[I["xa+"]=I["ax+"]]="xa+"}(J=g.FLAGS||(g.FLAGS={})),g.flagsToNumber=b;var Q=n(I={encoding:"utf8"}),_=d(Q),II=n({flag:"r"}),gI={encoding:"utf8",mode:438,flag:J[J.w]},CI=n(gI),AI={encoding:"utf8",mode:438,flag:J[J.a]},iI=n(AI),cI=d(iI),GI=n(I),lI=d(GI),bI={mode:511,recursive:!1},ZI={recursive:!1},tI=n({encoding:"utf8",withFileTypes:!1}),oI=d(tI),nI={bigint:!1};if(g.pathToFilename=m,q){var uI=C,dI=IA.unixify;C=function(I,g){return dI(uI(I,g))}}g.filenameToSteps=e,g.pathToSteps=B,g.dataToStr=function(I,g){return void 0===g&&(g=ug.ENCODING_UTF8),$.Buffer.isBuffer(I)?I.toString(g):I instanceof Uint8Array?$.bufferFrom(I).toString(g):String(I)},g.dataToBuffer=X,g.bufferToEncoding=y,g.toUnixTimestamp=s,I=function(){function I(I){void 0===I&&(I={}),this.ino=0,this.inodes={},this.releasedInos=[],this.fds={},this.releasedFds=[],this.maxFiles=1e4,this.openFiles=0,this.promisesApi=sC.default(this),this.statWatchers={},this.props=F({Node:Rg.Node,Link:Rg.Link,File:Rg.File},I),(I=this.createLink()).setNode(this.createNode(!0));var g=this;this.StatWatcher=function(I){function C(){return I.call(this,g)||this}return R(C,I),C}(eI),this.ReadStream=function(I){function C(){for(var C=[],A=0;A<arguments.length;A++)C[A]=arguments[A];return I.apply(this,H([g],C))||this}return R(C,I),C}(S),this.WriteStream=function(I){function C(){for(var C=[],A=0;A<arguments.length;A++)C[A]=arguments[A];return I.apply(this,H([g],C))||this}return R(C,I),C}(K),this.FSWatcher=function(I){function C(){return I.call(this,g)||this}return R(C,I),C}(BI),this.root=I}return I.fromJSON=function(g,C){var A=new I;return A.fromJSON(g,C),A},Object.defineProperty(I.prototype,"promises",{get:function(){if(null===this.promisesApi)throw Error("Promise is not supported in this environment.");return this.promisesApi},enumerable:!0,configurable:!0}),I.prototype.createLink=function(I,g,C,A){if(void 0===C&&(C=!1),!I)return new this.props.Link(this,null,"");if(!g)throw Error("createLink: name cannot be empty");return I.createChild(g,this.createNode(C,A))},I.prototype.deleteLink=function(I){var g=I.parent;return!!g&&(g.deleteChild(I),!0)},I.prototype.newInoNumber=function(){var I=this.releasedInos.pop();return I||(this.ino=(this.ino+1)%4294967295)},I.prototype.newFdNumber=function(){var g=this.releasedFds.pop();return"number"===typeof g?g:I.fd--},I.prototype.createNode=function(I,g){return void 0===I&&(I=!1),g=new this.props.Node(this.newInoNumber(),g),I&&g.setIsDirectory(),this.inodes[g.ino]=g},I.prototype.getNode=function(I){return this.inodes[I]},I.prototype.deleteNode=function(I){I.del(),delete this.inodes[I.ino],this.releasedInos.push(I.ino)},I.prototype.genRndStr=function(){var I=(Math.random()+1).toString(36).substr(2,6);return 6===I.length?I:this.genRndStr()},I.prototype.getLink=function(I){return this.root.walk(I)},I.prototype.getLinkOrThrow=function(I,g){var C=e(I);if(!(C=this.getLink(C)))throw l("ENOENT",g,I);return C},I.prototype.getResolvedLink=function(I){I="string"===typeof I?e(I):I;for(var g=this.root,C=0;C<I.length;){if(!(g=g.getChild(I[C])))return null;var A=g.getNode();A.isSymlink()?(I=A.symlink.concat(I.slice(C+1)),g=this.root,C=0):C++}return g},I.prototype.getResolvedLinkOrThrow=function(I,g){var C=this.getResolvedLink(I);if(!C)throw l("ENOENT",g,I);return C},I.prototype.resolveSymlinks=function(I){return this.getResolvedLink(I.steps.slice(1))},I.prototype.getLinkAsDirOrThrow=function(I,g){var C=this.getLinkOrThrow(I,g);if(!C.getNode().isDirectory())throw l("ENOTDIR",g,I);return C},I.prototype.getLinkParent=function(I){return this.root.walk(I,I.length-1)},I.prototype.getLinkParentAsDirOrThrow=function(I,g){I=I instanceof Array?I:e(I);var C=this.getLinkParent(I);if(!C)throw l("ENOENT",g,O+I.join(O));if(!C.getNode().isDirectory())throw l("ENOTDIR",g,O+I.join(O));return C},I.prototype.getFileByFd=function(I){return this.fds[String(I)]},I.prototype.getFileByFdOrThrow=function(I,g){if(I>>>0!==I)throw TypeError(j.FD);if(!(I=this.getFileByFd(I)))throw l("EBADF",g);return I},I.prototype.getNodeByIdOrCreate=function(I,g,C){if("number"===typeof I){if(!(I=this.getFileByFd(I)))throw Error("File nto found");return I.node}var A=B(I),i=this.getLink(A);if(i)return i.getNode();if(g&N&&(g=this.getLinkParent(A)))return(i=this.createLink(g,A[A.length-1],!1,C)).getNode();throw l("ENOENT","getNodeByIdOrCreate",m(I))},I.prototype.wrapAsync=function(I,g,C){var A=this;u(C),ag.default((function(){try{C(null,I.apply(A,g))}catch(i){C(i)}}))},I.prototype._toJSON=function(I,g,C){var A;void 0===I&&(I=this.root),void 0===g&&(g={});var i=!0,c=I.children;for(var G in I.getNode().isFile()&&((A={})[I.getName()]=I.parent.getChild(I.getName()),c=A,I=I.parent),c){if(i=!1,!(c=I.getChild(G)))throw Error("_toJSON: unexpected undefined");(A=c.getNode()).isFile()?(c=c.getPath(),C&&(c=P(C,c)),g[c]=A.getString()):A.isDirectory()&&this._toJSON(c,g,C)}return I=I.getPath(),C&&(I=P(C,I)),I&&i&&(g[I]=null),g},I.prototype.toJSON=function(I,g,C){void 0===g&&(g={}),void 0===C&&(C=!1);var A=[];if(I){I instanceof Array||(I=[I]);for(var i=0;i<I.length;i++){var c=m(I[i]);(c=this.getResolvedLink(c))&&A.push(c)}}else A.push(this.root);if(!A.length)return g;for(i=0;i<A.length;i++)c=A[i],this._toJSON(c,g,C?c.getPath():"");return g},I.prototype.fromJSON=function(I,g){for(var A in void 0===g&&(g=sg.default.cwd()),I){var i=I[A];if("string"===typeof i){var c=e(A=C(A,g));1<c.length&&(c=O+c.slice(0,c.length-1).join(O),this.mkdirpBase(c,511)),this.writeFileSync(A,i)}else this.mkdirpBase(A,511)}},I.prototype.reset=function(){this.ino=0,this.inodes={},this.releasedInos=[],this.fds={},this.releasedFds=[],this.openFiles=0,this.root=this.createLink(),this.root.setNode(this.createNode(!0))},I.prototype.mountSync=function(I,g){this.fromJSON(g,I)},I.prototype.openLink=function(I,g,C){if(void 0===C&&(C=!0),this.openFiles>=this.maxFiles)throw l("EMFILE","open",I.getPath());var A=I;if(C&&(A=this.resolveSymlinks(I)),!A)throw l("ENOENT","open",I.getPath());if((C=A.getNode()).isDirectory()){if((g&(f|x|v))!==f)throw l("EISDIR","open",I.getPath())}else if(g&z)throw l("ENOTDIR","open",I.getPath());if(!(g&v||C.canRead()))throw l("EACCES","open",I.getPath());return I=new this.props.File(I,C,g,this.newFdNumber()),this.fds[I.fd]=I,this.openFiles++,g&k&&I.truncate(),I},I.prototype.openFile=function(I,g,C,A){void 0===A&&(A=!0);var i=e(I),c=A?this.getResolvedLink(i):this.getLink(i);if(!c&&g&N){var G=this.getResolvedLink(i.slice(0,i.length-1));if(!G)throw l("ENOENT","open",O+i.join(O));g&N&&"number"===typeof C&&(c=this.createLink(G,i[i.length-1],!1,C))}if(c)return this.openLink(c,g,A);throw l("ENOENT","open",I)},I.prototype.openBase=function(I,g,C,A){if(void 0===A&&(A=!0),!(g=this.openFile(I,g,C,A)))throw l("ENOENT","open",I);return g.fd},I.prototype.openSync=function(I,g,C){return void 0===C&&(C=438),C=h(C),I=m(I),g=b(g),this.openBase(I,g,C)},I.prototype.open=function(I,g,C,A){var i=C;"function"===typeof C&&(i=438,A=C),C=h(i||438),I=m(I),g=b(g),this.wrapAsync(this.openBase,[I,g,C],A)},I.prototype.closeFile=function(I){this.fds[I.fd]&&(this.openFiles--,delete this.fds[I.fd],this.releasedFds.push(I.fd))},I.prototype.closeSync=function(I){a(I),I=this.getFileByFdOrThrow(I,"close"),this.closeFile(I)},I.prototype.close=function(I,g){a(I),this.wrapAsync(this.closeSync,[I],g)},I.prototype.openFileOrGetById=function(I,g,C){if("number"===typeof I){if(!(I=this.fds[I]))throw l("ENOENT");return I}return this.openFile(m(I),g,C)},I.prototype.readBase=function(I,g,C,A,i){return this.getFileByFdOrThrow(I).read(g,Number(C),Number(A),i)},I.prototype.readSync=function(I,g,C,A,i){return a(I),this.readBase(I,g,C,A,i)},I.prototype.read=function(I,g,C,A,i,c){var G=this;if(u(c),0===A)return sg.default.nextTick((function(){c&&c(null,0,g)}));ag.default((function(){try{var l=G.readBase(I,g,C,A,i);c(null,l,g)}catch(b){c(b)}}))},I.prototype.readFileBase=function(I,g,C){var A="number"===typeof I&&I>>>0===I;if(!A){var i=m(I);if(i=e(i),(i=this.getResolvedLink(i))&&i.getNode().isDirectory())throw l("EISDIR","open",i.getPath());I=this.openSync(I,g)}try{var c=y(this.getFileByFdOrThrow(I).getBuffer(),C)}finally{A||this.closeSync(I)}return c},I.prototype.readFileSync=function(I,g){var C=b((g=II(g)).flag);return this.readFileBase(I,C,g.encoding)},I.prototype.readFile=function(I,g,C){g=(C=d(II)(g,C))[0],C=C[1];var A=b(g.flag);this.wrapAsync(this.readFileBase,[I,A,g.encoding],C)},I.prototype.writeBase=function(I,g,C,A,i){return this.getFileByFdOrThrow(I,"write").write(g,C,A,i)},I.prototype.writeSync=function(I,g,C,A,i){a(I);var c="string"!==typeof g;if(c){var G=0|(C||0),l=A;C=i}else var b=A;return g=X(g,b),c?"undefined"===typeof l&&(l=g.length):(G=0,l=g.length),this.writeBase(I,g,G,l,C)},I.prototype.write=function(I,g,C,A,i,c){var G=this;a(I);var l=typeof g,b=typeof C,Z=typeof A,t=typeof i;if("string"!==l)if("function"===b)var o=C;else if("function"===Z){var n=0|C;o=A}else if("function"===t){n=0|C;var d=A;o=i}else{n=0|C,d=A;var m=i;o=c}else if("function"===b)o=C;else if("function"===Z)m=C,o=A;else if("function"===t){m=C;var e=A;o=i}var B=X(g,e);"string"!==l?"undefined"===typeof d&&(d=B.length):(n=0,d=B.length);var y=u(o);ag.default((function(){try{var C=G.writeBase(I,B,n,d,m);y(null,C,"string"!==l?B:g)}catch(A){y(A)}}))},I.prototype.writeFileBase=function(I,g,C,A){var i="number"===typeof I;I=i?I:this.openBase(m(I),C,A),A=0;var c=g.length;C=C&T?void 0:0;try{for(;0<c;){var G=this.writeSync(I,g,A,c,C);A+=G,c-=G,void 0!==C&&(C+=G)}}finally{i||this.closeSync(I)}},I.prototype.writeFileSync=function(I,g,C){var A=CI(C);C=b(A.flag);var i=h(A.mode);g=X(g,A.encoding),this.writeFileBase(I,g,C,i)},I.prototype.writeFile=function(I,g,C,A){var i=C;"function"===typeof C&&(i=gI,A=C),C=u(A);var c=CI(i);i=b(c.flag),A=h(c.mode),g=X(g,c.encoding),this.wrapAsync(this.writeFileBase,[I,g,i,A],C)},I.prototype.linkBase=function(I,g){var C=e(I),A=this.getLink(C);if(!A)throw l("ENOENT","link",I,g);var i=e(g);if(!(C=this.getLinkParent(i)))throw l("ENOENT","link",I,g);if(i=i[i.length-1],C.getChild(i))throw l("EEXIST","link",I,g);(I=A.getNode()).nlink++,C.createChild(i,I)},I.prototype.copyFileBase=function(I,g,C){var A=this.readFileSync(I);if(C&M&&this.existsSync(g))throw l("EEXIST","copyFile",I,g);if(C&D)throw l("ENOSYS","copyFile",I,g);this.writeFileBase(g,A,J.w,438)},I.prototype.copyFileSync=function(I,g,C){return I=m(I),g=m(g),this.copyFileBase(I,g,0|(C||0))},I.prototype.copyFile=function(I,g,C,A){if(I=m(I),g=m(g),"function"===typeof C)var i=0;else i=C,C=A;u(C),this.wrapAsync(this.copyFileBase,[I,g,i],C)},I.prototype.linkSync=function(I,g){I=m(I),g=m(g),this.linkBase(I,g)},I.prototype.link=function(I,g,C){I=m(I),g=m(g),this.wrapAsync(this.linkBase,[I,g],C)},I.prototype.unlinkBase=function(I){var g=e(I);if(!(g=this.getLink(g)))throw l("ENOENT","unlink",I);if(g.length)throw Error("Dir not empty...");this.deleteLink(g),(I=g.getNode()).nlink--,0>=I.nlink&&this.deleteNode(I)},I.prototype.unlinkSync=function(I){I=m(I),this.unlinkBase(I)},I.prototype.unlink=function(I,g){I=m(I),this.wrapAsync(this.unlinkBase,[I],g)},I.prototype.symlinkBase=function(I,g){var C=e(g),A=this.getLinkParent(C);if(!A)throw l("ENOENT","symlink",I,g);if(C=C[C.length-1],A.getChild(C))throw l("EEXIST","symlink",I,g);return(g=A.createChild(C)).getNode().makeSymlink(e(I)),g},I.prototype.symlinkSync=function(I,g){I=m(I),g=m(g),this.symlinkBase(I,g)},I.prototype.symlink=function(I,g,C,A){C=u("function"===typeof C?C:A),I=m(I),g=m(g),this.wrapAsync(this.symlinkBase,[I,g],C)},I.prototype.realpathBase=function(I,g){var C=e(I);if(!(C=this.getResolvedLink(C)))throw l("ENOENT","realpath",I);return ug.strToEncoding(C.getPath(),g)},I.prototype.realpathSync=function(I,g){return this.realpathBase(m(I),GI(g).encoding)},I.prototype.realpath=function(I,g,C){g=(C=lI(g,C))[0],C=C[1],I=m(I),this.wrapAsync(this.realpathBase,[I,g.encoding],C)},I.prototype.lstatBase=function(I,g){void 0===g&&(g=!1);var C=this.getLink(e(I));if(!C)throw l("ENOENT","lstat",I);return o.default.build(C.getNode(),g)},I.prototype.lstatSync=function(I,g){return this.lstatBase(m(I),i(g).bigint)},I.prototype.lstat=function(I,g,C){g=(C=A(g,C))[0],C=C[1],this.wrapAsync(this.lstatBase,[m(I),g.bigint],C)},I.prototype.statBase=function(I,g){void 0===g&&(g=!1);var C=this.getResolvedLink(e(I));if(!C)throw l("ENOENT","stat",I);return o.default.build(C.getNode(),g)},I.prototype.statSync=function(I,g){return this.statBase(m(I),i(g).bigint)},I.prototype.stat=function(I,g,C){g=(C=A(g,C))[0],C=C[1],this.wrapAsync(this.statBase,[m(I),g.bigint],C)},I.prototype.fstatBase=function(I,g){if(void 0===g&&(g=!1),!(I=this.getFileByFd(I)))throw l("EBADF","fstat");return o.default.build(I.node,g)},I.prototype.fstatSync=function(I,g){return this.fstatBase(I,i(g).bigint)},I.prototype.fstat=function(I,g,C){g=A(g,C),this.wrapAsync(this.fstatBase,[I,g[0].bigint],g[1])},I.prototype.renameBase=function(I,g){var C=this.getLink(e(I));if(!C)throw l("ENOENT","rename",I,g);var A=e(g),i=this.getLinkParent(A);if(!i)throw l("ENOENT","rename",I,g);(I=C.parent)&&I.deleteChild(C),C.steps=H(i.steps,[A[A.length-1]]),i.setChild(C.getName(),C)},I.prototype.renameSync=function(I,g){I=m(I),g=m(g),this.renameBase(I,g)},I.prototype.rename=function(I,g,C){I=m(I),g=m(g),this.wrapAsync(this.renameBase,[I,g],C)},I.prototype.existsBase=function(I){return!!this.statBase(I)},I.prototype.existsSync=function(I){try{return this.existsBase(m(I))}catch(g){return!1}},I.prototype.exists=function(I,g){var C=this,A=m(I);if("function"!==typeof g)throw Error(j.CB);ag.default((function(){try{g(C.existsBase(A))}catch(I){g(!1)}}))},I.prototype.accessBase=function(I){this.getLinkOrThrow(I,"access")},I.prototype.accessSync=function(I,g){void 0===g&&(g=E),I=m(I),this.accessBase(I,0|g)},I.prototype.access=function(I,g,C){var A=E;"function"!==typeof g&&(A=0|g,g=u(C)),I=m(I),this.wrapAsync(this.accessBase,[I,A],g)},I.prototype.appendFileSync=function(I,g,C){void 0===C&&(C=AI),(C=iI(C)).flag&&I>>>0!==I||(C.flag="a"),this.writeFileSync(I,g,C)},I.prototype.appendFile=function(I,g,C,A){C=(A=cI(C,A))[0],A=A[1],C.flag&&I>>>0!==I||(C.flag="a"),this.writeFile(I,g,C,A)},I.prototype.readdirBase=function(I,g){var C=e(I);if(!(C=this.getResolvedLink(C)))throw l("ENOENT","readdir",I);if(!C.getNode().isDirectory())throw l("ENOTDIR","scandir",I);if(g.withFileTypes){var A=[];for(i in C.children)(I=C.getChild(i))&&A.push(dg.default.build(I,g.encoding));return q||"buffer"===g.encoding||A.sort((function(I,g){return I.name<g.name?-1:I.name>g.name?1:0})),A}var i=[];for(A in C.children)i.push(ug.strToEncoding(A,g.encoding));return q||"buffer"===g.encoding||i.sort(),i},I.prototype.readdirSync=function(I,g){return g=tI(g),I=m(I),this.readdirBase(I,g)},I.prototype.readdir=function(I,g,C){g=(C=oI(g,C))[0],C=C[1],I=m(I),this.wrapAsync(this.readdirBase,[I,g],C)},I.prototype.readlinkBase=function(I,g){var C=this.getLinkOrThrow(I,"readlink").getNode();if(!C.isSymlink())throw l("EINVAL","readlink",I);return I=O+C.symlink.join(O),ug.strToEncoding(I,g)},I.prototype.readlinkSync=function(I,g){return g=Q(g),I=m(I),this.readlinkBase(I,g.encoding)},I.prototype.readlink=function(I,g,C){g=(C=_(g,C))[0],C=C[1],I=m(I),this.wrapAsync(this.readlinkBase,[I,g.encoding],C)},I.prototype.fsyncBase=function(I){this.getFileByFdOrThrow(I,"fsync")},I.prototype.fsyncSync=function(I){this.fsyncBase(I)},I.prototype.fsync=function(I,g){this.wrapAsync(this.fsyncBase,[I],g)},I.prototype.fdatasyncBase=function(I){this.getFileByFdOrThrow(I,"fdatasync")},I.prototype.fdatasyncSync=function(I){this.fdatasyncBase(I)},I.prototype.fdatasync=function(I,g){this.wrapAsync(this.fdatasyncBase,[I],g)},I.prototype.ftruncateBase=function(I,g){this.getFileByFdOrThrow(I,"ftruncate").truncate(g)},I.prototype.ftruncateSync=function(I,g){this.ftruncateBase(I,g)},I.prototype.ftruncate=function(I,g,C){var A="number"===typeof g?g:0;g=u("number"===typeof g?C:g),this.wrapAsync(this.ftruncateBase,[I,A],g)},I.prototype.truncateBase=function(I,g){I=this.openSync(I,"r+");try{this.ftruncateSync(I,g)}finally{this.closeSync(I)}},I.prototype.truncateSync=function(I,g){if(I>>>0===I)return this.ftruncateSync(I,g);this.truncateBase(I,g)},I.prototype.truncate=function(I,g,C){var A="number"===typeof g?g:0;if(g=u("number"===typeof g?C:g),I>>>0===I)return this.ftruncate(I,A,g);this.wrapAsync(this.truncateBase,[I,A],g)},I.prototype.futimesBase=function(I,g,C){(I=this.getFileByFdOrThrow(I,"futimes").node).atime=new Date(1e3*g),I.mtime=new Date(1e3*C)},I.prototype.futimesSync=function(I,g,C){this.futimesBase(I,s(g),s(C))},I.prototype.futimes=function(I,g,C,A){this.wrapAsync(this.futimesBase,[I,s(g),s(C)],A)},I.prototype.utimesBase=function(I,g,C){I=this.openSync(I,"r+");try{this.futimesBase(I,g,C)}finally{this.closeSync(I)}},I.prototype.utimesSync=function(I,g,C){this.utimesBase(m(I),s(g),s(C))},I.prototype.utimes=function(I,g,C,A){this.wrapAsync(this.utimesBase,[m(I),s(g),s(C)],A)},I.prototype.mkdirBase=function(I,g){var C=e(I);if(!C.length)throw l("EISDIR","mkdir",I);var A=this.getLinkParentAsDirOrThrow(I,"mkdir");if(C=C[C.length-1],A.getChild(C))throw l("EEXIST","mkdir",I);A.createChild(C,this.createNode(!0,g))},I.prototype.mkdirpBase=function(I,g){I=e(I);for(var C=this.root,A=0;A<I.length;A++){var i=I[A];if(!C.getNode().isDirectory())throw l("ENOTDIR","mkdir",C.getPath());var c=C.getChild(i);if(c){if(!c.getNode().isDirectory())throw l("ENOTDIR","mkdir",c.getPath());C=c}else C=C.createChild(i,this.createNode(!0,g))}},I.prototype.mkdirSync=function(I,g){var C=h((g=c(g)).mode,511);I=m(I),g.recursive?this.mkdirpBase(I,C):this.mkdirBase(I,C)},I.prototype.mkdir=function(I,g,C){var A=c(g);g=u("function"===typeof g?g:C),C=h(A.mode,511),I=m(I),A.recursive?this.wrapAsync(this.mkdirpBase,[I,C],g):this.wrapAsync(this.mkdirBase,[I,C],g)},I.prototype.mkdirpSync=function(I,g){this.mkdirSync(I,{mode:g,recursive:!0})},I.prototype.mkdirp=function(I,g,C){var A="function"===typeof g?void 0:g;g=u("function"===typeof g?g:C),this.mkdir(I,{mode:A,recursive:!0},g)},I.prototype.mkdtempBase=function(I,g,C){void 0===C&&(C=5);var A=I+this.genRndStr();try{return this.mkdirBase(A,511),ug.strToEncoding(A,g)}catch(i){if("EEXIST"===i.code){if(1<C)return this.mkdtempBase(I,g,C-1);throw Error("Could not create temp dir.")}throw i}},I.prototype.mkdtempSync=function(I,g){if(g=Q(g).encoding,!I||"string"!==typeof I)throw new TypeError("filename prefix is required");return V(I),this.mkdtempBase(I,g)},I.prototype.mkdtemp=function(I,g,C){if(g=(C=_(g,C))[0].encoding,C=C[1],!I||"string"!==typeof I)throw new TypeError("filename prefix is required");V(I)&&this.wrapAsync(this.mkdtempBase,[I,g],C)},I.prototype.rmdirBase=function(I,g){g=F({},ZI,g);var C=this.getLinkAsDirOrThrow(I,"rmdir");if(C.length&&!g.recursive)throw l("ENOTEMPTY","rmdir",I);this.deleteLink(C)},I.prototype.rmdirSync=function(I,g){this.rmdirBase(m(I),g)},I.prototype.rmdir=function(I,g,C){var A=F({},ZI,g);g=u("function"===typeof g?g:C),this.wrapAsync(this.rmdirBase,[m(I),A],g)},I.prototype.fchmodBase=function(I,g){this.getFileByFdOrThrow(I,"fchmod").chmod(g)},I.prototype.fchmodSync=function(I,g){this.fchmodBase(I,h(g))},I.prototype.fchmod=function(I,g,C){this.wrapAsync(this.fchmodBase,[I,h(g)],C)},I.prototype.chmodBase=function(I,g){I=this.openSync(I,"r+");try{this.fchmodBase(I,g)}finally{this.closeSync(I)}},I.prototype.chmodSync=function(I,g){g=h(g),I=m(I),this.chmodBase(I,g)},I.prototype.chmod=function(I,g,C){g=h(g),I=m(I),this.wrapAsync(this.chmodBase,[I,g],C)},I.prototype.lchmodBase=function(I,g){I=this.openBase(I,x,0,!1);try{this.fchmodBase(I,g)}finally{this.closeSync(I)}},I.prototype.lchmodSync=function(I,g){g=h(g),I=m(I),this.lchmodBase(I,g)},I.prototype.lchmod=function(I,g,C){g=h(g),I=m(I),this.wrapAsync(this.lchmodBase,[I,g],C)},I.prototype.fchownBase=function(I,g,C){this.getFileByFdOrThrow(I,"fchown").chown(g,C)},I.prototype.fchownSync=function(I,g,C){r(g),Y(C),this.fchownBase(I,g,C)},I.prototype.fchown=function(I,g,C,A){r(g),Y(C),this.wrapAsync(this.fchownBase,[I,g,C],A)},I.prototype.chownBase=function(I,g,C){this.getResolvedLinkOrThrow(I,"chown").getNode().chown(g,C)},I.prototype.chownSync=function(I,g,C){r(g),Y(C),this.chownBase(m(I),g,C)},I.prototype.chown=function(I,g,C,A){r(g),Y(C),this.wrapAsync(this.chownBase,[m(I),g,C],A)},I.prototype.lchownBase=function(I,g,C){this.getLinkOrThrow(I,"lchown").getNode().chown(g,C)},I.prototype.lchownSync=function(I,g,C){r(g),Y(C),this.lchownBase(m(I),g,C)},I.prototype.lchown=function(I,g,C,A){r(g),Y(C),this.wrapAsync(this.lchownBase,[m(I),g,C],A)},I.prototype.watchFile=function(I,g,C){I=m(I);var A=g;if("function"===typeof A&&(C=g,A=null),"function"!==typeof C)throw Error('"watchFile()" requires a listener function');g=5007;var i=!0;return A&&"object"===typeof A&&("number"===typeof A.interval&&(g=A.interval),"boolean"===typeof A.persistent&&(i=A.persistent)),(A=this.statWatchers[I])||((A=new this.StatWatcher).start(I,i,g),this.statWatchers[I]=A),A.addListener("change",C),A},I.prototype.unwatchFile=function(I,g){I=m(I);var C=this.statWatchers[I];C&&("function"===typeof g?C.removeListener("change",g):C.removeAllListeners("change"),0===C.listenerCount("change")&&(C.stop(),delete this.statWatchers[I]))},I.prototype.createReadStream=function(I,g){return new this.ReadStream(I,g)},I.prototype.createWriteStream=function(I,g){return new this.WriteStream(I,g)},I.prototype.watch=function(I,g,C){I=m(I);var A=g;"function"===typeof g&&(C=g,A=null);var i=Q(A);g=i.persistent,A=i.recursive,i=i.encoding,void 0===g&&(g=!0),void 0===A&&(A=!1);var c=new this.FSWatcher;return c.start(I,g,A,i),C&&c.addListener("change",C),c},I.fd=2147483647,I}(),g.Volume=I;var mI,eI=function(I){function g(g){var C=I.call(this)||this;return C.onInterval=function(){try{var I=C.vol.statSync(C.filename);C.hasChanged(I)&&(C.emit("change",I,C.prev),C.prev=I)}finally{C.loop()}},C.vol=g,C}return R(g,I),g.prototype.loop=function(){this.timeoutRef=this.setTimeout(this.onInterval,this.interval)},g.prototype.hasChanged=function(I){return I.mtimeMs>this.prev.mtimeMs||I.nlink!==this.prev.nlink},g.prototype.start=function(I,g,C){void 0===g&&(g=!0),void 0===C&&(C=5007),this.filename=m(I),this.setTimeout=g?setTimeout:Jg.default,this.interval=C,this.prev=this.vol.statSync(this.filename),this.loop()},g.prototype.stop=function(){clearTimeout(this.timeoutRef),sg.default.nextTick(W,this)},g}(Yg.EventEmitter);g.StatWatcher=eI,DI.inherits(S,VC.Readable),g.ReadStream=S,S.prototype.open=function(){var I=this;this._vol.open(this.path,this.flags,this.mode,(function(g,C){g?(I.autoClose&&I.destroy&&I.destroy(),I.emit("error",g)):(I.fd=C,I.emit("open",C),I.read())}))},S.prototype._read=function(I){if("number"!==typeof this.fd)return this.once("open",(function(){this._read(I)}));if(!this.destroyed){(!mI||128>mI.length-mI.used)&&((mI=$.bufferAllocUnsafe(this._readableState.highWaterMark)).used=0);var g=mI,C=Math.min(mI.length-mI.used,I),A=mI.used;if(void 0!==this.pos&&(C=Math.min(this.end-this.pos+1,C)),0>=C)return this.push(null);var i=this;this._vol.read(this.fd,mI,mI.used,C,this.pos,(function(I,C){I?(i.autoClose&&i.destroy&&i.destroy(),i.emit("error",I)):(I=null,0<C&&(i.bytesRead+=C,I=g.slice(A,A+C)),i.push(I))})),void 0!==this.pos&&(this.pos+=C),mI.used+=C}},S.prototype._destroy=function(I,g){this.close((function(C){g(I||C)}))},S.prototype.close=function(I){var g=this;if(I&&this.once("close",I),this.closed||"number"!==typeof this.fd)return"number"!==typeof this.fd?void this.once("open",p):sg.default.nextTick((function(){return g.emit("close")}));this.closed=!0,this._vol.close(this.fd,(function(I){I?g.emit("error",I):g.emit("close")})),this.fd=null},DI.inherits(K,VC.Writable),g.WriteStream=K,K.prototype.open=function(){this._vol.open(this.path,this.flags,this.mode,function(I,g){I?(this.autoClose&&this.destroy&&this.destroy(),this.emit("error",I)):(this.fd=g,this.emit("open",g))}.bind(this))},K.prototype._write=function(I,g,C){if(!(I instanceof $.Buffer))return this.emit("error",Error("Invalid data"));if("number"!==typeof this.fd)return this.once("open",(function(){this._write(I,g,C)}));var A=this;this._vol.write(this.fd,I,0,I.length,this.pos,(function(I,g){if(I)return A.autoClose&&A.destroy&&A.destroy(),C(I);A.bytesWritten+=g,C()})),void 0!==this.pos&&(this.pos+=I.length)},K.prototype._writev=function(I,g){if("number"!==typeof this.fd)return this.once("open",(function(){this._writev(I,g)}));for(var C=this,A=I.length,i=Array(A),c=0,G=0;G<A;G++){var l=I[G].chunk;i[G]=l,c+=l.length}A=$.Buffer.concat(i),this._vol.write(this.fd,A,0,A.length,this.pos,(function(I,A){if(I)return C.destroy&&C.destroy(),g(I);C.bytesWritten+=A,g()})),void 0!==this.pos&&(this.pos+=c)},K.prototype._destroy=S.prototype._destroy,K.prototype.close=S.prototype.close,K.prototype.destroySoon=K.prototype.end;var BI=function(I){function g(g){var C=I.call(this)||this;return C._filename="",C._filenameEncoded="",C._recursive=!1,C._encoding=ug.ENCODING_UTF8,C._onNodeChange=function(){C._emit("change")},C._onParentChild=function(I){I.getName()===C._getName()&&C._emit("rename")},C._emit=function(I){C.emit("change",I,C._filenameEncoded)},C._persist=function(){C._timer=setTimeout(C._persist,1e6)},C._vol=g,C}return R(g,I),g.prototype._getName=function(){return this._steps[this._steps.length-1]},g.prototype.start=function(I,g,C,A){void 0===g&&(g=!0),void 0===C&&(C=!1),void 0===A&&(A=ug.ENCODING_UTF8),this._filename=m(I),this._steps=e(this._filename),this._filenameEncoded=ug.strToEncoding(this._filename),this._recursive=C,this._encoding=A;try{this._link=this._vol.getLinkOrThrow(this._filename,"FSWatcher")}catch(i){throw(g=Error("watch "+this._filename+" "+i.code)).code=i.code,g.errno=i.code,g}this._link.getNode().on("change",this._onNodeChange),this._link.on("child:add",this._onNodeChange),this._link.on("child:delete",this._onNodeChange),(I=this._link.parent)&&(I.setMaxListeners(I.getMaxListeners()+1),I.on("child:delete",this._onParentChild)),g&&this._persist()},g.prototype.close=function(){clearTimeout(this._timer),this._link.getNode().removeListener("change",this._onNodeChange);var I=this._link.parent;I&&I.removeListener("child:delete",this._onParentChild)},g}(Yg.EventEmitter);g.FSWatcher=BI}));l(gA);var CA=gA.pathToFilename,AA=gA.filenameToSteps,iA=gA.Volume,cA=b((function(I,g){Object.defineProperty(g,"__esModule",{value:!0}),g.fsProps="constants F_OK R_OK W_OK X_OK Stats".split(" "),g.fsSyncMethods="renameSync ftruncateSync truncateSync chownSync fchownSync lchownSync chmodSync fchmodSync lchmodSync statSync lstatSync fstatSync linkSync symlinkSync readlinkSync realpathSync unlinkSync rmdirSync mkdirSync mkdirpSync readdirSync closeSync openSync utimesSync futimesSync fsyncSync writeSync readSync readFileSync writeFileSync appendFileSync existsSync accessSync fdatasyncSync mkdtempSync copyFileSync createReadStream createWriteStream".split(" "),g.fsAsyncMethods="rename ftruncate truncate chown fchown lchown chmod fchmod lchmod stat lstat fstat link symlink readlink realpath unlink rmdir mkdir mkdirp readdir close open utimes futimes fsync write read readFile writeFile appendFile exists access fdatasync mkdtemp copyFile watchFile unwatchFile watch".split(" ")}));l(cA);var GA=b((function(I,g){function C(I){for(var g={F_OK:l,R_OK:b,W_OK:t,X_OK:n,constants:Z.constants,Stats:o.default,Dirent:dg.default},C=0,A=i;C<A.length;C++){var G=A[C];"function"===typeof I[G]&&(g[G]=I[G].bind(I))}for(C=0,A=c;C<A.length;C++)"function"===typeof I[G=A[C]]&&(g[G]=I[G].bind(I));return g.StatWatcher=I.StatWatcher,g.FSWatcher=I.FSWatcher,g.WriteStream=I.WriteStream,g.ReadStream=I.ReadStream,g.promises=I.promises,g._toUnixTimestamp=gA.toUnixTimestamp,g}var A=G&&G.__assign||function(){return A=Object.assign||function(I){for(var g,C=1,A=arguments.length;C<A;C++)for(var i in g=arguments[C])Object.prototype.hasOwnProperty.call(g,i)&&(I[i]=g[i]);return I},A.apply(this,arguments)};Object.defineProperty(g,"__esModule",{value:!0});var i=cA.fsSyncMethods,c=cA.fsAsyncMethods,l=Z.constants.F_OK,b=Z.constants.R_OK,t=Z.constants.W_OK,n=Z.constants.X_OK;g.Volume=gA.Volume,g.vol=new gA.Volume,g.createFsFromVolume=C,g.fs=C(g.vol),I.exports=A(A({},I.exports),g.fs),I.exports.semantic=!0}));l(GA);var lA=GA.createFsFromVolume;Hg.prototype.emit=function(I){for(var g,C,i=[],G=1;G<arguments.length;G++)i[G-1]=arguments[G];G=this.listeners(I);try{for(var l=A(G),b=l.next();!b.done;b=l.next()){var Z=b.value;try{Z.apply(void 0,c(i))}catch(t){console.error(t)}}}catch(t){g={error:t}}finally{try{b&&!b.done&&(C=l.return)&&C.call(l)}finally{if(g)throw g.error}}return 0<G.length};var bA=function(){function I(){this.volume=new iA,this.fs=lA(this.volume),this.fromJSON({"/dev/stdin":"","/dev/stdout":"","/dev/stderr":""})}return I.prototype._toJSON=function(I,g,C){void 0===g&&(g={});var A,i=!0;for(A in I.children){i=!1;var c=I.getChild(A);if(c){var G=c.getNode();G&&G.isFile()?(c=c.getPath(),C&&(c=Bg(C,c)),g[c]=G.getBuffer()):G&&G.isDirectory()&&this._toJSON(c,g,C)}}return I=I.getPath(),C&&(I=Bg(C,I)),I&&i&&(g[I]=null),g},I.prototype.toJSON=function(I,g,C){var i,c;void 0===g&&(g={}),void 0===C&&(C=!1);var G=[];if(I){I instanceof Array||(I=[I]);try{for(var l=A(I),b=l.next();!b.done;b=l.next()){var Z=CA(b.value),t=this.volume.getResolvedLink(Z);t&&G.push(t)}}catch(m){var o={error:m}}finally{try{b&&!b.done&&(i=l.return)&&i.call(l)}finally{if(o)throw o.error}}}else G.push(this.volume.root);if(!G.length)return g;try{for(var n=A(G),u=n.next();!u.done;u=n.next())t=u.value,this._toJSON(t,g,C?t.getPath():"")}catch(m){var d={error:m}}finally{try{u&&!u.done&&(c=n.return)&&c.call(n)}finally{if(d)throw d.error}}return g},I.prototype.fromJSONFixed=function(I,g){for(var C in g){var A=g[C];if(A?null!==Object.getPrototypeOf(A):null!==A){var i=AA(C);1<i.length&&(i="/"+i.slice(0,i.length-1).join("/"),I.mkdirpBase(i,511)),I.writeFileSync(C,A||"")}else I.mkdirpBase(C,511)}},I.prototype.fromJSON=function(I){this.volume=new iA,this.fromJSONFixed(this.volume,I),this.fs=lA(this.volume),this.volume.releasedFds=[0,1,2],I=this.volume.openSync("/dev/stderr","w");var g=this.volume.openSync("/dev/stdout","w"),C=this.volume.openSync("/dev/stdin","r");if(2!==I)throw Error("invalid handle for stderr: "+I);if(1!==g)throw Error("invalid handle for stdout: "+g);if(0!==C)throw Error("invalid handle for stdin: "+C)},I.prototype.getStdOut=function(){return function(I,g,C,A){return new(C||(C=Promise))((function(i,c){function G(I){try{b(A.next(I))}catch(g){c(g)}}function l(I){try{b(A.throw(I))}catch(g){c(g)}}function b(I){I.done?i(I.value):new C((function(g){g(I.value)})).then(G,l)}b((A=A.apply(I,g||[])).next())}))}(this,void 0,void 0,(function(){var I=this;return function(I,g){function C(I){return function(g){return A([I,g])}}function A(C){if(i)throw new TypeError("Generator is already executing.");for(;b;)try{if(i=1,c&&(G=2&C[0]?c.return:C[0]?c.throw||((G=c.return)&&G.call(c),0):c.next)&&!(G=G.call(c,C[1])).done)return G;switch(c=0,G&&(C=[2&C[0],G.value]),C[0]){case 0:case 1:G=C;break;case 4:return b.label++,{value:C[1],done:!1};case 5:b.label++,c=C[1],C=[0];continue;case 7:C=b.ops.pop(),b.trys.pop();continue;default:if(!(G=0<(G=b.trys).length&&G[G.length-1])&&(6===C[0]||2===C[0])){b=0;continue}if(3===C[0]&&(!G||C[1]>G[0]&&C[1]<G[3]))b.label=C[1];else if(6===C[0]&&b.label<G[1])b.label=G[1],G=C;else{if(!(G&&b.label<G[2])){G[2]&&b.ops.pop(),b.trys.pop();continue}b.label=G[2],b.ops.push(C)}}C=g.call(I,b)}catch(A){C=[6,A],c=0}finally{i=G=0}if(5&C[0])throw C[1];return{value:C[0]?C[1]:void 0,done:!0}}var i,c,G,l,b={label:0,sent:function(){if(1&G[0])throw G[1];return G[1]},trys:[],ops:[]};return l={next:C(0),throw:C(1),return:C(2)},"function"===typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l}(this,(function(){return[2,new Promise((function(g){g(I.fs.readFileSync("/dev/stdout","utf8"))}))]}))}))},I}();g.default=bA},650:function(I,g){"use strict";g.byteLength=function(I){var g=b(I),C=g[0],A=g[1];return 3*(C+A)/4-A},g.toByteArray=function(I){var g,C,c=b(I),G=c[0],l=c[1],Z=new i(function(I,g,C){return 3*(g+C)/4-C}(0,G,l)),t=0,o=l>0?G-4:G;for(C=0;C<o;C+=4)g=A[I.charCodeAt(C)]<<18|A[I.charCodeAt(C+1)]<<12|A[I.charCodeAt(C+2)]<<6|A[I.charCodeAt(C+3)],Z[t++]=g>>16&255,Z[t++]=g>>8&255,Z[t++]=255&g;2===l&&(g=A[I.charCodeAt(C)]<<2|A[I.charCodeAt(C+1)]>>4,Z[t++]=255&g);1===l&&(g=A[I.charCodeAt(C)]<<10|A[I.charCodeAt(C+1)]<<4|A[I.charCodeAt(C+2)]>>2,Z[t++]=g>>8&255,Z[t++]=255&g);return Z},g.fromByteArray=function(I){for(var g,A=I.length,i=A%3,c=[],G=16383,l=0,b=A-i;l<b;l+=G)c.push(Z(I,l,l+G>b?b:l+G));1===i?(g=I[A-1],c.push(C[g>>2]+C[g<<4&63]+"==")):2===i&&(g=(I[A-2]<<8)+I[A-1],c.push(C[g>>10]+C[g>>4&63]+C[g<<2&63]+"="));return c.join("")};for(var C=[],A=[],i="undefined"!==typeof Uint8Array?Uint8Array:Array,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",G=0,l=c.length;G<l;++G)C[G]=c[G],A[c.charCodeAt(G)]=G;function b(I){var g=I.length;if(g%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var C=I.indexOf("=");return-1===C&&(C=g),[C,C===g?0:4-C%4]}function Z(I,g,A){for(var i,c,G=[],l=g;l<A;l+=3)i=(I[l]<<16&16711680)+(I[l+1]<<8&65280)+(255&I[l+2]),G.push(C[(c=i)>>18&63]+C[c>>12&63]+C[c>>6&63]+C[63&c]);return G.join("")}A["-".charCodeAt(0)]=62,A["_".charCodeAt(0)]=63},2016:function(I,g,C){"use strict";var A=C(4837).default,i=C(7868).default,c=C(36).default,G=C(9823).default,l=C(6982).default,b=C(650),Z=C(3866),t="function"===typeof Symbol&&"function"===typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;g.Buffer=u,g.SlowBuffer=function(I){+I!=I&&(I=0);return u.alloc(+I)},g.INSPECT_MAX_BYTES=50;var o=2147483647;function n(I){if(I>o)throw new RangeError('The value "'+I+'" is invalid for option "size"');var g=new Uint8Array(I);return Object.setPrototypeOf(g,u.prototype),g}function u(I,g,C){if("number"===typeof I){if("string"===typeof g)throw new TypeError('The "string" argument must be of type string. Received type number');return e(I)}return d(I,g,C)}function d(I,g,C){if("string"===typeof I)return function(I,g){"string"===typeof g&&""!==g||(g="utf8");if(!u.isEncoding(g))throw new TypeError("Unknown encoding: "+g);var C=0|V(I,g),A=n(C),i=A.write(I,g);i!==C&&(A=A.slice(0,i));return A}(I,g);if(ArrayBuffer.isView(I))return function(I){if(II(I,Uint8Array)){var g=new Uint8Array(I);return X(g.buffer,g.byteOffset,g.byteLength)}return B(I)}(I);if(null==I)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof I);if(II(I,ArrayBuffer)||I&&II(I.buffer,ArrayBuffer))return X(I,g,C);if("undefined"!==typeof SharedArrayBuffer&&(II(I,SharedArrayBuffer)||I&&II(I.buffer,SharedArrayBuffer)))return X(I,g,C);if("number"===typeof I)throw new TypeError('The "value" argument must not be of type number. Received type number');var A=I.valueOf&&I.valueOf();if(null!=A&&A!==I)return u.from(A,g,C);var i=function(I){if(u.isBuffer(I)){var g=0|y(I.length),C=n(g);return 0===C.length||I.copy(C,0,0,g),C}if(void 0!==I.length)return"number"!==typeof I.length||gI(I.length)?n(0):B(I);if("Buffer"===I.type&&Array.isArray(I.data))return B(I.data)}(I);if(i)return i;if("undefined"!==typeof Symbol&&null!=Symbol.toPrimitive&&"function"===typeof I[Symbol.toPrimitive])return u.from(I[Symbol.toPrimitive]("string"),g,C);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof I)}function m(I){if("number"!==typeof I)throw new TypeError('"size" argument must be of type number');if(I<0)throw new RangeError('The value "'+I+'" is invalid for option "size"')}function e(I){return m(I),n(I<0?0:0|y(I))}function B(I){for(var g=I.length<0?0:0|y(I.length),C=n(g),A=0;A<g;A+=1)C[A]=255&I[A];return C}function X(I,g,C){if(g<0||I.byteLength<g)throw new RangeError('"offset" is outside of buffer bounds');if(I.byteLength<g+(C||0))throw new RangeError('"length" is outside of buffer bounds');var A;return A=void 0===g&&void 0===C?new Uint8Array(I):void 0===C?new Uint8Array(I,g):new Uint8Array(I,g,C),Object.setPrototypeOf(A,u.prototype),A}function y(I){if(I>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|I}function V(I,g){if(u.isBuffer(I))return I.length;if(ArrayBuffer.isView(I)||II(I,ArrayBuffer))return I.byteLength;if("string"!==typeof I)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof I);var C=I.length,A=arguments.length>2&&!0===arguments[2];if(!A&&0===C)return 0;for(var i=!1;;)switch(g){case"ascii":case"latin1":case"binary":return C;case"utf8":case"utf-8":return Q(I).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*C;case"hex":return C>>>1;case"base64":return _(I).length;default:if(i)return A?-1:Q(I).length;g=(""+g).toLowerCase(),i=!0}}function h(I,g,C){var A=!1;if((void 0===g||g<0)&&(g=0),g>this.length)return"";if((void 0===C||C>this.length)&&(C=this.length),C<=0)return"";if((C>>>=0)<=(g>>>=0))return"";for(I||(I="utf8");;)switch(I){case"hex":return f(this,g,C);case"utf8":case"utf-8":return H(this,g,C);case"ascii":return F(this,g,C);case"latin1":case"binary":return w(this,g,C);case"base64":return R(this,g,C);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return v(this,g,C);default:if(A)throw new TypeError("Unknown encoding: "+I);I=(I+"").toLowerCase(),A=!0}}function a(I,g,C){var A=I[g];I[g]=I[C],I[C]=A}function s(I,g,C,A,i){if(0===I.length)return-1;if("string"===typeof C?(A=C,C=0):C>2147483647?C=2147483647:C<-2147483648&&(C=-2147483648),gI(C=+C)&&(C=i?0:I.length-1),C<0&&(C=I.length+C),C>=I.length){if(i)return-1;C=I.length-1}else if(C<0){if(!i)return-1;C=0}if("string"===typeof g&&(g=u.from(g,A)),u.isBuffer(g))return 0===g.length?-1:r(I,g,C,A,i);if("number"===typeof g)return g&=255,"function"===typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(I,g,C):Uint8Array.prototype.lastIndexOf.call(I,g,C):r(I,[g],C,A,i);throw new TypeError("val must be string, number or Buffer")}function r(I,g,C,A,i){var c,G=1,l=I.length,b=g.length;if(void 0!==A&&("ucs2"===(A=String(A).toLowerCase())||"ucs-2"===A||"utf16le"===A||"utf-16le"===A)){if(I.length<2||g.length<2)return-1;G=2,l/=2,b/=2,C/=2}function Z(I,g){return 1===G?I[g]:I.readUInt16BE(g*G)}if(i){var t=-1;for(c=C;c<l;c++)if(Z(I,c)===Z(g,-1===t?0:c-t)){if(-1===t&&(t=c),c-t+1===b)return t*G}else-1!==t&&(c-=c-t),t=-1}else for(C+b>l&&(C=l-b),c=C;c>=0;c--){for(var o=!0,n=0;n<b;n++)if(Z(I,c+n)!==Z(g,n)){o=!1;break}if(o)return c}return-1}function Y(I,g,C,A){C=Number(C)||0;var i=I.length-C;A?(A=Number(A))>i&&(A=i):A=i;var c,G=g.length;for(A>G/2&&(A=G/2),c=0;c<A;++c){var l=parseInt(g.substr(2*c,2),16);if(gI(l))return c;I[C+c]=l}return c}function W(I,g,C,A){return $(Q(g,I.length-C),I,C,A)}function S(I,g,C,A){return $(function(I){for(var g=[],C=0;C<I.length;++C)g.push(255&I.charCodeAt(C));return g}(g),I,C,A)}function p(I,g,C,A){return $(_(g),I,C,A)}function K(I,g,C,A){return $(function(I,g){for(var C,A,i,c=[],G=0;G<I.length&&!((g-=2)<0);++G)A=(C=I.charCodeAt(G))>>8,i=C%256,c.push(i),c.push(A);return c}(g,I.length-C),I,C,A)}function R(I,g,C){return 0===g&&C===I.length?b.fromByteArray(I):b.fromByteArray(I.slice(g,C))}function H(I,g,C){C=Math.min(I.length,C);for(var A=[],i=g;i<C;){var c=I[i],G=null,l=c>239?4:c>223?3:c>191?2:1;if(i+l<=C){var b=void 0,Z=void 0,t=void 0,o=void 0;switch(l){case 1:c<128&&(G=c);break;case 2:128===(192&(b=I[i+1]))&&(o=(31&c)<<6|63&b)>127&&(G=o);break;case 3:b=I[i+1],Z=I[i+2],128===(192&b)&&128===(192&Z)&&(o=(15&c)<<12|(63&b)<<6|63&Z)>2047&&(o<55296||o>57343)&&(G=o);break;case 4:b=I[i+1],Z=I[i+2],t=I[i+3],128===(192&b)&&128===(192&Z)&&128===(192&t)&&(o=(15&c)<<18|(63&b)<<12|(63&Z)<<6|63&t)>65535&&o<1114112&&(G=o)}}null===G?(G=65533,l=1):G>65535&&(G-=65536,A.push(G>>>10&1023|55296),G=56320|1023&G),A.push(G),i+=l}return function(I){var g=I.length;if(g<=J)return String.fromCharCode.apply(String,I);var C="",A=0;for(;A<g;)C+=String.fromCharCode.apply(String,I.slice(A,A+=J));return C}(A)}g.kMaxLength=o,u.TYPED_ARRAY_SUPPORT=function(){try{var I=new Uint8Array(1),g={foo:function(){return 42}};return Object.setPrototypeOf(g,Uint8Array.prototype),Object.setPrototypeOf(I,g),42===I.foo()}catch(C){return!1}}(),u.TYPED_ARRAY_SUPPORT||"undefined"===typeof console||"function"!==typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}}),u.poolSize=8192,u.from=function(I,g,C){return d(I,g,C)},Object.setPrototypeOf(u.prototype,Uint8Array.prototype),Object.setPrototypeOf(u,Uint8Array),u.alloc=function(I,g,C){return function(I,g,C){return m(I),I<=0?n(I):void 0!==g?"string"===typeof C?n(I).fill(g,C):n(I).fill(g):n(I)}(I,g,C)},u.allocUnsafe=function(I){return e(I)},u.allocUnsafeSlow=function(I){return e(I)},u.isBuffer=function(I){return null!=I&&!0===I._isBuffer&&I!==u.prototype},u.compare=function(I,g){if(II(I,Uint8Array)&&(I=u.from(I,I.offset,I.byteLength)),II(g,Uint8Array)&&(g=u.from(g,g.offset,g.byteLength)),!u.isBuffer(I)||!u.isBuffer(g))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(I===g)return 0;for(var C=I.length,A=g.length,i=0,c=Math.min(C,A);i<c;++i)if(I[i]!==g[i]){C=I[i],A=g[i];break}return C<A?-1:A<C?1:0},u.isEncoding=function(I){switch(String(I).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(I,g){if(!Array.isArray(I))throw new TypeError('"list" argument must be an Array of Buffers');if(0===I.length)return u.alloc(0);var C;if(void 0===g)for(g=0,C=0;C<I.length;++C)g+=I[C].length;var A=u.allocUnsafe(g),i=0;for(C=0;C<I.length;++C){var c=I[C];if(II(c,Uint8Array))i+c.length>A.length?(u.isBuffer(c)||(c=u.from(c)),c.copy(A,i)):Uint8Array.prototype.set.call(A,c,i);else{if(!u.isBuffer(c))throw new TypeError('"list" argument must be an Array of Buffers');c.copy(A,i)}i+=c.length}return A},u.byteLength=V,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var I=this.length;if(I%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var g=0;g<I;g+=2)a(this,g,g+1);return this},u.prototype.swap32=function(){var I=this.length;if(I%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var g=0;g<I;g+=4)a(this,g,g+3),a(this,g+1,g+2);return this},u.prototype.swap64=function(){var I=this.length;if(I%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var g=0;g<I;g+=8)a(this,g,g+7),a(this,g+1,g+6),a(this,g+2,g+5),a(this,g+3,g+4);return this},u.prototype.toString=function(){var I=this.length;return 0===I?"":0===arguments.length?H(this,0,I):h.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(I){if(!u.isBuffer(I))throw new TypeError("Argument must be a Buffer");return this===I||0===u.compare(this,I)},u.prototype.inspect=function(){var I="",C=g.INSPECT_MAX_BYTES;return I=this.toString("hex",0,C).replace(/(.{2})/g,"$1 ").trim(),this.length>C&&(I+=" ... "),"<Buffer "+I+">"},t&&(u.prototype[t]=u.prototype.inspect),u.prototype.compare=function(I,g,C,A,i){if(II(I,Uint8Array)&&(I=u.from(I,I.offset,I.byteLength)),!u.isBuffer(I))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof I);if(void 0===g&&(g=0),void 0===C&&(C=I?I.length:0),void 0===A&&(A=0),void 0===i&&(i=this.length),g<0||C>I.length||A<0||i>this.length)throw new RangeError("out of range index");if(A>=i&&g>=C)return 0;if(A>=i)return-1;if(g>=C)return 1;if(this===I)return 0;for(var c=(i>>>=0)-(A>>>=0),G=(C>>>=0)-(g>>>=0),l=Math.min(c,G),b=this.slice(A,i),Z=I.slice(g,C),t=0;t<l;++t)if(b[t]!==Z[t]){c=b[t],G=Z[t];break}return c<G?-1:G<c?1:0},u.prototype.includes=function(I,g,C){return-1!==this.indexOf(I,g,C)},u.prototype.indexOf=function(I,g,C){return s(this,I,g,C,!0)},u.prototype.lastIndexOf=function(I,g,C){return s(this,I,g,C,!1)},u.prototype.write=function(I,g,C,A){if(void 0===g)A="utf8",C=this.length,g=0;else if(void 0===C&&"string"===typeof g)A=g,C=this.length,g=0;else{if(!isFinite(g))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");g>>>=0,isFinite(C)?(C>>>=0,void 0===A&&(A="utf8")):(A=C,C=void 0)}var i=this.length-g;if((void 0===C||C>i)&&(C=i),I.length>0&&(C<0||g<0)||g>this.length)throw new RangeError("Attempt to write outside buffer bounds");A||(A="utf8");for(var c=!1;;)switch(A){case"hex":return Y(this,I,g,C);case"utf8":case"utf-8":return W(this,I,g,C);case"ascii":case"latin1":case"binary":return S(this,I,g,C);case"base64":return p(this,I,g,C);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return K(this,I,g,C);default:if(c)throw new TypeError("Unknown encoding: "+A);A=(""+A).toLowerCase(),c=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var J=4096;function F(I,g,C){var A="";C=Math.min(I.length,C);for(var i=g;i<C;++i)A+=String.fromCharCode(127&I[i]);return A}function w(I,g,C){var A="";C=Math.min(I.length,C);for(var i=g;i<C;++i)A+=String.fromCharCode(I[i]);return A}function f(I,g,C){var A=I.length;(!g||g<0)&&(g=0),(!C||C<0||C>A)&&(C=A);for(var i="",c=g;c<C;++c)i+=CI[I[c]];return i}function v(I,g,C){for(var A=I.slice(g,C),i="",c=0;c<A.length-1;c+=2)i+=String.fromCharCode(A[c]+256*A[c+1]);return i}function x(I,g,C){if(I%1!==0||I<0)throw new RangeError("offset is not uint");if(I+g>C)throw new RangeError("Trying to access beyond buffer length")}function N(I,g,C,A,i,c){if(!u.isBuffer(I))throw new TypeError('"buffer" argument must be a Buffer instance');if(g>i||g<c)throw new RangeError('"value" argument is out of bounds');if(C+A>I.length)throw new RangeError("Index out of range")}function L(I,g,C,A,i){O(g,A,i,I,C,7);var c=Number(g&BigInt(4294967295));I[C++]=c,c>>=8,I[C++]=c,c>>=8,I[C++]=c,c>>=8,I[C++]=c;var G=Number(g>>BigInt(32)&BigInt(4294967295));return I[C++]=G,G>>=8,I[C++]=G,G>>=8,I[C++]=G,G>>=8,I[C++]=G,C}function k(I,g,C,A,i){O(g,A,i,I,C,7);var c=Number(g&BigInt(4294967295));I[C+7]=c,c>>=8,I[C+6]=c,c>>=8,I[C+5]=c,c>>=8,I[C+4]=c;var G=Number(g>>BigInt(32)&BigInt(4294967295));return I[C+3]=G,G>>=8,I[C+2]=G,G>>=8,I[C+1]=G,G>>=8,I[C]=G,C+8}function T(I,g,C,A,i,c){if(C+A>I.length)throw new RangeError("Index out of range");if(C<0)throw new RangeError("Index out of range")}function U(I,g,C,A,i){return g=+g,C>>>=0,i||T(I,0,C,4),Z.write(I,g,C,A,23,4),C+4}function z(I,g,C,A,i){return g=+g,C>>>=0,i||T(I,0,C,8),Z.write(I,g,C,A,52,8),C+8}u.prototype.slice=function(I,g){var C=this.length;(I=~~I)<0?(I+=C)<0&&(I=0):I>C&&(I=C),(g=void 0===g?C:~~g)<0?(g+=C)<0&&(g=0):g>C&&(g=C),g<I&&(g=I);var A=this.subarray(I,g);return Object.setPrototypeOf(A,u.prototype),A},u.prototype.readUintLE=u.prototype.readUIntLE=function(I,g,C){I>>>=0,g>>>=0,C||x(I,g,this.length);for(var A=this[I],i=1,c=0;++c<g&&(i*=256);)A+=this[I+c]*i;return A},u.prototype.readUintBE=u.prototype.readUIntBE=function(I,g,C){I>>>=0,g>>>=0,C||x(I,g,this.length);for(var A=this[I+--g],i=1;g>0&&(i*=256);)A+=this[I+--g]*i;return A},u.prototype.readUint8=u.prototype.readUInt8=function(I,g){return I>>>=0,g||x(I,1,this.length),this[I]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(I,g){return I>>>=0,g||x(I,2,this.length),this[I]|this[I+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(I,g){return I>>>=0,g||x(I,2,this.length),this[I]<<8|this[I+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(I,g){return I>>>=0,g||x(I,4,this.length),(this[I]|this[I+1]<<8|this[I+2]<<16)+16777216*this[I+3]},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(I,g){return I>>>=0,g||x(I,4,this.length),16777216*this[I]+(this[I+1]<<16|this[I+2]<<8|this[I+3])},u.prototype.readBigUInt64LE=AI((function(I){P(I>>>=0,"offset");var g=this[I],C=this[I+7];void 0!==g&&void 0!==C||q(I,this.length-8);var A=g+this[++I]*Math.pow(2,8)+this[++I]*Math.pow(2,16)+this[++I]*Math.pow(2,24),i=this[++I]+this[++I]*Math.pow(2,8)+this[++I]*Math.pow(2,16)+C*Math.pow(2,24);return BigInt(A)+(BigInt(i)<<BigInt(32))})),u.prototype.readBigUInt64BE=AI((function(I){P(I>>>=0,"offset");var g=this[I],C=this[I+7];void 0!==g&&void 0!==C||q(I,this.length-8);var A=g*Math.pow(2,24)+this[++I]*Math.pow(2,16)+this[++I]*Math.pow(2,8)+this[++I],i=this[++I]*Math.pow(2,24)+this[++I]*Math.pow(2,16)+this[++I]*Math.pow(2,8)+C;return(BigInt(A)<<BigInt(32))+BigInt(i)})),u.prototype.readIntLE=function(I,g,C){I>>>=0,g>>>=0,C||x(I,g,this.length);for(var A=this[I],i=1,c=0;++c<g&&(i*=256);)A+=this[I+c]*i;return A>=(i*=128)&&(A-=Math.pow(2,8*g)),A},u.prototype.readIntBE=function(I,g,C){I>>>=0,g>>>=0,C||x(I,g,this.length);for(var A=g,i=1,c=this[I+--A];A>0&&(i*=256);)c+=this[I+--A]*i;return c>=(i*=128)&&(c-=Math.pow(2,8*g)),c},u.prototype.readInt8=function(I,g){return I>>>=0,g||x(I,1,this.length),128&this[I]?-1*(255-this[I]+1):this[I]},u.prototype.readInt16LE=function(I,g){I>>>=0,g||x(I,2,this.length);var C=this[I]|this[I+1]<<8;return 32768&C?4294901760|C:C},u.prototype.readInt16BE=function(I,g){I>>>=0,g||x(I,2,this.length);var C=this[I+1]|this[I]<<8;return 32768&C?4294901760|C:C},u.prototype.readInt32LE=function(I,g){return I>>>=0,g||x(I,4,this.length),this[I]|this[I+1]<<8|this[I+2]<<16|this[I+3]<<24},u.prototype.readInt32BE=function(I,g){return I>>>=0,g||x(I,4,this.length),this[I]<<24|this[I+1]<<16|this[I+2]<<8|this[I+3]},u.prototype.readBigInt64LE=AI((function(I){P(I>>>=0,"offset");var g=this[I],C=this[I+7];void 0!==g&&void 0!==C||q(I,this.length-8);var A=this[I+4]+this[I+5]*Math.pow(2,8)+this[I+6]*Math.pow(2,16)+(C<<24);return(BigInt(A)<<BigInt(32))+BigInt(g+this[++I]*Math.pow(2,8)+this[++I]*Math.pow(2,16)+this[++I]*Math.pow(2,24))})),u.prototype.readBigInt64BE=AI((function(I){P(I>>>=0,"offset");var g=this[I],C=this[I+7];void 0!==g&&void 0!==C||q(I,this.length-8);var A=(g<<24)+this[++I]*Math.pow(2,16)+this[++I]*Math.pow(2,8)+this[++I];return(BigInt(A)<<BigInt(32))+BigInt(this[++I]*Math.pow(2,24)+this[++I]*Math.pow(2,16)+this[++I]*Math.pow(2,8)+C)})),u.prototype.readFloatLE=function(I,g){return I>>>=0,g||x(I,4,this.length),Z.read(this,I,!0,23,4)},u.prototype.readFloatBE=function(I,g){return I>>>=0,g||x(I,4,this.length),Z.read(this,I,!1,23,4)},u.prototype.readDoubleLE=function(I,g){return I>>>=0,g||x(I,8,this.length),Z.read(this,I,!0,52,8)},u.prototype.readDoubleBE=function(I,g){return I>>>=0,g||x(I,8,this.length),Z.read(this,I,!1,52,8)},u.prototype.writeUintLE=u.prototype.writeUIntLE=function(I,g,C,A){(I=+I,g>>>=0,C>>>=0,A)||N(this,I,g,C,Math.pow(2,8*C)-1,0);var i=1,c=0;for(this[g]=255&I;++c<C&&(i*=256);)this[g+c]=I/i&255;return g+C},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(I,g,C,A){(I=+I,g>>>=0,C>>>=0,A)||N(this,I,g,C,Math.pow(2,8*C)-1,0);var i=C-1,c=1;for(this[g+i]=255&I;--i>=0&&(c*=256);)this[g+i]=I/c&255;return g+C},u.prototype.writeUint8=u.prototype.writeUInt8=function(I,g,C){return I=+I,g>>>=0,C||N(this,I,g,1,255,0),this[g]=255&I,g+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(I,g,C){return I=+I,g>>>=0,C||N(this,I,g,2,65535,0),this[g]=255&I,this[g+1]=I>>>8,g+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(I,g,C){return I=+I,g>>>=0,C||N(this,I,g,2,65535,0),this[g]=I>>>8,this[g+1]=255&I,g+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(I,g,C){return I=+I,g>>>=0,C||N(this,I,g,4,4294967295,0),this[g+3]=I>>>24,this[g+2]=I>>>16,this[g+1]=I>>>8,this[g]=255&I,g+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(I,g,C){return I=+I,g>>>=0,C||N(this,I,g,4,4294967295,0),this[g]=I>>>24,this[g+1]=I>>>16,this[g+2]=I>>>8,this[g+3]=255&I,g+4},u.prototype.writeBigUInt64LE=AI((function(I){var g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return L(this,I,g,BigInt(0),BigInt("0xffffffffffffffff"))})),u.prototype.writeBigUInt64BE=AI((function(I){var g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return k(this,I,g,BigInt(0),BigInt("0xffffffffffffffff"))})),u.prototype.writeIntLE=function(I,g,C,A){if(I=+I,g>>>=0,!A){var i=Math.pow(2,8*C-1);N(this,I,g,C,i-1,-i)}var c=0,G=1,l=0;for(this[g]=255&I;++c<C&&(G*=256);)I<0&&0===l&&0!==this[g+c-1]&&(l=1),this[g+c]=(I/G>>0)-l&255;return g+C},u.prototype.writeIntBE=function(I,g,C,A){if(I=+I,g>>>=0,!A){var i=Math.pow(2,8*C-1);N(this,I,g,C,i-1,-i)}var c=C-1,G=1,l=0;for(this[g+c]=255&I;--c>=0&&(G*=256);)I<0&&0===l&&0!==this[g+c+1]&&(l=1),this[g+c]=(I/G>>0)-l&255;return g+C},u.prototype.writeInt8=function(I,g,C){return I=+I,g>>>=0,C||N(this,I,g,1,127,-128),I<0&&(I=255+I+1),this[g]=255&I,g+1},u.prototype.writeInt16LE=function(I,g,C){return I=+I,g>>>=0,C||N(this,I,g,2,32767,-32768),this[g]=255&I,this[g+1]=I>>>8,g+2},u.prototype.writeInt16BE=function(I,g,C){return I=+I,g>>>=0,C||N(this,I,g,2,32767,-32768),this[g]=I>>>8,this[g+1]=255&I,g+2},u.prototype.writeInt32LE=function(I,g,C){return I=+I,g>>>=0,C||N(this,I,g,4,2147483647,-2147483648),this[g]=255&I,this[g+1]=I>>>8,this[g+2]=I>>>16,this[g+3]=I>>>24,g+4},u.prototype.writeInt32BE=function(I,g,C){return I=+I,g>>>=0,C||N(this,I,g,4,2147483647,-2147483648),I<0&&(I=4294967295+I+1),this[g]=I>>>24,this[g+1]=I>>>16,this[g+2]=I>>>8,this[g+3]=255&I,g+4},u.prototype.writeBigInt64LE=AI((function(I){var g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return L(this,I,g,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),u.prototype.writeBigInt64BE=AI((function(I){var g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return k(this,I,g,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),u.prototype.writeFloatLE=function(I,g,C){return U(this,I,g,!0,C)},u.prototype.writeFloatBE=function(I,g,C){return U(this,I,g,!1,C)},u.prototype.writeDoubleLE=function(I,g,C){return z(this,I,g,!0,C)},u.prototype.writeDoubleBE=function(I,g,C){return z(this,I,g,!1,C)},u.prototype.copy=function(I,g,C,A){if(!u.isBuffer(I))throw new TypeError("argument should be a Buffer");if(C||(C=0),A||0===A||(A=this.length),g>=I.length&&(g=I.length),g||(g=0),A>0&&A<C&&(A=C),A===C)return 0;if(0===I.length||0===this.length)return 0;if(g<0)throw new RangeError("targetStart out of bounds");if(C<0||C>=this.length)throw new RangeError("Index out of range");if(A<0)throw new RangeError("sourceEnd out of bounds");A>this.length&&(A=this.length),I.length-g<A-C&&(A=I.length-g+C);var i=A-C;return this===I&&"function"===typeof Uint8Array.prototype.copyWithin?this.copyWithin(g,C,A):Uint8Array.prototype.set.call(I,this.subarray(C,A),g),i},u.prototype.fill=function(I,g,C,A){if("string"===typeof I){if("string"===typeof g?(A=g,g=0,C=this.length):"string"===typeof C&&(A=C,C=this.length),void 0!==A&&"string"!==typeof A)throw new TypeError("encoding must be a string");if("string"===typeof A&&!u.isEncoding(A))throw new TypeError("Unknown encoding: "+A);if(1===I.length){var i=I.charCodeAt(0);("utf8"===A&&i<128||"latin1"===A)&&(I=i)}}else"number"===typeof I?I&=255:"boolean"===typeof I&&(I=Number(I));if(g<0||this.length<g||this.length<C)throw new RangeError("Out of range index");if(C<=g)return this;var c;if(g>>>=0,C=void 0===C?this.length:C>>>0,I||(I=0),"number"===typeof I)for(c=g;c<C;++c)this[c]=I;else{var G=u.isBuffer(I)?I:u.from(I,A),l=G.length;if(0===l)throw new TypeError('The value "'+I+'" is invalid for argument "value"');for(c=0;c<C-g;++c)this[c+g]=G[c%l]}return this};var E={};function M(I,g,C){E[I]=function(C){G(Z,C);var b=l(Z);function Z(){var C;return A(this,Z),C=b.call(this),Object.defineProperty(c(C),"message",{value:g.apply(c(C),arguments),writable:!0,configurable:!0}),C.name="".concat(C.name," [").concat(I,"]"),C.stack,delete C.name,C}return i(Z,[{key:"code",get:function(){return I},set:function(I){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:I,writable:!0})}},{key:"toString",value:function(){return"".concat(this.name," [").concat(I,"]: ").concat(this.message)}}]),Z}(C)}function D(I){for(var g="",C=I.length,A="-"===I[0]?1:0;C>=A+4;C-=3)g="_".concat(I.slice(C-3,C)).concat(g);return"".concat(I.slice(0,C)).concat(g)}function O(I,g,C,A,i,c){if(I>C||I<g){var G,l="bigint"===typeof g?"n":"";throw G=c>3?0===g||g===BigInt(0)?">= 0".concat(l," and < 2").concat(l," ** ").concat(8*(c+1)).concat(l):">= -(2".concat(l," ** ").concat(8*(c+1)-1).concat(l,") and < 2 ** ")+"".concat(8*(c+1)-1).concat(l):">= ".concat(g).concat(l," and <= ").concat(C).concat(l),new E.ERR_OUT_OF_RANGE("value",G,I)}!function(I,g,C){P(g,"offset"),void 0!==I[g]&&void 0!==I[g+C]||q(g,I.length-(C+1))}(A,i,c)}function P(I,g){if("number"!==typeof I)throw new E.ERR_INVALID_ARG_TYPE(g,"number",I)}function q(I,g,C){if(Math.floor(I)!==I)throw P(I,C),new E.ERR_OUT_OF_RANGE(C||"offset","an integer",I);if(g<0)throw new E.ERR_BUFFER_OUT_OF_BOUNDS;throw new E.ERR_OUT_OF_RANGE(C||"offset",">= ".concat(C?1:0," and <= ").concat(g),I)}M("ERR_BUFFER_OUT_OF_BOUNDS",(function(I){return I?"".concat(I," is outside of buffer bounds"):"Attempt to access memory outside buffer bounds"}),RangeError),M("ERR_INVALID_ARG_TYPE",(function(I,g){return'The "'.concat(I,'" argument must be of type number. Received type ').concat(typeof g)}),TypeError),M("ERR_OUT_OF_RANGE",(function(I,g,C){var A='The value of "'.concat(I,'" is out of range.'),i=C;return Number.isInteger(C)&&Math.abs(C)>Math.pow(2,32)?i=D(String(C)):"bigint"===typeof C&&(i=String(C),(C>Math.pow(BigInt(2),BigInt(32))||C<-Math.pow(BigInt(2),BigInt(32)))&&(i=D(i)),i+="n"),A+=" It must be ".concat(g,". Received ").concat(i)}),RangeError);var j=/[^+/0-9A-Za-z-_]/g;function Q(I,g){var C;g=g||1/0;for(var A=I.length,i=null,c=[],G=0;G<A;++G){if((C=I.charCodeAt(G))>55295&&C<57344){if(!i){if(C>56319){(g-=3)>-1&&c.push(239,191,189);continue}if(G+1===A){(g-=3)>-1&&c.push(239,191,189);continue}i=C;continue}if(C<56320){(g-=3)>-1&&c.push(239,191,189),i=C;continue}C=65536+(i-55296<<10|C-56320)}else i&&(g-=3)>-1&&c.push(239,191,189);if(i=null,C<128){if((g-=1)<0)break;c.push(C)}else if(C<2048){if((g-=2)<0)break;c.push(C>>6|192,63&C|128)}else if(C<65536){if((g-=3)<0)break;c.push(C>>12|224,C>>6&63|128,63&C|128)}else{if(!(C<1114112))throw new Error("Invalid code point");if((g-=4)<0)break;c.push(C>>18|240,C>>12&63|128,C>>6&63|128,63&C|128)}}return c}function _(I){return b.toByteArray(function(I){if((I=(I=I.split("=")[0]).trim().replace(j,"")).length<2)return"";for(;I.length%4!==0;)I+="=";return I}(I))}function $(I,g,C,A){var i;for(i=0;i<A&&!(i+C>=g.length||i>=I.length);++i)g[i+C]=I[i];return i}function II(I,g){return I instanceof g||null!=I&&null!=I.constructor&&null!=I.constructor.name&&I.constructor.name===g.name}function gI(I){return I!==I}var CI=function(){for(var I="0123456789abcdef",g=new Array(256),C=0;C<16;++C)for(var A=16*C,i=0;i<16;++i)g[A+i]=I[C]+I[i];return g}();function AI(I){return"undefined"===typeof BigInt?iI:I}function iI(){throw new Error("BigInt not supported")}},6087:function(I,g,C){g.formatArgs=function(g){if(g[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+g[0]+(this.useColors?"%c ":" ")+"+"+I.exports.humanize(this.diff),!this.useColors)return;var C="color: "+this.color;g.splice(1,0,C,"color: inherit");var A=0,i=0;g[0].replace(/%[a-zA-Z%]/g,(function(I){"%%"!==I&&(A++,"%c"===I&&(i=A))})),g.splice(i,0,C)},g.save=function(I){try{I?g.storage.setItem("debug",I):g.storage.removeItem("debug")}catch(C){}},g.load=function(){var I;try{I=g.storage.getItem("debug")}catch(C){}!I&&"undefined"!==typeof process&&"env"in process&&(I={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.DEBUG);return I},g.useColors=function(){if("undefined"!==typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},g.storage=function(){try{return localStorage}catch(I){}}(),g.destroy=function(){var I=!1;return function(){I||(I=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}}(),g.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],g.log=console.debug||console.log||function(){},I.exports=C(8053)(g),I.exports.formatters.j=function(I){try{return JSON.stringify(I)}catch(g){return"[UnexpectedJSONParseError]: "+g.message}}},8053:function(I,g,C){var A=C(7329).default;I.exports=function(I){function g(I){var C,A,c,G=null;function l(){for(var I=arguments.length,A=new Array(I),i=0;i<I;i++)A[i]=arguments[i];if(l.enabled){var c=l,G=Number(new Date),b=G-(C||G);c.diff=b,c.prev=C,c.curr=G,C=G,A[0]=g.coerce(A[0]),"string"!==typeof A[0]&&A.unshift("%O");var Z=0;A[0]=A[0].replace(/%([a-zA-Z%])/g,(function(I,C){if("%%"===I)return"%";Z++;var i=g.formatters[C];if("function"===typeof i){var G=A[Z];I=i.call(c,G),A.splice(Z,1),Z--}return I})),g.formatArgs.call(c,A);var t=c.log||g.log;t.apply(c,A)}}return l.namespace=I,l.useColors=g.useColors(),l.color=g.selectColor(I),l.extend=i,l.destroy=g.destroy,Object.defineProperty(l,"enabled",{enumerable:!0,configurable:!1,get:function(){return null!==G?G:(A!==g.namespaces&&(A=g.namespaces,c=g.enabled(I)),c)},set:function(I){G=I}}),"function"===typeof g.init&&g.init(l),l}function i(I,C){var A=g(this.namespace+("undefined"===typeof C?":":C)+I);return A.log=this.log,A}function c(I){return I.toString().substring(2,I.toString().length-2).replace(/\.\*\?$/,"*")}return g.debug=g,g.default=g,g.coerce=function(I){if(I instanceof Error)return I.stack||I.message;return I},g.disable=function(){var I=[].concat(A(g.names.map(c)),A(g.skips.map(c).map((function(I){return"-"+I})))).join(",");return g.enable(""),I},g.enable=function(I){var C;g.save(I),g.namespaces=I,g.names=[],g.skips=[];var A=("string"===typeof I?I:"").split(/[\s,]+/),i=A.length;for(C=0;C<i;C++)A[C]&&("-"===(I=A[C].replace(/\*/g,".*?"))[0]?g.skips.push(new RegExp("^"+I.slice(1)+"$")):g.names.push(new RegExp("^"+I+"$")))},g.enabled=function(I){if("*"===I[I.length-1])return!0;var C,A;for(C=0,A=g.skips.length;C<A;C++)if(g.skips[C].test(I))return!1;for(C=0,A=g.names.length;C<A;C++)if(g.names[C].test(I))return!0;return!1},g.humanize=C(5183),g.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(I).forEach((function(C){g[C]=I[C]})),g.names=[],g.skips=[],g.formatters={},g.selectColor=function(I){for(var C=0,A=0;A<I.length;A++)C=(C<<5)-C+I.charCodeAt(A),C|=0;return g.colors[Math.abs(C)%g.colors.length]},g.enable(g.load()),g}},3866:function(I,g){g.read=function(I,g,C,A,i){var c,G,l=8*i-A-1,b=(1<<l)-1,Z=b>>1,t=-7,o=C?i-1:0,n=C?-1:1,u=I[g+o];for(o+=n,c=u&(1<<-t)-1,u>>=-t,t+=l;t>0;c=256*c+I[g+o],o+=n,t-=8);for(G=c&(1<<-t)-1,c>>=-t,t+=A;t>0;G=256*G+I[g+o],o+=n,t-=8);if(0===c)c=1-Z;else{if(c===b)return G?NaN:1/0*(u?-1:1);G+=Math.pow(2,A),c-=Z}return(u?-1:1)*G*Math.pow(2,c-A)},g.write=function(I,g,C,A,i,c){var G,l,b,Z=8*c-i-1,t=(1<<Z)-1,o=t>>1,n=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,u=A?0:c-1,d=A?1:-1,m=g<0||0===g&&1/g<0?1:0;for(g=Math.abs(g),isNaN(g)||g===1/0?(l=isNaN(g)?1:0,G=t):(G=Math.floor(Math.log(g)/Math.LN2),g*(b=Math.pow(2,-G))<1&&(G--,b*=2),(g+=G+o>=1?n/b:n*Math.pow(2,1-o))*b>=2&&(G++,b/=2),G+o>=t?(l=0,G=t):G+o>=1?(l=(g*b-1)*Math.pow(2,i),G+=o):(l=g*Math.pow(2,o-1)*Math.pow(2,i),G=0));i>=8;I[C+u]=255&l,u+=d,l/=256,i-=8);for(G=G<<i|l,Z+=i;Z>0;I[C+u]=255&G,u+=d,G/=256,Z-=8);I[C+u-d]|=128*m}},8732:function(I){"use strict";I.exports=function(I){return!!I&&("symbol"===typeof Symbol.observable&&"function"===typeof I[Symbol.observable]?I===I[Symbol.observable]():"function"===typeof I["@@observable"]&&I===I["@@observable"]())}},8698:function(I,g,C){"undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof C.g&&C.g,I.exports=function(){"use strict";var I="3.7.3",g=I,C="function"===typeof atob,A="function"===typeof btoa,i="function"===typeof Buffer,c="function"===typeof TextDecoder?new TextDecoder:void 0,G="function"===typeof TextEncoder?new TextEncoder:void 0,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",b=Array.prototype.slice.call(l),Z=function(I){var g={};return I.forEach((function(I,C){return g[I]=C})),g}(b),t=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,o=String.fromCharCode.bind(String),n="function"===typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):function(I,g){return void 0===g&&(g=function(I){return I}),new Uint8Array(Array.prototype.slice.call(I,0).map(g))},u=function(I){return I.replace(/=/g,"").replace(/[+\/]/g,(function(I){return"+"==I?"-":"_"}))},d=function(I){return I.replace(/[^A-Za-z0-9\+\/]/g,"")},m=function(I){for(var g,C,A,i,c="",G=I.length%3,l=0;l<I.length;){if((C=I.charCodeAt(l++))>255||(A=I.charCodeAt(l++))>255||(i=I.charCodeAt(l++))>255)throw new TypeError("invalid character found");c+=b[(g=C<<16|A<<8|i)>>18&63]+b[g>>12&63]+b[g>>6&63]+b[63&g]}return G?c.slice(0,G-3)+"===".substring(G):c},e=A?function(I){return btoa(I)}:i?function(I){return Buffer.from(I,"binary").toString("base64")}:m,B=i?function(I){return Buffer.from(I).toString("base64")}:function(I){for(var g=4096,C=[],A=0,i=I.length;A<i;A+=g)C.push(o.apply(null,I.subarray(A,A+g)));return e(C.join(""))},X=function(I,g){return void 0===g&&(g=!1),g?u(B(I)):B(I)},y=function(I){if(I.length<2)return(g=I.charCodeAt(0))<128?I:g<2048?o(192|g>>>6)+o(128|63&g):o(224|g>>>12&15)+o(128|g>>>6&63)+o(128|63&g);var g=65536+1024*(I.charCodeAt(0)-55296)+(I.charCodeAt(1)-56320);return o(240|g>>>18&7)+o(128|g>>>12&63)+o(128|g>>>6&63)+o(128|63&g)},V=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,h=function(I){return I.replace(V,y)},a=i?function(I){return Buffer.from(I,"utf8").toString("base64")}:G?function(I){return B(G.encode(I))}:function(I){return e(h(I))},s=function(I,g){return void 0===g&&(g=!1),g?u(a(I)):a(I)},r=function(I){return s(I,!0)},Y=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,W=function(I){switch(I.length){case 4:var g=((7&I.charCodeAt(0))<<18|(63&I.charCodeAt(1))<<12|(63&I.charCodeAt(2))<<6|63&I.charCodeAt(3))-65536;return o(55296+(g>>>10))+o(56320+(1023&g));case 3:return o((15&I.charCodeAt(0))<<12|(63&I.charCodeAt(1))<<6|63&I.charCodeAt(2));default:return o((31&I.charCodeAt(0))<<6|63&I.charCodeAt(1))}},S=function(I){return I.replace(Y,W)},p=function(I){if(I=I.replace(/\s+/g,""),!t.test(I))throw new TypeError("malformed base64.");I+="==".slice(2-(3&I.length));for(var g,C,A,i="",c=0;c<I.length;)g=Z[I.charAt(c++)]<<18|Z[I.charAt(c++)]<<12|(C=Z[I.charAt(c++)])<<6|(A=Z[I.charAt(c++)]),i+=64===C?o(g>>16&255):64===A?o(g>>16&255,g>>8&255):o(g>>16&255,g>>8&255,255&g);return i},K=C?function(I){return atob(d(I))}:i?function(I){return Buffer.from(I,"base64").toString("binary")}:p,R=i?function(I){return n(Buffer.from(I,"base64"))}:function(I){return n(K(I),(function(I){return I.charCodeAt(0)}))},H=function(I){return R(F(I))},J=i?function(I){return Buffer.from(I,"base64").toString("utf8")}:c?function(I){return c.decode(R(I))}:function(I){return S(K(I))},F=function(I){return d(I.replace(/[-_]/g,(function(I){return"-"==I?"+":"/"})))},w=function(I){return J(F(I))},f=function(I){return{value:I,enumerable:!1,writable:!0,configurable:!0}},v=function(){var I=function(I,g){return Object.defineProperty(String.prototype,I,f(g))};I("fromBase64",(function(){return w(this)})),I("toBase64",(function(I){return s(this,I)})),I("toBase64URI",(function(){return s(this,!0)})),I("toBase64URL",(function(){return s(this,!0)})),I("toUint8Array",(function(){return H(this)}))},x=function(){var I=function(I,g){return Object.defineProperty(Uint8Array.prototype,I,f(g))};I("toBase64",(function(I){return X(this,I)})),I("toBase64URI",(function(){return X(this,!0)})),I("toBase64URL",(function(){return X(this,!0)}))},N=function(){v(),x()},L={version:I,VERSION:g,atob:K,atobPolyfill:p,btoa:e,btoaPolyfill:m,fromBase64:w,toBase64:s,encode:s,encodeURI:r,encodeURL:r,utob:h,btou:S,decode:w,isValid:function(I){if("string"!==typeof I)return!1;var g=I.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(g)||!/[^\s0-9a-zA-Z\-_]/.test(g)},fromUint8Array:X,toUint8Array:H,extendString:v,extendUint8Array:x,extendBuiltins:N,Base64:{}};return Object.keys(L).forEach((function(I){return L.Base64[I]=L[I]})),L}()},5183:function(I){var g=1e3,C=60*g,A=60*C,i=24*A,c=7*i,G=365.25*i;function l(I,g,C,A){var i=g>=1.5*C;return Math.round(I/C)+" "+A+(i?"s":"")}I.exports=function(I,b){b=b||{};var Z=typeof I;if("string"===Z&&I.length>0)return function(I){if((I=String(I)).length>100)return;var l=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(I);if(!l)return;var b=parseFloat(l[1]);switch((l[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return b*G;case"weeks":case"week":case"w":return b*c;case"days":case"day":case"d":return b*i;case"hours":case"hour":case"hrs":case"hr":case"h":return b*A;case"minutes":case"minute":case"mins":case"min":case"m":return b*C;case"seconds":case"second":case"secs":case"sec":case"s":return b*g;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return b;default:return}}(I);if("number"===Z&&isFinite(I))return b.long?function(I){var c=Math.abs(I);if(c>=i)return l(I,c,i,"day");if(c>=A)return l(I,c,A,"hour");if(c>=C)return l(I,c,C,"minute");if(c>=g)return l(I,c,g,"second");return I+" ms"}(I):function(I){var c=Math.abs(I);if(c>=i)return Math.round(I/i)+"d";if(c>=A)return Math.round(I/A)+"h";if(c>=C)return Math.round(I/C)+"m";if(c>=g)return Math.round(I/g)+"s";return I+"ms"}(I);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(I))}},3889:function(I,g,C){"use strict";C.r(g),C.d(g,{Observable:function(){return H},Subject:function(){return O},filter:function(){return w},flatMap:function(){return N},interval:function(){return L},map:function(){return T},merge:function(){return U},multicast:function(){return P},scan:function(){return j},unsubscribe:function(){return J}});var A=C(6257);function i(I,g){if(!(I instanceof g))throw new TypeError("Cannot call a class as a function")}var c=C(2641);function G(I){var g=function(I,g){if("object"!==(0,c.Z)(I)||null===I)return I;var C=I[Symbol.toPrimitive];if(void 0!==C){var A=C.call(I,g||"default");if("object"!==(0,c.Z)(A))return A;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===g?String:Number)(I)}(I,"string");return"symbol"===(0,c.Z)(g)?g:String(g)}function l(I,g){for(var C=0;C<g.length;C++){var A=g[C];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(I,G(A.key),A)}}function b(I,g,C){return g&&l(I.prototype,g),C&&l(I,C),Object.defineProperty(I,"prototype",{writable:!1}),I}var Z=function(I,g,C,A){return new(C||(C=Promise))((function(i,c){function G(I){try{b(A.next(I))}catch(g){c(g)}}function l(I){try{b(A.throw(I))}catch(g){c(g)}}function b(I){var g;I.done?i(I.value):(g=I.value,g instanceof C?g:new C((function(I){I(g)}))).then(G,l)}b((A=A.apply(I,g||[])).next())}))},t=function(){function I(g){i(this,I),this._baseObserver=g,this._pendingPromises=new Set}return b(I,[{key:"complete",value:function(){var I=this;Promise.all(this._pendingPromises).then((function(){return I._baseObserver.complete()})).catch((function(g){return I._baseObserver.error(g)}))}},{key:"error",value:function(I){this._baseObserver.error(I)}},{key:"schedule",value:function(I){var g=this,C=Promise.all(this._pendingPromises),i=[],c=function(I){return i.push(I)},G=Promise.resolve().then((function(){return Z(g,void 0,void 0,(0,A.Z)().mark((function g(){var l,b,Z;return(0,A.Z)().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,C;case 2:return g.next=4,I(c);case 4:for(this._pendingPromises.delete(G),l=0,b=i;l<b.length;l++)Z=b[l],this._baseObserver.next(Z);case 6:case"end":return g.stop()}}),g,this)})))})).catch((function(I){g._pendingPromises.delete(G),g._baseObserver.error(I)}));this._pendingPromises.add(G)}}]),I}();function o(I,g){(null==g||g>I.length)&&(g=I.length);for(var C=0,A=new Array(g);C<g;C++)A[C]=I[C];return A}function n(I,g){var C="undefined"!==typeof Symbol&&I[Symbol.iterator]||I["@@iterator"];if(!C){if(Array.isArray(I)||(C=function(I,g){if(I){if("string"===typeof I)return o(I,g);var C=Object.prototype.toString.call(I).slice(8,-1);return"Object"===C&&I.constructor&&(C=I.constructor.name),"Map"===C||"Set"===C?Array.from(I):"Arguments"===C||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(C)?o(I,g):void 0}}(I))||g&&I&&"number"===typeof I.length){C&&(I=C);var A=0,i=function(){};return{s:i,n:function(){return A>=I.length?{done:!0}:{done:!1,value:I[A++]}},e:function(I){throw I},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,G=!0,l=!1;return{s:function(){C=C.call(I)},n:function(){var I=C.next();return G=I.done,I},e:function(I){l=!0,c=I},f:function(){try{G||null==C.return||C.return()}finally{if(l)throw c}}}}var u=function(){return"function"===typeof Symbol},d=function(I){return u()&&Boolean(Symbol[I])},m=function(I){return d(I)?Symbol[I]:"@@"+I};d("asyncIterator")||(Symbol.asyncIterator=Symbol.asyncIterator||Symbol.for("Symbol.asyncIterator"));var e=m("iterator"),B=m("observable"),X=m("species");function y(I,g){var C=I[g];if(null!=C){if("function"!==typeof C)throw new TypeError(C+" is not a function");return C}}function V(I){var g=I.constructor;return void 0!==g&&null===(g=g[X])&&(g=void 0),void 0!==g?g:R}function h(I){return I instanceof R}function a(I){a.log?a.log(I):setTimeout((function(){throw I}),0)}function s(I){Promise.resolve().then((function(){try{I()}catch(g){a(g)}}))}function r(I){var g=I._cleanup;if(void 0!==g&&(I._cleanup=void 0,g))try{if("function"===typeof g)g();else{var C=y(g,"unsubscribe");C&&C.call(g)}}catch(A){a(A)}}function Y(I){I._observer=void 0,I._queue=void 0,I._state="closed"}function W(I,g,C){I._state="running";var A=I._observer;try{var i=A?y(A,g):void 0;switch(g){case"next":i&&i.call(A,C);break;case"error":if(Y(I),!i)throw C;i.call(A,C);break;case"complete":Y(I),i&&i.call(A)}}catch(c){a(c)}"closed"===I._state?r(I):"running"===I._state&&(I._state="ready")}function S(I,g,C){if("closed"!==I._state)return"buffering"===I._state?(I._queue=I._queue||[],void I._queue.push({type:g,value:C})):"ready"!==I._state?(I._state="buffering",I._queue=[{type:g,value:C}],void s((function(){return function(I){var g=I._queue;if(g){I._queue=void 0,I._state="ready";var C,A=n(g);try{for(A.s();!(C=A.n()).done;){var i=C.value;if(W(I,i.type,i.value),"closed"===I._state)break}}catch(c){A.e(c)}finally{A.f()}}}(I)}))):void W(I,g,C)}var p=function(){function I(g,C){i(this,I),this._cleanup=void 0,this._observer=g,this._queue=void 0,this._state="initializing";var A=new K(this);try{this._cleanup=C.call(void 0,A)}catch(c){A.error(c)}"initializing"===this._state&&(this._state="ready")}return b(I,[{key:"closed",get:function(){return"closed"===this._state}},{key:"unsubscribe",value:function(){"closed"!==this._state&&(Y(this),r(this))}}]),I}(),K=function(){function I(g){i(this,I),this._subscription=g}return b(I,[{key:"closed",get:function(){return"closed"===this._subscription._state}},{key:"next",value:function(I){S(this._subscription,"next",I)}},{key:"error",value:function(I){S(this._subscription,"error",I)}},{key:"complete",value:function(){S(this._subscription,"complete")}}]),I}(),R=function(I){function g(I){if(i(this,g),!(this instanceof g))throw new TypeError("Observable cannot be called as a function");if("function"!==typeof I)throw new TypeError("Observable initializer must be a function");this._subscriber=I}return b(g,[{key:"subscribe",value:function(I,g,C){return"object"===typeof I&&null!==I||(I={next:I,error:g,complete:C}),new p(I,this._subscriber)}},{key:"pipe",value:function(I){for(var g=this,C=arguments.length,A=new Array(C>1?C-1:0),i=1;i<C;i++)A[i-1]=arguments[i];for(var c=0,G=[I].concat(A);c<G.length;c++){var l=G[c];g=l(g)}return g}},{key:"tap",value:function(I,C,A){var i=this,c="object"!==typeof I||null===I?{next:I,error:C,complete:A}:I;return new g((function(I){return i.subscribe({next:function(g){c.next&&c.next(g),I.next(g)},error:function(g){c.error&&c.error(g),I.error(g)},complete:function(){c.complete&&c.complete(),I.complete()},start:function(I){c.start&&c.start(I)}})}))}},{key:"forEach",value:function(I){var g=this;return new Promise((function(C,A){if("function"===typeof I)var i=g.subscribe({next:function(g){try{I(g,c)}catch(C){A(C),i.unsubscribe()}},error:function(I){A(I)},complete:function(){C(void 0)}});else A(new TypeError(I+" is not a function"));function c(){i.unsubscribe(),C(void 0)}}))}},{key:"map",value:function(I){var g=this;if("function"!==typeof I)throw new TypeError(I+" is not a function");return new(V(this))((function(C){return g.subscribe({next:function(g){var A=g;try{A=I(g)}catch(i){return C.error(i)}C.next(A)},error:function(I){C.error(I)},complete:function(){C.complete()}})}))}},{key:"filter",value:function(I){var g=this;if("function"!==typeof I)throw new TypeError(I+" is not a function");return new(V(this))((function(C){return g.subscribe({next:function(g){try{if(!I(g))return}catch(A){return C.error(A)}C.next(g)},error:function(I){C.error(I)},complete:function(){C.complete()}})}))}},{key:"reduce",value:function(I,g){var C=this;if("function"!==typeof I)throw new TypeError(I+" is not a function");var A=V(this),i=arguments.length>1,c=!1,G=g;return new A((function(g){return C.subscribe({next:function(C){var A=!c;if(c=!0,!A||i)try{G=I(G,C)}catch(l){return g.error(l)}else G=C},error:function(I){g.error(I)},complete:function(){if(!c&&!i)return g.error(new TypeError("Cannot reduce an empty sequence"));g.next(G),g.complete()}})}))}},{key:"concat",value:function(){for(var I=this,g=arguments.length,C=new Array(g),A=0;A<g;A++)C[A]=arguments[A];var i=V(this);return new i((function(g){var A,c=0;return function I(G){A=G.subscribe({next:function(I){g.next(I)},error:function(I){g.error(I)},complete:function(){c===C.length?(A=void 0,g.complete()):I(i.from(C[c++]))}})}(I),function(){A&&(A.unsubscribe(),A=void 0)}}))}},{key:"flatMap",value:function(I){var g=this;if("function"!==typeof I)throw new TypeError(I+" is not a function");var C=V(this);return new C((function(A){var i=[],c=g.subscribe({next:function(g){var c;if(I)try{c=I(g)}catch(b){return A.error(b)}else c=g;var l=C.from(c).subscribe({next:function(I){A.next(I)},error:function(I){A.error(I)},complete:function(){var I=i.indexOf(l);I>=0&&i.splice(I,1),G()}});i.push(l)},error:function(I){A.error(I)},complete:function(){G()}});function G(){c.closed&&0===i.length&&A.complete()}return function(){i.forEach((function(I){return I.unsubscribe()})),c.unsubscribe()}}))}},{key:I,value:function(){return this}}],[{key:"from",value:function(I){var C="function"===typeof this?this:g;if(null==I)throw new TypeError(I+" is not an object");var A=y(I,B);if(A){var i=A.call(I);if(Object(i)!==i)throw new TypeError(i+" is not an object");return h(i)&&i.constructor===C?i:new C((function(I){return i.subscribe(I)}))}if(d("iterator")){var c=y(I,e);if(c)return new C((function(g){s((function(){if(!g.closed){var C,A=n(c.call(I));try{for(A.s();!(C=A.n()).done;){var i=C.value;if(g.next(i),g.closed)return}}catch(G){A.e(G)}finally{A.f()}g.complete()}}))}))}if(Array.isArray(I))return new C((function(g){s((function(){if(!g.closed){var C,A=n(I);try{for(A.s();!(C=A.n()).done;){var i=C.value;if(g.next(i),g.closed)return}}catch(c){A.e(c)}finally{A.f()}g.complete()}}))}));throw new TypeError(I+" is not observable")}},{key:"of",value:function(){for(var I=arguments.length,C=new Array(I),A=0;A<I;A++)C[A]=arguments[A];var i="function"===typeof this?this:g;return new i((function(I){s((function(){if(!I.closed){for(var g=0,A=C;g<A.length;g++){var i=A[g];if(I.next(i),I.closed)return}I.complete()}}))}))}},{key:X,get:function(){return this}}]),g}((Symbol.observable,B));u()&&Object.defineProperty(R,Symbol("extensions"),{value:{symbol:B,hostReportError:a},configurable:!0});var H=R;var J=function(I){"function"===typeof I?I():I&&"function"===typeof I.unsubscribe&&I.unsubscribe()},F=function(I,g,C,A){return new(C||(C=Promise))((function(i,c){function G(I){try{b(A.next(I))}catch(g){c(g)}}function l(I){try{b(A.throw(I))}catch(g){c(g)}}function b(I){var g;I.done?i(I.value):(g=I.value,g instanceof C?g:new C((function(I){I(g)}))).then(G,l)}b((A=A.apply(I,g||[])).next())}))};var w=function(I){return function(g){return new H((function(C){var i=new t(C),c=g.subscribe({complete:function(){i.complete()},error:function(I){i.error(I)},next:function(g){var C=this;i.schedule((function(i){return F(C,void 0,void 0,(0,A.Z)().mark((function C(){return(0,A.Z)().wrap((function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,I(g);case 2:if(!C.sent){C.next=4;break}i(g);case 4:case"end":return C.stop()}}),C)})))}))}});return function(){return J(c)}}))}};function f(I){return I&&d("asyncIterator")&&I[Symbol.asyncIterator]}var v=function(I,g,C,A){return new(C||(C=Promise))((function(i,c){function G(I){try{b(A.next(I))}catch(g){c(g)}}function l(I){try{b(A.throw(I))}catch(g){c(g)}}function b(I){var g;I.done?i(I.value):(g=I.value,g instanceof C?g:new C((function(I){I(g)}))).then(G,l)}b((A=A.apply(I,g||[])).next())}))},x=function(I){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var g,C=I[Symbol.asyncIterator];return C?C.call(I):(I="function"===typeof __values?__values(I):I[Symbol.iterator](),g={},A("next"),A("throw"),A("return"),g[Symbol.asyncIterator]=function(){return this},g);function A(C){g[C]=I[C]&&function(g){return new Promise((function(A,i){(function(I,g,C,A){Promise.resolve(A).then((function(g){I({value:g,done:C})}),g)})(A,i,(g=I[C](g)).done,g.value)}))}}};var N=function(I){return function(g){return new H((function(C){var i=new t(C),c=g.subscribe({complete:function(){i.complete()},error:function(I){i.error(I)},next:function(g){var C=this;i.schedule((function(i){return v(C,void 0,void 0,(0,A.Z)().mark((function C(){var c,G,l,b,Z,t;return(0,A.Z)().wrap((function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,I(g);case 2:if(l=C.sent,!((A=l)&&d("iterator")&&A[Symbol.iterator]||f(l))){C.next=31;break}C.prev=4,b=x(l);case 6:return C.next=8,b.next();case 8:if((Z=C.sent).done){C.next=14;break}t=Z.value,i(t);case 12:C.next=6;break;case 14:C.next=19;break;case 16:C.prev=16,C.t0=C.catch(4),c={error:C.t0};case 19:if(C.prev=19,C.prev=20,!Z||Z.done||!(G=b.return)){C.next=24;break}return C.next=24,G.call(b);case 24:if(C.prev=24,!c){C.next=27;break}throw c.error;case 27:return C.finish(24);case 28:return C.finish(19);case 29:C.next=32;break;case 31:l.map((function(I){return i(I)}));case 32:case"end":return C.stop()}var A}),C,null,[[4,16,19,29],[20,,24,28]])})))}))}});return function(){return J(c)}}))}};function L(I){return new R((function(g){var C=0,A=setInterval((function(){g.next(C++)}),I);return function(){return clearInterval(A)}}))}var k=function(I,g,C,A){return new(C||(C=Promise))((function(i,c){function G(I){try{b(A.next(I))}catch(g){c(g)}}function l(I){try{b(A.throw(I))}catch(g){c(g)}}function b(I){var g;I.done?i(I.value):(g=I.value,g instanceof C?g:new C((function(I){I(g)}))).then(G,l)}b((A=A.apply(I,g||[])).next())}))};var T=function(I){return function(g){return new H((function(C){var i=new t(C),c=g.subscribe({complete:function(){i.complete()},error:function(I){i.error(I)},next:function(g){var C=this;i.schedule((function(i){return k(C,void 0,void 0,(0,A.Z)().mark((function C(){var c;return(0,A.Z)().wrap((function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,I(g);case 2:c=C.sent,i(c);case 4:case"end":return C.stop()}}),C)})))}))}});return function(){return J(c)}}))}};var U=function(){for(var I=arguments.length,g=new Array(I),C=0;C<I;C++)g[C]=arguments[C];return 0===g.length?R.from([]):new R((function(I){var C=0,A=g.map((function(A){return A.subscribe({error:function(g){I.error(g),i()},next:function(g){I.next(g)},complete:function(){++C===g.length&&(I.complete(),i())}})})),i=function(){A.forEach((function(I){return J(I)}))};return i}))};function z(I,g){return z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(I,g){return I.__proto__=g,I},z(I,g)}function E(I){return E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(I){return I.__proto__||Object.getPrototypeOf(I)},E(I)}function M(I,g){if(g&&("object"===(0,c.Z)(g)||"function"===typeof g))return g;if(void 0!==g)throw new TypeError("Derived constructors may only return object or undefined");return function(I){if(void 0===I)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return I}(I)}function D(I){var g=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(I){return!1}}();return function(){var C,A=E(I);if(g){var i=E(this).constructor;C=Reflect.construct(A,arguments,i)}else C=A.apply(this,arguments);return M(this,C)}}var O=function(I){!function(I,g){if("function"!==typeof g&&null!==g)throw new TypeError("Super expression must either be null or a function");I.prototype=Object.create(g&&g.prototype,{constructor:{value:I,writable:!0,configurable:!0}}),Object.defineProperty(I,"prototype",{writable:!1}),g&&z(I,g)}(C,I);var g=D(C);function C(){var I;return i(this,C),(I=g.call(this,(function(g){return I._observers.add(g),function(){return I._observers.delete(g)}})))._observers=new Set,I}return b(C,[{key:"next",value:function(I){var g,C=n(this._observers);try{for(C.s();!(g=C.n()).done;){g.value.next(I)}}catch(A){C.e(A)}finally{C.f()}}},{key:"error",value:function(I){var g,C=n(this._observers);try{for(C.s();!(g=C.n()).done;){g.value.error(I)}}catch(A){C.e(A)}finally{C.f()}}},{key:"complete",value:function(){var I,g=n(this._observers);try{for(g.s();!(I=g.n()).done;){I.value.complete()}}catch(C){g.e(C)}finally{g.f()}}}]),C}(H);var P=function(I){var g,C=new O,A=0;return new H((function(i){g||(g=I.subscribe(C));var c=C.subscribe(i);return A++,function(){A--,c.unsubscribe(),0===A&&(J(g),g=void 0)}}))},q=function(I,g,C,A){return new(C||(C=Promise))((function(i,c){function G(I){try{b(A.next(I))}catch(g){c(g)}}function l(I){try{b(A.throw(I))}catch(g){c(g)}}function b(I){var g;I.done?i(I.value):(g=I.value,g instanceof C?g:new C((function(I){I(g)}))).then(G,l)}b((A=A.apply(I,g||[])).next())}))};var j=function(I,g){return function(C){return new H((function(i){var c,G=0,l=new t(i),b=C.subscribe({complete:function(){l.complete()},error:function(I){l.error(I)},next:function(C){var i=this;l.schedule((function(l){return q(i,void 0,void 0,(0,A.Z)().mark((function i(){var b;return(0,A.Z)().wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return b=0===G?"undefined"===typeof g?C:g:c,A.next=3,I(b,C,G++);case 3:c=A.sent,l(c);case 5:case"end":return A.stop()}}),i)})))}))}});return function(){return J(b)}}))}}},5360:function(I){"use strict";function g(I){if("string"!==typeof I)throw new TypeError("Path must be a string. Received "+JSON.stringify(I))}function C(I,g){for(var C,A="",i=0,c=-1,G=0,l=0;l<=I.length;++l){if(l<I.length)C=I.charCodeAt(l);else{if(47===C)break;C=47}if(47===C){if(c===l-1||1===G);else if(c!==l-1&&2===G){if(A.length<2||2!==i||46!==A.charCodeAt(A.length-1)||46!==A.charCodeAt(A.length-2))if(A.length>2){var b=A.lastIndexOf("/");if(b!==A.length-1){-1===b?(A="",i=0):i=(A=A.slice(0,b)).length-1-A.lastIndexOf("/"),c=l,G=0;continue}}else if(2===A.length||1===A.length){A="",i=0,c=l,G=0;continue}g&&(A.length>0?A+="/..":A="..",i=2)}else A.length>0?A+="/"+I.slice(c+1,l):A=I.slice(c+1,l),i=l-c-1;c=l,G=0}else 46===C&&-1!==G?++G:G=-1}return A}var A={resolve:function(){for(var I,A="",i=!1,c=arguments.length-1;c>=-1&&!i;c--){var G;c>=0?G=arguments[c]:(void 0===I&&(I=process.cwd()),G=I),g(G),0!==G.length&&(A=G+"/"+A,i=47===G.charCodeAt(0))}return A=C(A,!i),i?A.length>0?"/"+A:"/":A.length>0?A:"."},normalize:function(I){if(g(I),0===I.length)return".";var A=47===I.charCodeAt(0),i=47===I.charCodeAt(I.length-1);return 0!==(I=C(I,!A)).length||A||(I="."),I.length>0&&i&&(I+="/"),A?"/"+I:I},isAbsolute:function(I){return g(I),I.length>0&&47===I.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var I,C=0;C<arguments.length;++C){var i=arguments[C];g(i),i.length>0&&(void 0===I?I=i:I+="/"+i)}return void 0===I?".":A.normalize(I)},relative:function(I,C){if(g(I),g(C),I===C)return"";if((I=A.resolve(I))===(C=A.resolve(C)))return"";for(var i=1;i<I.length&&47===I.charCodeAt(i);++i);for(var c=I.length,G=c-i,l=1;l<C.length&&47===C.charCodeAt(l);++l);for(var b=C.length-l,Z=G<b?G:b,t=-1,o=0;o<=Z;++o){if(o===Z){if(b>Z){if(47===C.charCodeAt(l+o))return C.slice(l+o+1);if(0===o)return C.slice(l+o)}else G>Z&&(47===I.charCodeAt(i+o)?t=o:0===o&&(t=0));break}var n=I.charCodeAt(i+o);if(n!==C.charCodeAt(l+o))break;47===n&&(t=o)}var u="";for(o=i+t+1;o<=c;++o)o!==c&&47!==I.charCodeAt(o)||(0===u.length?u+="..":u+="/..");return u.length>0?u+C.slice(l+t):(l+=t,47===C.charCodeAt(l)&&++l,C.slice(l))},_makeLong:function(I){return I},dirname:function(I){if(g(I),0===I.length)return".";for(var C=I.charCodeAt(0),A=47===C,i=-1,c=!0,G=I.length-1;G>=1;--G)if(47===(C=I.charCodeAt(G))){if(!c){i=G;break}}else c=!1;return-1===i?A?"/":".":A&&1===i?"//":I.slice(0,i)},basename:function(I,C){if(void 0!==C&&"string"!==typeof C)throw new TypeError('"ext" argument must be a string');g(I);var A,i=0,c=-1,G=!0;if(void 0!==C&&C.length>0&&C.length<=I.length){if(C.length===I.length&&C===I)return"";var l=C.length-1,b=-1;for(A=I.length-1;A>=0;--A){var Z=I.charCodeAt(A);if(47===Z){if(!G){i=A+1;break}}else-1===b&&(G=!1,b=A+1),l>=0&&(Z===C.charCodeAt(l)?-1===--l&&(c=A):(l=-1,c=b))}return i===c?c=b:-1===c&&(c=I.length),I.slice(i,c)}for(A=I.length-1;A>=0;--A)if(47===I.charCodeAt(A)){if(!G){i=A+1;break}}else-1===c&&(G=!1,c=A+1);return-1===c?"":I.slice(i,c)},extname:function(I){g(I);for(var C=-1,A=0,i=-1,c=!0,G=0,l=I.length-1;l>=0;--l){var b=I.charCodeAt(l);if(47!==b)-1===i&&(c=!1,i=l+1),46===b?-1===C?C=l:1!==G&&(G=1):-1!==C&&(G=-1);else if(!c){A=l+1;break}}return-1===C||-1===i||0===G||1===G&&C===i-1&&C===A+1?"":I.slice(C,i)},format:function(I){if(null===I||"object"!==typeof I)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof I);return function(I,g){var C=g.dir||g.root,A=g.base||(g.name||"")+(g.ext||"");return C?C===g.root?C+A:C+I+A:A}("/",I)},parse:function(I){g(I);var C={root:"",dir:"",base:"",ext:"",name:""};if(0===I.length)return C;var A,i=I.charCodeAt(0),c=47===i;c?(C.root="/",A=1):A=0;for(var G=-1,l=0,b=-1,Z=!0,t=I.length-1,o=0;t>=A;--t)if(47!==(i=I.charCodeAt(t)))-1===b&&(Z=!1,b=t+1),46===i?-1===G?G=t:1!==o&&(o=1):-1!==G&&(o=-1);else if(!Z){l=t+1;break}return-1===G||-1===b||0===o||1===o&&G===b-1&&G===l+1?-1!==b&&(C.base=C.name=0===l&&c?I.slice(1,b):I.slice(l,b)):(0===l&&c?(C.name=I.slice(1,G),C.base=I.slice(1,b)):(C.name=I.slice(l,G),C.base=I.slice(l,b)),C.ext=I.slice(G,b)),l>0?C.dir=I.slice(0,l-1):c&&(C.dir="/"),C},sep:"/",delimiter:":",win32:null,posix:null};A.posix=A,I.exports=A},3285:function(I,g,C){"use strict";var A=65536,i=4294967295;var c=C(3895).Buffer,G=C.g.crypto||C.g.msCrypto;G&&G.getRandomValues?I.exports=function(I,g){if(I>i)throw new RangeError("requested too many random bytes");var C=c.allocUnsafe(I);if(I>0)if(I>A)for(var l=0;l<I;l+=A)G.getRandomValues(C.slice(l,l+A));else G.getRandomValues(C);if("function"===typeof g)return process.nextTick((function(){g(null,C)}));return C}:I.exports=function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}},6641:function(I,g,C){"use strict";function A(){throw new Error("secure random number generation not supported by this browser\nuse chrome, FireFox or Internet Explorer 11")}var i=C(3895),c=C(3285),G=i.Buffer,l=i.kMaxLength,b=C.g.crypto||C.g.msCrypto,Z=Math.pow(2,32)-1;function t(I,g){if("number"!==typeof I||I!==I)throw new TypeError("offset must be a number");if(I>Z||I<0)throw new TypeError("offset must be a uint32");if(I>l||I>g)throw new RangeError("offset out of range")}function o(I,g,C){if("number"!==typeof I||I!==I)throw new TypeError("size must be a number");if(I>Z||I<0)throw new TypeError("size must be a uint32");if(I+g>C||I>l)throw new RangeError("buffer too small")}function n(I,g,C,A){if(process.browser){var i=I.buffer,G=new Uint8Array(i,g,C);return b.getRandomValues(G),A?void process.nextTick((function(){A(null,I)})):I}if(!A)return c(C).copy(I,g),I;c(C,(function(C,i){if(C)return A(C);i.copy(I,g),A(null,I)}))}b&&b.getRandomValues||!process.browser?(g.randomFill=function(I,g,A,i){if(!G.isBuffer(I)&&!(I instanceof C.g.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');if("function"===typeof g)i=g,g=0,A=I.length;else if("function"===typeof A)i=A,A=I.length-g;else if("function"!==typeof i)throw new TypeError('"cb" argument must be a function');return t(g,I.length),o(A,g,I.length),n(I,g,A,i)},g.randomFillSync=function(I,g,A){"undefined"===typeof g&&(g=0);if(!G.isBuffer(I)&&!(I instanceof C.g.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');t(g,I.length),void 0===A&&(A=I.length-g);return o(A,g,I.length),n(I,g,A)}):(g.randomFill=A,g.randomFillSync=A)},3895:function(I,g,C){var A=C(2016),i=A.Buffer;function c(I,g){for(var C in I)g[C]=I[C]}function G(I,g,C){return i(I,g,C)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?I.exports=A:(c(A,g),g.Buffer=G),G.prototype=Object.create(i.prototype),c(i,G),G.from=function(I,g,C){if("number"===typeof I)throw new TypeError("Argument must not be a number");return i(I,g,C)},G.alloc=function(I,g,C){if("number"!==typeof I)throw new TypeError("Argument must be a number");var A=i(I);return void 0!==g?"string"===typeof C?A.fill(g,C):A.fill(g):A.fill(0),A},G.allocUnsafe=function(I){if("number"!==typeof I)throw new TypeError("Argument must be a number");return i(I)},G.allocUnsafeSlow=function(I){if("number"!==typeof I)throw new TypeError("Argument must be a number");return A.SlowBuffer(I)}},7003:function(I,g,C){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.serialize=g.deserialize=g.registerSerializer=void 0;var A=C(7705),i=A.DefaultSerializer;g.registerSerializer=function(I){i=A.extendSerializer(i,I)},g.deserialize=function(I){return i.deserialize(I)},g.serialize=function(I){return i.serialize(I)}},913:function(I,g,C){"use strict";var A=this&&this.__createBinding||(Object.create?function(I,g,C,A){void 0===A&&(A=C),Object.defineProperty(I,A,{enumerable:!0,get:function(){return g[C]}})}:function(I,g,C,A){void 0===A&&(A=C),I[A]=g[C]}),i=this&&this.__exportStar||function(I,g){for(var C in I)"default"===C||Object.prototype.hasOwnProperty.call(g,C)||A(g,I,C)};Object.defineProperty(g,"__esModule",{value:!0}),g.Transfer=g.DefaultSerializer=g.expose=g.registerSerializer=void 0;var c=C(7003);Object.defineProperty(g,"registerSerializer",{enumerable:!0,get:function(){return c.registerSerializer}}),i(C(529),g);var G=C(9488);Object.defineProperty(g,"expose",{enumerable:!0,get:function(){return G.expose}});var l=C(7705);Object.defineProperty(g,"DefaultSerializer",{enumerable:!0,get:function(){return l.DefaultSerializer}});var b=C(2644);Object.defineProperty(g,"Transfer",{enumerable:!0,get:function(){return b.Transfer}})},8936:function(I,g){"use strict";var C;function A(I){return(""+I).replace(/^((?:https?|file|ftp|chrome-extension|moz-extension):\/\/.+)?\/[^/]+(?:\?.*)?$/,"$1")+"/"}Object.defineProperty(g,"__esModule",{value:!0}),g.getBundleURL=g.getBaseURL=void 0,g.getBundleURL=function(){return C||(C=function(){try{throw new Error}catch(g){var I=(""+g.stack).match(/(https?|file|ftp|chrome-extension|moz-extension):\/\/[^)\n]+/g);if(I)return A(I[0])}return"/"}()),C},g.getBaseURL=A},6086:function(I,g,C){"use strict";var A=C(9823).default,i=C(6982).default,c=C(2975).default,G=C(7868).default,l=C(4837).default;Object.defineProperty(g,"__esModule",{value:!0}),g.isWorkerRuntime=g.getWorkerImplementation=g.defaultPoolSize=void 0;var b=C(8936);g.defaultPoolSize="undefined"!==typeof navigator&&navigator.hardwareConcurrency?navigator.hardwareConcurrency:4;var Z,t=function(I){return/^[a-zA-Z][a-zA-Z\d+\-.]*:/.test(I)};function o(I){var g=new Blob([I],{type:"application/javascript"});return URL.createObjectURL(g)}g.getWorkerImplementation=function(){return Z||(Z=function(){if("undefined"===typeof Worker)return G((function I(){throw l(this,I),Error("No web worker implementation available. You might have tried to spawn a worker within a worker in a browser that doesn't support workers in workers.")}));var I=function(I){A(C,I);var g=i(C);function C(I,A){var i,c;return l(this,C),"string"===typeof I&&A&&A._baseURL?I=new URL(I,A._baseURL):"string"===typeof I&&!t(I)&&b.getBundleURL().match(/^file:\/\//i)&&(I=new URL(I,b.getBundleURL().replace(/\/[^\/]+$/,"/")),(null===(i=null===A||void 0===A?void 0:A.CORSWorkaround)||void 0===i||i)&&(I=o("importScripts(".concat(JSON.stringify(I),");")))),"string"===typeof I&&t(I)&&(null===(c=null===A||void 0===A?void 0:A.CORSWorkaround)||void 0===c||c)&&(I=o("importScripts(".concat(JSON.stringify(I),");"))),g.call(this,I,A)}return G(C)}(c(Worker));return{blob:function(I){A(C,I);var g=i(C);function C(I,A){l(this,C);var i=window.URL.createObjectURL(I);return g.call(this,i,A)}return G(C,null,[{key:"fromText",value:function(I,g){return new C(new window.Blob([I],{type:"text/javascript"}),g)}}]),C}(I),default:I}}()),Z},g.isWorkerRuntime=function(){var I="undefined"!==typeof self&&"undefined"!==typeof Window&&self instanceof Window;return!("undefined"===typeof self||!self.postMessage||I)}},529:function(I,g,C){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.Worker=g.BlobWorker=g.isWorkerRuntime=g.Thread=g.spawn=g.Pool=void 0;var A=C(6086);Object.defineProperty(g,"isWorkerRuntime",{enumerable:!0,get:function(){return A.isWorkerRuntime}});var i=C(5033);Object.defineProperty(g,"Pool",{enumerable:!0,get:function(){return i.Pool}});var c=C(8273);Object.defineProperty(g,"spawn",{enumerable:!0,get:function(){return c.spawn}});var G=C(6629);Object.defineProperty(g,"Thread",{enumerable:!0,get:function(){return G.Thread}}),g.BlobWorker=A.getWorkerImplementation().blob,g.Worker=A.getWorkerImplementation().default},3339:function(I,g,C){"use strict";var A=C(7329).default,i=C(1187).default,c=this&&this.__importDefault||function(I){return I&&I.__esModule?I:{default:I}};Object.defineProperty(g,"__esModule",{value:!0}),g.createProxyModule=g.createProxyFunction=void 0;var G=c(C(6087)),l=C(3889),b=C(7003),Z=C(2365),t=C(2644),o=C(9235),n=G.default("threads:master:messages"),u=1;function d(I,g){return new l.Observable((function(C){var A,i=function i(c){var G;if(n("Message from worker:",c.data),c.data&&c.data.uid===g)if((G=c.data)&&G.type===o.WorkerMessageType.running)A=c.data.resultType;else if(function(I){return I&&I.type===o.WorkerMessageType.result}(c.data))"promise"===A?("undefined"!==typeof c.data.payload&&C.next(b.deserialize(c.data.payload)),C.complete(),I.removeEventListener("message",i)):(c.data.payload&&C.next(b.deserialize(c.data.payload)),c.data.complete&&(C.complete(),I.removeEventListener("message",i)));else if(function(I){return I&&I.type===o.WorkerMessageType.error}(c.data)){var l=b.deserialize(c.data.error);C.error(l),I.removeEventListener("message",i)}};return I.addEventListener("message",i),function(){if("observable"===A||!A){var C={type:o.MasterMessageType.cancel,uid:g};I.postMessage(C)}I.removeEventListener("message",i)}}))}function m(I){if(0===I.length)return{args:[],transferables:[]};var g,C,c=[],G=[],l=i(I);try{for(l.s();!(g=l.n()).done;){var Z=g.value;t.isTransferDescriptor(Z)?(c.push(b.serialize(Z.send)),G.push.apply(G,A(Z.transferables))):c.push(b.serialize(Z))}}catch(o){l.e(o)}finally{l.f()}return{args:c,transferables:0===G.length?G:(C=G,Array.from(new Set(C)))}}function e(I,g){return function(){for(var C=u++,A=arguments.length,i=new Array(A),c=0;c<A;c++)i[c]=arguments[c];var G=m(i),b=G.args,t=G.transferables,e={type:o.MasterMessageType.run,uid:C,method:g,args:b};n("Sending command to run function to worker:",e);try{I.postMessage(e,t)}catch(B){return Z.ObservablePromise.from(Promise.reject(B))}return Z.ObservablePromise.from(l.multicast(d(I,C)))}}g.createProxyFunction=e,g.createProxyModule=function(I,g){var C,A={},c=i(g);try{for(c.s();!(C=c.n()).done;){var G=C.value;A[G]=e(I,G)}}catch(l){c.e(l)}finally{c.f()}return A}},41:function(I,g){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.PoolEventType=void 0,function(I){I.initialized="initialized",I.taskCanceled="taskCanceled",I.taskCompleted="taskCompleted",I.taskFailed="taskFailed",I.taskQueued="taskQueued",I.taskQueueDrained="taskQueueDrained",I.taskStart="taskStart",I.terminated="terminated"}(g.PoolEventType||(g.PoolEventType={}))},5033:function(I,g,C){"use strict";var A=C(6670).default,i=C(4837).default,c=C(7868).default,G=C(7329).default,l=this&&this.__awaiter||function(I,g,C,A){return new(C||(C=Promise))((function(i,c){function G(I){try{b(A.next(I))}catch(g){c(g)}}function l(I){try{b(A.throw(I))}catch(g){c(g)}}function b(I){var g;I.done?i(I.value):(g=I.value,g instanceof C?g:new C((function(I){I(g)}))).then(G,l)}b((A=A.apply(I,g||[])).next())}))},b=this&&this.__importDefault||function(I){return I&&I.__esModule?I:{default:I}};Object.defineProperty(g,"__esModule",{value:!0}),g.Pool=g.Thread=g.PoolEventType=void 0;var Z=b(C(6087)),t=C(3889),o=C(7793),n=C(6086),u=C(41);Object.defineProperty(g,"PoolEventType",{enumerable:!0,get:function(){return u.PoolEventType}});var d=C(6629);Object.defineProperty(g,"Thread",{enumerable:!0,get:function(){return d.Thread}});var m=1;function e(I){return new Promise((function(g){return setTimeout(g,I)}))}function B(I,g){return I.reduce((function(I,C){return[].concat(G(I),G(g(C)))}),[])}var X=function(){function I(g,C){var A=this;i(this,I),this.eventSubject=new t.Subject,this.initErrors=[],this.isClosing=!1,this.nextTaskID=1,this.taskQueue=[];var c="number"===typeof C?{size:C}:C||{},G=c.size,l=void 0===G?n.defaultPoolSize:G;this.debug=Z.default("threads:pool:".concat((c.name||String(m++)).replace(/\W/g," ").trim().replace(/\s+/g,"-"))),this.options=c,this.workers=function(I,g){return function(I){for(var g=[],C=0;C<I;C++)g.push(C);return g}(g).map((function(){return{init:I(),runningTasks:[]}}))}(g,l),this.eventObservable=t.multicast(t.Observable.from(this.eventSubject)),Promise.all(this.workers.map((function(I){return I.init}))).then((function(){return A.eventSubject.next({type:u.PoolEventType.initialized,size:A.workers.length})}),(function(I){A.debug("Error while initializing pool worker:",I),A.eventSubject.error(I),A.initErrors.push(I)}))}return c(I,[{key:"findIdlingWorker",value:function(){var I=this.options.concurrency,g=void 0===I?1:I;return this.workers.find((function(I){return I.runningTasks.length<g}))}},{key:"runPoolTask",value:function(I,g){return l(this,void 0,void 0,A().mark((function C(){var i,c;return A().wrap((function(C){for(;;)switch(C.prev=C.next){case 0:return i=this.workers.indexOf(I)+1,this.debug("Running task #".concat(g.id," on worker #").concat(i,"...")),this.eventSubject.next({type:u.PoolEventType.taskStart,taskID:g.id,workerID:i}),C.prev=3,C.t0=g,C.next=7,I.init;case 7:return C.t1=C.sent,C.next=10,C.t0.run.call(C.t0,C.t1);case 10:c=C.sent,this.debug("Task #".concat(g.id," completed successfully")),this.eventSubject.next({type:u.PoolEventType.taskCompleted,returnValue:c,taskID:g.id,workerID:i}),C.next=19;break;case 15:C.prev=15,C.t2=C.catch(3),this.debug("Task #".concat(g.id," failed")),this.eventSubject.next({type:u.PoolEventType.taskFailed,taskID:g.id,error:C.t2,workerID:i});case 19:case"end":return C.stop()}}),C,this,[[3,15]])})))}},{key:"run",value:function(I,g){return l(this,void 0,void 0,A().mark((function C(){var i,c=this;return A().wrap((function(C){for(;;)switch(C.prev=C.next){case 0:i=l(c,void 0,void 0,A().mark((function C(){var c;return A().wrap((function(C){for(;;)switch(C.prev=C.next){case 0:return c=function(){I.runningTasks=I.runningTasks.filter((function(I){return I!==i}))},C.next=3,e(0);case 3:return C.prev=3,C.next=6,this.runPoolTask(I,g);case 6:return C.prev=6,c(),this.isClosing||this.scheduleWork(),C.finish(6);case 10:case"end":return C.stop()}}),C,this,[[3,,6,10]])}))),I.runningTasks.push(i);case 2:case"end":return C.stop()}}),C)})))}},{key:"scheduleWork",value:function(){this.debug("Attempt de-queueing a task in order to run it...");var I=this.findIdlingWorker();if(I){var g=this.taskQueue.shift();if(!g)return this.debug("Task queue is empty"),void this.eventSubject.next({type:u.PoolEventType.taskQueueDrained});this.run(I,g)}}},{key:"taskCompletion",value:function(I){var g=this;return new Promise((function(C,A){var i=g.events().subscribe((function(g){g.type===u.PoolEventType.taskCompleted&&g.taskID===I?(i.unsubscribe(),C(g.returnValue)):g.type===u.PoolEventType.taskFailed&&g.taskID===I?(i.unsubscribe(),A(g.error)):g.type===u.PoolEventType.terminated&&(i.unsubscribe(),A(Error("Pool has been terminated before task was run.")))}))}))}},{key:"settled",value:function(){var I=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return l(this,void 0,void 0,A().mark((function g(){var C,i,c,G=this;return A().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(C=function(){return B(G.workers,(function(I){return I.runningTasks}))},i=[],c=this.eventObservable.subscribe((function(I){I.type===u.PoolEventType.taskFailed&&i.push(I.error)})),!(this.initErrors.length>0)){g.next=5;break}return g.abrupt("return",Promise.reject(this.initErrors[0]));case 5:if(!I||0!==this.taskQueue.length){g.next=9;break}return g.next=8,o.allSettled(C());case 8:return g.abrupt("return",i);case 9:return g.next=11,new Promise((function(I,g){var C=G.eventObservable.subscribe({next:function(g){g.type===u.PoolEventType.taskQueueDrained&&(C.unsubscribe(),I(void 0))},error:g})}));case 11:return g.next=13,o.allSettled(C());case 13:return c.unsubscribe(),g.abrupt("return",i);case 15:case"end":return g.stop()}}),g,this)})))}},{key:"completed",value:function(){var I=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return l(this,void 0,void 0,A().mark((function g(){var C,i,c,G=this;return A().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return C=this.settled(I),i=new Promise((function(I,g){var A=G.eventObservable.subscribe({next:function(i){i.type===u.PoolEventType.taskQueueDrained?(A.unsubscribe(),I(C)):i.type===u.PoolEventType.taskFailed&&(A.unsubscribe(),g(i.error))},error:g})})),g.next=4,Promise.race([C,i]);case 4:if(!((c=g.sent).length>0)){g.next=7;break}throw c[0];case 7:case"end":return g.stop()}}),g,this)})))}},{key:"events",value:function(){return this.eventObservable}},{key:"queue",value:function(I){var g=this,C=this.options.maxQueuedJobs,A=void 0===C?1/0:C;if(this.isClosing)throw Error("Cannot schedule pool tasks after terminate() has been called.");if(this.initErrors.length>0)throw this.initErrors[0];var i=this.nextTaskID++,c=this.taskCompletion(i);c.catch((function(I){g.debug("Task #".concat(i," errored:"),I)}));var G={id:i,run:I,cancel:function(){-1!==g.taskQueue.indexOf(G)&&(g.taskQueue=g.taskQueue.filter((function(I){return I!==G})),g.eventSubject.next({type:u.PoolEventType.taskCanceled,taskID:G.id}))},then:c.then.bind(c)};if(this.taskQueue.length>=A)throw Error("Maximum number of pool tasks queued. Refusing to queue another one.\nThis usually happens for one of two reasons: We are either at peak workload right now or some tasks just won't finish, thus blocking the pool.");return this.debug("Queueing task #".concat(G.id,"...")),this.taskQueue.push(G),this.eventSubject.next({type:u.PoolEventType.taskQueued,taskID:G.id}),this.scheduleWork(),G}},{key:"terminate",value:function(I){return l(this,void 0,void 0,A().mark((function g(){var C=this;return A().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(this.isClosing=!0,I){g.next=4;break}return g.next=4,this.completed(!0);case 4:return this.eventSubject.next({type:u.PoolEventType.terminated,remainingQueue:G(this.taskQueue)}),this.eventSubject.complete(),g.next=8,Promise.all(this.workers.map((function(I){return l(C,void 0,void 0,A().mark((function g(){return A().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.t0=d.Thread,g.next=3,I.init;case 3:return g.t1=g.sent,g.abrupt("return",g.t0.terminate.call(g.t0,g.t1));case 5:case"end":return g.stop()}}),g)})))})));case 8:case"end":return g.stop()}}),g,this)})))}}]),I}();function y(I,g){return new X(I,g)}X.EventType=u.PoolEventType,y.EventType=u.PoolEventType,g.Pool=y},8273:function(I,g,C){"use strict";var A=C(8726).default,i=C(6843).default,c=C(6670).default,G=this&&this.__awaiter||function(I,g,C,A){return new(C||(C=Promise))((function(i,c){function G(I){try{b(A.next(I))}catch(g){c(g)}}function l(I){try{b(A.throw(I))}catch(g){c(g)}}function b(I){var g;I.done?i(I.value):(g=I.value,g instanceof C?g:new C((function(I){I(g)}))).then(G,l)}b((A=A.apply(I,g||[])).next())}))},l=this&&this.__importDefault||function(I){return I&&I.__esModule?I:{default:I}};Object.defineProperty(g,"__esModule",{value:!0}),g.spawn=void 0;var b=l(C(6087)),Z=C(3889),t=C(7003),o=C(4642),n=C(6179),u=C(5893),d=C(3339),m=b.default("threads:master:messages"),e=b.default("threads:master:spawn"),B=b.default("threads:master:thread-utils"),X="undefined"!==typeof process&&{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.THREADS_WORKER_INIT_TIMEOUT?Number.parseInt({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.THREADS_WORKER_INIT_TIMEOUT,10):1e4;function y(I,g,C){return G(this,void 0,void 0,c().mark((function A(){var i,G,l;return c().wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return G=new Promise((function(I,A){i=setTimeout((function(){return A(Error(C))}),g)})),A.next=3,Promise.race([I,G]);case 3:return l=A.sent,clearTimeout(i),A.abrupt("return",l);case 6:case"end":return A.stop()}}),A)})))}function V(I){return new Promise((function(g,C){I.addEventListener("message",(function A(i){var c;m("Message from worker before finishing initialization:",i.data),(c=i.data)&&"init"===c.type?(I.removeEventListener("message",A),g(i.data)):function(I){return I&&"uncaughtError"===I.type}(i.data)&&(I.removeEventListener("message",A),C(t.deserialize(i.data.error)))}))}))}function h(I,g){return new Z.Observable((function(C){var A=function(I){var g={type:u.WorkerEventType.message,data:I.data};C.next(g)},i=function(I){B("Unhandled promise rejection event in thread:",I);var g={type:u.WorkerEventType.internalError,error:Error(I.reason)};C.next(g)};I.addEventListener("message",A),I.addEventListener("unhandledrejection",i),g.then((function(){var g={type:u.WorkerEventType.termination};I.removeEventListener("message",A),I.removeEventListener("unhandledrejection",i),C.next(g),C.complete()}))}))}function a(I){var g=this,C=o.createPromiseWithResolver(),A=i(C,2),l=A[0],b=A[1];return{terminate:function(){return G(g,void 0,void 0,c().mark((function g(){return c().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return B("Terminating worker"),g.next=3,I.terminate();case 3:b();case 4:case"end":return g.stop()}}),g)})))},termination:l}}function s(I,g,C,i){var c,G=C.filter((function(I){return I.type===u.WorkerEventType.internalError})).map((function(I){return I.error}));return Object.assign(I,(A(c={},n.$errors,G),A(c,n.$events,C),A(c,n.$terminate,i),A(c,n.$worker,g),c))}g.spawn=function(I,g){return G(this,void 0,void 0,c().mark((function C(){var A,i,G,l,b,Z,t,o,n,u;return c().wrap((function(C){for(;;)switch(C.prev=C.next){case 0:return e("Initializing new thread"),A=g&&g.timeout?g.timeout:X,C.next=4,y(V(I),A,"Timeout: Did not receive an init message from worker after ".concat(A,"ms. Make sure the worker calls expose()."));case 4:if(i=C.sent,G=i.exposed,l=a(I),b=l.termination,Z=l.terminate,t=h(I,b),"function"!==G.type){C.next=13;break}return o=d.createProxyFunction(I),C.abrupt("return",s(o,I,t,Z));case 13:if("module"!==G.type){C.next=18;break}return n=d.createProxyModule(I,G.methods),C.abrupt("return",s(n,I,t,Z));case 18:throw u=G.type,Error("Worker init message states unexpected type of expose(): ".concat(u));case 20:case"end":return C.stop()}}),C)})))}},6629:function(I,g,C){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.Thread=void 0;var A=C(6179);function i(I){throw Error(I)}g.Thread={errors:function(I){return I[A.$errors]||i("Error observable not found. Make sure to pass a thread instance as returned by the spawn() promise.")},events:function(I){return I[A.$events]||i("Events observable not found. Make sure to pass a thread instance as returned by the spawn() promise.")},terminate:function(I){return I[A.$terminate]()}}},2365:function(I,g,C){"use strict";var A=C(1187).default,i=C(4837).default,c=C(7868).default,G=C(36).default,l=C(8136).default,b=C(9663).default,Z=C(9823).default,t=C(6982).default;Object.defineProperty(g,"__esModule",{value:!0}),g.ObservablePromise=void 0;var o=C(3889),n=function(){},u=function(I){return I},d=function(I){return Promise.resolve().then(I)};function m(I){throw I}var e=function(I){Z(C,I);var g=t(C);function C(I){var A;return i(this,C),(A=g.call(this,(function(g){var C=G(A),i=Object.assign(Object.assign({},g),{complete:function(){g.complete(),C.onCompletion()},error:function(I){g.error(I),C.onError(I)},next:function(I){g.next(I),C.onNext(I)}});try{return A.initHasRun=!0,I(i)}catch(c){i.error(c)}}))).initHasRun=!1,A.fulfillmentCallbacks=[],A.rejectionCallbacks=[],A.firstValueSet=!1,A.state="pending",A}return c(C,[{key:"onNext",value:function(I){this.firstValueSet||(this.firstValue=I,this.firstValueSet=!0)}},{key:"onError",value:function(I){this.state="rejected",this.rejection=I;var g,C=A(this.rejectionCallbacks);try{var i=function(){var C=g.value;d((function(){return C(I)}))};for(C.s();!(g=C.n()).done;)i()}catch(c){C.e(c)}finally{C.f()}}},{key:"onCompletion",value:function(){var I=this;this.state="fulfilled";var g,C=A(this.fulfillmentCallbacks);try{var i=function(){var C=g.value;d((function(){return C(I.firstValue)}))};for(C.s();!(g=C.n()).done;)i()}catch(c){C.e(c)}finally{C.f()}}},{key:"then",value:function(I,g){var C=this,A=I||u,i=g||m,c=!1;return new Promise((function(I,g){var G=function(C){if(!c){c=!0;try{I(i(C))}catch(A){g(A)}}};return C.initHasRun||C.subscribe({error:G}),"fulfilled"===C.state?I(A(C.firstValue)):"rejected"===C.state?(c=!0,I(i(C.rejection))):(C.fulfillmentCallbacks.push((function(g){try{I(A(g))}catch(C){G(C)}})),void C.rejectionCallbacks.push(G))}))}},{key:"catch",value:function(I){return this.then(void 0,I)}},{key:"finally",value:function(I){var g=I||n;return this.then((function(I){return g(),I}),(function(){return g()}))}}],[{key:"from",value:function(I){return function(I){return I&&"function"===typeof I.then}(I)?new C((function(g){I.then((function(I){g.next(I),g.complete()}),(function(I){g.error(I)}))})):l(b(C),"from",this).call(this,I)}}]),C}(o.Observable);g.ObservablePromise=e},7793:function(I,g){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.allSettled=void 0,g.allSettled=function(I){return Promise.all(I.map((function(I){var g=Promise.resolve(I);try{return g.then((function(I){return{status:"fulfilled",value:I}}),(function(I){return{status:"rejected",reason:I}}))}catch(C){return Promise.reject(C)}})))}},4642:function(I,g){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.createPromiseWithResolver=void 0;var C=function(){};g.createPromiseWithResolver=function(){var I,g=!1,A=C;return[new Promise((function(C){g?C(I):A=C})),function(C){g=!0,A(I=C)}]}},7705:function(I,g){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.DefaultSerializer=g.extendSerializer=void 0,g.extendSerializer=function(I,g){var C=I.deserialize.bind(I),A=I.serialize.bind(I);return{deserialize:function(I){return g.deserialize(I,C)},serialize:function(I){return g.serialize(I,A)}}};var C=function(I){return Object.assign(Error(I.message),{name:I.name,stack:I.stack})},A=function(I){return{__error_marker:"$$error",message:I.message,name:I.name,stack:I.stack}};g.DefaultSerializer={deserialize:function(I){return(g=I)&&"object"===typeof g&&"__error_marker"in g&&"$$error"===g.__error_marker?C(I):I;var g},serialize:function(I){return I instanceof Error?A(I):I}}},6179:function(I,g){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.$worker=g.$transferable=g.$terminate=g.$events=g.$errors=void 0,g.$errors=Symbol("thread.errors"),g.$events=Symbol("thread.events"),g.$terminate=Symbol("thread.terminate"),g.$transferable=Symbol("thread.transferable"),g.$worker=Symbol("thread.worker")},2644:function(I,g,C){"use strict";var A=C(8726).default;Object.defineProperty(g,"__esModule",{value:!0}),g.Transfer=g.isTransferDescriptor=void 0;var i=C(6179);g.isTransferDescriptor=function(I){return I&&"object"===typeof I&&I[i.$transferable]},g.Transfer=function(I,g){var C,c;if(!g){if(!(c=I)||"object"!==typeof c)throw Error();g=[I]}return A(C={},i.$transferable,!0),A(C,"send",I),A(C,"transferables",g),C}},5893:function(I,g,C){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.WorkerEventType=void 0;C(6179);!function(I){I.internalError="internalError",I.message="message",I.termination="termination"}(g.WorkerEventType||(g.WorkerEventType={}))},9235:function(I,g){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.WorkerMessageType=g.MasterMessageType=void 0,function(I){I.cancel="cancel",I.run="run"}(g.MasterMessageType||(g.MasterMessageType={})),function(I){I.error="error",I.init="init",I.result="result",I.running="running",I.uncaughtError="uncaughtError"}(g.WorkerMessageType||(g.WorkerMessageType={}))},2617:function(I,g){"use strict";Object.defineProperty(g,"__esModule",{value:!0});g.default={isWorkerRuntime:function(){var I="undefined"!==typeof self&&"undefined"!==typeof Window&&self instanceof Window;return!("undefined"===typeof self||!self.postMessage||I)},postMessageToMaster:function(I,g){self.postMessage(I,g)},subscribeToMasterMessages:function(I){var g=function(g){I(g.data)};return self.addEventListener("message",g),function(){self.removeEventListener("message",g)}}}},9488:function(I,g,C){"use strict";var A=C(6670).default,i=C(7329).default,c=this&&this.__awaiter||function(I,g,C,A){return new(C||(C=Promise))((function(i,c){function G(I){try{b(A.next(I))}catch(g){c(g)}}function l(I){try{b(A.throw(I))}catch(g){c(g)}}function b(I){var g;I.done?i(I.value):(g=I.value,g instanceof C?g:new C((function(I){I(g)}))).then(G,l)}b((A=A.apply(I,g||[])).next())}))},G=this&&this.__importDefault||function(I){return I&&I.__esModule?I:{default:I}};Object.defineProperty(g,"__esModule",{value:!0}),g.expose=g.isWorkerRuntime=g.Transfer=g.registerSerializer=void 0;var l=G(C(8732)),b=C(7003),Z=C(2644),t=C(9235),o=G(C(2617)),n=C(7003);Object.defineProperty(g,"registerSerializer",{enumerable:!0,get:function(){return n.registerSerializer}});var u=C(2644);Object.defineProperty(g,"Transfer",{enumerable:!0,get:function(){return u.Transfer}}),g.isWorkerRuntime=o.default.isWorkerRuntime;var d=!1,m=new Map,e=function(I){return I&&I.type===t.MasterMessageType.run},B=function(I){return l.default(I)||function(I){return I&&"object"===typeof I&&"function"===typeof I.subscribe}(I)};function X(I){return Z.isTransferDescriptor(I)?{payload:I.send,transferables:I.transferables}:{payload:I,transferables:void 0}}function y(I,g){var C=X(g),A=C.payload,i=C.transferables,c={type:t.WorkerMessageType.error,uid:I,error:b.serialize(A)};o.default.postMessageToMaster(c,i)}function V(I,g,C){var A=X(C),i=A.payload,c=A.transferables,G={type:t.WorkerMessageType.result,uid:I,complete:!!g||void 0,payload:i};o.default.postMessageToMaster(G,c)}function h(I,g){var C={type:t.WorkerMessageType.running,uid:I,resultType:g};o.default.postMessageToMaster(C)}function a(I){try{var g={type:t.WorkerMessageType.uncaughtError,error:b.serialize(I)};o.default.postMessageToMaster(g)}catch(C){console.error("Not reporting uncaught error back to master thread as it occured while reporting an uncaught error already.\nLatest error:",C,"\nOriginal error:",I)}}function s(I,g,C){return c(this,void 0,void 0,A().mark((function c(){var G,l,Z,t;return A().wrap((function(A){for(;;)switch(A.prev=A.next){case 0:A.prev=0,G=g.apply(void 0,i(C)),A.next=7;break;case 4:return A.prev=4,A.t0=A.catch(0),A.abrupt("return",y(I,A.t0));case 7:if(l=B(G)?"observable":"promise",h(I,l),!B(G)){A.next=14;break}Z=G.subscribe((function(g){return V(I,!1,b.serialize(g))}),(function(g){y(I,b.serialize(g)),m.delete(I)}),(function(){V(I,!0),m.delete(I)})),m.set(I,Z),A.next=24;break;case 14:return A.prev=14,A.next=17,G;case 17:t=A.sent,V(I,!0,b.serialize(t)),A.next=24;break;case 21:A.prev=21,A.t1=A.catch(14),y(I,b.serialize(A.t1));case 24:case"end":return A.stop()}}),c,null,[[0,4],[14,21]])})))}g.expose=function(I){if(!o.default.isWorkerRuntime())throw Error("expose() called in the master thread.");if(d)throw Error("expose() called more than once. This is not possible. Pass an object to expose() if you want to expose multiple functions.");if(d=!0,"function"===typeof I)o.default.subscribeToMasterMessages((function(g){e(g)&&!g.method&&s(g.uid,I,g.args.map(b.deserialize))})),function(){var I={type:t.WorkerMessageType.init,exposed:{type:"function"}};o.default.postMessageToMaster(I)}();else{if("object"!==typeof I||!I)throw Error("Invalid argument passed to expose(). Expected a function or an object, got: ".concat(I));o.default.subscribeToMasterMessages((function(g){e(g)&&g.method&&s(g.uid,I[g.method],g.args.map(b.deserialize))})),function(I){var g={type:t.WorkerMessageType.init,exposed:{type:"module",methods:I}};o.default.postMessageToMaster(g)}(Object.keys(I).filter((function(g){return"function"===typeof I[g]})))}o.default.subscribeToMasterMessages((function(I){if((A=I)&&A.type===t.MasterMessageType.cancel){var g=I.uid,C=m.get(g);C&&(C.unsubscribe(),m.delete(g))}var A}))},"undefined"!==typeof self&&"function"===typeof self.addEventListener&&o.default.isWorkerRuntime()&&(self.addEventListener("error",(function(I){setTimeout((function(){return a(I.error||I)}),250)})),self.addEventListener("unhandledrejection",(function(I){var g=I.reason;g&&"string"===typeof g.message&&setTimeout((function(){return a(g)}),250)}))),"undefined"!==typeof process&&"function"===typeof process.on&&o.default.isWorkerRuntime()&&(process.on("uncaughtException",(function(I){setTimeout((function(){return a(I)}),250)})),process.on("unhandledRejection",(function(I){I&&"string"===typeof I.message&&setTimeout((function(){return a(I)}),250)})))},5077:function(I,g){"use strict";var C=this&&this.__awaiter||function(I,g,C,A){return new(C||(C=Promise))((function(i,c){function G(I){try{b(A.next(I))}catch(g){c(g)}}function l(I){try{b(A.throw(I))}catch(g){c(g)}}function b(I){var g;I.done?i(I.value):(g=I.value,g instanceof C?g:new C((function(I){I(g)}))).then(G,l)}b((A=A.apply(I,g||[])).next())}))},A=this&&this.__generator||function(I,g){var C,A,i,c,G={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return c={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function l(c){return function(l){return function(c){if(C)throw new TypeError("Generator is already executing.");for(;G;)try{if(C=1,A&&(i=2&c[0]?A.return:c[0]?A.throw||((i=A.return)&&i.call(A),0):A.next)&&!(i=i.call(A,c[1])).done)return i;switch(A=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return G.label++,{value:c[1],done:!1};case 5:G.label++,A=c[1],c=[0];continue;case 7:c=G.ops.pop(),G.trys.pop();continue;default:if(!(i=(i=G.trys).length>0&&i[i.length-1])&&(6===c[0]||2===c[0])){G=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){G.label=c[1];break}if(6===c[0]&&G.label<i[1]){G.label=i[1],i=c;break}if(i&&G.label<i[2]){G.label=i[2],G.ops.push(c);break}i[2]&&G.ops.pop(),G.trys.pop();continue}c=g.call(I,G)}catch(l){c=[6,l],A=0}finally{C=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}};Object.defineProperty(g,"__esModule",{value:!0}),g.LazyLoader=g.FluenceConnection=void 0;var i=function(){};g.FluenceConnection=i;var c=function(){function I(I){this.loadValue=I,this.value=null}return I.prototype.getValue=function(){if(null==this.value)throw new Error("Value has not been loaded. Call `start` method to load the value.");return this.value},I.prototype.start=function(){return C(this,void 0,void 0,(function(){var I;return A(this,(function(g){switch(g.label){case 0:return null!==this.value?[2]:(I=this,[4,this.loadValue()]);case 1:return I.value=g.sent(),[2]}}))}))},I.prototype.stop=function(){return C(this,void 0,void 0,(function(){return A(this,(function(I){return[2]}))}))},I}();g.LazyLoader=c},2064:function(I,g,C){"use strict";var A=this&&this.__awaiter||function(I,g,C,A){return new(C||(C=Promise))((function(i,c){function G(I){try{b(A.next(I))}catch(g){c(g)}}function l(I){try{b(A.throw(I))}catch(g){c(g)}}function b(I){var g;I.done?i(I.value):(g=I.value,g instanceof C?g:new C((function(I){I(g)}))).then(G,l)}b((A=A.apply(I,g||[])).next())}))},i=this&&this.__generator||function(I,g){var C,A,i,c,G={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return c={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function l(c){return function(l){return function(c){if(C)throw new TypeError("Generator is already executing.");for(;G;)try{if(C=1,A&&(i=2&c[0]?A.return:c[0]?A.throw||((i=A.return)&&i.call(A),0):A.next)&&!(i=i.call(A,c[1])).done)return i;switch(A=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return G.label++,{value:c[1],done:!1};case 5:G.label++,A=c[1],c=[0];continue;case 7:c=G.ops.pop(),G.trys.pop();continue;default:if(!(i=(i=G.trys).length>0&&i[i.length-1])&&(6===c[0]||2===c[0])){G=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){G.label=c[1];break}if(6===c[0]&&G.label<i[1]){G.label=i[1],i=c;break}if(i&&G.label<i[2]){G.label=i[2],G.ops.push(c);break}i[2]&&G.ops.pop(),G.trys.pop();continue}c=g.call(I,G)}catch(l){c=[6,l],A=0}finally{C=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}};Object.defineProperty(g,"__esModule",{value:!0}),g.MarineBackgroundRunner=void 0;var c=C(1901),G=C(913),l=function(){function I(I,g,C){this.workerLoader=I,this.controlModuleLoader=g,this.logFunction=C}return I.prototype.start=function(){return A(this,void 0,void 0,(function(){var I,g,C;return i(this,(function(A){switch(A.label){case 0:return this.workerThread?[2]:[4,this.workerLoader.start()];case 1:return A.sent(),[4,this.controlModuleLoader.start()];case 2:return A.sent(),I=this.workerLoader.getValue(),g=this.controlModuleLoader.getValue(),C=this,[4,(0,G.spawn)(I,{timeout:99999999})];case 3:return C.workerThread=A.sent(),this.workerThread.onLogMessage().subscribe(this.logFunction),[4,this.workerThread.init(g)];case 4:return A.sent(),[2]}}))}))},I.prototype.createService=function(I,g,C){if(!this.workerThread)throw"Worker is not initialized";var A=C?(0,c.logLevelToEnv)(C):{};return this.workerThread.createService(I,g,void 0,A)},I.prototype.callService=function(I,g,C,A){if(!this.workerThread)throw"Worker is not initialized";return this.workerThread.callService(I,g,C,A)},I.prototype.stop=function(){return A(this,void 0,void 0,(function(){return i(this,(function(I){switch(I.label){case 0:return this.workerThread?[4,this.workerThread.terminate()]:[2];case 1:return I.sent(),[4,G.Thread.terminate(this.workerThread)];case 2:return I.sent(),[2]}}))}))},I}();g.MarineBackgroundRunner=l},5338:function(I,g,C){"use strict";var A=this&&this.__extends||function(){var I=function(g,C){return I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,g){I.__proto__=g}||function(I,g){for(var C in g)Object.prototype.hasOwnProperty.call(g,C)&&(I[C]=g[C])},I(g,C)};return function(g,C){if("function"!==typeof C&&null!==C)throw new TypeError("Class extends value "+String(C)+" is not a constructor or null");function A(){this.constructor=g}I(g,C),g.prototype=null===C?Object.create(C):(A.prototype=C.prototype,new A)}}(),i=this&&this.__awaiter||function(I,g,C,A){return new(C||(C=Promise))((function(i,c){function G(I){try{b(A.next(I))}catch(g){c(g)}}function l(I){try{b(A.throw(I))}catch(g){c(g)}}function b(I){var g;I.done?i(I.value):(g=I.value,g instanceof C?g:new C((function(I){I(g)}))).then(G,l)}b((A=A.apply(I,g||[])).next())}))},c=this&&this.__generator||function(I,g){var C,A,i,c,G={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return c={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function l(c){return function(l){return function(c){if(C)throw new TypeError("Generator is already executing.");for(;G;)try{if(C=1,A&&(i=2&c[0]?A.return:c[0]?A.throw||((i=A.return)&&i.call(A),0):A.next)&&!(i=i.call(A,c[1])).done)return i;switch(A=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return G.label++,{value:c[1],done:!1};case 5:G.label++,A=c[1],c=[0];continue;case 7:c=G.ops.pop(),G.trys.pop();continue;default:if(!(i=(i=G.trys).length>0&&i[i.length-1])&&(6===c[0]||2===c[0])){G=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){G.label=c[1];break}if(6===c[0]&&G.label<i[1]){G.label=i[1],i=c;break}if(i&&G.label<i[2]){G.label=i[2],G.ops.push(c);break}i[2]&&G.ops.pop(),G.trys.pop();continue}c=g.call(I,G)}catch(l){c=[6,l],A=0}finally{C=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},G=this&&this.__importDefault||function(I){return I&&I.__esModule?I:{default:I}};Object.defineProperty(g,"__esModule",{value:!0}),g.InlinedWorkerLoader=g.WasmWebLoader=g.loadWasmFromServer=void 0;var l=C(913),b=C(2016),Z=C(5077),t=C(8698),o=G(C(8031)),n=function(I){var g=new SharedArrayBuffer(I.length);return new Uint8Array(g).set(I,0),g};g.loadWasmFromServer=function(I){return i(void 0,void 0,void 0,(function(){var g,C,A;return c(this,(function(i){switch(i.label){case 0:return g=window.location.origin+"/"+I,[4,fetch(g)];case 1:return[4,i.sent().arrayBuffer()];case 2:return C=i.sent(),new Uint8Array(C),A=b.Buffer.from(C),crossOriginIsolated?[2,n(A)]:[2,A]}}))}))};var u=function(I){function C(C){return I.call(this,(function(){return(0,g.loadWasmFromServer)(C)}))||this}return A(C,I),C}(Z.LazyLoader);g.WasmWebLoader=u;var d=function(I){function g(){return I.call(this,(function(){var I=(0,t.fromBase64)(o.default);return Promise.resolve(l.BlobWorker.fromText(I))}))||this}return A(g,I),g}(Z.LazyLoader);g.InlinedWorkerLoader=d},8031:function(I,g){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.default="LyoKICogQVRURU5USU9OOiBUaGUgImV2YWwiIGRldnRvb2wgaGFzIGJlZW4gdXNlZCAobWF5YmUgYnkgZGVmYXVsdCBpbiBtb2RlOiAiZGV2ZWxvcG1lbnQiKS4KICogVGhpcyBkZXZ0b29sIGlzIG5laXRoZXIgbWFkZSBmb3IgcHJvZHVjdGlvbiBub3IgZm9yIHJlYWRhYmxlIG91dHB1dCBmaWxlcy4KICogSXQgdXNlcyAiZXZhbCgpIiBjYWxscyB0byBjcmVhdGUgYSBzZXBhcmF0ZSBzb3VyY2UgZmlsZSBpbiB0aGUgYnJvd3NlciBkZXZ0b29scy4KICogSWYgeW91IGFyZSB0cnlpbmcgdG8gcmVhZCB0aGUgb3V0cHV0IGZpbGUsIHNlbGVjdCBhIGRpZmZlcmVudCBkZXZ0b29sIChodHRwczovL3dlYnBhY2suanMub3JnL2NvbmZpZ3VyYXRpb24vZGV2dG9vbC8pCiAqIG9yIGRpc2FibGUgdGhlIGRlZmF1bHQgZGV2dG9vbCB3aXRoICJkZXZ0b29sOiBmYWxzZSIuCiAqIElmIHlvdSBhcmUgbG9va2luZyBmb3IgcHJvZHVjdGlvbi1yZWFkeSBvdXRwdXQgZmlsZXMsIHNlZSBtb2RlOiAicHJvZHVjdGlvbiIgKGh0dHBzOi8vd2VicGFjay5qcy5vcmcvY29uZmlndXJhdGlvbi9tb2RlLykuCiAqLwovKioqKioqLyAoKCkgPT4geyAvLyB3ZWJwYWNrQm9vdHN0cmFwCi8qKioqKiovIAkidXNlIHN0cmljdCI7Ci8qKioqKiovIAl2YXIgX193ZWJwYWNrX21vZHVsZXNfXyA9ICh7CgovKioqLyAiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0BmbHVlbmNlbGFicyttYXJpbmUtanNAMC4zLjM4L25vZGVfbW9kdWxlcy9AZmx1ZW5jZWxhYnMvbWFyaW5lLWpzL2Rpc3QvTWFyaW5lU2VydmljZS5qcyI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0BmbHVlbmNlbGFicyttYXJpbmUtanNAMC4zLjM4L25vZGVfbW9kdWxlcy9AZmx1ZW5jZWxhYnMvbWFyaW5lLWpzL2Rpc3QvTWFyaW5lU2VydmljZS5qcyAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKGZ1bmN0aW9uKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpldmFsKCJcbi8qXG4gKiBDb3B5cmlnaHQgMjAyMiBGbHVlbmNlIExhYnMgTGltaXRlZFxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xudmFyIF9fYXNzaWduID0gKHRoaXMgJiYgdGhpcy5fX2Fzc2lnbikgfHwgZnVuY3Rpb24gKCkge1xuICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiAodCkge1xuICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcbiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07XG4gICAgICAgICAgICBmb3IgKHZhciBwIGluIHMpXG4gICAgICAgICAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSlcbiAgICAgICAgICAgICAgICAgICAgdFtwXSA9IHNbcF07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHQ7XG4gICAgfTtcbiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn07XG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7XG4gICAgICAgICAgICBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7XG4gICAgICAgICAgICBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG52YXIgX19nZW5lcmF0b3IgPSAodGhpcyAmJiB0aGlzLl9fZ2VuZXJhdG9yKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgYm9keSkge1xuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24gKCkgeyBpZiAodFswXSAmIDEpXG4gICAgICAgICAgICB0aHJvdyB0WzFdOyByZXR1cm4gdFsxXTsgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZztcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IHJldHVybiBmdW5jdGlvbiAodikgeyByZXR1cm4gc3RlcChbbiwgdl0pOyB9OyB9XG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xuICAgICAgICBpZiAoZilcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xuICAgICAgICB3aGlsZSAoXylcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0O1xuICAgICAgICAgICAgICAgIGlmICh5ID0gMCwgdClcbiAgICAgICAgICAgICAgICAgICAgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgdCA9IG9wO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgIF8ubGFiZWwrKztcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgICAgICAgICAgXy5sYWJlbCsrO1xuICAgICAgICAgICAgICAgICAgICAgICAgeSA9IG9wWzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgb3AgPSBbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgICAgICAgICAgICAgb3AgPSBfLm9wcy5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF8ubGFiZWwgPSBvcFsxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF8ubGFiZWwgPSB0WzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQgPSBvcDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ICYmIF8ubGFiZWwgPCB0WzJdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXy5sYWJlbCA9IHRbMl07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXy5vcHMucHVzaChvcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodFsyXSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfLm9wcy5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgb3AgPSBbNiwgZV07XG4gICAgICAgICAgICAgICAgeSA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICBmID0gdCA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIGlmIChvcFswXSAmIDUpXG4gICAgICAgICAgICB0aHJvdyBvcFsxXTtcbiAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcbiAgICB9XG59O1xudmFyIF9faW1wb3J0RGVmYXVsdCA9ICh0aGlzICYmIHRoaXMuX19pbXBvcnREZWZhdWx0KSB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBcImRlZmF1bHRcIjogbW9kIH07XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoeyB2YWx1ZTogdHJ1ZSB9KSk7XG5leHBvcnRzLk1hcmluZVNlcnZpY2UgPSB2b2lkIDA7XG52YXIgd2FzaV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHdhc21lci93YXNpICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0B3YXNtZXIrd2FzaUAwLjEyLjAvbm9kZV9tb2R1bGVzL0B3YXNtZXIvd2FzaS9saWIvaW5kZXguZXNtLmpzXCIpO1xudmFyIGJyb3dzZXJfMSA9IF9faW1wb3J0RGVmYXVsdChfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAd2FzbWVyL3dhc2kvbGliL2JpbmRpbmdzL2Jyb3dzZXIgKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQHdhc21lcit3YXNpQDAuMTIuMC9ub2RlX21vZHVsZXMvQHdhc21lci93YXNpL2xpYi9iaW5kaW5ncy9icm93c2VyLmpzXCIpKTtcbnZhciB3YXNtZnNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEB3YXNtZXIvd2FzbWZzICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0B3YXNtZXIrd2FzbWZzQDAuMTIuMC9ub2RlX21vZHVsZXMvQHdhc21lci93YXNtZnMvbGliL2luZGV4LmVzbS5qc1wiKTtcbnZhciBtYXJpbmVfanNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vbWFyaW5lX2pzICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0BmbHVlbmNlbGFicyttYXJpbmUtanNAMC4zLjM4L25vZGVfbW9kdWxlcy9AZmx1ZW5jZWxhYnMvbWFyaW5lLWpzL2Rpc3QvbWFyaW5lX2pzLmpzXCIpO1xudmFyIGNhY2hlZ2V0VWludDhNZW1vcnkwID0gbnVsbDtcbmZ1bmN0aW9uIGdldFVpbnQ4TWVtb3J5MCh3YXNtKSB7XG4gICAgaWYgKGNhY2hlZ2V0VWludDhNZW1vcnkwID09PSBudWxsIHx8IGNhY2hlZ2V0VWludDhNZW1vcnkwLmJ1ZmZlciAhPT0gd2FzbS5tZW1vcnkuYnVmZmVyKSB7XG4gICAgICAgIGNhY2hlZ2V0VWludDhNZW1vcnkwID0gbmV3IFVpbnQ4QXJyYXkod2FzbS5tZW1vcnkuYnVmZmVyKTtcbiAgICB9XG4gICAgcmV0dXJuIGNhY2hlZ2V0VWludDhNZW1vcnkwO1xufVxuZnVuY3Rpb24gZ2V0U3RyaW5nRnJvbVdhc20wKHdhc20sIHB0ciwgbGVuKSB7XG4gICAgcmV0dXJuIGRlY29kZXIuZGVjb2RlKGdldFVpbnQ4TWVtb3J5MCh3YXNtKS5zdWJhcnJheShwdHIsIHB0ciArIGxlbikpO1xufVxudmFyIGRlY29kZXIgPSBuZXcgVGV4dERlY29kZXIoKTtcbnZhciBNYXJpbmVTZXJ2aWNlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIE1hcmluZVNlcnZpY2UoY29udHJvbE1vZHVsZSwgc2VydmljZU1vZHVsZSwgc2VydmljZUlkLCBsb2dGdW5jdGlvbiwgbWFyaW5lU2VydmljZUNvbmZpZywgZW52KSB7XG4gICAgICAgIHRoaXMuY29udHJvbE1vZHVsZSA9IGNvbnRyb2xNb2R1bGU7XG4gICAgICAgIHRoaXMuc2VydmljZU1vZHVsZSA9IHNlcnZpY2VNb2R1bGU7XG4gICAgICAgIHRoaXMuc2VydmljZUlkID0gc2VydmljZUlkO1xuICAgICAgICB0aGlzLmxvZ0Z1bmN0aW9uID0gbG9nRnVuY3Rpb247XG4gICAgICAgIHRoaXMuZW52ID0ge307XG4gICAgICAgIHRoaXMuX2NvbnRyb2xNb2R1bGVJbnN0YW5jZSA9ICdub3Qtc2V0JztcbiAgICAgICAgdGhpcy5lbnYgPSBfX2Fzc2lnbih7IFdBU01fTE9HOiAnb2ZmJyB9LCBlbnYpO1xuICAgIH1cbiAgICBNYXJpbmVTZXJ2aWNlLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgd2FzaSwgY2ZnLCB3YXNpSW1wb3J0cywgc2VydmljZUluc3RhbmNlLCBjb250cm9sTW9kdWxlSW5zdGFuY2UsIGN1c3RvbVNlY3Rpb25zLCBpdEN1c3RvbVNlY3Rpb25zLCByYXdSZXN1bHQsIHJlc3VsdDtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICB3YXNpID0gbmV3IHdhc2lfMS5XQVNJKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnY6IHRoaXMuZW52LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpbmRpbmdzOiBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgYnJvd3Nlcl8xLmRlZmF1bHQpLCB7IGZzOiBuZXcgd2FzbWZzXzEuV2FzbUZzKCkuZnMgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNmZyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBvcnRzOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgd2FzaUltcG9ydHMgPSBoYXNXYXNpSW1wb3J0cyh0aGlzLnNlcnZpY2VNb2R1bGUpID8gd2FzaS5nZXRJbXBvcnRzKHRoaXMuc2VydmljZU1vZHVsZSkgOiB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIFdlYkFzc2VtYmx5Lmluc3RhbnRpYXRlKHRoaXMuc2VydmljZU1vZHVsZSwgX19hc3NpZ24oX19hc3NpZ24oe30sIHdhc2lJbXBvcnRzKSwgeyBob3N0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dfdXRmOF9zdHJpbmc6IGZ1bmN0aW9uIChsZXZlbFJhdywgdGFyZ2V0LCBvZmZzZXQsIHNpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgd2FzbSA9IGNmZy5leHBvcnRzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsZXZlbCA9IHJhd0xldmVsVG9UeXBlcyhsZXZlbFJhdyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxldmVsID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSBnZXRTdHJpbmdGcm9tV2FzbTAod2FzbSwgb2Zmc2V0LCBzaXplKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5sb2dGdW5jdGlvbih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZpY2U6IF90aGlzLnNlcnZpY2VJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogbWVzc2FnZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV2ZWw6IGxldmVsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSB9KSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlSW5zdGFuY2UgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB3YXNpLnN0YXJ0KHNlcnZpY2VJbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjZmcuZXhwb3J0cyA9IHNlcnZpY2VJbnN0YW5jZS5leHBvcnRzO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgKDAsIG1hcmluZV9qc18xLmluaXQpKHRoaXMuY29udHJvbE1vZHVsZSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sTW9kdWxlSW5zdGFuY2UgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXN0b21TZWN0aW9ucyA9IFdlYkFzc2VtYmx5Lk1vZHVsZS5jdXN0b21TZWN0aW9ucyh0aGlzLnNlcnZpY2VNb2R1bGUsICdpbnRlcmZhY2UtdHlwZXMnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0Q3VzdG9tU2VjdGlvbnMgPSBuZXcgVWludDhBcnJheShjdXN0b21TZWN0aW9uc1swXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByYXdSZXN1bHQgPSBjb250cm9sTW9kdWxlSW5zdGFuY2UucmVnaXN0ZXJfbW9kdWxlKHRoaXMuc2VydmljZUlkLCBpdEN1c3RvbVNlY3Rpb25zLCBzZXJ2aWNlSW5zdGFuY2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBKU09OLnBhcnNlKHJhd1Jlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY29udHJvbE1vZHVsZUluc3RhbmNlID0gY29udHJvbE1vZHVsZUluc3RhbmNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCByZXN1bHRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgJ3JlZ2lzdGVyX21vZHVsZSByZXN1bHQgcGFyc2luZyBlcnJvcjogJyArIGV4ICsgJywgb3JpZ2luYWwgdGV4dDogJyArIHJhd1Jlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBNYXJpbmVTZXJ2aWNlLnByb3RvdHlwZS50ZXJtaW5hdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2NvbnRyb2xNb2R1bGVJbnN0YW5jZSA9ICdub3Qtc2V0JztcbiAgICB9O1xuICAgIE1hcmluZVNlcnZpY2UucHJvdG90eXBlLmNhbGwgPSBmdW5jdGlvbiAoZnVuY3Rpb25OYW1lLCBhcmdzLCBjYWxsUGFyYW1zKSB7XG4gICAgICAgIGlmICh0aGlzLl9jb250cm9sTW9kdWxlSW5zdGFuY2UgPT09ICdub3Qtc2V0Jykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdOb3QgaW5pdGlhbGl6ZWQnKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fY29udHJvbE1vZHVsZUluc3RhbmNlID09PSAndGVybWluYXRlZCcpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVGVybWluYXRlZCcpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBhcmdzU3RyaW5nID0gSlNPTi5zdHJpbmdpZnkoYXJncyk7XG4gICAgICAgIHZhciByYXdSZXMgPSB0aGlzLl9jb250cm9sTW9kdWxlSW5zdGFuY2UuY2FsbF9tb2R1bGUodGhpcy5zZXJ2aWNlSWQsIGZ1bmN0aW9uTmFtZSwgYXJnc1N0cmluZyk7XG4gICAgICAgIHZhciBqc29uUmVzID0gSlNPTi5wYXJzZShyYXdSZXMpO1xuICAgICAgICBpZiAoanNvblJlcy5lcnJvcikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwibWFyaW5lLWpzIGZhaWxlZCB3aXRoOiBcIi5jb25jYXQoanNvblJlcy5lcnJvcikpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBqc29uUmVzLnJlc3VsdDtcbiAgICB9O1xuICAgIHJldHVybiBNYXJpbmVTZXJ2aWNlO1xufSgpKTtcbmV4cG9ydHMuTWFyaW5lU2VydmljZSA9IE1hcmluZVNlcnZpY2U7XG5mdW5jdGlvbiBoYXNXYXNpSW1wb3J0cyhtb2R1bGUpIHtcbiAgICB2YXIgaW1wb3J0cyA9IFdlYkFzc2VtYmx5Lk1vZHVsZS5pbXBvcnRzKG1vZHVsZSk7XG4gICAgdmFyIGZpcnN0V2FzaUltcG9ydCA9IGltcG9ydHMuZmluZChmdW5jdGlvbiAoeCkge1xuICAgICAgICByZXR1cm4geC5tb2R1bGUgPT09ICd3YXNpX3NuYXBzaG90X3ByZXZpZXcxJyB8fCB4Lm1vZHVsZSA9PT0gJ3dhc2lfdW5zdGFibGUnO1xuICAgIH0pO1xuICAgIHJldHVybiBmaXJzdFdhc2lJbXBvcnQgIT09IHVuZGVmaW5lZDtcbn1cbnZhciByYXdMZXZlbFRvVHlwZXMgPSBmdW5jdGlvbiAocmF3TGV2ZWwpIHtcbiAgICBzd2l0Y2ggKHJhd0xldmVsKSB7XG4gICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgIHJldHVybiAnZXJyb3InO1xuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICByZXR1cm4gJ3dhcm4nO1xuICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICByZXR1cm4gJ2luZm8nO1xuICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICByZXR1cm4gJ2RlYnVnJztcbiAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgcmV0dXJuICd0cmFjZSc7XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xufTtcblxuXG4vLyMgc291cmNlVVJMPXdlYnBhY2s6Ly9AZmx1ZW5jZWxhYnMvbWFyaW5lLndvcmtlci1zY3JpcHQvLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0BmbHVlbmNlbGFicyttYXJpbmUtanNAMC4zLjM4L25vZGVfbW9kdWxlcy9AZmx1ZW5jZWxhYnMvbWFyaW5lLWpzL2Rpc3QvTWFyaW5lU2VydmljZS5qcz8iKTsKCi8qKiovIH0pLAoKLyoqKi8gIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9AZmx1ZW5jZWxhYnMrbWFyaW5lLWpzQDAuMy4zOC9ub2RlX21vZHVsZXMvQGZsdWVuY2VsYWJzL21hcmluZS1qcy9kaXN0L2NvbmZpZy5qcyI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiAuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQGZsdWVuY2VsYWJzK21hcmluZS1qc0AwLjMuMzgvbm9kZV9tb2R1bGVzL0BmbHVlbmNlbGFicy9tYXJpbmUtanMvZGlzdC9jb25maWcuanMgKioqIQogIFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykgPT4gewoKZXZhbCgiXG4vKlxuICogQ29weXJpZ2h0IDIwMjIgRmx1ZW5jZSBMYWJzIExpbWl0ZWRcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHsgdmFsdWU6IHRydWUgfSkpO1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL0BmbHVlbmNlbGFicy9tYXJpbmUud29ya2VyLXNjcmlwdC8uLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQGZsdWVuY2VsYWJzK21hcmluZS1qc0AwLjMuMzgvbm9kZV9tb2R1bGVzL0BmbHVlbmNlbGFicy9tYXJpbmUtanMvZGlzdC9jb25maWcuanM/Iik7CgovKioqLyB9KSwKCi8qKiovICIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQGZsdWVuY2VsYWJzK21hcmluZS1qc0AwLjMuMzgvbm9kZV9tb2R1bGVzL0BmbHVlbmNlbGFicy9tYXJpbmUtanMvZGlzdC9pbmRleC5qcyI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAhKioqIC4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9AZmx1ZW5jZWxhYnMrbWFyaW5lLWpzQDAuMy4zOC9ub2RlX21vZHVsZXMvQGZsdWVuY2VsYWJzL21hcmluZS1qcy9kaXN0L2luZGV4LmpzICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKGZ1bmN0aW9uKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpldmFsKCJcbi8qXG4gKiBDb3B5cmlnaHQgMjAyMiBGbHVlbmNlIExhYnMgTGltaXRlZFxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xudmFyIF9fY3JlYXRlQmluZGluZyA9ICh0aGlzICYmIHRoaXMuX19jcmVhdGVCaW5kaW5nKSB8fCAoT2JqZWN0LmNyZWF0ZSA/IChmdW5jdGlvbiAobywgbSwgaywgazIpIHtcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZClcbiAgICAgICAgazIgPSBrO1xuICAgIHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihtLCBrKTtcbiAgICBpZiAoIWRlc2MgfHwgKFwiZ2V0XCIgaW4gZGVzYyA/ICFtLl9fZXNNb2R1bGUgOiBkZXNjLndyaXRhYmxlIHx8IGRlc2MuY29uZmlndXJhYmxlKSkge1xuICAgICAgICBkZXNjID0geyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIG1ba107IH0gfTtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCBkZXNjKTtcbn0pIDogKGZ1bmN0aW9uIChvLCBtLCBrLCBrMikge1xuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKVxuICAgICAgICBrMiA9IGs7XG4gICAgb1trMl0gPSBtW2tdO1xufSkpO1xudmFyIF9fZXhwb3J0U3RhciA9ICh0aGlzICYmIHRoaXMuX19leHBvcnRTdGFyKSB8fCBmdW5jdGlvbiAobSwgZXhwb3J0cykge1xuICAgIGZvciAodmFyIHAgaW4gbSlcbiAgICAgICAgaWYgKHAgIT09IFwiZGVmYXVsdFwiICYmICFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZXhwb3J0cywgcCkpXG4gICAgICAgICAgICBfX2NyZWF0ZUJpbmRpbmcoZXhwb3J0cywgbSwgcCk7XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoeyB2YWx1ZTogdHJ1ZSB9KSk7XG5leHBvcnRzLk1hcmluZVNlcnZpY2UgPSB2b2lkIDA7XG52YXIgTWFyaW5lU2VydmljZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9NYXJpbmVTZXJ2aWNlICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0BmbHVlbmNlbGFicyttYXJpbmUtanNAMC4zLjM4L25vZGVfbW9kdWxlcy9AZmx1ZW5jZWxhYnMvbWFyaW5lLWpzL2Rpc3QvTWFyaW5lU2VydmljZS5qc1wiKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIk1hcmluZVNlcnZpY2VcIiwgKHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBNYXJpbmVTZXJ2aWNlXzEuTWFyaW5lU2VydmljZTsgfSB9KSk7XG5fX2V4cG9ydFN0YXIoX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9jb25maWcgKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQGZsdWVuY2VsYWJzK21hcmluZS1qc0AwLjMuMzgvbm9kZV9tb2R1bGVzL0BmbHVlbmNlbGFicy9tYXJpbmUtanMvZGlzdC9jb25maWcuanNcIiksIGV4cG9ydHMpO1xuX19leHBvcnRTdGFyKF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vdHlwZXMgKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQGZsdWVuY2VsYWJzK21hcmluZS1qc0AwLjMuMzgvbm9kZV9tb2R1bGVzL0BmbHVlbmNlbGFicy9tYXJpbmUtanMvZGlzdC90eXBlcy5qc1wiKSwgZXhwb3J0cyk7XG5cblxuLy8jIHNvdXJjZVVSTD13ZWJwYWNrOi8vQGZsdWVuY2VsYWJzL21hcmluZS53b3JrZXItc2NyaXB0Ly4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9AZmx1ZW5jZWxhYnMrbWFyaW5lLWpzQDAuMy4zOC9ub2RlX21vZHVsZXMvQGZsdWVuY2VsYWJzL21hcmluZS1qcy9kaXN0L2luZGV4LmpzPyIpOwoKLyoqKi8gfSksCgovKioqLyAiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0BmbHVlbmNlbGFicyttYXJpbmUtanNAMC4zLjM4L25vZGVfbW9kdWxlcy9AZmx1ZW5jZWxhYnMvbWFyaW5lLWpzL2Rpc3QvbWFyaW5lX2pzLmpzIjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAhKioqIC4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9AZmx1ZW5jZWxhYnMrbWFyaW5lLWpzQDAuMy4zOC9ub2RlX21vZHVsZXMvQGZsdWVuY2VsYWJzL21hcmluZS1qcy9kaXN0L21hcmluZV9qcy5qcyAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoZnVuY3Rpb24oX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCmV2YWwoIlxuLypcbiAqIENvcHlyaWdodCAyMDIyIEZsdWVuY2UgTGFicyBMaW1pdGVkXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7XG4gICAgICAgICAgICBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7XG4gICAgICAgICAgICBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG52YXIgX19nZW5lcmF0b3IgPSAodGhpcyAmJiB0aGlzLl9fZ2VuZXJhdG9yKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgYm9keSkge1xuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24gKCkgeyBpZiAodFswXSAmIDEpXG4gICAgICAgICAgICB0aHJvdyB0WzFdOyByZXR1cm4gdFsxXTsgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZztcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IHJldHVybiBmdW5jdGlvbiAodikgeyByZXR1cm4gc3RlcChbbiwgdl0pOyB9OyB9XG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xuICAgICAgICBpZiAoZilcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xuICAgICAgICB3aGlsZSAoXylcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0O1xuICAgICAgICAgICAgICAgIGlmICh5ID0gMCwgdClcbiAgICAgICAgICAgICAgICAgICAgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgdCA9IG9wO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgIF8ubGFiZWwrKztcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgICAgICAgICAgXy5sYWJlbCsrO1xuICAgICAgICAgICAgICAgICAgICAgICAgeSA9IG9wWzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgb3AgPSBbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgICAgICAgICAgICAgb3AgPSBfLm9wcy5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF8ubGFiZWwgPSBvcFsxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF8ubGFiZWwgPSB0WzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQgPSBvcDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ICYmIF8ubGFiZWwgPCB0WzJdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXy5sYWJlbCA9IHRbMl07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXy5vcHMucHVzaChvcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodFsyXSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfLm9wcy5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgb3AgPSBbNiwgZV07XG4gICAgICAgICAgICAgICAgeSA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICBmID0gdCA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIGlmIChvcFswXSAmIDUpXG4gICAgICAgICAgICB0aHJvdyBvcFsxXTtcbiAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcbiAgICB9XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoeyB2YWx1ZTogdHJ1ZSB9KSk7XG5leHBvcnRzLmluaXQgPSB2b2lkIDA7XG4vLyBUaGlzIGlzIHBhdGNoZWQgZ2VuZXJhdGVkIGJ5IHdhc20tcGFjayBmaWxlXG52YXIgbWFyaW5lX2pzX2pzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL3NuaXBwZXRzL21hcmluZS1qcy02ZmFhNjdiOGFmOWNjMTczL21hcmluZS1qcy5qcyAqLyBcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9AZmx1ZW5jZWxhYnMrbWFyaW5lLWpzQDAuMy4zOC9ub2RlX21vZHVsZXMvQGZsdWVuY2VsYWJzL21hcmluZS1qcy9kaXN0L3NuaXBwZXRzL21hcmluZS1qcy02ZmFhNjdiOGFmOWNjMTczL21hcmluZS1qcy5qc1wiKTtcbmZ1bmN0aW9uIGluaXQobW9kdWxlKSB7XG4gICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBnZXRPYmplY3QoaWR4KSB7IHJldHVybiBoZWFwW2lkeF07IH1cbiAgICAgICAgZnVuY3Rpb24gZHJvcE9iamVjdChpZHgpIHtcbiAgICAgICAgICAgIGlmIChpZHggPCAzNilcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICBoZWFwW2lkeF0gPSBoZWFwX25leHQ7XG4gICAgICAgICAgICBoZWFwX25leHQgPSBpZHg7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gdGFrZU9iamVjdChpZHgpIHtcbiAgICAgICAgICAgIHZhciByZXQgPSBnZXRPYmplY3QoaWR4KTtcbiAgICAgICAgICAgIGRyb3BPYmplY3QoaWR4KTtcbiAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZ2V0VWludDhNZW1vcnkwKCkge1xuICAgICAgICAgICAgaWYgKGNhY2hlZFVpbnQ4TWVtb3J5MC5ieXRlTGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgY2FjaGVkVWludDhNZW1vcnkwID0gbmV3IFVpbnQ4QXJyYXkod2FzbS5tZW1vcnkuYnVmZmVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRVaW50OE1lbW9yeTA7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZ2V0U3RyaW5nRnJvbVdhc20wKHB0ciwgbGVuKSB7XG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkVGV4dERlY29kZXIuZGVjb2RlKGdldFVpbnQ4TWVtb3J5MCgpLnN1YmFycmF5KHB0ciwgcHRyICsgbGVuKSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gYWRkSGVhcE9iamVjdChvYmopIHtcbiAgICAgICAgICAgIGlmIChoZWFwX25leHQgPT09IGhlYXAubGVuZ3RoKVxuICAgICAgICAgICAgICAgIGhlYXAucHVzaChoZWFwLmxlbmd0aCArIDEpO1xuICAgICAgICAgICAgdmFyIGlkeCA9IGhlYXBfbmV4dDtcbiAgICAgICAgICAgIGhlYXBfbmV4dCA9IGhlYXBbaWR4XTtcbiAgICAgICAgICAgIGhlYXBbaWR4XSA9IG9iajtcbiAgICAgICAgICAgIHJldHVybiBpZHg7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcGFzc1N0cmluZ1RvV2FzbTAoYXJnLCBtYWxsb2MsIHJlYWxsb2MpIHtcbiAgICAgICAgICAgIGlmIChyZWFsbG9jID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgYnVmID0gY2FjaGVkVGV4dEVuY29kZXIuZW5jb2RlKGFyZyk7XG4gICAgICAgICAgICAgICAgdmFyIHB0cl8xID0gbWFsbG9jKGJ1Zi5sZW5ndGgpO1xuICAgICAgICAgICAgICAgIGdldFVpbnQ4TWVtb3J5MCgpLnN1YmFycmF5KHB0cl8xLCBwdHJfMSArIGJ1Zi5sZW5ndGgpLnNldChidWYpO1xuICAgICAgICAgICAgICAgIFdBU01fVkVDVE9SX0xFTiA9IGJ1Zi5sZW5ndGg7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHB0cl8xO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGxlbiA9IGFyZy5sZW5ndGg7XG4gICAgICAgICAgICB2YXIgcHRyID0gbWFsbG9jKGxlbik7XG4gICAgICAgICAgICB2YXIgbWVtID0gZ2V0VWludDhNZW1vcnkwKCk7XG4gICAgICAgICAgICB2YXIgb2Zmc2V0ID0gMDtcbiAgICAgICAgICAgIGZvciAoOyBvZmZzZXQgPCBsZW47IG9mZnNldCsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvZGUgPSBhcmcuY2hhckNvZGVBdChvZmZzZXQpO1xuICAgICAgICAgICAgICAgIGlmIChjb2RlID4gMHg3RilcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgbWVtW3B0ciArIG9mZnNldF0gPSBjb2RlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG9mZnNldCAhPT0gbGVuKSB7XG4gICAgICAgICAgICAgICAgaWYgKG9mZnNldCAhPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBhcmcgPSBhcmcuc2xpY2Uob2Zmc2V0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcHRyID0gcmVhbGxvYyhwdHIsIGxlbiwgbGVuID0gb2Zmc2V0ICsgYXJnLmxlbmd0aCAqIDMpO1xuICAgICAgICAgICAgICAgIHZhciB2aWV3ID0gZ2V0VWludDhNZW1vcnkwKCkuc3ViYXJyYXkocHRyICsgb2Zmc2V0LCBwdHIgKyBsZW4pO1xuICAgICAgICAgICAgICAgIHZhciByZXQgPSBlbmNvZGVTdHJpbmcoYXJnLCB2aWV3KTtcbiAgICAgICAgICAgICAgICBvZmZzZXQgKz0gcmV0LndyaXR0ZW47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBXQVNNX1ZFQ1RPUl9MRU4gPSBvZmZzZXQ7XG4gICAgICAgICAgICByZXR1cm4gcHRyO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGdldEludDMyTWVtb3J5MCgpIHtcbiAgICAgICAgICAgIGlmIChjYWNoZWRJbnQzMk1lbW9yeTAuYnl0ZUxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGNhY2hlZEludDMyTWVtb3J5MCA9IG5ldyBJbnQzMkFycmF5KHdhc20ubWVtb3J5LmJ1ZmZlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkSW50MzJNZW1vcnkwO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHBhc3NBcnJheThUb1dhc20wKGFyZywgbWFsbG9jKSB7XG4gICAgICAgICAgICB2YXIgcHRyID0gbWFsbG9jKGFyZy5sZW5ndGggKiAxKTtcbiAgICAgICAgICAgIGdldFVpbnQ4TWVtb3J5MCgpLnNldChhcmcsIHB0ciAvIDEpO1xuICAgICAgICAgICAgV0FTTV9WRUNUT1JfTEVOID0gYXJnLmxlbmd0aDtcbiAgICAgICAgICAgIHJldHVybiBwdHI7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJlZ2lzdGVycyBhIG1vZHVsZSBpbnNpZGUgd2ViLXJ1bnRpbWUuXG4gICAgICAgICAqXG4gICAgICAgICAqICMgQXJndW1lbnRzXG4gICAgICAgICAqXG4gICAgICAgICAqICogYG5hbWVgIC0gbmFtZSBvZiBtb2R1bGUgdG8gcmVnaXN0ZXJcbiAgICAgICAgICogKiBgd2l0X3NlY3Rpb25fYnl0ZXNgIC0gYnl0ZXMgb2YgXCJpbnRlcmZhY2UtdHlwZXNcIiBjdXN0b20gc2VjdGlvbiBmcm9tIHdhc20gZmlsZVxuICAgICAgICAgKiAqIGBpbnN0YW5jZWAgLSBgV2ViQXNzZW1ibHk6Okluc3RhbmNlYCBtYWRlIGZyb20gdGFyZ2V0IHdhc20gZmlsZVxuICAgICAgICAgKlxuICAgICAgICAgKiAjIFJldHVybiB2YWx1ZVxuICAgICAgICAgKlxuICAgICAgICAgKiBKU09OIG9iamVjdCB3aXRoIGZpZWxkIFwiZXJyb3JcIi4gSWYgZXJyb3IgaXMgZW1wdHksIG1vZHVsZSBpcyByZWdpc3RlcmVkLlxuICAgICAgICAgKiBvdGhlcndpc2UsIGl0IGNvbnRhaW5zIGVycm9yIG1lc3NhZ2UuXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lXG4gICAgICAgICAqIEBwYXJhbSB7VWludDhBcnJheX0gd2l0X3NlY3Rpb25fYnl0ZXNcbiAgICAgICAgICogQHBhcmFtIHthbnl9IHdhc21faW5zdGFuY2VcbiAgICAgICAgICogQHJldHVybnMge3N0cmluZ31cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIHJlZ2lzdGVyX21vZHVsZShuYW1lLCB3aXRfc2VjdGlvbl9ieXRlcywgd2FzbV9pbnN0YW5jZSkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB2YXIgcmV0cHRyID0gd2FzbS5fX3diaW5kZ2VuX2FkZF90b19zdGFja19wb2ludGVyKC0xNik7XG4gICAgICAgICAgICAgICAgdmFyIHB0cjAgPSBwYXNzU3RyaW5nVG9XYXNtMChuYW1lLCB3YXNtLl9fd2JpbmRnZW5fbWFsbG9jLCB3YXNtLl9fd2JpbmRnZW5fcmVhbGxvYyk7XG4gICAgICAgICAgICAgICAgdmFyIGxlbjAgPSBXQVNNX1ZFQ1RPUl9MRU47XG4gICAgICAgICAgICAgICAgdmFyIHB0cjEgPSBwYXNzQXJyYXk4VG9XYXNtMCh3aXRfc2VjdGlvbl9ieXRlcywgd2FzbS5fX3diaW5kZ2VuX21hbGxvYyk7XG4gICAgICAgICAgICAgICAgdmFyIGxlbjEgPSBXQVNNX1ZFQ1RPUl9MRU47XG4gICAgICAgICAgICAgICAgd2FzbS5yZWdpc3Rlcl9tb2R1bGUocmV0cHRyLCBwdHIwLCBsZW4wLCBwdHIxLCBsZW4xLCBhZGRIZWFwT2JqZWN0KHdhc21faW5zdGFuY2UpKTtcbiAgICAgICAgICAgICAgICB2YXIgcjAgPSBnZXRJbnQzMk1lbW9yeTAoKVtyZXRwdHIgLyA0ICsgMF07XG4gICAgICAgICAgICAgICAgdmFyIHIxID0gZ2V0SW50MzJNZW1vcnkwKClbcmV0cHRyIC8gNCArIDFdO1xuICAgICAgICAgICAgICAgIHJldHVybiBnZXRTdHJpbmdGcm9tV2FzbTAocjAsIHIxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgICAgIHdhc20uX193YmluZGdlbl9hZGRfdG9fc3RhY2tfcG9pbnRlcigxNik7XG4gICAgICAgICAgICAgICAgd2FzbS5fX3diaW5kZ2VuX2ZyZWUocjAsIHIxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogIENhbGxzIGEgZnVuY3Rpb24gZnJvbSBhIG1vZHVsZS5cbiAgICAgICAgICpcbiAgICAgICAgICogIyBBcmd1bWVudHNcbiAgICAgICAgICpcbiAgICAgICAgICogKiBtb2R1bGVfbmFtZSAtIG5hbWUgb2YgcmVnaXN0ZXJlZCBtb2R1bGVcbiAgICAgICAgICogKiBmdW5jdGlvbl9uYW1lIC0gbmFtZSBvZiB0aGUgZnVuY3Rpb24gdG8gY2FsbFxuICAgICAgICAgKiAqIGFyZ3MgLSBKU09OIGFycmF5IG9mIGZ1bmN0aW9uIGFyZ3VtZW50c1xuICAgICAgICAgKlxuICAgICAgICAgKiAjIFJldHVybiB2YWx1ZVxuICAgICAgICAgKlxuICAgICAgICAgKiBKU09OIG9iamVjdCB3aXRoIGZpZWxkcyBcImVycm9yXCIgYW5kIFwicmVzdWx0XCIuIElmIFwiZXJyb3JcIiBpcyBlbXB0eSBzdHJpbmcsXG4gICAgICAgICAqIFwicmVzdWx0XCIgY29udGFpbnMgYSBmdW5jdGlvbiByZXR1cm4gdmFsdWUuIE90aGVyd2lzZSwgXCJlcnJvclwiIGNvbnRhaW5zIGVycm9yIG1lc3NhZ2UuXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBtb2R1bGVfbmFtZVxuICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gZnVuY3Rpb25fbmFtZVxuICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gYXJnc1xuICAgICAgICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gY2FsbF9tb2R1bGUobW9kdWxlX25hbWUsIGZ1bmN0aW9uX25hbWUsIGFyZ3MpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdmFyIHJldHB0ciA9IHdhc20uX193YmluZGdlbl9hZGRfdG9fc3RhY2tfcG9pbnRlcigtMTYpO1xuICAgICAgICAgICAgICAgIHZhciBwdHIwID0gcGFzc1N0cmluZ1RvV2FzbTAobW9kdWxlX25hbWUsIHdhc20uX193YmluZGdlbl9tYWxsb2MsIHdhc20uX193YmluZGdlbl9yZWFsbG9jKTtcbiAgICAgICAgICAgICAgICB2YXIgbGVuMCA9IFdBU01fVkVDVE9SX0xFTjtcbiAgICAgICAgICAgICAgICB2YXIgcHRyMSA9IHBhc3NTdHJpbmdUb1dhc20wKGZ1bmN0aW9uX25hbWUsIHdhc20uX193YmluZGdlbl9tYWxsb2MsIHdhc20uX193YmluZGdlbl9yZWFsbG9jKTtcbiAgICAgICAgICAgICAgICB2YXIgbGVuMSA9IFdBU01fVkVDVE9SX0xFTjtcbiAgICAgICAgICAgICAgICB2YXIgcHRyMiA9IHBhc3NTdHJpbmdUb1dhc20wKGFyZ3MsIHdhc20uX193YmluZGdlbl9tYWxsb2MsIHdhc20uX193YmluZGdlbl9yZWFsbG9jKTtcbiAgICAgICAgICAgICAgICB2YXIgbGVuMiA9IFdBU01fVkVDVE9SX0xFTjtcbiAgICAgICAgICAgICAgICB3YXNtLmNhbGxfbW9kdWxlKHJldHB0ciwgcHRyMCwgbGVuMCwgcHRyMSwgbGVuMSwgcHRyMiwgbGVuMik7XG4gICAgICAgICAgICAgICAgdmFyIHIwID0gZ2V0SW50MzJNZW1vcnkwKClbcmV0cHRyIC8gNCArIDBdO1xuICAgICAgICAgICAgICAgIHZhciByMSA9IGdldEludDMyTWVtb3J5MCgpW3JldHB0ciAvIDQgKyAxXTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0U3RyaW5nRnJvbVdhc20wKHIwLCByMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICB3YXNtLl9fd2JpbmRnZW5fYWRkX3RvX3N0YWNrX3BvaW50ZXIoMTYpO1xuICAgICAgICAgICAgICAgIHdhc20uX193YmluZGdlbl9mcmVlKHIwLCByMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZ2V0QXJyYXlVOEZyb21XYXNtMChwdHIsIGxlbikge1xuICAgICAgICAgICAgcmV0dXJuIGdldFVpbnQ4TWVtb3J5MCgpLnN1YmFycmF5KHB0ciAvIDEsIHB0ciAvIDEgKyBsZW4pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGdldEltcG9ydHMoKSB7XG4gICAgICAgICAgICB2YXIgaW1wb3J0cyA9IHt9O1xuICAgICAgICAgICAgaW1wb3J0cy53YmcgPSB7fTtcbiAgICAgICAgICAgIGltcG9ydHMud2JnLl9fd2JnX3dyaXRlYnl0ZXJhbmdlXzBjNTlhYWJjMmFhZDEyMTAgPSBmdW5jdGlvbiAoYXJnMCwgYXJnMSwgYXJnMiwgYXJnMykge1xuICAgICAgICAgICAgICAgICgwLCBtYXJpbmVfanNfanNfMS53cml0ZV9ieXRlX3JhbmdlKShnZXRPYmplY3QoYXJnMCksIGFyZzEgPj4+IDAsIGdldEFycmF5VThGcm9tV2FzbTAoYXJnMiwgYXJnMykpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGltcG9ydHMud2JnLl9fd2JnX3JlYWRieXRlXzBiOTZjZDYyZTRjMWFmMjUgPSBmdW5jdGlvbiAoYXJnMCwgYXJnMSkge1xuICAgICAgICAgICAgICAgIHZhciByZXQgPSAoMCwgbWFyaW5lX2pzX2pzXzEucmVhZF9ieXRlKShnZXRPYmplY3QoYXJnMCksIGFyZzEgPj4+IDApO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaW1wb3J0cy53YmcuX193YmdfcmVhZGJ5dGVyYW5nZV82ZGVmNTk3MGIxYWViZjYxID0gZnVuY3Rpb24gKGFyZzAsIGFyZzEsIGFyZzIsIGFyZzMpIHtcbiAgICAgICAgICAgICAgICAoMCwgbWFyaW5lX2pzX2pzXzEucmVhZF9ieXRlX3JhbmdlKShnZXRPYmplY3QoYXJnMCksIGFyZzEgPj4+IDAsIGdldEFycmF5VThGcm9tV2FzbTAoYXJnMiwgYXJnMykpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGltcG9ydHMud2JnLl9fd2JnX2dldG1lbW9yeXNpemVfMTZkNzkyYzU0NzQ2OWJhNCA9IGZ1bmN0aW9uIChhcmcwKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJldCA9ICgwLCBtYXJpbmVfanNfanNfMS5nZXRfbWVtb3J5X3NpemUpKGdldE9iamVjdChhcmcwKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpbXBvcnRzLndiZy5fX3diZ19uZXdfYWJkYTc2ZTg4M2JhOGE1ZiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmV0ID0gbmV3IEVycm9yKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFkZEhlYXBPYmplY3QocmV0KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpbXBvcnRzLndiZy5fX3diZ19zdGFja182NTgyNzlmZTQ0NTQxY2Y2ID0gZnVuY3Rpb24gKGFyZzAsIGFyZzEpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmV0ID0gZ2V0T2JqZWN0KGFyZzEpLnN0YWNrO1xuICAgICAgICAgICAgICAgIHZhciBwdHIwID0gcGFzc1N0cmluZ1RvV2FzbTAocmV0LCB3YXNtLl9fd2JpbmRnZW5fbWFsbG9jLCB3YXNtLl9fd2JpbmRnZW5fcmVhbGxvYyk7XG4gICAgICAgICAgICAgICAgdmFyIGxlbjAgPSBXQVNNX1ZFQ1RPUl9MRU47XG4gICAgICAgICAgICAgICAgZ2V0SW50MzJNZW1vcnkwKClbYXJnMCAvIDQgKyAxXSA9IGxlbjA7XG4gICAgICAgICAgICAgICAgZ2V0SW50MzJNZW1vcnkwKClbYXJnMCAvIDQgKyAwXSA9IHB0cjA7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaW1wb3J0cy53YmcuX193YmdfZXJyb3JfZjg1MTY2N2FmNzFiY2ZjNiA9IGZ1bmN0aW9uIChhcmcwLCBhcmcxKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihnZXRTdHJpbmdGcm9tV2FzbTAoYXJnMCwgYXJnMSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICAgICAgd2FzbS5fX3diaW5kZ2VuX2ZyZWUoYXJnMCwgYXJnMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGltcG9ydHMud2JnLl9fd2JpbmRnZW5fb2JqZWN0X2Ryb3BfcmVmID0gZnVuY3Rpb24gKGFyZzApIHtcbiAgICAgICAgICAgICAgICB0YWtlT2JqZWN0KGFyZzApO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGltcG9ydHMud2JnLl9fd2JnX3dyaXRlYnl0ZV8xMTFmZTkzYzJiMDEyNmZlID0gZnVuY3Rpb24gKGFyZzAsIGFyZzEsIGFyZzIpIHtcbiAgICAgICAgICAgICAgICAoMCwgbWFyaW5lX2pzX2pzXzEud3JpdGVfYnl0ZSkoZ2V0T2JqZWN0KGFyZzApLCBhcmcxID4+PiAwLCBhcmcyKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpbXBvcnRzLndiZy5fX3diZ19jYWxsZXhwb3J0XzYzMzYzMGI5MTMyZTIwYTQgPSBmdW5jdGlvbiAoYXJnMCwgYXJnMSwgYXJnMiwgYXJnMywgYXJnNCwgYXJnNSkge1xuICAgICAgICAgICAgICAgIHZhciByZXQgPSAoMCwgbWFyaW5lX2pzX2pzXzEuY2FsbF9leHBvcnQpKGdldE9iamVjdChhcmcxKSwgZ2V0U3RyaW5nRnJvbVdhc20wKGFyZzIsIGFyZzMpLCBnZXRTdHJpbmdGcm9tV2FzbTAoYXJnNCwgYXJnNSkpO1xuICAgICAgICAgICAgICAgIHZhciBwdHIwID0gcGFzc1N0cmluZ1RvV2FzbTAocmV0LCB3YXNtLl9fd2JpbmRnZW5fbWFsbG9jLCB3YXNtLl9fd2JpbmRnZW5fcmVhbGxvYyk7XG4gICAgICAgICAgICAgICAgdmFyIGxlbjAgPSBXQVNNX1ZFQ1RPUl9MRU47XG4gICAgICAgICAgICAgICAgZ2V0SW50MzJNZW1vcnkwKClbYXJnMCAvIDQgKyAxXSA9IGxlbjA7XG4gICAgICAgICAgICAgICAgZ2V0SW50MzJNZW1vcnkwKClbYXJnMCAvIDQgKyAwXSA9IHB0cjA7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIGltcG9ydHM7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gaW5pdE1lbW9yeShpbXBvcnRzLCBtYXliZV9tZW1vcnkpIHtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBmaW5hbGl6ZUluaXQoaW5zdGFuY2UsIG1vZHVsZSkge1xuICAgICAgICAgICAgd2FzbSA9IGluc3RhbmNlLmV4cG9ydHM7XG4gICAgICAgICAgICBpbml0Ll9fd2JpbmRnZW5fd2FzbV9tb2R1bGUgPSBtb2R1bGU7XG4gICAgICAgICAgICBjYWNoZWRJbnQzMk1lbW9yeTAgPSBuZXcgSW50MzJBcnJheSgpO1xuICAgICAgICAgICAgY2FjaGVkVWludDhNZW1vcnkwID0gbmV3IFVpbnQ4QXJyYXkoKTtcbiAgICAgICAgICAgIC8vIGNhbGxzIG1haW4oKSBmdW5jdGlvbi4gVXNlZCB0byBzZXQgdXBcbiAgICAgICAgICAgIHdhc20uX193YmluZGdlbl9zdGFydCgpO1xuICAgICAgICAgICAgcmV0dXJuIHdhc207XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gaW5pdCh3YXNtTW9kdWxlKSB7XG4gICAgICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGltcG9ydHMsIGluc3RhbmNlO1xuICAgICAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltcG9ydHMgPSBnZXRJbXBvcnRzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5pdE1lbW9yeShpbXBvcnRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBXZWJBc3NlbWJseS5pbnN0YW50aWF0ZSh3YXNtTW9kdWxlLCBpbXBvcnRzKV07XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2UgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIGZpbmFsaXplSW5pdChpbnN0YW5jZSwgbW9kdWxlKV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHZhciB3YXNtLCBoZWFwLCBoZWFwX25leHQsIGNhY2hlZFRleHREZWNvZGVyLCBjYWNoZWRVaW50OE1lbW9yeTAsIFdBU01fVkVDVE9SX0xFTiwgY2FjaGVkVGV4dEVuY29kZXIsIGVuY29kZVN0cmluZywgY2FjaGVkSW50MzJNZW1vcnkwO1xuICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICBoZWFwID0gbmV3IEFycmF5KDMyKS5maWxsKHVuZGVmaW5lZCk7XG4gICAgICAgICAgICAgICAgICAgIGhlYXAucHVzaCh1bmRlZmluZWQsIG51bGwsIHRydWUsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgaGVhcF9uZXh0ID0gaGVhcC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIGNhY2hlZFRleHREZWNvZGVyID0gbmV3IFRleHREZWNvZGVyKCd1dGYtOCcsIHsgaWdub3JlQk9NOiB0cnVlLCBmYXRhbDogdHJ1ZSB9KTtcbiAgICAgICAgICAgICAgICAgICAgY2FjaGVkVGV4dERlY29kZXIuZGVjb2RlKCk7XG4gICAgICAgICAgICAgICAgICAgIGNhY2hlZFVpbnQ4TWVtb3J5MCA9IG5ldyBVaW50OEFycmF5KCk7XG4gICAgICAgICAgICAgICAgICAgIFdBU01fVkVDVE9SX0xFTiA9IDA7XG4gICAgICAgICAgICAgICAgICAgIGNhY2hlZFRleHRFbmNvZGVyID0gbmV3IFRleHRFbmNvZGVyKCd1dGYtOCcpO1xuICAgICAgICAgICAgICAgICAgICBlbmNvZGVTdHJpbmcgPSAodHlwZW9mIGNhY2hlZFRleHRFbmNvZGVyLmVuY29kZUludG8gPT09ICdmdW5jdGlvbidcbiAgICAgICAgICAgICAgICAgICAgICAgID8gZnVuY3Rpb24gKGFyZywgdmlldykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjYWNoZWRUZXh0RW5jb2Rlci5lbmNvZGVJbnRvKGFyZywgdmlldyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICA6IGZ1bmN0aW9uIChhcmcsIHZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYnVmID0gY2FjaGVkVGV4dEVuY29kZXIuZW5jb2RlKGFyZyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlldy5zZXQoYnVmKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFkOiBhcmcubGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3cml0dGVuOiBidWYubGVuZ3RoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBjYWNoZWRJbnQzMk1lbW9yeTAgPSBuZXcgSW50MzJBcnJheSgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBpbml0KG1vZHVsZSldO1xuICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhc206IHdhc20sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVnaXN0ZXJfbW9kdWxlOiByZWdpc3Rlcl9tb2R1bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbF9tb2R1bGU6IGNhbGxfbW9kdWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgfV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuZXhwb3J0cy5pbml0ID0gaW5pdDtcblxuXG4vLyMgc291cmNlVVJMPXdlYnBhY2s6Ly9AZmx1ZW5jZWxhYnMvbWFyaW5lLndvcmtlci1zY3JpcHQvLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0BmbHVlbmNlbGFicyttYXJpbmUtanNAMC4zLjM4L25vZGVfbW9kdWxlcy9AZmx1ZW5jZWxhYnMvbWFyaW5lLWpzL2Rpc3QvbWFyaW5lX2pzLmpzPyIpOwoKLyoqKi8gfSksCgovKioqLyAiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0BmbHVlbmNlbGFicyttYXJpbmUtanNAMC4zLjM4L25vZGVfbW9kdWxlcy9AZmx1ZW5jZWxhYnMvbWFyaW5lLWpzL2Rpc3Qvc25pcHBldHMvbWFyaW5lLWpzLTZmYWE2N2I4YWY5Y2MxNzMvbWFyaW5lLWpzLmpzIjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAhKioqIC4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9AZmx1ZW5jZWxhYnMrbWFyaW5lLWpzQDAuMy4zOC9ub2RlX21vZHVsZXMvQGZsdWVuY2VsYWJzL21hcmluZS1qcy9kaXN0L3NuaXBwZXRzL21hcmluZS1qcy02ZmFhNjdiOGFmOWNjMTczL21hcmluZS1qcy5qcyAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSA9PiB7CgpldmFsKCJcbi8qXG4gKiBDb3B5cmlnaHQgMjAyMiBGbHVlbmNlIExhYnMgTGltaXRlZFxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoeyB2YWx1ZTogdHJ1ZSB9KSk7XG5leHBvcnRzLnJlYWRfYnl0ZV9yYW5nZSA9IGV4cG9ydHMud3JpdGVfYnl0ZV9yYW5nZSA9IGV4cG9ydHMud3JpdGVfYnl0ZSA9IGV4cG9ydHMucmVhZF9ieXRlID0gZXhwb3J0cy5nZXRfbWVtb3J5X3NpemUgPSBleHBvcnRzLmNhbGxfZXhwb3J0ID0gdm9pZCAwO1xuLy8gSW50ZXJuYWwgQVBJIGlmIG1hcmluZS13ZWIuIE9ubHkgdGhlc2UgZnVuY3Rpb25zIGFyZSB1c2VkIGZvciBpbnRlcmFjdGluZyB3aXRoIFdlYkFzc2VtYmx5Lkluc3RhbmNlXG4vLyBOb25lIG9mIHRoZSBmdW5jdGlvbnMgYmVsb3cgcGVyZm9ybXMgZXJyb3ItY2hlY2tpbmdcbi8vIEl0IGlzIGNhbGxlcidzIHJlc3BvbnNpYmlsaXR5IHRvIGVuc3VyZSB0aGF0IHRoZSBpbnN0YW5jZSBpcyB2YWxpZCBhbmQgaGFzIGFsbCB0aGUgZXhwb3J0cyBhbmQgcmVxdWlyZWQgbWVtb3J5IHNpemVcbi8qKlxuICogQ2FsbHMgYW4gZXhwb3J0IGZ1bmN0aW9uIGZyb20gd2FzbSBtb2R1bGVcbiAqXG4gKiBAcGFyYW0ge1dlYkFzc2VtYmx5Lkluc3RhbmNlfSBpbnN0YW5jZSBpbnN0YW5jZSB3aGljaCB3aWxsIGJlIGNhbGxlZFxuICogQHBhcmFtIHtzdHJpbmd9IGV4cG9ydF9uYW1lIG5hbWUgb2YgdGhlIGV4cG9ydFxuICogQHBhcmFtIHtzdHJpbmd9IGFyZ3MgSlNPTiBhcnJheSBvZiBhcmdzXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBKU09OIGFycmF5IG9mIHJlc3VsdHNcbiAqICovXG5mdW5jdGlvbiBjYWxsX2V4cG9ydChpbnN0YW5jZSwgZXhwb3J0X25hbWUsIGFyZ3MpIHtcbiAgICB2YXIgX2E7XG4gICAgdmFyIHBhcnNlZF9hcmdzID0gSlNPTi5wYXJzZShhcmdzKTtcbiAgICB2YXIgcHJlcGFyZWRfYXJncyA9IFtdO1xuICAgIGZvciAodmFyIGFyZ19pbmRleCA9IDA7IGFyZ19pbmRleCA8IHBhcnNlZF9hcmdzLmxlbmd0aDsgYXJnX2luZGV4KyspIHtcbiAgICAgICAgdmFyIGFyZyA9IHBhcnNlZF9hcmdzW2FyZ19pbmRleF07XG4gICAgICAgIGlmIChhcmdbXCJJMzJcIl0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcHJlcGFyZWRfYXJncy5wdXNoKGFyZ1tcIkkzMlwiXSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFyZ1tcIkk2NFwiXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICA7XG4gICAgICAgICAgICB2YXIgdmFsID0gQmlnSW50KGFyZ1tcIkk2NFwiXSk7XG4gICAgICAgICAgICBwcmVwYXJlZF9hcmdzLnB1c2godmFsKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYXJnW1wiRjMyXCJdICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHByZXBhcmVkX2FyZ3MucHVzaChhcmdbXCJGMzJcIl0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhcmdbXCJGNjRcIl0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcHJlcGFyZWRfYXJncy5wdXNoKGFyZ1tcIkY2NFwiXSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmFyIHJlc3VsdCA9IChfYSA9IGluc3RhbmNlLmV4cG9ydHMpW2V4cG9ydF9uYW1lXS5hcHBseShfYSwgcHJlcGFyZWRfYXJncyk7XG4gICAgdmFyIGpzb25fcmVzdWx0ID0gXCJbXVwiO1xuICAgIGlmIChyZXN1bHQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBpZiAodHlwZW9mIHJlc3VsdCA9PSBcImJpZ2ludFwiKSB7XG4gICAgICAgICAgICBqc29uX3Jlc3VsdCA9IFwiW1wiICsgcmVzdWx0LnRvU3RyaW5nKCkgKyBcIl1cIjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGpzb25fcmVzdWx0ID0gXCJbXCIgKyBKU09OLnN0cmluZ2lmeShyZXN1bHQpICsgXCJdXCI7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGpzb25fcmVzdWx0O1xufVxuZXhwb3J0cy5jYWxsX2V4cG9ydCA9IGNhbGxfZXhwb3J0O1xuLyoqXG4gKiBHZXRzIHNpemUgb2YgdGhlIHdhc20gbWVtb3J5XG4gKlxuICogQHBhcmFtIHtXZWJBc3NlbWJseS5JbnN0YW5jZX0gaW5zdGFuY2UgaW5zdGFuY2Ugd2hpY2ggd2lsbCBiZSBjYWxsZWRcbiAqIEByZXR1cm5zIHtudW1iZXJ9IHNpemUgb2YgZGF0YVxuICogKi9cbmZ1bmN0aW9uIGdldF9tZW1vcnlfc2l6ZShpbnN0YW5jZSkge1xuICAgIHZhciBidWYgPSBuZXcgVWludDhBcnJheShpbnN0YW5jZS5leHBvcnRzLm1lbW9yeS5idWZmZXIpO1xuICAgIHJldHVybiBidWYuYnl0ZUxlbmd0aDtcbn1cbmV4cG9ydHMuZ2V0X21lbW9yeV9zaXplID0gZ2V0X21lbW9yeV9zaXplO1xuLyoqXG4gKiBSZWFkcyBvbmUgYnl0ZSBmcm9tIHdhc20gbWVtb3J5XG4gKlxuICogQHBhcmFtIHtXZWJBc3NlbWJseS5JbnN0YW5jZX0gaW5zdGFuY2UgaW5zdGFuY2Ugd2hpY2ggd2lsbCBiZSB1c2VkXG4gKiBAcGFyYW0ge251bWJlcn0gb2Zmc2V0IG9mZnNldCBpbiB3YXNtIG1lbW9yeVxuICogQHJldHVybnMge251bWJlcn0gYnl0ZSBmcm9tIHdhc20gbWVtb3J5XG4gKiAqL1xuZnVuY3Rpb24gcmVhZF9ieXRlKGluc3RhbmNlLCBvZmZzZXQpIHtcbiAgICB2YXIgYnVmID0gbmV3IFVpbnQ4QXJyYXkoaW5zdGFuY2UuZXhwb3J0cy5tZW1vcnkuYnVmZmVyKTtcbiAgICByZXR1cm4gYnVmW29mZnNldF07XG59XG5leHBvcnRzLnJlYWRfYnl0ZSA9IHJlYWRfYnl0ZTtcbi8qKlxuICogV3JpdGVzIG9uZSBieXRlIHRvIHdhc20gbWVtb3J5XG4gKlxuICogQHBhcmFtIHtXZWJBc3NlbWJseS5JbnN0YW5jZX0gaW5zdGFuY2UgaW5zdGFuY2Ugd2hpY2ggd2lsbCBiZSB1c2VkXG4gKiBAcGFyYW0ge251bWJlcn0gb2Zmc2V0IG9mZnNldCBpbiB3YXNtIG1lbW9yeVxuICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlIHZhbHVlIHRvIHdyaXRlIGluIG1lbW9yeVxuICogKi9cbmZ1bmN0aW9uIHdyaXRlX2J5dGUoaW5zdGFuY2UsIG9mZnNldCwgdmFsdWUpIHtcbiAgICB2YXIgYnVmID0gbmV3IFVpbnQ4QXJyYXkoaW5zdGFuY2UuZXhwb3J0cy5tZW1vcnkuYnVmZmVyKTtcbiAgICBidWZbb2Zmc2V0XSA9IHZhbHVlO1xufVxuZXhwb3J0cy53cml0ZV9ieXRlID0gd3JpdGVfYnl0ZTtcbi8qKlxuICogV3JpdGVzIGJ5dGUgcmFuZ2UgdG8gd2FzbSBtZW1vcnlcbiAqXG4gKiBAcGFyYW0ge1dlYkFzc2VtYmx5Lkluc3RhbmNlfSBpbnN0YW5jZSBpbnN0YW5jZSB3aGljaCB3aWxsIGJlIHVzZWRcbiAqIEBwYXJhbSB7bnVtYmVyfSBvZmZzZXQgb2Zmc2V0IGluIHdhc20gbWVtb3J5XG4gKiBAcGFyYW0ge1VpbnQ4QXJyYXl9IHNsaWNlIGFycmF5IHdpdGggYnl0ZXMgdG8gd3JpdGUgaW50byBtZW1vcnlcbiAqICovXG5mdW5jdGlvbiB3cml0ZV9ieXRlX3JhbmdlKGluc3RhbmNlLCBvZmZzZXQsIHNsaWNlKSB7XG4gICAgdmFyIGJ1ZiA9IG5ldyBVaW50OEFycmF5KGluc3RhbmNlLmV4cG9ydHMubWVtb3J5LmJ1ZmZlcik7XG4gICAgZm9yICh2YXIgYnl0ZV9pbmRleCA9IDA7IGJ5dGVfaW5kZXggPCBzbGljZS5sZW5ndGg7IGJ5dGVfaW5kZXgrKykge1xuICAgICAgICBidWZbb2Zmc2V0ICsgYnl0ZV9pbmRleF0gPSBzbGljZVtieXRlX2luZGV4XTtcbiAgICB9XG59XG5leHBvcnRzLndyaXRlX2J5dGVfcmFuZ2UgPSB3cml0ZV9ieXRlX3JhbmdlO1xuLyoqXG4gKiBSZWFkcyBieXRlIHJhbmdlIGZyb20gd2FzbSBtZW1vcnlcbiAqXG4gKiBAcGFyYW0ge1dlYkFzc2VtYmx5Lkluc3RhbmNlfSBpbnN0YW5jZSBpbnN0YW5jZSB3aGljaCB3aWxsIGJlIHVzZWRcbiAqIEBwYXJhbSB7bnVtYmVyfSBvZmZzZXQgb2Zmc2V0IGluIHdhc20gbWVtb3J5XG4gKiBAcGFyYW0ge1VpbnQ4QXJyYXl9IHNsaWNlIGFycmF5IHRvIHBsYWNlIHJlYWQgYnl0ZXNcbiAqICovXG5mdW5jdGlvbiByZWFkX2J5dGVfcmFuZ2UoaW5zdGFuY2UsIG9mZnNldCwgc2xpY2UpIHtcbiAgICB2YXIgYnVmID0gbmV3IFVpbnQ4QXJyYXkoaW5zdGFuY2UuZXhwb3J0cy5tZW1vcnkuYnVmZmVyKTtcbiAgICBmb3IgKHZhciBieXRlX2luZGV4ID0gMDsgYnl0ZV9pbmRleCA8IHNsaWNlLmxlbmd0aDsgYnl0ZV9pbmRleCsrKSB7XG4gICAgICAgIHNsaWNlW2J5dGVfaW5kZXhdID0gYnVmW29mZnNldCArIGJ5dGVfaW5kZXhdO1xuICAgIH1cbn1cbmV4cG9ydHMucmVhZF9ieXRlX3JhbmdlID0gcmVhZF9ieXRlX3JhbmdlO1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL0BmbHVlbmNlbGFicy9tYXJpbmUud29ya2VyLXNjcmlwdC8uLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQGZsdWVuY2VsYWJzK21hcmluZS1qc0AwLjMuMzgvbm9kZV9tb2R1bGVzL0BmbHVlbmNlbGFicy9tYXJpbmUtanMvZGlzdC9zbmlwcGV0cy9tYXJpbmUtanMtNmZhYTY3YjhhZjljYzE3My9tYXJpbmUtanMuanM/Iik7CgovKioqLyB9KSwKCi8qKiovICIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQGZsdWVuY2VsYWJzK21hcmluZS1qc0AwLjMuMzgvbm9kZV9tb2R1bGVzL0BmbHVlbmNlbGFicy9tYXJpbmUtanMvZGlzdC90eXBlcy5qcyI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAhKioqIC4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9AZmx1ZW5jZWxhYnMrbWFyaW5lLWpzQDAuMy4zOC9ub2RlX21vZHVsZXMvQGZsdWVuY2VsYWJzL21hcmluZS1qcy9kaXN0L3R5cGVzLmpzICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykgPT4gewoKZXZhbCgiXG4vKlxuICogQ29weXJpZ2h0IDIwMjIgRmx1ZW5jZSBMYWJzIExpbWl0ZWRcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHsgdmFsdWU6IHRydWUgfSkpO1xuZXhwb3J0cy5sb2dMZXZlbFRvRW52ID0gZXhwb3J0cy5pc0xvZ0xldmVsID0gZXhwb3J0cy5sb2dMZXZlbHMgPSB2b2lkIDA7XG5leHBvcnRzLmxvZ0xldmVscyA9IFsndHJhY2UnLCAnZGVidWcnLCAnaW5mbycsICd3YXJuJywgJ2Vycm9yJ107XG52YXIgaXNMb2dMZXZlbCA9IGZ1bmN0aW9uICh1bmtub3duKSB7IHJldHVybiBleHBvcnRzLmxvZ0xldmVscy5zb21lKGZ1bmN0aW9uICh2YWwpIHsgcmV0dXJuIHVua25vd24gPT09IHZhbDsgfSk7IH07XG5leHBvcnRzLmlzTG9nTGV2ZWwgPSBpc0xvZ0xldmVsO1xudmFyIGxvZ0xldmVsVG9FbnYgPSBmdW5jdGlvbiAobGV2ZWwpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBXQVNNX0xPRzogbGV2ZWwsXG4gICAgfTtcbn07XG5leHBvcnRzLmxvZ0xldmVsVG9FbnYgPSBsb2dMZXZlbFRvRW52O1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL0BmbHVlbmNlbGFicy9tYXJpbmUud29ya2VyLXNjcmlwdC8uLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQGZsdWVuY2VsYWJzK21hcmluZS1qc0AwLjMuMzgvbm9kZV9tb2R1bGVzL0BmbHVlbmNlbGFicy9tYXJpbmUtanMvZGlzdC90eXBlcy5qcz8iKTsKCi8qKiovIH0pLAoKLyoqKi8gIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9Ad2FzbWVyK3dhc2lAMC4xMi4wL25vZGVfbW9kdWxlcy9Ad2FzbWVyL3dhc2kvbGliL2JpbmRpbmdzL2Jyb3dzZXIuanMiOgovKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAhKioqIC4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9Ad2FzbWVyK3dhc2lAMC4xMi4wL25vZGVfbW9kdWxlcy9Ad2FzbWVyL3dhc2kvbGliL2JpbmRpbmdzL2Jyb3dzZXIuanMgKioqIQogIFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pID0+IHsKCmV2YWwoIlxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoeyB2YWx1ZTogdHJ1ZSB9KSk7XG4vLyBAdHMtaWdub3JlXG52YXIgcmFuZG9tZmlsbCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIHJhbmRvbWZpbGwgKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vcmFuZG9tZmlsbEAxLjAuNC9ub2RlX21vZHVsZXMvcmFuZG9tZmlsbC9icm93c2VyLmpzXCIpO1xudmFyIGJyb3dzZXJfaHJ0aW1lXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuLi9wb2x5ZmlsbHMvYnJvd3Nlci1ocnRpbWUgKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQHdhc21lcit3YXNpQDAuMTIuMC9ub2RlX21vZHVsZXMvQHdhc21lci93YXNpL2xpYi9wb2x5ZmlsbHMvYnJvd3Nlci1ocnRpbWUuanNcIik7XG4vLyBAdHMtaWdub3JlXG52YXIgcGF0aCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIHBhdGgtYnJvd3NlcmlmeSAqLyBcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9wYXRoLWJyb3dzZXJpZnlAMS4wLjEvbm9kZV9tb2R1bGVzL3BhdGgtYnJvd3NlcmlmeS9pbmRleC5qc1wiKTtcbnZhciBpbmRleF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi4vaW5kZXggKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQHdhc21lcit3YXNpQDAuMTIuMC9ub2RlX21vZHVsZXMvQHdhc21lci93YXNpL2xpYi9pbmRleC5qc1wiKTtcbnZhciBocnRpbWVfYmlnaW50XzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuLi9wb2x5ZmlsbHMvaHJ0aW1lLmJpZ2ludCAqLyBcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9Ad2FzbWVyK3dhc2lAMC4xMi4wL25vZGVfbW9kdWxlcy9Ad2FzbWVyL3dhc2kvbGliL3BvbHlmaWxscy9ocnRpbWUuYmlnaW50LmpzXCIpO1xudmFyIGJpbmRpbmdzID0ge1xuICAgIGhydGltZTogaHJ0aW1lX2JpZ2ludF8xLmRlZmF1bHQoYnJvd3Nlcl9ocnRpbWVfMS5kZWZhdWx0KSxcbiAgICBleGl0OiBmdW5jdGlvbiAoY29kZSkge1xuICAgICAgICB0aHJvdyBuZXcgaW5kZXhfMS5XQVNJRXhpdEVycm9yKGNvZGUpO1xuICAgIH0sXG4gICAga2lsbDogZnVuY3Rpb24gKHNpZ25hbCkge1xuICAgICAgICB0aHJvdyBuZXcgaW5kZXhfMS5XQVNJS2lsbEVycm9yKHNpZ25hbCk7XG4gICAgfSxcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgcmFuZG9tRmlsbFN5bmM6IHJhbmRvbWZpbGwucmFuZG9tRmlsbFN5bmMsXG4gICAgaXNUVFk6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRydWU7IH0sXG4gICAgcGF0aDogcGF0aCxcbiAgICAvLyBMZXQgdGhlIHVzZXIgYXR0YWNoIHRoZSBmcyBhdCBydW50aW1lXG4gICAgZnM6IG51bGxcbn07XG5leHBvcnRzW1wiZGVmYXVsdFwiXSA9IGJpbmRpbmdzO1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL0BmbHVlbmNlbGFicy9tYXJpbmUud29ya2VyLXNjcmlwdC8uLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQHdhc21lcit3YXNpQDAuMTIuMC9ub2RlX21vZHVsZXMvQHdhc21lci93YXNpL2xpYi9iaW5kaW5ncy9icm93c2VyLmpzPyIpOwoKLyoqKi8gfSksCgovKioqLyAiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0B3YXNtZXIrd2FzaUAwLjEyLjAvbm9kZV9tb2R1bGVzL0B3YXNtZXIvd2FzaS9saWIvY29uc3RhbnRzLmpzIjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAhKioqIC4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9Ad2FzbWVyK3dhc2lAMC4xMi4wL25vZGVfbW9kdWxlcy9Ad2FzbWVyL3dhc2kvbGliL2NvbnN0YW50cy5qcyAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSA9PiB7CgpldmFsKCJcbnZhciBfYTtcbi8qXG5cblRoaXMgcHJvamVjdCBpcyBiYXNlZCBmcm9tIHRoZSBOb2RlIGltcGxlbWVudGF0aW9uIG1hZGUgYnkgR3VzIENhcGxhblxuaHR0cHM6Ly9naXRodWIuY29tL2RldnNuZWsvbm9kZS13YXNpXG5Ib3dldmVyLCBKYXZhU2NyaXB0IFdBU0kgaXMgZm9jdXNlZCBvbjpcbiAqIEJyaW5naW5nIFdBU0kgdG8gdGhlIEJyb3dzZXJzXG4gKiBNYWtlIGVhc3kgdG8gcGx1ZyBkaWZmZXJlbnQgZmlsZXN5c3RlbXNcbiAqIFByb3ZpZGUgYSB0eXBlLXNhZmUgYXBpIHVzaW5nIFR5cGVzY3JpcHRcblxuXG5Db3B5cmlnaHQgMjAxOSBHdXMgQ2FwbGFuXG5cblBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbm9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvXG5kZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZVxucmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yXG5zZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcblxuVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbmFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuXG5USEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG5JTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbkZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkdcbkZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1NcbklOIFRIRSBTT0ZUV0FSRS5cblxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7IHZhbHVlOiB0cnVlIH0pKTtcbnZhciBiaWdpbnRfMSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vcG9seWZpbGxzL2JpZ2ludCAqLyBcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9Ad2FzbWVyK3dhc2lAMC4xMi4wL25vZGVfbW9kdWxlcy9Ad2FzbWVyL3dhc2kvbGliL3BvbHlmaWxscy9iaWdpbnQuanNcIik7XG5leHBvcnRzLldBU0lfRVNVQ0NFU1MgPSAwO1xuZXhwb3J0cy5XQVNJX0UyQklHID0gMTtcbmV4cG9ydHMuV0FTSV9FQUNDRVMgPSAyO1xuZXhwb3J0cy5XQVNJX0VBRERSSU5VU0UgPSAzO1xuZXhwb3J0cy5XQVNJX0VBRERSTk9UQVZBSUwgPSA0O1xuZXhwb3J0cy5XQVNJX0VBRk5PU1VQUE9SVCA9IDU7XG5leHBvcnRzLldBU0lfRUFHQUlOID0gNjtcbmV4cG9ydHMuV0FTSV9FQUxSRUFEWSA9IDc7XG5leHBvcnRzLldBU0lfRUJBREYgPSA4O1xuZXhwb3J0cy5XQVNJX0VCQURNU0cgPSA5O1xuZXhwb3J0cy5XQVNJX0VCVVNZID0gMTA7XG5leHBvcnRzLldBU0lfRUNBTkNFTEVEID0gMTE7XG5leHBvcnRzLldBU0lfRUNISUxEID0gMTI7XG5leHBvcnRzLldBU0lfRUNPTk5BQk9SVEVEID0gMTM7XG5leHBvcnRzLldBU0lfRUNPTk5SRUZVU0VEID0gMTQ7XG5leHBvcnRzLldBU0lfRUNPTk5SRVNFVCA9IDE1O1xuZXhwb3J0cy5XQVNJX0VERUFETEsgPSAxNjtcbmV4cG9ydHMuV0FTSV9FREVTVEFERFJSRVEgPSAxNztcbmV4cG9ydHMuV0FTSV9FRE9NID0gMTg7XG5leHBvcnRzLldBU0lfRURRVU9UID0gMTk7XG5leHBvcnRzLldBU0lfRUVYSVNUID0gMjA7XG5leHBvcnRzLldBU0lfRUZBVUxUID0gMjE7XG5leHBvcnRzLldBU0lfRUZCSUcgPSAyMjtcbmV4cG9ydHMuV0FTSV9FSE9TVFVOUkVBQ0ggPSAyMztcbmV4cG9ydHMuV0FTSV9FSURSTSA9IDI0O1xuZXhwb3J0cy5XQVNJX0VJTFNFUSA9IDI1O1xuZXhwb3J0cy5XQVNJX0VJTlBST0dSRVNTID0gMjY7XG5leHBvcnRzLldBU0lfRUlOVFIgPSAyNztcbmV4cG9ydHMuV0FTSV9FSU5WQUwgPSAyODtcbmV4cG9ydHMuV0FTSV9FSU8gPSAyOTtcbmV4cG9ydHMuV0FTSV9FSVNDT05OID0gMzA7XG5leHBvcnRzLldBU0lfRUlTRElSID0gMzE7XG5leHBvcnRzLldBU0lfRUxPT1AgPSAzMjtcbmV4cG9ydHMuV0FTSV9FTUZJTEUgPSAzMztcbmV4cG9ydHMuV0FTSV9FTUxJTksgPSAzNDtcbmV4cG9ydHMuV0FTSV9FTVNHU0laRSA9IDM1O1xuZXhwb3J0cy5XQVNJX0VNVUxUSUhPUCA9IDM2O1xuZXhwb3J0cy5XQVNJX0VOQU1FVE9PTE9ORyA9IDM3O1xuZXhwb3J0cy5XQVNJX0VORVRET1dOID0gMzg7XG5leHBvcnRzLldBU0lfRU5FVFJFU0VUID0gMzk7XG5leHBvcnRzLldBU0lfRU5FVFVOUkVBQ0ggPSA0MDtcbmV4cG9ydHMuV0FTSV9FTkZJTEUgPSA0MTtcbmV4cG9ydHMuV0FTSV9FTk9CVUZTID0gNDI7XG5leHBvcnRzLldBU0lfRU5PREVWID0gNDM7XG5leHBvcnRzLldBU0lfRU5PRU5UID0gNDQ7XG5leHBvcnRzLldBU0lfRU5PRVhFQyA9IDQ1O1xuZXhwb3J0cy5XQVNJX0VOT0xDSyA9IDQ2O1xuZXhwb3J0cy5XQVNJX0VOT0xJTksgPSA0NztcbmV4cG9ydHMuV0FTSV9FTk9NRU0gPSA0ODtcbmV4cG9ydHMuV0FTSV9FTk9NU0cgPSA0OTtcbmV4cG9ydHMuV0FTSV9FTk9QUk9UT09QVCA9IDUwO1xuZXhwb3J0cy5XQVNJX0VOT1NQQyA9IDUxO1xuZXhwb3J0cy5XQVNJX0VOT1NZUyA9IDUyO1xuZXhwb3J0cy5XQVNJX0VOT1RDT05OID0gNTM7XG5leHBvcnRzLldBU0lfRU5PVERJUiA9IDU0O1xuZXhwb3J0cy5XQVNJX0VOT1RFTVBUWSA9IDU1O1xuZXhwb3J0cy5XQVNJX0VOT1RSRUNPVkVSQUJMRSA9IDU2O1xuZXhwb3J0cy5XQVNJX0VOT1RTT0NLID0gNTc7XG5leHBvcnRzLldBU0lfRU5PVFNVUCA9IDU4O1xuZXhwb3J0cy5XQVNJX0VOT1RUWSA9IDU5O1xuZXhwb3J0cy5XQVNJX0VOWElPID0gNjA7XG5leHBvcnRzLldBU0lfRU9WRVJGTE9XID0gNjE7XG5leHBvcnRzLldBU0lfRU9XTkVSREVBRCA9IDYyO1xuZXhwb3J0cy5XQVNJX0VQRVJNID0gNjM7XG5leHBvcnRzLldBU0lfRVBJUEUgPSA2NDtcbmV4cG9ydHMuV0FTSV9FUFJPVE8gPSA2NTtcbmV4cG9ydHMuV0FTSV9FUFJPVE9OT1NVUFBPUlQgPSA2NjtcbmV4cG9ydHMuV0FTSV9FUFJPVE9UWVBFID0gNjc7XG5leHBvcnRzLldBU0lfRVJBTkdFID0gNjg7XG5leHBvcnRzLldBU0lfRVJPRlMgPSA2OTtcbmV4cG9ydHMuV0FTSV9FU1BJUEUgPSA3MDtcbmV4cG9ydHMuV0FTSV9FU1JDSCA9IDcxO1xuZXhwb3J0cy5XQVNJX0VTVEFMRSA9IDcyO1xuZXhwb3J0cy5XQVNJX0VUSU1FRE9VVCA9IDczO1xuZXhwb3J0cy5XQVNJX0VUWFRCU1kgPSA3NDtcbmV4cG9ydHMuV0FTSV9FWERFViA9IDc1O1xuZXhwb3J0cy5XQVNJX0VOT1RDQVBBQkxFID0gNzY7XG5leHBvcnRzLldBU0lfU0lHQUJSVCA9IDA7XG5leHBvcnRzLldBU0lfU0lHQUxSTSA9IDE7XG5leHBvcnRzLldBU0lfU0lHQlVTID0gMjtcbmV4cG9ydHMuV0FTSV9TSUdDSExEID0gMztcbmV4cG9ydHMuV0FTSV9TSUdDT05UID0gNDtcbmV4cG9ydHMuV0FTSV9TSUdGUEUgPSA1O1xuZXhwb3J0cy5XQVNJX1NJR0hVUCA9IDY7XG5leHBvcnRzLldBU0lfU0lHSUxMID0gNztcbmV4cG9ydHMuV0FTSV9TSUdJTlQgPSA4O1xuZXhwb3J0cy5XQVNJX1NJR0tJTEwgPSA5O1xuZXhwb3J0cy5XQVNJX1NJR1BJUEUgPSAxMDtcbmV4cG9ydHMuV0FTSV9TSUdRVUlUID0gMTE7XG5leHBvcnRzLldBU0lfU0lHU0VHViA9IDEyO1xuZXhwb3J0cy5XQVNJX1NJR1NUT1AgPSAxMztcbmV4cG9ydHMuV0FTSV9TSUdURVJNID0gMTQ7XG5leHBvcnRzLldBU0lfU0lHVFJBUCA9IDE1O1xuZXhwb3J0cy5XQVNJX1NJR1RTVFAgPSAxNjtcbmV4cG9ydHMuV0FTSV9TSUdUVElOID0gMTc7XG5leHBvcnRzLldBU0lfU0lHVFRPVSA9IDE4O1xuZXhwb3J0cy5XQVNJX1NJR1VSRyA9IDE5O1xuZXhwb3J0cy5XQVNJX1NJR1VTUjEgPSAyMDtcbmV4cG9ydHMuV0FTSV9TSUdVU1IyID0gMjE7XG5leHBvcnRzLldBU0lfU0lHVlRBTFJNID0gMjI7XG5leHBvcnRzLldBU0lfU0lHWENQVSA9IDIzO1xuZXhwb3J0cy5XQVNJX1NJR1hGU1ogPSAyNDtcbmV4cG9ydHMuV0FTSV9GSUxFVFlQRV9VTktOT1dOID0gMDtcbmV4cG9ydHMuV0FTSV9GSUxFVFlQRV9CTE9DS19ERVZJQ0UgPSAxO1xuZXhwb3J0cy5XQVNJX0ZJTEVUWVBFX0NIQVJBQ1RFUl9ERVZJQ0UgPSAyO1xuZXhwb3J0cy5XQVNJX0ZJTEVUWVBFX0RJUkVDVE9SWSA9IDM7XG5leHBvcnRzLldBU0lfRklMRVRZUEVfUkVHVUxBUl9GSUxFID0gNDtcbmV4cG9ydHMuV0FTSV9GSUxFVFlQRV9TT0NLRVRfREdSQU0gPSA1O1xuZXhwb3J0cy5XQVNJX0ZJTEVUWVBFX1NPQ0tFVF9TVFJFQU0gPSA2O1xuZXhwb3J0cy5XQVNJX0ZJTEVUWVBFX1NZTUJPTElDX0xJTksgPSA3O1xuZXhwb3J0cy5XQVNJX0ZERkxBR19BUFBFTkQgPSAweDAwMDE7XG5leHBvcnRzLldBU0lfRkRGTEFHX0RTWU5DID0gMHgwMDAyO1xuZXhwb3J0cy5XQVNJX0ZERkxBR19OT05CTE9DSyA9IDB4MDAwNDtcbmV4cG9ydHMuV0FTSV9GREZMQUdfUlNZTkMgPSAweDAwMDg7XG5leHBvcnRzLldBU0lfRkRGTEFHX1NZTkMgPSAweDAwMTA7XG5leHBvcnRzLldBU0lfUklHSFRfRkRfREFUQVNZTkMgPSBiaWdpbnRfMS5CaWdJbnRQb2x5ZmlsbCgweDAwMDAwMDAwMDAwMDAwMDEpO1xuZXhwb3J0cy5XQVNJX1JJR0hUX0ZEX1JFQUQgPSBiaWdpbnRfMS5CaWdJbnRQb2x5ZmlsbCgweDAwMDAwMDAwMDAwMDAwMDIpO1xuZXhwb3J0cy5XQVNJX1JJR0hUX0ZEX1NFRUsgPSBiaWdpbnRfMS5CaWdJbnRQb2x5ZmlsbCgweDAwMDAwMDAwMDAwMDAwMDQpO1xuZXhwb3J0cy5XQVNJX1JJR0hUX0ZEX0ZEU1RBVF9TRVRfRkxBR1MgPSBiaWdpbnRfMS5CaWdJbnRQb2x5ZmlsbCgweDAwMDAwMDAwMDAwMDAwMDgpO1xuZXhwb3J0cy5XQVNJX1JJR0hUX0ZEX1NZTkMgPSBiaWdpbnRfMS5CaWdJbnRQb2x5ZmlsbCgweDAwMDAwMDAwMDAwMDAwMTApO1xuZXhwb3J0cy5XQVNJX1JJR0hUX0ZEX1RFTEwgPSBiaWdpbnRfMS5CaWdJbnRQb2x5ZmlsbCgweDAwMDAwMDAwMDAwMDAwMjApO1xuZXhwb3J0cy5XQVNJX1JJR0hUX0ZEX1dSSVRFID0gYmlnaW50XzEuQmlnSW50UG9seWZpbGwoMHgwMDAwMDAwMDAwMDAwMDQwKTtcbmV4cG9ydHMuV0FTSV9SSUdIVF9GRF9BRFZJU0UgPSBiaWdpbnRfMS5CaWdJbnRQb2x5ZmlsbCgweDAwMDAwMDAwMDAwMDAwODApO1xuZXhwb3J0cy5XQVNJX1JJR0hUX0ZEX0FMTE9DQVRFID0gYmlnaW50XzEuQmlnSW50UG9seWZpbGwoMHgwMDAwMDAwMDAwMDAwMTAwKTtcbmV4cG9ydHMuV0FTSV9SSUdIVF9QQVRIX0NSRUFURV9ESVJFQ1RPUlkgPSBiaWdpbnRfMS5CaWdJbnRQb2x5ZmlsbCgweDAwMDAwMDAwMDAwMDAyMDApO1xuZXhwb3J0cy5XQVNJX1JJR0hUX1BBVEhfQ1JFQVRFX0ZJTEUgPSBiaWdpbnRfMS5CaWdJbnRQb2x5ZmlsbCgweDAwMDAwMDAwMDAwMDA0MDApO1xuZXhwb3J0cy5XQVNJX1JJR0hUX1BBVEhfTElOS19TT1VSQ0UgPSBiaWdpbnRfMS5CaWdJbnRQb2x5ZmlsbCgweDAwMDAwMDAwMDAwMDA4MDApO1xuZXhwb3J0cy5XQVNJX1JJR0hUX1BBVEhfTElOS19UQVJHRVQgPSBiaWdpbnRfMS5CaWdJbnRQb2x5ZmlsbCgweDAwMDAwMDAwMDAwMDEwMDApO1xuZXhwb3J0cy5XQVNJX1JJR0hUX1BBVEhfT1BFTiA9IGJpZ2ludF8xLkJpZ0ludFBvbHlmaWxsKDB4MDAwMDAwMDAwMDAwMjAwMCk7XG5leHBvcnRzLldBU0lfUklHSFRfRkRfUkVBRERJUiA9IGJpZ2ludF8xLkJpZ0ludFBvbHlmaWxsKDB4MDAwMDAwMDAwMDAwNDAwMCk7XG5leHBvcnRzLldBU0lfUklHSFRfUEFUSF9SRUFETElOSyA9IGJpZ2ludF8xLkJpZ0ludFBvbHlmaWxsKDB4MDAwMDAwMDAwMDAwODAwMCk7XG5leHBvcnRzLldBU0lfUklHSFRfUEFUSF9SRU5BTUVfU09VUkNFID0gYmlnaW50XzEuQmlnSW50UG9seWZpbGwoMHgwMDAwMDAwMDAwMDEwMDAwKTtcbmV4cG9ydHMuV0FTSV9SSUdIVF9QQVRIX1JFTkFNRV9UQVJHRVQgPSBiaWdpbnRfMS5CaWdJbnRQb2x5ZmlsbCgweDAwMDAwMDAwMDAwMjAwMDApO1xuZXhwb3J0cy5XQVNJX1JJR0hUX1BBVEhfRklMRVNUQVRfR0VUID0gYmlnaW50XzEuQmlnSW50UG9seWZpbGwoMHgwMDAwMDAwMDAwMDQwMDAwKTtcbmV4cG9ydHMuV0FTSV9SSUdIVF9QQVRIX0ZJTEVTVEFUX1NFVF9TSVpFID0gYmlnaW50XzEuQmlnSW50UG9seWZpbGwoMHgwMDAwMDAwMDAwMDgwMDAwKTtcbmV4cG9ydHMuV0FTSV9SSUdIVF9QQVRIX0ZJTEVTVEFUX1NFVF9USU1FUyA9IGJpZ2ludF8xLkJpZ0ludFBvbHlmaWxsKDB4MDAwMDAwMDAwMDEwMDAwMCk7XG5leHBvcnRzLldBU0lfUklHSFRfRkRfRklMRVNUQVRfR0VUID0gYmlnaW50XzEuQmlnSW50UG9seWZpbGwoMHgwMDAwMDAwMDAwMjAwMDAwKTtcbmV4cG9ydHMuV0FTSV9SSUdIVF9GRF9GSUxFU1RBVF9TRVRfU0laRSA9IGJpZ2ludF8xLkJpZ0ludFBvbHlmaWxsKDB4MDAwMDAwMDAwMDQwMDAwMCk7XG5leHBvcnRzLldBU0lfUklHSFRfRkRfRklMRVNUQVRfU0VUX1RJTUVTID0gYmlnaW50XzEuQmlnSW50UG9seWZpbGwoMHgwMDAwMDAwMDAwODAwMDAwKTtcbmV4cG9ydHMuV0FTSV9SSUdIVF9QQVRIX1NZTUxJTksgPSBiaWdpbnRfMS5CaWdJbnRQb2x5ZmlsbCgweDAwMDAwMDAwMDEwMDAwMDApO1xuZXhwb3J0cy5XQVNJX1JJR0hUX1BBVEhfUkVNT1ZFX0RJUkVDVE9SWSA9IGJpZ2ludF8xLkJpZ0ludFBvbHlmaWxsKDB4MDAwMDAwMDAwMjAwMDAwMCk7XG5leHBvcnRzLldBU0lfUklHSFRfUEFUSF9VTkxJTktfRklMRSA9IGJpZ2ludF8xLkJpZ0ludFBvbHlmaWxsKDB4MDAwMDAwMDAwNDAwMDAwMCk7XG5leHBvcnRzLldBU0lfUklHSFRfUE9MTF9GRF9SRUFEV1JJVEUgPSBiaWdpbnRfMS5CaWdJbnRQb2x5ZmlsbCgweDAwMDAwMDAwMDgwMDAwMDApO1xuZXhwb3J0cy5XQVNJX1JJR0hUX1NPQ0tfU0hVVERPV04gPSBiaWdpbnRfMS5CaWdJbnRQb2x5ZmlsbCgweDAwMDAwMDAwMTAwMDAwMDApO1xuZXhwb3J0cy5SSUdIVFNfQUxMID0gZXhwb3J0cy5XQVNJX1JJR0hUX0ZEX0RBVEFTWU5DIHxcbiAgICBleHBvcnRzLldBU0lfUklHSFRfRkRfUkVBRCB8XG4gICAgZXhwb3J0cy5XQVNJX1JJR0hUX0ZEX1NFRUsgfFxuICAgIGV4cG9ydHMuV0FTSV9SSUdIVF9GRF9GRFNUQVRfU0VUX0ZMQUdTIHxcbiAgICBleHBvcnRzLldBU0lfUklHSFRfRkRfU1lOQyB8XG4gICAgZXhwb3J0cy5XQVNJX1JJR0hUX0ZEX1RFTEwgfFxuICAgIGV4cG9ydHMuV0FTSV9SSUdIVF9GRF9XUklURSB8XG4gICAgZXhwb3J0cy5XQVNJX1JJR0hUX0ZEX0FEVklTRSB8XG4gICAgZXhwb3J0cy5XQVNJX1JJR0hUX0ZEX0FMTE9DQVRFIHxcbiAgICBleHBvcnRzLldBU0lfUklHSFRfUEFUSF9DUkVBVEVfRElSRUNUT1JZIHxcbiAgICBleHBvcnRzLldBU0lfUklHSFRfUEFUSF9DUkVBVEVfRklMRSB8XG4gICAgZXhwb3J0cy5XQVNJX1JJR0hUX1BBVEhfTElOS19TT1VSQ0UgfFxuICAgIGV4cG9ydHMuV0FTSV9SSUdIVF9QQVRIX0xJTktfVEFSR0VUIHxcbiAgICBleHBvcnRzLldBU0lfUklHSFRfUEFUSF9PUEVOIHxcbiAgICBleHBvcnRzLldBU0lfUklHSFRfRkRfUkVBRERJUiB8XG4gICAgZXhwb3J0cy5XQVNJX1JJR0hUX1BBVEhfUkVBRExJTksgfFxuICAgIGV4cG9ydHMuV0FTSV9SSUdIVF9QQVRIX1JFTkFNRV9TT1VSQ0UgfFxuICAgIGV4cG9ydHMuV0FTSV9SSUdIVF9QQVRIX1JFTkFNRV9UQVJHRVQgfFxuICAgIGV4cG9ydHMuV0FTSV9SSUdIVF9QQVRIX0ZJTEVTVEFUX0dFVCB8XG4gICAgZXhwb3J0cy5XQVNJX1JJR0hUX1BBVEhfRklMRVNUQVRfU0VUX1NJWkUgfFxuICAgIGV4cG9ydHMuV0FTSV9SSUdIVF9QQVRIX0ZJTEVTVEFUX1NFVF9USU1FUyB8XG4gICAgZXhwb3J0cy5XQVNJX1JJR0hUX0ZEX0ZJTEVTVEFUX0dFVCB8XG4gICAgZXhwb3J0cy5XQVNJX1JJR0hUX0ZEX0ZJTEVTVEFUX1NFVF9USU1FUyB8XG4gICAgZXhwb3J0cy5XQVNJX1JJR0hUX0ZEX0ZJTEVTVEFUX1NFVF9TSVpFIHxcbiAgICBleHBvcnRzLldBU0lfUklHSFRfUEFUSF9TWU1MSU5LIHxcbiAgICBleHBvcnRzLldBU0lfUklHSFRfUEFUSF9VTkxJTktfRklMRSB8XG4gICAgZXhwb3J0cy5XQVNJX1JJR0hUX1BBVEhfUkVNT1ZFX0RJUkVDVE9SWSB8XG4gICAgZXhwb3J0cy5XQVNJX1JJR0hUX1BPTExfRkRfUkVBRFdSSVRFIHxcbiAgICBleHBvcnRzLldBU0lfUklHSFRfU09DS19TSFVURE9XTjtcbmV4cG9ydHMuUklHSFRTX0JMT0NLX0RFVklDRV9CQVNFID0gZXhwb3J0cy5SSUdIVFNfQUxMO1xuZXhwb3J0cy5SSUdIVFNfQkxPQ0tfREVWSUNFX0lOSEVSSVRJTkcgPSBleHBvcnRzLlJJR0hUU19BTEw7XG5leHBvcnRzLlJJR0hUU19DSEFSQUNURVJfREVWSUNFX0JBU0UgPSBleHBvcnRzLlJJR0hUU19BTEw7XG5leHBvcnRzLlJJR0hUU19DSEFSQUNURVJfREVWSUNFX0lOSEVSSVRJTkcgPSBleHBvcnRzLlJJR0hUU19BTEw7XG5leHBvcnRzLlJJR0hUU19SRUdVTEFSX0ZJTEVfQkFTRSA9IGV4cG9ydHMuV0FTSV9SSUdIVF9GRF9EQVRBU1lOQyB8XG4gICAgZXhwb3J0cy5XQVNJX1JJR0hUX0ZEX1JFQUQgfFxuICAgIGV4cG9ydHMuV0FTSV9SSUdIVF9GRF9TRUVLIHxcbiAgICBleHBvcnRzLldBU0lfUklHSFRfRkRfRkRTVEFUX1NFVF9GTEFHUyB8XG4gICAgZXhwb3J0cy5XQVNJX1JJR0hUX0ZEX1NZTkMgfFxuICAgIGV4cG9ydHMuV0FTSV9SSUdIVF9GRF9URUxMIHxcbiAgICBleHBvcnRzLldBU0lfUklHSFRfRkRfV1JJVEUgfFxuICAgIGV4cG9ydHMuV0FTSV9SSUdIVF9GRF9BRFZJU0UgfFxuICAgIGV4cG9ydHMuV0FTSV9SSUdIVF9GRF9BTExPQ0FURSB8XG4gICAgZXhwb3J0cy5XQVNJX1JJR0hUX0ZEX0ZJTEVTVEFUX0dFVCB8XG4gICAgZXhwb3J0cy5XQVNJX1JJR0hUX0ZEX0ZJTEVTVEFUX1NFVF9TSVpFIHxcbiAgICBleHBvcnRzLldBU0lfUklHSFRfRkRfRklMRVNUQVRfU0VUX1RJTUVTIHxcbiAgICBleHBvcnRzLldBU0lfUklHSFRfUE9MTF9GRF9SRUFEV1JJVEU7XG5leHBvcnRzLlJJR0hUU19SRUdVTEFSX0ZJTEVfSU5IRVJJVElORyA9IGJpZ2ludF8xLkJpZ0ludFBvbHlmaWxsKDApO1xuZXhwb3J0cy5SSUdIVFNfRElSRUNUT1JZX0JBU0UgPSBleHBvcnRzLldBU0lfUklHSFRfRkRfRkRTVEFUX1NFVF9GTEFHUyB8XG4gICAgZXhwb3J0cy5XQVNJX1JJR0hUX0ZEX1NZTkMgfFxuICAgIGV4cG9ydHMuV0FTSV9SSUdIVF9GRF9BRFZJU0UgfFxuICAgIGV4cG9ydHMuV0FTSV9SSUdIVF9QQVRIX0NSRUFURV9ESVJFQ1RPUlkgfFxuICAgIGV4cG9ydHMuV0FTSV9SSUdIVF9QQVRIX0NSRUFURV9GSUxFIHxcbiAgICBleHBvcnRzLldBU0lfUklHSFRfUEFUSF9MSU5LX1NPVVJDRSB8XG4gICAgZXhwb3J0cy5XQVNJX1JJR0hUX1BBVEhfTElOS19UQVJHRVQgfFxuICAgIGV4cG9ydHMuV0FTSV9SSUdIVF9QQVRIX09QRU4gfFxuICAgIGV4cG9ydHMuV0FTSV9SSUdIVF9GRF9SRUFERElSIHxcbiAgICBleHBvcnRzLldBU0lfUklHSFRfUEFUSF9SRUFETElOSyB8XG4gICAgZXhwb3J0cy5XQVNJX1JJR0hUX1BBVEhfUkVOQU1FX1NPVVJDRSB8XG4gICAgZXhwb3J0cy5XQVNJX1JJR0hUX1BBVEhfUkVOQU1FX1RBUkdFVCB8XG4gICAgZXhwb3J0cy5XQVNJX1JJR0hUX1BBVEhfRklMRVNUQVRfR0VUIHxcbiAgICBleHBvcnRzLldBU0lfUklHSFRfUEFUSF9GSUxFU1RBVF9TRVRfU0laRSB8XG4gICAgZXhwb3J0cy5XQVNJX1JJR0hUX1BBVEhfRklMRVNUQVRfU0VUX1RJTUVTIHxcbiAgICBleHBvcnRzLldBU0lfUklHSFRfRkRfRklMRVNUQVRfR0VUIHxcbiAgICBleHBvcnRzLldBU0lfUklHSFRfRkRfRklMRVNUQVRfU0VUX1RJTUVTIHxcbiAgICBleHBvcnRzLldBU0lfUklHSFRfUEFUSF9TWU1MSU5LIHxcbiAgICBleHBvcnRzLldBU0lfUklHSFRfUEFUSF9VTkxJTktfRklMRSB8XG4gICAgZXhwb3J0cy5XQVNJX1JJR0hUX1BBVEhfUkVNT1ZFX0RJUkVDVE9SWSB8XG4gICAgZXhwb3J0cy5XQVNJX1JJR0hUX1BPTExfRkRfUkVBRFdSSVRFO1xuZXhwb3J0cy5SSUdIVFNfRElSRUNUT1JZX0lOSEVSSVRJTkcgPSBleHBvcnRzLlJJR0hUU19ESVJFQ1RPUllfQkFTRSB8IGV4cG9ydHMuUklHSFRTX1JFR1VMQVJfRklMRV9CQVNFO1xuZXhwb3J0cy5SSUdIVFNfU09DS0VUX0JBU0UgPSBleHBvcnRzLldBU0lfUklHSFRfRkRfUkVBRCB8XG4gICAgZXhwb3J0cy5XQVNJX1JJR0hUX0ZEX0ZEU1RBVF9TRVRfRkxBR1MgfFxuICAgIGV4cG9ydHMuV0FTSV9SSUdIVF9GRF9XUklURSB8XG4gICAgZXhwb3J0cy5XQVNJX1JJR0hUX0ZEX0ZJTEVTVEFUX0dFVCB8XG4gICAgZXhwb3J0cy5XQVNJX1JJR0hUX1BPTExfRkRfUkVBRFdSSVRFIHxcbiAgICBleHBvcnRzLldBU0lfUklHSFRfU09DS19TSFVURE9XTjtcbmV4cG9ydHMuUklHSFRTX1NPQ0tFVF9JTkhFUklUSU5HID0gZXhwb3J0cy5SSUdIVFNfQUxMO1xuZXhwb3J0cy5SSUdIVFNfVFRZX0JBU0UgPSBleHBvcnRzLldBU0lfUklHSFRfRkRfUkVBRCB8XG4gICAgZXhwb3J0cy5XQVNJX1JJR0hUX0ZEX0ZEU1RBVF9TRVRfRkxBR1MgfFxuICAgIGV4cG9ydHMuV0FTSV9SSUdIVF9GRF9XUklURSB8XG4gICAgZXhwb3J0cy5XQVNJX1JJR0hUX0ZEX0ZJTEVTVEFUX0dFVCB8XG4gICAgZXhwb3J0cy5XQVNJX1JJR0hUX1BPTExfRkRfUkVBRFdSSVRFO1xuZXhwb3J0cy5SSUdIVFNfVFRZX0lOSEVSSVRJTkcgPSBiaWdpbnRfMS5CaWdJbnRQb2x5ZmlsbCgwKTtcbmV4cG9ydHMuV0FTSV9DTE9DS19SRUFMVElNRSA9IDA7XG5leHBvcnRzLldBU0lfQ0xPQ0tfTU9OT1RPTklDID0gMTtcbmV4cG9ydHMuV0FTSV9DTE9DS19QUk9DRVNTX0NQVVRJTUVfSUQgPSAyO1xuZXhwb3J0cy5XQVNJX0NMT0NLX1RIUkVBRF9DUFVUSU1FX0lEID0gMztcbmV4cG9ydHMuV0FTSV9FVkVOVFRZUEVfQ0xPQ0sgPSAwO1xuZXhwb3J0cy5XQVNJX0VWRU5UVFlQRV9GRF9SRUFEID0gMTtcbmV4cG9ydHMuV0FTSV9FVkVOVFRZUEVfRkRfV1JJVEUgPSAyO1xuZXhwb3J0cy5XQVNJX0ZJTEVTVEFUX1NFVF9BVElNID0gMSA8PCAwO1xuZXhwb3J0cy5XQVNJX0ZJTEVTVEFUX1NFVF9BVElNX05PVyA9IDEgPDwgMTtcbmV4cG9ydHMuV0FTSV9GSUxFU1RBVF9TRVRfTVRJTSA9IDEgPDwgMjtcbmV4cG9ydHMuV0FTSV9GSUxFU1RBVF9TRVRfTVRJTV9OT1cgPSAxIDw8IDM7XG5leHBvcnRzLldBU0lfT19DUkVBVCA9IDEgPDwgMDtcbmV4cG9ydHMuV0FTSV9PX0RJUkVDVE9SWSA9IDEgPDwgMTtcbmV4cG9ydHMuV0FTSV9PX0VYQ0wgPSAxIDw8IDI7XG5leHBvcnRzLldBU0lfT19UUlVOQyA9IDEgPDwgMztcbmV4cG9ydHMuV0FTSV9QUkVPUEVOVFlQRV9ESVIgPSAwO1xuZXhwb3J0cy5XQVNJX0RJUkNPT0tJRV9TVEFSVCA9IDA7XG5leHBvcnRzLldBU0lfU1RESU5fRklMRU5PID0gMDtcbmV4cG9ydHMuV0FTSV9TVERPVVRfRklMRU5PID0gMTtcbmV4cG9ydHMuV0FTSV9TVERFUlJfRklMRU5PID0gMjtcbmV4cG9ydHMuV0FTSV9XSEVOQ0VfU0VUID0gMDtcbmV4cG9ydHMuV0FTSV9XSEVOQ0VfQ1VSID0gMTtcbmV4cG9ydHMuV0FTSV9XSEVOQ0VfRU5EID0gMjtcbi8vIGh0dHA6Ly9tYW43Lm9yZy9saW51eC9tYW4tcGFnZXMvbWFuMy9lcnJuby4zLmh0bWxcbmV4cG9ydHMuRVJST1JfTUFQID0ge1xuICAgIEUyQklHOiBleHBvcnRzLldBU0lfRTJCSUcsXG4gICAgRUFDQ0VTOiBleHBvcnRzLldBU0lfRUFDQ0VTLFxuICAgIEVBRERSSU5VU0U6IGV4cG9ydHMuV0FTSV9FQUREUklOVVNFLFxuICAgIEVBRERSTk9UQVZBSUw6IGV4cG9ydHMuV0FTSV9FQUREUk5PVEFWQUlMLFxuICAgIEVBRk5PU1VQUE9SVDogZXhwb3J0cy5XQVNJX0VBRk5PU1VQUE9SVCxcbiAgICBFQUxSRUFEWTogZXhwb3J0cy5XQVNJX0VBTFJFQURZLFxuICAgIEVBR0FJTjogZXhwb3J0cy5XQVNJX0VBR0FJTixcbiAgICAvLyBFQkFERTogV0FTSV9FQkFERSxcbiAgICBFQkFERjogZXhwb3J0cy5XQVNJX0VCQURGLFxuICAgIC8vIEVCQURGRDogV0FTSV9FQkFERkQsXG4gICAgRUJBRE1TRzogZXhwb3J0cy5XQVNJX0VCQURNU0csXG4gICAgLy8gRUJBRFI6IFdBU0lfRUJBRFIsXG4gICAgLy8gRUJBRFJRQzogV0FTSV9FQkFEUlFDLFxuICAgIC8vIEVCQURTTFQ6IFdBU0lfRUJBRFNMVCxcbiAgICBFQlVTWTogZXhwb3J0cy5XQVNJX0VCVVNZLFxuICAgIEVDQU5DRUxFRDogZXhwb3J0cy5XQVNJX0VDQU5DRUxFRCxcbiAgICBFQ0hJTEQ6IGV4cG9ydHMuV0FTSV9FQ0hJTEQsXG4gICAgLy8gRUNIUk5HOiBXQVNJX0VDSFJORyxcbiAgICAvLyBFQ09NTTogV0FTSV9FQ09NTSxcbiAgICBFQ09OTkFCT1JURUQ6IGV4cG9ydHMuV0FTSV9FQ09OTkFCT1JURUQsXG4gICAgRUNPTk5SRUZVU0VEOiBleHBvcnRzLldBU0lfRUNPTk5SRUZVU0VELFxuICAgIEVDT05OUkVTRVQ6IGV4cG9ydHMuV0FTSV9FQ09OTlJFU0VULFxuICAgIEVERUFETE9DSzogZXhwb3J0cy5XQVNJX0VERUFETEssXG4gICAgRURFU1RBRERSUkVROiBleHBvcnRzLldBU0lfRURFU1RBRERSUkVRLFxuICAgIEVET006IGV4cG9ydHMuV0FTSV9FRE9NLFxuICAgIEVEUVVPVDogZXhwb3J0cy5XQVNJX0VEUVVPVCxcbiAgICBFRVhJU1Q6IGV4cG9ydHMuV0FTSV9FRVhJU1QsXG4gICAgRUZBVUxUOiBleHBvcnRzLldBU0lfRUZBVUxULFxuICAgIEVGQklHOiBleHBvcnRzLldBU0lfRUZCSUcsXG4gICAgRUhPU1RET1dOOiBleHBvcnRzLldBU0lfRUhPU1RVTlJFQUNILFxuICAgIEVIT1NUVU5SRUFDSDogZXhwb3J0cy5XQVNJX0VIT1NUVU5SRUFDSCxcbiAgICAvLyBFSFdQT0lTT046IFdBU0lfRUhXUE9JU09OLFxuICAgIEVJRFJNOiBleHBvcnRzLldBU0lfRUlEUk0sXG4gICAgRUlMU0VROiBleHBvcnRzLldBU0lfRUlMU0VRLFxuICAgIEVJTlBST0dSRVNTOiBleHBvcnRzLldBU0lfRUlOUFJPR1JFU1MsXG4gICAgRUlOVFI6IGV4cG9ydHMuV0FTSV9FSU5UUixcbiAgICBFSU5WQUw6IGV4cG9ydHMuV0FTSV9FSU5WQUwsXG4gICAgRUlPOiBleHBvcnRzLldBU0lfRUlPLFxuICAgIEVJU0NPTk46IGV4cG9ydHMuV0FTSV9FSVNDT05OLFxuICAgIEVJU0RJUjogZXhwb3J0cy5XQVNJX0VJU0RJUixcbiAgICBFTE9PUDogZXhwb3J0cy5XQVNJX0VMT09QLFxuICAgIEVNRklMRTogZXhwb3J0cy5XQVNJX0VNRklMRSxcbiAgICBFTUxJTks6IGV4cG9ydHMuV0FTSV9FTUxJTkssXG4gICAgRU1TR1NJWkU6IGV4cG9ydHMuV0FTSV9FTVNHU0laRSxcbiAgICBFTVVMVElIT1A6IGV4cG9ydHMuV0FTSV9FTVVMVElIT1AsXG4gICAgRU5BTUVUT09MT05HOiBleHBvcnRzLldBU0lfRU5BTUVUT09MT05HLFxuICAgIEVORVRET1dOOiBleHBvcnRzLldBU0lfRU5FVERPV04sXG4gICAgRU5FVFJFU0VUOiBleHBvcnRzLldBU0lfRU5FVFJFU0VULFxuICAgIEVORVRVTlJFQUNIOiBleHBvcnRzLldBU0lfRU5FVFVOUkVBQ0gsXG4gICAgRU5GSUxFOiBleHBvcnRzLldBU0lfRU5GSUxFLFxuICAgIEVOT0JVRlM6IGV4cG9ydHMuV0FTSV9FTk9CVUZTLFxuICAgIEVOT0RFVjogZXhwb3J0cy5XQVNJX0VOT0RFVixcbiAgICBFTk9FTlQ6IGV4cG9ydHMuV0FTSV9FTk9FTlQsXG4gICAgRU5PRVhFQzogZXhwb3J0cy5XQVNJX0VOT0VYRUMsXG4gICAgRU5PTENLOiBleHBvcnRzLldBU0lfRU5PTENLLFxuICAgIEVOT0xJTks6IGV4cG9ydHMuV0FTSV9FTk9MSU5LLFxuICAgIEVOT01FTTogZXhwb3J0cy5XQVNJX0VOT01FTSxcbiAgICBFTk9NU0c6IGV4cG9ydHMuV0FTSV9FTk9NU0csXG4gICAgRU5PUFJPVE9PUFQ6IGV4cG9ydHMuV0FTSV9FTk9QUk9UT09QVCxcbiAgICBFTk9TUEM6IGV4cG9ydHMuV0FTSV9FTk9TUEMsXG4gICAgRU5PU1lTOiBleHBvcnRzLldBU0lfRU5PU1lTLFxuICAgIEVOT1RDT05OOiBleHBvcnRzLldBU0lfRU5PVENPTk4sXG4gICAgRU5PVERJUjogZXhwb3J0cy5XQVNJX0VOT1RESVIsXG4gICAgRU5PVEVNUFRZOiBleHBvcnRzLldBU0lfRU5PVEVNUFRZLFxuICAgIEVOT1RSRUNPVkVSQUJMRTogZXhwb3J0cy5XQVNJX0VOT1RSRUNPVkVSQUJMRSxcbiAgICBFTk9UU09DSzogZXhwb3J0cy5XQVNJX0VOT1RTT0NLLFxuICAgIEVOT1RUWTogZXhwb3J0cy5XQVNJX0VOT1RUWSxcbiAgICBFTlhJTzogZXhwb3J0cy5XQVNJX0VOWElPLFxuICAgIEVPVkVSRkxPVzogZXhwb3J0cy5XQVNJX0VPVkVSRkxPVyxcbiAgICBFT1dORVJERUFEOiBleHBvcnRzLldBU0lfRU9XTkVSREVBRCxcbiAgICBFUEVSTTogZXhwb3J0cy5XQVNJX0VQRVJNLFxuICAgIEVQSVBFOiBleHBvcnRzLldBU0lfRVBJUEUsXG4gICAgRVBST1RPOiBleHBvcnRzLldBU0lfRVBST1RPLFxuICAgIEVQUk9UT05PU1VQUE9SVDogZXhwb3J0cy5XQVNJX0VQUk9UT05PU1VQUE9SVCxcbiAgICBFUFJPVE9UWVBFOiBleHBvcnRzLldBU0lfRVBST1RPVFlQRSxcbiAgICBFUkFOR0U6IGV4cG9ydHMuV0FTSV9FUkFOR0UsXG4gICAgRVJPRlM6IGV4cG9ydHMuV0FTSV9FUk9GUyxcbiAgICBFU1BJUEU6IGV4cG9ydHMuV0FTSV9FU1BJUEUsXG4gICAgRVNSQ0g6IGV4cG9ydHMuV0FTSV9FU1JDSCxcbiAgICBFU1RBTEU6IGV4cG9ydHMuV0FTSV9FU1RBTEUsXG4gICAgRVRJTUVET1VUOiBleHBvcnRzLldBU0lfRVRJTUVET1VULFxuICAgIEVUWFRCU1k6IGV4cG9ydHMuV0FTSV9FVFhUQlNZLFxuICAgIEVYREVWOiBleHBvcnRzLldBU0lfRVhERVZcbn07XG5leHBvcnRzLlNJR05BTF9NQVAgPSAoX2EgPSB7fSxcbiAgICBfYVtleHBvcnRzLldBU0lfU0lHSFVQXSA9IFwiU0lHSFVQXCIsXG4gICAgX2FbZXhwb3J0cy5XQVNJX1NJR0lOVF0gPSBcIlNJR0lOVFwiLFxuICAgIF9hW2V4cG9ydHMuV0FTSV9TSUdRVUlUXSA9IFwiU0lHUVVJVFwiLFxuICAgIF9hW2V4cG9ydHMuV0FTSV9TSUdJTExdID0gXCJTSUdJTExcIixcbiAgICBfYVtleHBvcnRzLldBU0lfU0lHVFJBUF0gPSBcIlNJR1RSQVBcIixcbiAgICBfYVtleHBvcnRzLldBU0lfU0lHQUJSVF0gPSBcIlNJR0FCUlRcIixcbiAgICBfYVtleHBvcnRzLldBU0lfU0lHQlVTXSA9IFwiU0lHQlVTXCIsXG4gICAgX2FbZXhwb3J0cy5XQVNJX1NJR0ZQRV0gPSBcIlNJR0ZQRVwiLFxuICAgIF9hW2V4cG9ydHMuV0FTSV9TSUdLSUxMXSA9IFwiU0lHS0lMTFwiLFxuICAgIF9hW2V4cG9ydHMuV0FTSV9TSUdVU1IxXSA9IFwiU0lHVVNSMVwiLFxuICAgIF9hW2V4cG9ydHMuV0FTSV9TSUdTRUdWXSA9IFwiU0lHU0VHVlwiLFxuICAgIF9hW2V4cG9ydHMuV0FTSV9TSUdVU1IyXSA9IFwiU0lHVVNSMlwiLFxuICAgIF9hW2V4cG9ydHMuV0FTSV9TSUdQSVBFXSA9IFwiU0lHUElQRVwiLFxuICAgIF9hW2V4cG9ydHMuV0FTSV9TSUdBTFJNXSA9IFwiU0lHQUxSTVwiLFxuICAgIF9hW2V4cG9ydHMuV0FTSV9TSUdURVJNXSA9IFwiU0lHVEVSTVwiLFxuICAgIF9hW2V4cG9ydHMuV0FTSV9TSUdDSExEXSA9IFwiU0lHQ0hMRFwiLFxuICAgIF9hW2V4cG9ydHMuV0FTSV9TSUdDT05UXSA9IFwiU0lHQ09OVFwiLFxuICAgIF9hW2V4cG9ydHMuV0FTSV9TSUdTVE9QXSA9IFwiU0lHU1RPUFwiLFxuICAgIF9hW2V4cG9ydHMuV0FTSV9TSUdUU1RQXSA9IFwiU0lHVFNUUFwiLFxuICAgIF9hW2V4cG9ydHMuV0FTSV9TSUdUVElOXSA9IFwiU0lHVFRJTlwiLFxuICAgIF9hW2V4cG9ydHMuV0FTSV9TSUdUVE9VXSA9IFwiU0lHVFRPVVwiLFxuICAgIF9hW2V4cG9ydHMuV0FTSV9TSUdVUkddID0gXCJTSUdVUkdcIixcbiAgICBfYVtleHBvcnRzLldBU0lfU0lHWENQVV0gPSBcIlNJR1hDUFVcIixcbiAgICBfYVtleHBvcnRzLldBU0lfU0lHWEZTWl0gPSBcIlNJR1hGU1pcIixcbiAgICBfYVtleHBvcnRzLldBU0lfU0lHVlRBTFJNXSA9IFwiU0lHVlRBTFJNXCIsXG4gICAgX2EpO1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL0BmbHVlbmNlbGFicy9tYXJpbmUud29ya2VyLXNjcmlwdC8uLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQHdhc21lcit3YXNpQDAuMTIuMC9ub2RlX21vZHVsZXMvQHdhc21lci93YXNpL2xpYi9jb25zdGFudHMuanM/Iik7CgovKioqLyB9KSwKCi8qKiovICIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQHdhc21lcit3YXNpQDAuMTIuMC9ub2RlX21vZHVsZXMvQHdhc21lci93YXNpL2xpYi9pbmRleC5lc20uanMiOgovKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0B3YXNtZXIrd2FzaUAwLjEyLjAvbm9kZV9tb2R1bGVzL0B3YXNtZXIvd2FzaS9saWIvaW5kZXguZXNtLmpzICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pID0+IHsKCmV2YWwoIlxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoeyB2YWx1ZTogdHJ1ZSB9KSk7XG5leHBvcnRzLldBU0lLaWxsRXJyb3IgPSBleHBvcnRzLldBU0lFeGl0RXJyb3IgPSBleHBvcnRzLldBU0lFcnJvciA9IGV4cG9ydHMuV0FTSSA9IHZvaWQgMDtcbi8qXG4gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbkNvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlXG50aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZVxuTGljZW5zZSBhdCBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcblxuVEhJUyBDT0RFIElTIFBST1ZJREVEIE9OIEFOICpBUyBJUyogQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxuS0lORCwgRUlUSEVSIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIFdJVEhPVVQgTElNSVRBVElPTiBBTlkgSU1QTElFRFxuV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIFRJVExFLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSxcbk1FUkNIQU5UQUJMSVRZIE9SIE5PTi1JTkZSSU5HRU1FTlQuXG5cblNlZSB0aGUgQXBhY2hlIFZlcnNpb24gMi4wIExpY2Vuc2UgZm9yIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9uc1xuYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5mdW5jdGlvbiBhYShhLCBiKSB7IGFhID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGEsIGIpIHsgYS5fX3Byb3RvX18gPSBiOyB9IHx8IGZ1bmN0aW9uIChhLCBiKSB7IGZvciAodmFyIGMgaW4gYilcbiAgICBiLmhhc093blByb3BlcnR5KGMpICYmIChhW2NdID0gYltjXSk7IH07IHJldHVybiBhYShhLCBiKTsgfVxuZnVuY3Rpb24gYmEoYSwgYikgeyBmdW5jdGlvbiBjKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gYTsgfSBhYShhLCBiKTsgYS5wcm90b3R5cGUgPSBudWxsID09PSBiID8gT2JqZWN0LmNyZWF0ZShiKSA6IChjLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgYyk7IH1cbmZ1bmN0aW9uIGNhKGEpIHsgdmFyIGIgPSBcImZ1bmN0aW9uXCIgPT09IHR5cGVvZiBTeW1ib2wgJiYgYVtTeW1ib2wuaXRlcmF0b3JdLCBjID0gMDsgcmV0dXJuIGIgPyBiLmNhbGwoYSkgOiB7IG5leHQ6IGZ1bmN0aW9uICgpIHsgYSAmJiBjID49IGEubGVuZ3RoICYmIChhID0gdm9pZCAwKTsgcmV0dXJuIHsgdmFsdWU6IGEgJiYgYVtjKytdLCBkb25lOiAhYSB9OyB9IH07IH1cbmZ1bmN0aW9uIGRhKGEsIGIpIHsgdmFyIGMgPSBcImZ1bmN0aW9uXCIgPT09IHR5cGVvZiBTeW1ib2wgJiYgYVtTeW1ib2wuaXRlcmF0b3JdOyBpZiAoIWMpXG4gICAgcmV0dXJuIGE7IGEgPSBjLmNhbGwoYSk7IHZhciBkLCBlID0gW107IHRyeSB7XG4gICAgZm9yICg7ICh2b2lkIDAgPT09IGIgfHwgMCA8IGItLSkgJiYgIShkID0gYS5uZXh0KCkpLmRvbmU7KVxuICAgICAgICBlLnB1c2goZC52YWx1ZSk7XG59XG5jYXRjaCAoZykge1xuICAgIHZhciBmID0geyBlcnJvcjogZyB9O1xufVxuZmluYWxseSB7XG4gICAgdHJ5IHtcbiAgICAgICAgZCAmJiAhZC5kb25lICYmIChjID0gYVtcInJldHVyblwiXSkgJiYgYy5jYWxsKGEpO1xuICAgIH1cbiAgICBmaW5hbGx5IHtcbiAgICAgICAgaWYgKGYpXG4gICAgICAgICAgICB0aHJvdyBmLmVycm9yO1xuICAgIH1cbn0gcmV0dXJuIGU7IH1cbmZ1bmN0aW9uIGZhKCkgeyBmb3IgKHZhciBhID0gW10sIGIgPSAwOyBiIDwgYXJndW1lbnRzLmxlbmd0aDsgYisrKVxuICAgIGEgPSBhLmNvbmNhdChkYShhcmd1bWVudHNbYl0pKTsgcmV0dXJuIGE7IH1cbnZhciBoYSA9IFwidW5kZWZpbmVkXCIgIT09IHR5cGVvZiBnbG9iYWxUaGlzID8gZ2xvYmFsVGhpcyA6IFwidW5kZWZpbmVkXCIgIT09IHR5cGVvZiBfX3dlYnBhY2tfcmVxdWlyZV9fLmcgPyBfX3dlYnBhY2tfcmVxdWlyZV9fLmcgOiB7fSwgayA9IFwidW5kZWZpbmVkXCIgIT09IHR5cGVvZiBCaWdJbnQgPyBCaWdJbnQgOiBoYS5CaWdJbnQgfHwgTnVtYmVyLCBpYSA9IERhdGFWaWV3O1xuaWEucHJvdG90eXBlLnNldEJpZ1VpbnQ2NCB8fCAoaWEucHJvdG90eXBlLnNldEJpZ1VpbnQ2NCA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7IGlmIChiIDwgTWF0aC5wb3coMiwgMzIpKSB7XG4gICAgYiA9IE51bWJlcihiKTtcbiAgICB2YXIgZCA9IDA7XG59XG5lbHNlIHtcbiAgICBkID0gYi50b1N0cmluZygyKTtcbiAgICBiID0gXCJcIjtcbiAgICBmb3IgKHZhciBlID0gMDsgZSA8IDY0IC0gZC5sZW5ndGg7IGUrKylcbiAgICAgICAgYiArPSBcIjBcIjtcbiAgICBiICs9IGQ7XG4gICAgZCA9IHBhcnNlSW50KGIuc3Vic3RyaW5nKDAsIDMyKSwgMik7XG4gICAgYiA9IHBhcnNlSW50KGIuc3Vic3RyaW5nKDMyKSwgMik7XG59IHRoaXMuc2V0VWludDMyKGEgKyAoYyA/IDAgOiA0KSwgYiwgYyk7IHRoaXMuc2V0VWludDMyKGEgKyAoYyA/IDQgOiAwKSwgZCwgYyk7IH0sIGlhLnByb3RvdHlwZS5nZXRCaWdVaW50NjQgPSBmdW5jdGlvbiAoYSwgYikgeyB2YXIgYyA9IHRoaXMuZ2V0VWludDMyKGEgKyAoYiA/IDAgOiA0KSwgYik7IGEgPSB0aGlzLmdldFVpbnQzMihhICsgKGIgPyA0IDogMCksIGIpOyBjID0gYy50b1N0cmluZygyKTsgYSA9IGEudG9TdHJpbmcoMik7IGIgPSBcIlwiOyBmb3IgKHZhciBkID0gMDsgZCA8IDMyIC0gYy5sZW5ndGg7IGQrKylcbiAgICBiICs9IFwiMFwiOyByZXR1cm4gayhcIjBiXCIgKyBhICsgKGIgKyBjKSk7IH0pO1xudmFyIGphID0gXCJ1bmRlZmluZWRcIiAhPT0gdHlwZW9mIF9fd2VicGFja19yZXF1aXJlX18uZyA/IF9fd2VicGFja19yZXF1aXJlX18uZyA6IFwidW5kZWZpbmVkXCIgIT09IHR5cGVvZiBzZWxmID8gc2VsZiA6IFwidW5kZWZpbmVkXCIgIT09IHR5cGVvZiB3aW5kb3cgPyB3aW5kb3cgOiB7fSwgbSA9IFtdLCB1ID0gW10sIGthID0gXCJ1bmRlZmluZWRcIiAhPT0gdHlwZW9mIFVpbnQ4QXJyYXkgPyBVaW50OEFycmF5IDogQXJyYXksIGxhID0gITE7XG5mdW5jdGlvbiBtYSgpIHsgbGEgPSAhMDsgZm9yICh2YXIgYSA9IDA7IDY0ID4gYTsgKythKVxuICAgIG1bYV0gPSBcIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky9cIlthXSwgdVtcIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky9cIi5jaGFyQ29kZUF0KGEpXSA9IGE7IHVbNDVdID0gNjI7IHVbOTVdID0gNjM7IH1cbmZ1bmN0aW9uIG5hKGEsIGIsIGMpIHsgZm9yICh2YXIgZCA9IFtdLCBlID0gYjsgZSA8IGM7IGUgKz0gMylcbiAgICBiID0gKGFbZV0gPDwgMTYpICsgKGFbZSArIDFdIDw8IDgpICsgYVtlICsgMl0sIGQucHVzaChtW2IgPj4gMTggJiA2M10gKyBtW2IgPj4gMTIgJiA2M10gKyBtW2IgPj4gNiAmIDYzXSArIG1bYiAmIDYzXSk7IHJldHVybiBkLmpvaW4oXCJcIik7IH1cbmZ1bmN0aW9uIG9hKGEpIHsgbGEgfHwgbWEoKTsgZm9yICh2YXIgYiA9IGEubGVuZ3RoLCBjID0gYiAlIDMsIGQgPSBcIlwiLCBlID0gW10sIGYgPSAwLCBnID0gYiAtIGM7IGYgPCBnOyBmICs9IDE2MzgzKVxuICAgIGUucHVzaChuYShhLCBmLCBmICsgMTYzODMgPiBnID8gZyA6IGYgKyAxNjM4MykpOyAxID09PSBjID8gKGEgPSBhW2IgLSAxXSwgZCArPSBtW2EgPj4gMl0sIGQgKz0gbVthIDw8IDQgJiA2M10sIGQgKz0gXCI9PVwiKSA6IDIgPT09IGMgJiYgKGEgPSAoYVtiIC0gMl0gPDwgOCkgKyBhW2IgLSAxXSwgZCArPSBtW2EgPj4gMTBdLCBkICs9IG1bYSA+PiA0ICYgNjNdLCBkICs9IG1bYSA8PCAyICYgNjNdLCBkICs9IFwiPVwiKTsgZS5wdXNoKGQpOyByZXR1cm4gZS5qb2luKFwiXCIpOyB9XG5mdW5jdGlvbiBwYShhLCBiLCBjLCBkLCBlKSB7IHZhciBmID0gOCAqIGUgLSBkIC0gMTsgdmFyIGcgPSAoMSA8PCBmKSAtIDEsIGggPSBnID4+IDEsIGwgPSAtNzsgZSA9IGMgPyBlIC0gMSA6IDA7IHZhciBuID0gYyA/IC0xIDogMSwgciA9IGFbYiArIGVdOyBlICs9IG47IGMgPSByICYgKDEgPDwgLWwpIC0gMTsgciA+Pj0gLWw7IGZvciAobCArPSBmOyAwIDwgbDsgYyA9IDI1NiAqIGMgKyBhW2IgKyBlXSwgZSArPSBuLCBsIC09IDgpXG4gICAgOyBmID0gYyAmICgxIDw8IC1sKSAtIDE7IGMgPj49IC1sOyBmb3IgKGwgKz0gZDsgMCA8IGw7IGYgPSAyNTYgKiBmICsgYVtiICsgZV0sIGUgKz0gbiwgbCAtPSA4KVxuICAgIDsgaWYgKDAgPT09IGMpXG4gICAgYyA9IDEgLSBoO1xuZWxzZSB7XG4gICAgaWYgKGMgPT09IGcpXG4gICAgICAgIHJldHVybiBmID8gTmFOIDogSW5maW5pdHkgKiAociA/IC0xIDogMSk7XG4gICAgZiArPSBNYXRoLnBvdygyLCBkKTtcbiAgICBjIC09IGg7XG59IHJldHVybiAociA/IC0xIDogMSkgKiBmICogTWF0aC5wb3coMiwgYyAtIGQpOyB9XG5mdW5jdGlvbiBxYShhLCBiLCBjLCBkLCBlLCBmKSB7XG4gICAgdmFyIGcsIGggPSA4ICogZiAtIGUgLSAxLCBsID0gKDEgPDwgaCkgLSAxLCBuID0gbCA+PiAxLCByID0gMjMgPT09IGUgPyBNYXRoLnBvdygyLCAtMjQpIC0gTWF0aC5wb3coMiwgLTc3KSA6IDA7XG4gICAgZiA9IGQgPyAwIDogZiAtIDE7XG4gICAgdmFyIHAgPSBkID8gMSA6IC0xLCB5ID0gMCA+IGIgfHwgMCA9PT0gYiAmJiAwID4gMSAvIGIgPyAxIDogMDtcbiAgICBiID0gTWF0aC5hYnMoYik7XG4gICAgaXNOYU4oYikgfHwgSW5maW5pdHkgPT09IGIgPyAoYiA9IGlzTmFOKGIpID8gMSA6IDAsIGQgPSBsKSA6IChkID0gTWF0aC5mbG9vcihNYXRoLmxvZyhiKSAvIE1hdGguTE4yKSwgMSA+IGIgKiAoZyA9IE1hdGgucG93KDIsIC1kKSkgJiYgKGQtLSwgZyAqPSAyKSwgYiA9IDEgPD0gZCArIG4gPyBiICsgciAvIGcgOiBiICsgciAqIE1hdGgucG93KDIsIDEgLSBuKSwgMiA8PSBiICogZyAmJiAoZCsrLCBnIC89IDIpLCBkICsgbiA+PSBsID8gKGIgPSAwLCBkID0gbCkgOiAxIDw9IGQgKyBuID8gKGIgPSAoYiAqIGcgLSAxKSAqIE1hdGgucG93KDIsIGUpLCBkICs9IG4pIDogKGIgPSBiICogTWF0aC5wb3coMiwgbiAtIDEpICogTWF0aC5wb3coMiwgZSksIGQgPSAwKSk7XG4gICAgZm9yICg7IDggPD0gZTsgYVtjICsgZl0gPSBiICYgMjU1LCBmICs9IHAsIGIgLz0gMjU2LCBlIC09IDgpXG4gICAgICAgIDtcbiAgICBkID0gZCA8PCBlIHwgYjtcbiAgICBmb3IgKGggKz0gZTsgMCA8IGg7IGFbYyArIGZdID0gZCAmIDI1NSxcbiAgICAgICAgZiArPSBwLCBkIC89IDI1NiwgaCAtPSA4KVxuICAgICAgICA7XG4gICAgYVtjICsgZiAtIHBdIHw9IDEyOCAqIHk7XG59XG52YXIgcmEgPSB7fS50b1N0cmluZywgc2EgPSBBcnJheS5pc0FycmF5IHx8IGZ1bmN0aW9uIChhKSB7IHJldHVybiBcIltvYmplY3QgQXJyYXldXCIgPT0gcmEuY2FsbChhKTsgfTtcbnYuVFlQRURfQVJSQVlfU1VQUE9SVCA9IHZvaWQgMCAhPT0gamEuVFlQRURfQVJSQVlfU1VQUE9SVCA/IGphLlRZUEVEX0FSUkFZX1NVUFBPUlQgOiAhMDtcbnZhciB0YSA9IHYuVFlQRURfQVJSQVlfU1VQUE9SVCA/IDIxNDc0ODM2NDcgOiAxMDczNzQxODIzO1xuZnVuY3Rpb24gdyhhLCBiKSB7IGlmICgodi5UWVBFRF9BUlJBWV9TVVBQT1JUID8gMjE0NzQ4MzY0NyA6IDEwNzM3NDE4MjMpIDwgYilcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcihcIkludmFsaWQgdHlwZWQgYXJyYXkgbGVuZ3RoXCIpOyB2LlRZUEVEX0FSUkFZX1NVUFBPUlQgPyAoYSA9IG5ldyBVaW50OEFycmF5KGIpLCBhLl9fcHJvdG9fXyA9IHYucHJvdG90eXBlKSA6IChudWxsID09PSBhICYmIChhID0gbmV3IHYoYikpLCBhLmxlbmd0aCA9IGIpOyByZXR1cm4gYTsgfVxuZnVuY3Rpb24gdihhLCBiLCBjKSB7IGlmICghKHYuVFlQRURfQVJSQVlfU1VQUE9SVCB8fCB0aGlzIGluc3RhbmNlb2YgdikpXG4gICAgcmV0dXJuIG5ldyB2KGEsIGIsIGMpOyBpZiAoXCJudW1iZXJcIiA9PT0gdHlwZW9mIGEpIHtcbiAgICBpZiAoXCJzdHJpbmdcIiA9PT0gdHlwZW9mIGIpXG4gICAgICAgIHRocm93IEVycm9yKFwiSWYgZW5jb2RpbmcgaXMgc3BlY2lmaWVkIHRoZW4gdGhlIGZpcnN0IGFyZ3VtZW50IG11c3QgYmUgYSBzdHJpbmdcIik7XG4gICAgcmV0dXJuIHZhKHRoaXMsIGEpO1xufSByZXR1cm4gd2EodGhpcywgYSwgYiwgYyk7IH1cbnYucG9vbFNpemUgPSA4MTkyO1xudi5fYXVnbWVudCA9IGZ1bmN0aW9uIChhKSB7IGEuX19wcm90b19fID0gdi5wcm90b3R5cGU7IHJldHVybiBhOyB9O1xuZnVuY3Rpb24gd2EoYSwgYiwgYywgZCkge1xuICAgIGlmIChcIm51bWJlclwiID09PSB0eXBlb2YgYilcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignXCJ2YWx1ZVwiIGFyZ3VtZW50IG11c3Qgbm90IGJlIGEgbnVtYmVyJyk7XG4gICAgaWYgKFwidW5kZWZpbmVkXCIgIT09IHR5cGVvZiBBcnJheUJ1ZmZlciAmJiBiIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHtcbiAgICAgICAgYi5ieXRlTGVuZ3RoO1xuICAgICAgICBpZiAoMCA+IGMgfHwgYi5ieXRlTGVuZ3RoIDwgYylcbiAgICAgICAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKFwiJ29mZnNldCcgaXMgb3V0IG9mIGJvdW5kc1wiKTtcbiAgICAgICAgaWYgKGIuYnl0ZUxlbmd0aCA8IGMgKyAoZCB8fCAwKSlcbiAgICAgICAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKFwiJ2xlbmd0aCcgaXMgb3V0IG9mIGJvdW5kc1wiKTtcbiAgICAgICAgYiA9IHZvaWQgMCA9PT0gYyAmJiB2b2lkIDAgPT09IGQgPyBuZXcgVWludDhBcnJheShiKSA6IHZvaWQgMCA9PT0gZCA/IG5ldyBVaW50OEFycmF5KGIsIGMpIDogbmV3IFVpbnQ4QXJyYXkoYiwgYywgZCk7XG4gICAgICAgIHYuVFlQRURfQVJSQVlfU1VQUE9SVCA/IChhID0gYiwgYS5fX3Byb3RvX18gPSB2LnByb3RvdHlwZSkgOiBhID0geGEoYSwgYik7XG4gICAgICAgIHJldHVybiBhO1xuICAgIH1cbiAgICBpZiAoXCJzdHJpbmdcIiA9PT1cbiAgICAgICAgdHlwZW9mIGIpIHtcbiAgICAgICAgZCA9IGE7XG4gICAgICAgIGEgPSBjO1xuICAgICAgICBpZiAoXCJzdHJpbmdcIiAhPT0gdHlwZW9mIGEgfHwgXCJcIiA9PT0gYSlcbiAgICAgICAgICAgIGEgPSBcInV0ZjhcIjtcbiAgICAgICAgaWYgKCF2LmlzRW5jb2RpbmcoYSkpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdcImVuY29kaW5nXCIgbXVzdCBiZSBhIHZhbGlkIHN0cmluZyBlbmNvZGluZycpO1xuICAgICAgICBjID0geWEoYiwgYSkgfCAwO1xuICAgICAgICBkID0gdyhkLCBjKTtcbiAgICAgICAgYiA9IGQud3JpdGUoYiwgYSk7XG4gICAgICAgIGIgIT09IGMgJiYgKGQgPSBkLnNsaWNlKDAsIGIpKTtcbiAgICAgICAgcmV0dXJuIGQ7XG4gICAgfVxuICAgIHJldHVybiB6YShhLCBiKTtcbn1cbnYuZnJvbSA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7IHJldHVybiB3YShudWxsLCBhLCBiLCBjKTsgfTtcbnYuVFlQRURfQVJSQVlfU1VQUE9SVCAmJiAodi5wcm90b3R5cGUuX19wcm90b19fID0gVWludDhBcnJheS5wcm90b3R5cGUsIHYuX19wcm90b19fID0gVWludDhBcnJheSk7XG5mdW5jdGlvbiBBYShhKSB7IGlmIChcIm51bWJlclwiICE9PSB0eXBlb2YgYSlcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdcInNpemVcIiBhcmd1bWVudCBtdXN0IGJlIGEgbnVtYmVyJyk7IGlmICgwID4gYSlcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignXCJzaXplXCIgYXJndW1lbnQgbXVzdCBub3QgYmUgbmVnYXRpdmUnKTsgfVxudi5hbGxvYyA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7IEFhKGEpOyBhID0gMCA+PSBhID8gdyhudWxsLCBhKSA6IHZvaWQgMCAhPT0gYiA/IFwic3RyaW5nXCIgPT09IHR5cGVvZiBjID8gdyhudWxsLCBhKS5maWxsKGIsIGMpIDogdyhudWxsLCBhKS5maWxsKGIpIDogdyhudWxsLCBhKTsgcmV0dXJuIGE7IH07XG5mdW5jdGlvbiB2YShhLCBiKSB7IEFhKGIpOyBhID0gdyhhLCAwID4gYiA/IDAgOiBCYShiKSB8IDApOyBpZiAoIXYuVFlQRURfQVJSQVlfU1VQUE9SVClcbiAgICBmb3IgKHZhciBjID0gMDsgYyA8IGI7ICsrYylcbiAgICAgICAgYVtjXSA9IDA7IHJldHVybiBhOyB9XG52LmFsbG9jVW5zYWZlID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIHZhKG51bGwsIGEpOyB9O1xudi5hbGxvY1Vuc2FmZVNsb3cgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gdmEobnVsbCwgYSk7IH07XG5mdW5jdGlvbiB4YShhLCBiKSB7IHZhciBjID0gMCA+IGIubGVuZ3RoID8gMCA6IEJhKGIubGVuZ3RoKSB8IDA7IGEgPSB3KGEsIGMpOyBmb3IgKHZhciBkID0gMDsgZCA8IGM7IGQgKz0gMSlcbiAgICBhW2RdID0gYltkXSAmIDI1NTsgcmV0dXJuIGE7IH1cbmZ1bmN0aW9uIHphKGEsIGIpIHsgaWYgKHooYikpIHtcbiAgICB2YXIgYyA9IEJhKGIubGVuZ3RoKSB8IDA7XG4gICAgYSA9IHcoYSwgYyk7XG4gICAgaWYgKDAgPT09IGEubGVuZ3RoKVxuICAgICAgICByZXR1cm4gYTtcbiAgICBiLmNvcHkoYSwgMCwgMCwgYyk7XG4gICAgcmV0dXJuIGE7XG59IGlmIChiKSB7XG4gICAgaWYgKFwidW5kZWZpbmVkXCIgIT09IHR5cGVvZiBBcnJheUJ1ZmZlciAmJiBiLmJ1ZmZlciBpbnN0YW5jZW9mIEFycmF5QnVmZmVyIHx8IFwibGVuZ3RoXCIgaW4gYilcbiAgICAgICAgcmV0dXJuIChjID0gXCJudW1iZXJcIiAhPT0gdHlwZW9mIGIubGVuZ3RoKSB8fCAoYyA9IGIubGVuZ3RoLCBjID0gYyAhPT0gYyksIGMgPyB3KGEsIDApIDogeGEoYSwgYik7XG4gICAgaWYgKFwiQnVmZmVyXCIgPT09IGIudHlwZSAmJiBzYShiLmRhdGEpKVxuICAgICAgICByZXR1cm4geGEoYSwgYi5kYXRhKTtcbn0gdGhyb3cgbmV3IFR5cGVFcnJvcihcIkZpcnN0IGFyZ3VtZW50IG11c3QgYmUgYSBzdHJpbmcsIEJ1ZmZlciwgQXJyYXlCdWZmZXIsIEFycmF5LCBvciBhcnJheS1saWtlIG9iamVjdC5cIik7IH1cbmZ1bmN0aW9uIEJhKGEpIHsgaWYgKGEgPj0gKHYuVFlQRURfQVJSQVlfU1VQUE9SVCA/IDIxNDc0ODM2NDcgOiAxMDczNzQxODIzKSlcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcihcIkF0dGVtcHQgdG8gYWxsb2NhdGUgQnVmZmVyIGxhcmdlciB0aGFuIG1heGltdW0gc2l6ZTogMHhcIiArICh2LlRZUEVEX0FSUkFZX1NVUFBPUlQgPyAyMTQ3NDgzNjQ3IDogMTA3Mzc0MTgyMykudG9TdHJpbmcoMTYpICsgXCIgYnl0ZXNcIik7IHJldHVybiBhIHwgMDsgfVxudi5pc0J1ZmZlciA9IENhO1xuZnVuY3Rpb24geihhKSB7IHJldHVybiAhKG51bGwgPT0gYSB8fCAhYS5faXNCdWZmZXIpOyB9XG52LmNvbXBhcmUgPSBmdW5jdGlvbiAoYSwgYikgeyBpZiAoIXooYSkgfHwgIXooYikpXG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkFyZ3VtZW50cyBtdXN0IGJlIEJ1ZmZlcnNcIik7IGlmIChhID09PSBiKVxuICAgIHJldHVybiAwOyBmb3IgKHZhciBjID0gYS5sZW5ndGgsIGQgPSBiLmxlbmd0aCwgZSA9IDAsIGYgPSBNYXRoLm1pbihjLCBkKTsgZSA8IGY7ICsrZSlcbiAgICBpZiAoYVtlXSAhPT0gYltlXSkge1xuICAgICAgICBjID0gYVtlXTtcbiAgICAgICAgZCA9IGJbZV07XG4gICAgICAgIGJyZWFrO1xuICAgIH0gcmV0dXJuIGMgPCBkID8gLTEgOiBkIDwgYyA/IDEgOiAwOyB9O1xudi5pc0VuY29kaW5nID0gZnVuY3Rpb24gKGEpIHsgc3dpdGNoIChTdHJpbmcoYSkudG9Mb3dlckNhc2UoKSkge1xuICAgIGNhc2UgXCJoZXhcIjpcbiAgICBjYXNlIFwidXRmOFwiOlxuICAgIGNhc2UgXCJ1dGYtOFwiOlxuICAgIGNhc2UgXCJhc2NpaVwiOlxuICAgIGNhc2UgXCJsYXRpbjFcIjpcbiAgICBjYXNlIFwiYmluYXJ5XCI6XG4gICAgY2FzZSBcImJhc2U2NFwiOlxuICAgIGNhc2UgXCJ1Y3MyXCI6XG4gICAgY2FzZSBcInVjcy0yXCI6XG4gICAgY2FzZSBcInV0ZjE2bGVcIjpcbiAgICBjYXNlIFwidXRmLTE2bGVcIjogcmV0dXJuICEwO1xuICAgIGRlZmF1bHQ6IHJldHVybiAhMTtcbn0gfTtcbnYuY29uY2F0ID0gZnVuY3Rpb24gKGEsIGIpIHsgaWYgKCFzYShhKSlcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdcImxpc3RcIiBhcmd1bWVudCBtdXN0IGJlIGFuIEFycmF5IG9mIEJ1ZmZlcnMnKTsgaWYgKDAgPT09IGEubGVuZ3RoKVxuICAgIHJldHVybiB2LmFsbG9jKDApOyB2YXIgYzsgaWYgKHZvaWQgMCA9PT0gYilcbiAgICBmb3IgKGMgPSBiID0gMDsgYyA8IGEubGVuZ3RoOyArK2MpXG4gICAgICAgIGIgKz0gYVtjXS5sZW5ndGg7IGIgPSB2LmFsbG9jVW5zYWZlKGIpOyB2YXIgZCA9IDA7IGZvciAoYyA9IDA7IGMgPCBhLmxlbmd0aDsgKytjKSB7XG4gICAgdmFyIGUgPSBhW2NdO1xuICAgIGlmICgheihlKSlcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignXCJsaXN0XCIgYXJndW1lbnQgbXVzdCBiZSBhbiBBcnJheSBvZiBCdWZmZXJzJyk7XG4gICAgZS5jb3B5KGIsIGQpO1xuICAgIGQgKz0gZS5sZW5ndGg7XG59IHJldHVybiBiOyB9O1xuZnVuY3Rpb24geWEoYSwgYikge1xuICAgIGlmICh6KGEpKVxuICAgICAgICByZXR1cm4gYS5sZW5ndGg7XG4gICAgaWYgKFwidW5kZWZpbmVkXCIgIT09IHR5cGVvZiBBcnJheUJ1ZmZlciAmJiBcImZ1bmN0aW9uXCIgPT09IHR5cGVvZiBBcnJheUJ1ZmZlci5pc1ZpZXcgJiYgKEFycmF5QnVmZmVyLmlzVmlldyhhKSB8fCBhIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpKVxuICAgICAgICByZXR1cm4gYS5ieXRlTGVuZ3RoO1xuICAgIFwic3RyaW5nXCIgIT09IHR5cGVvZiBhICYmIChhID0gXCJcIiArIGEpO1xuICAgIHZhciBjID0gYS5sZW5ndGg7XG4gICAgaWYgKDAgPT09IGMpXG4gICAgICAgIHJldHVybiAwO1xuICAgIGZvciAodmFyIGQgPSAhMTs7KVxuICAgICAgICBzd2l0Y2ggKGIpIHtcbiAgICAgICAgICAgIGNhc2UgXCJhc2NpaVwiOlxuICAgICAgICAgICAgY2FzZSBcImxhdGluMVwiOlxuICAgICAgICAgICAgY2FzZSBcImJpbmFyeVwiOiByZXR1cm4gYztcbiAgICAgICAgICAgIGNhc2UgXCJ1dGY4XCI6XG4gICAgICAgICAgICBjYXNlIFwidXRmLThcIjpcbiAgICAgICAgICAgIGNhc2Ugdm9pZCAwOiByZXR1cm4gRGEoYSkubGVuZ3RoO1xuICAgICAgICAgICAgY2FzZSBcInVjczJcIjpcbiAgICAgICAgICAgIGNhc2UgXCJ1Y3MtMlwiOlxuICAgICAgICAgICAgY2FzZSBcInV0ZjE2bGVcIjpcbiAgICAgICAgICAgIGNhc2UgXCJ1dGYtMTZsZVwiOiByZXR1cm4gMiAqIGM7XG4gICAgICAgICAgICBjYXNlIFwiaGV4XCI6IHJldHVybiBjID4+PiAxO1xuICAgICAgICAgICAgY2FzZSBcImJhc2U2NFwiOiByZXR1cm4gRWEoYSkubGVuZ3RoO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBpZiAoZClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIERhKGEpLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBiID0gKFwiXCIgKyBiKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgICAgIGQgPSAhMDtcbiAgICAgICAgfVxufVxudi5ieXRlTGVuZ3RoID0geWE7XG5mdW5jdGlvbiBGYShhLCBiLCBjKSB7XG4gICAgdmFyIGQgPSAhMTtcbiAgICBpZiAodm9pZCAwID09PSBiIHx8IDAgPiBiKVxuICAgICAgICBiID0gMDtcbiAgICBpZiAoYiA+IHRoaXMubGVuZ3RoKVxuICAgICAgICByZXR1cm4gXCJcIjtcbiAgICBpZiAodm9pZCAwID09PSBjIHx8IGMgPiB0aGlzLmxlbmd0aClcbiAgICAgICAgYyA9IHRoaXMubGVuZ3RoO1xuICAgIGlmICgwID49IGMpXG4gICAgICAgIHJldHVybiBcIlwiO1xuICAgIGMgPj4+PSAwO1xuICAgIGIgPj4+PSAwO1xuICAgIGlmIChjIDw9IGIpXG4gICAgICAgIHJldHVybiBcIlwiO1xuICAgIGZvciAoYSB8fCAoYSA9IFwidXRmOFwiKTs7KVxuICAgICAgICBzd2l0Y2ggKGEpIHtcbiAgICAgICAgICAgIGNhc2UgXCJoZXhcIjpcbiAgICAgICAgICAgICAgICBhID0gYjtcbiAgICAgICAgICAgICAgICBiID0gYztcbiAgICAgICAgICAgICAgICBjID0gdGhpcy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgaWYgKCFhIHx8IDAgPiBhKVxuICAgICAgICAgICAgICAgICAgICBhID0gMDtcbiAgICAgICAgICAgICAgICBpZiAoIWIgfHwgMCA+IGIgfHwgYiA+IGMpXG4gICAgICAgICAgICAgICAgICAgIGIgPSBjO1xuICAgICAgICAgICAgICAgIGQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGZvciAoYyA9IGE7IGMgPCBiOyArK2MpXG4gICAgICAgICAgICAgICAgICAgIGEgPSBkLCBkID0gdGhpc1tjXSwgZCA9IDE2ID4gZCA/IFwiMFwiICsgZC50b1N0cmluZygxNikgOiBkLnRvU3RyaW5nKDE2KSwgZCA9IGEgKyBkO1xuICAgICAgICAgICAgICAgIHJldHVybiBkO1xuICAgICAgICAgICAgY2FzZSBcInV0ZjhcIjpcbiAgICAgICAgICAgIGNhc2UgXCJ1dGYtOFwiOiByZXR1cm4gR2EodGhpcywgYiwgYyk7XG4gICAgICAgICAgICBjYXNlIFwiYXNjaWlcIjpcbiAgICAgICAgICAgICAgICBhID0gXCJcIjtcbiAgICAgICAgICAgICAgICBmb3IgKGMgPSBNYXRoLm1pbih0aGlzLmxlbmd0aCwgYyk7IGIgPCBjOyArK2IpXG4gICAgICAgICAgICAgICAgICAgIGEgKz0gU3RyaW5nLmZyb21DaGFyQ29kZSh0aGlzW2JdICYgMTI3KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgIGNhc2UgXCJsYXRpbjFcIjpcbiAgICAgICAgICAgIGNhc2UgXCJiaW5hcnlcIjpcbiAgICAgICAgICAgICAgICBhID0gXCJcIjtcbiAgICAgICAgICAgICAgICBmb3IgKGMgPSBNYXRoLm1pbih0aGlzLmxlbmd0aCwgYyk7IGIgPCBjOyArK2IpXG4gICAgICAgICAgICAgICAgICAgIGEgKz0gU3RyaW5nLmZyb21DaGFyQ29kZSh0aGlzW2JdKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgIGNhc2UgXCJiYXNlNjRcIjogcmV0dXJuIGIgPSAwID09PSBiICYmIGMgPT09IHRoaXMubGVuZ3RoID8gb2EodGhpcykgOiBvYSh0aGlzLnNsaWNlKGIsIGMpKSwgYjtcbiAgICAgICAgICAgIGNhc2UgXCJ1Y3MyXCI6XG4gICAgICAgICAgICBjYXNlIFwidWNzLTJcIjpcbiAgICAgICAgICAgIGNhc2UgXCJ1dGYxNmxlXCI6XG4gICAgICAgICAgICBjYXNlIFwidXRmLTE2bGVcIjpcbiAgICAgICAgICAgICAgICBiID0gdGhpcy5zbGljZShiLCBjKTtcbiAgICAgICAgICAgICAgICBjID0gXCJcIjtcbiAgICAgICAgICAgICAgICBmb3IgKGEgPSAwOyBhIDwgYi5sZW5ndGg7IGEgKz0gMilcbiAgICAgICAgICAgICAgICAgICAgYyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGJbYV0gKyAyNTYgKiBiW2EgKyAxXSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGM7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGlmIChkKVxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiVW5rbm93biBlbmNvZGluZzogXCIgKyBhKTtcbiAgICAgICAgICAgICAgICBhID0gKGEgKyBcIlwiKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgICAgIGQgPSAhMDtcbiAgICAgICAgfVxufVxudi5wcm90b3R5cGUuX2lzQnVmZmVyID0gITA7XG5mdW5jdGlvbiBBKGEsIGIsIGMpIHsgdmFyIGQgPSBhW2JdOyBhW2JdID0gYVtjXTsgYVtjXSA9IGQ7IH1cbnYucHJvdG90eXBlLnN3YXAxNiA9IGZ1bmN0aW9uICgpIHsgdmFyIGEgPSB0aGlzLmxlbmd0aDsgaWYgKDAgIT09IGEgJSAyKVxuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKFwiQnVmZmVyIHNpemUgbXVzdCBiZSBhIG11bHRpcGxlIG9mIDE2LWJpdHNcIik7IGZvciAodmFyIGIgPSAwOyBiIDwgYTsgYiArPSAyKVxuICAgIEEodGhpcywgYiwgYiArIDEpOyByZXR1cm4gdGhpczsgfTtcbnYucHJvdG90eXBlLnN3YXAzMiA9IGZ1bmN0aW9uICgpIHsgdmFyIGEgPSB0aGlzLmxlbmd0aDsgaWYgKDAgIT09IGEgJSA0KVxuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKFwiQnVmZmVyIHNpemUgbXVzdCBiZSBhIG11bHRpcGxlIG9mIDMyLWJpdHNcIik7IGZvciAodmFyIGIgPSAwOyBiIDwgYTsgYiArPSA0KVxuICAgIEEodGhpcywgYiwgYiArIDMpLCBBKHRoaXMsIGIgKyAxLCBiICsgMik7IHJldHVybiB0aGlzOyB9O1xudi5wcm90b3R5cGUuc3dhcDY0ID0gZnVuY3Rpb24gKCkgeyB2YXIgYSA9IHRoaXMubGVuZ3RoOyBpZiAoMCAhPT0gYSAlIDgpXG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoXCJCdWZmZXIgc2l6ZSBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgNjQtYml0c1wiKTsgZm9yICh2YXIgYiA9IDA7IGIgPCBhOyBiICs9IDgpXG4gICAgQSh0aGlzLCBiLCBiICsgNyksIEEodGhpcywgYiArIDEsIGIgKyA2KSwgQSh0aGlzLCBiICsgMiwgYiArIDUpLCBBKHRoaXMsIGIgKyAzLCBiICsgNCk7IHJldHVybiB0aGlzOyB9O1xudi5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7IHZhciBhID0gdGhpcy5sZW5ndGggfCAwOyByZXR1cm4gMCA9PT0gYSA/IFwiXCIgOiAwID09PSBhcmd1bWVudHMubGVuZ3RoID8gR2EodGhpcywgMCwgYSkgOiBGYS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOyB9O1xudi5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKGEpIHsgaWYgKCF6KGEpKVxuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJBcmd1bWVudCBtdXN0IGJlIGEgQnVmZmVyXCIpOyByZXR1cm4gdGhpcyA9PT0gYSA/ICEwIDogMCA9PT0gdi5jb21wYXJlKHRoaXMsIGEpOyB9O1xudi5wcm90b3R5cGUuaW5zcGVjdCA9IGZ1bmN0aW9uICgpIHsgdmFyIGEgPSBcIlwiOyAwIDwgdGhpcy5sZW5ndGggJiYgKGEgPSB0aGlzLnRvU3RyaW5nKFwiaGV4XCIsIDAsIDUwKS5tYXRjaCgvLnsyfS9nKS5qb2luKFwiIFwiKSwgNTAgPCB0aGlzLmxlbmd0aCAmJiAoYSArPSBcIiAuLi4gXCIpKTsgcmV0dXJuIFwiPEJ1ZmZlciBcIiArIGEgKyBcIj5cIjsgfTtcbnYucHJvdG90eXBlLmNvbXBhcmUgPSBmdW5jdGlvbiAoYSwgYiwgYywgZCwgZSkge1xuICAgIGlmICgheihhKSlcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkFyZ3VtZW50IG11c3QgYmUgYSBCdWZmZXJcIik7XG4gICAgdm9pZCAwID09PSBiICYmIChiID0gMCk7XG4gICAgdm9pZCAwID09PSBjICYmIChjID0gYSA/IGEubGVuZ3RoIDogMCk7XG4gICAgdm9pZCAwID09PSBkICYmIChkID0gMCk7XG4gICAgdm9pZCAwID09PSBlICYmIChlID0gdGhpcy5sZW5ndGgpO1xuICAgIGlmICgwID4gYiB8fCBjID4gYS5sZW5ndGggfHwgMCA+IGQgfHwgZSA+IHRoaXMubGVuZ3RoKVxuICAgICAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcihcIm91dCBvZiByYW5nZSBpbmRleFwiKTtcbiAgICBpZiAoZCA+PSBlICYmIGIgPj0gYylcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgaWYgKGQgPj0gZSlcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIGlmIChiID49IGMpXG4gICAgICAgIHJldHVybiAxO1xuICAgIGIgPj4+PSAwO1xuICAgIGMgPj4+PSAwO1xuICAgIGQgPj4+PSAwO1xuICAgIGUgPj4+PSAwO1xuICAgIGlmICh0aGlzID09PSBhKVxuICAgICAgICByZXR1cm4gMDtcbiAgICB2YXIgZiA9IGUgLSBkLCBnID0gYyAtIGIsIGggPSBNYXRoLm1pbihmLCBnKTtcbiAgICBkID0gdGhpcy5zbGljZShkLCBlKTtcbiAgICBhID0gYS5zbGljZShiLCBjKTtcbiAgICBmb3IgKGIgPSAwOyBiIDwgaDsgKytiKVxuICAgICAgICBpZiAoZFtiXSAhPT0gYVtiXSkge1xuICAgICAgICAgICAgZiA9IGRbYl07XG4gICAgICAgICAgICBnID0gYVtiXTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgcmV0dXJuIGYgPFxuICAgICAgICBnID8gLTEgOiBnIDwgZiA/IDEgOiAwO1xufTtcbmZ1bmN0aW9uIEhhKGEsIGIsIGMsIGQsIGUpIHtcbiAgICBpZiAoMCA9PT0gYS5sZW5ndGgpXG4gICAgICAgIHJldHVybiAtMTtcbiAgICBcInN0cmluZ1wiID09PSB0eXBlb2YgYyA/IChkID0gYywgYyA9IDApIDogMjE0NzQ4MzY0NyA8IGMgPyBjID0gMjE0NzQ4MzY0NyA6IC0yMTQ3NDgzNjQ4ID4gYyAmJiAoYyA9IC0yMTQ3NDgzNjQ4KTtcbiAgICBjID0gK2M7XG4gICAgaXNOYU4oYykgJiYgKGMgPSBlID8gMCA6IGEubGVuZ3RoIC0gMSk7XG4gICAgMCA+IGMgJiYgKGMgPSBhLmxlbmd0aCArIGMpO1xuICAgIGlmIChjID49IGEubGVuZ3RoKSB7XG4gICAgICAgIGlmIChlKVxuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICBjID0gYS5sZW5ndGggLSAxO1xuICAgIH1cbiAgICBlbHNlIGlmICgwID4gYylcbiAgICAgICAgaWYgKGUpXG4gICAgICAgICAgICBjID0gMDtcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgIFwic3RyaW5nXCIgPT09IHR5cGVvZiBiICYmIChiID0gdi5mcm9tKGIsIGQpKTtcbiAgICBpZiAoeihiKSlcbiAgICAgICAgcmV0dXJuIDAgPT09IGIubGVuZ3RoID8gLTEgOiBJYShhLCBiLCBjLCBkLCBlKTtcbiAgICBpZiAoXCJudW1iZXJcIiA9PT0gdHlwZW9mIGIpXG4gICAgICAgIHJldHVybiBiICY9IDI1NSwgdi5UWVBFRF9BUlJBWV9TVVBQT1JUICYmIFwiZnVuY3Rpb25cIiA9PT0gdHlwZW9mIFVpbnQ4QXJyYXkucHJvdG90eXBlLmluZGV4T2YgPyBlID8gVWludDhBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKGEsIGIsIGMpIDpcbiAgICAgICAgICAgIFVpbnQ4QXJyYXkucHJvdG90eXBlLmxhc3RJbmRleE9mLmNhbGwoYSwgYiwgYykgOiBJYShhLCBbYl0sIGMsIGQsIGUpO1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJ2YWwgbXVzdCBiZSBzdHJpbmcsIG51bWJlciBvciBCdWZmZXJcIik7XG59XG5mdW5jdGlvbiBJYShhLCBiLCBjLCBkLCBlKSB7IGZ1bmN0aW9uIGYoYSwgYikgeyByZXR1cm4gMSA9PT0gZyA/IGFbYl0gOiBhLnJlYWRVSW50MTZCRShiICogZyk7IH0gdmFyIGcgPSAxLCBoID0gYS5sZW5ndGgsIGwgPSBiLmxlbmd0aDsgaWYgKHZvaWQgMCAhPT0gZCAmJiAoZCA9IFN0cmluZyhkKS50b0xvd2VyQ2FzZSgpLCBcInVjczJcIiA9PT0gZCB8fCBcInVjcy0yXCIgPT09IGQgfHwgXCJ1dGYxNmxlXCIgPT09IGQgfHwgXCJ1dGYtMTZsZVwiID09PSBkKSkge1xuICAgIGlmICgyID4gYS5sZW5ndGggfHwgMiA+IGIubGVuZ3RoKVxuICAgICAgICByZXR1cm4gLTE7XG4gICAgZyA9IDI7XG4gICAgaCAvPSAyO1xuICAgIGwgLz0gMjtcbiAgICBjIC89IDI7XG59IGlmIChlKVxuICAgIGZvciAoZCA9IC0xOyBjIDwgaDsgYysrKVxuICAgICAgICBpZiAoZihhLCBjKSA9PT0gZihiLCAtMSA9PT0gZCA/IDAgOiBjIC0gZCkpIHtcbiAgICAgICAgICAgIGlmICgtMSA9PT0gZCAmJiAoZCA9IGMpLCBjIC0gZCArIDEgPT09IGwpXG4gICAgICAgICAgICAgICAgcmV0dXJuIGQgKiBnO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIC0xICE9PSBkICYmIChjIC09IGMgLSBkKSwgZCA9IC0xO1xuZWxzZVxuICAgIGZvciAoYyArIGwgPiBoICYmIChjID0gaCAtIGwpOyAwIDw9IGM7IGMtLSkge1xuICAgICAgICBoID0gITA7XG4gICAgICAgIGZvciAoZCA9IDA7IGQgPCBsOyBkKyspXG4gICAgICAgICAgICBpZiAoZihhLCBjICsgZCkgIT09IGYoYiwgZCkpIHtcbiAgICAgICAgICAgICAgICBoID0gITE7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIGlmIChoKVxuICAgICAgICAgICAgcmV0dXJuIGM7XG4gICAgfSByZXR1cm4gLTE7IH1cbnYucHJvdG90eXBlLmluY2x1ZGVzID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgcmV0dXJuIC0xICE9PSB0aGlzLmluZGV4T2YoYSwgYiwgYyk7IH07XG52LnByb3RvdHlwZS5pbmRleE9mID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgcmV0dXJuIEhhKHRoaXMsIGEsIGIsIGMsICEwKTsgfTtcbnYucHJvdG90eXBlLmxhc3RJbmRleE9mID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgcmV0dXJuIEhhKHRoaXMsIGEsIGIsIGMsICExKTsgfTtcbnYucHJvdG90eXBlLndyaXRlID0gZnVuY3Rpb24gKGEsIGIsIGMsIGQpIHtcbiAgICBpZiAodm9pZCAwID09PSBiKVxuICAgICAgICBkID0gXCJ1dGY4XCIsIGMgPSB0aGlzLmxlbmd0aCwgYiA9IDA7XG4gICAgZWxzZSBpZiAodm9pZCAwID09PSBjICYmIFwic3RyaW5nXCIgPT09IHR5cGVvZiBiKVxuICAgICAgICBkID0gYiwgYyA9IHRoaXMubGVuZ3RoLCBiID0gMDtcbiAgICBlbHNlIGlmIChpc0Zpbml0ZShiKSlcbiAgICAgICAgYiB8PSAwLCBpc0Zpbml0ZShjKSA/IChjIHw9IDAsIHZvaWQgMCA9PT0gZCAmJiAoZCA9IFwidXRmOFwiKSkgOiAoZCA9IGMsIGMgPSB2b2lkIDApO1xuICAgIGVsc2VcbiAgICAgICAgdGhyb3cgRXJyb3IoXCJCdWZmZXIud3JpdGUoc3RyaW5nLCBlbmNvZGluZywgb2Zmc2V0WywgbGVuZ3RoXSkgaXMgbm8gbG9uZ2VyIHN1cHBvcnRlZFwiKTtcbiAgICB2YXIgZSA9IHRoaXMubGVuZ3RoIC0gYjtcbiAgICBpZiAodm9pZCAwID09PSBjIHx8IGMgPiBlKVxuICAgICAgICBjID0gZTtcbiAgICBpZiAoMCA8IGEubGVuZ3RoICYmICgwID4gYyB8fCAwID4gYikgfHwgYiA+IHRoaXMubGVuZ3RoKVxuICAgICAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcihcIkF0dGVtcHQgdG8gd3JpdGUgb3V0c2lkZSBidWZmZXIgYm91bmRzXCIpO1xuICAgIGQgfHwgKGQgPSBcInV0ZjhcIik7XG4gICAgZm9yIChlID0gITE7OylcbiAgICAgICAgc3dpdGNoIChkKSB7XG4gICAgICAgICAgICBjYXNlIFwiaGV4XCI6XG4gICAgICAgICAgICAgICAgYToge1xuICAgICAgICAgICAgICAgICAgICBiID1cbiAgICAgICAgICAgICAgICAgICAgICAgIE51bWJlcihiKSB8fCAwO1xuICAgICAgICAgICAgICAgICAgICBkID0gdGhpcy5sZW5ndGggLSBiO1xuICAgICAgICAgICAgICAgICAgICBjID8gKGMgPSBOdW1iZXIoYyksIGMgPiBkICYmIChjID0gZCkpIDogYyA9IGQ7XG4gICAgICAgICAgICAgICAgICAgIGQgPSBhLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKDAgIT09IGQgJSAyKVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkludmFsaWQgaGV4IHN0cmluZ1wiKTtcbiAgICAgICAgICAgICAgICAgICAgYyA+IGQgLyAyICYmIChjID0gZCAvIDIpO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGQgPSAwOyBkIDwgYzsgKytkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlID0gcGFyc2VJbnQoYS5zdWJzdHIoMiAqIGQsIDIpLCAxNik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNOYU4oZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhID0gZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhayBhO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1tiICsgZF0gPSBlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGEgPSBkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgIGNhc2UgXCJ1dGY4XCI6XG4gICAgICAgICAgICBjYXNlIFwidXRmLThcIjogcmV0dXJuIEphKERhKGEsIHRoaXMubGVuZ3RoIC0gYiksIHRoaXMsIGIsIGMpO1xuICAgICAgICAgICAgY2FzZSBcImFzY2lpXCI6IHJldHVybiBKYShLYShhKSwgdGhpcywgYiwgYyk7XG4gICAgICAgICAgICBjYXNlIFwibGF0aW4xXCI6XG4gICAgICAgICAgICBjYXNlIFwiYmluYXJ5XCI6IHJldHVybiBKYShLYShhKSwgdGhpcywgYiwgYyk7XG4gICAgICAgICAgICBjYXNlIFwiYmFzZTY0XCI6IHJldHVybiBKYShFYShhKSwgdGhpcywgYiwgYyk7XG4gICAgICAgICAgICBjYXNlIFwidWNzMlwiOlxuICAgICAgICAgICAgY2FzZSBcInVjcy0yXCI6XG4gICAgICAgICAgICBjYXNlIFwidXRmMTZsZVwiOlxuICAgICAgICAgICAgY2FzZSBcInV0Zi0xNmxlXCI6XG4gICAgICAgICAgICAgICAgZCA9IGE7XG4gICAgICAgICAgICAgICAgZSA9IHRoaXMubGVuZ3RoIC1cbiAgICAgICAgICAgICAgICAgICAgYjtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBmID0gW10sIGcgPSAwOyBnIDwgZC5sZW5ndGggJiYgISgwID4gKGUgLT0gMikpOyArK2cpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGggPSBkLmNoYXJDb2RlQXQoZyk7XG4gICAgICAgICAgICAgICAgICAgIGEgPSBoID4+IDg7XG4gICAgICAgICAgICAgICAgICAgIGggJT0gMjU2O1xuICAgICAgICAgICAgICAgICAgICBmLnB1c2goaCk7XG4gICAgICAgICAgICAgICAgICAgIGYucHVzaChhKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIEphKGYsIHRoaXMsIGIsIGMpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBpZiAoZSlcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlVua25vd24gZW5jb2Rpbmc6IFwiICsgZCk7XG4gICAgICAgICAgICAgICAgZCA9IChcIlwiICsgZCkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgICBlID0gITA7XG4gICAgICAgIH1cbn07XG52LnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB7IHR5cGU6IFwiQnVmZmVyXCIsIGRhdGE6IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKHRoaXMuX2FyciB8fCB0aGlzLCAwKSB9OyB9O1xuZnVuY3Rpb24gR2EoYSwgYiwgYykge1xuICAgIGMgPSBNYXRoLm1pbihhLmxlbmd0aCwgYyk7XG4gICAgZm9yICh2YXIgZCA9IFtdOyBiIDwgYzspIHtcbiAgICAgICAgdmFyIGUgPSBhW2JdLCBmID0gbnVsbCwgZyA9IDIzOSA8IGUgPyA0IDogMjIzIDwgZSA/IDMgOiAxOTEgPCBlID8gMiA6IDE7XG4gICAgICAgIGlmIChiICsgZyA8PSBjKVxuICAgICAgICAgICAgc3dpdGNoIChnKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAxMjggPiBlICYmIChmID0gZSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgdmFyIGggPSBhW2IgKyAxXTtcbiAgICAgICAgICAgICAgICAgICAgMTI4ID09PSAoaCAmIDE5MikgJiYgKGUgPSAoZSAmIDMxKSA8PCA2IHwgaCAmIDYzLCAxMjcgPCBlICYmIChmID0gZSkpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgIGggPSBhW2IgKyAxXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGwgPSBhW2IgKyAyXTtcbiAgICAgICAgICAgICAgICAgICAgMTI4ID09PSAoaCAmIDE5MikgJiYgMTI4ID09PSAobCAmIDE5MikgJiYgKGUgPSAoZSAmIDE1KSA8PCAxMiB8IChoICYgNjMpIDw8IDYgfCBsICYgNjMsIDIwNDcgPCBlICYmICg1NTI5NiA+IGUgfHwgNTczNDMgPCBlKSAmJiAoZiA9IGUpKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICBoID0gYVtiICsgMV07XG4gICAgICAgICAgICAgICAgICAgIGwgPSBhW2IgKyAyXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG4gPSBhW2IgKyAzXTtcbiAgICAgICAgICAgICAgICAgICAgMTI4ID09PSAoaCAmIDE5MikgJiYgMTI4ID09PSAobCAmIDE5MikgJiYgMTI4ID09PSAobiAmIDE5MikgJiYgKGUgPSAoZSAmIDE1KSA8PCAxOCB8IChoICYgNjMpIDw8IDEyIHwgKGwgJiA2MykgPDwgNiB8IG4gJiA2MywgNjU1MzUgPCBlICYmIDExMTQxMTIgPiBlICYmIChmID1cbiAgICAgICAgICAgICAgICAgICAgICAgIGUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgbnVsbCA9PT0gZiA/IChmID0gNjU1MzMsIGcgPSAxKSA6IDY1NTM1IDwgZiAmJiAoZiAtPSA2NTUzNiwgZC5wdXNoKGYgPj4+IDEwICYgMTAyMyB8IDU1Mjk2KSwgZiA9IDU2MzIwIHwgZiAmIDEwMjMpO1xuICAgICAgICBkLnB1c2goZik7XG4gICAgICAgIGIgKz0gZztcbiAgICB9XG4gICAgYSA9IGQubGVuZ3RoO1xuICAgIGlmIChhIDw9IExhKVxuICAgICAgICBkID0gU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShTdHJpbmcsIGQpO1xuICAgIGVsc2Uge1xuICAgICAgICBjID0gXCJcIjtcbiAgICAgICAgZm9yIChiID0gMDsgYiA8IGE7KVxuICAgICAgICAgICAgYyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KFN0cmluZywgZC5zbGljZShiLCBiICs9IExhKSk7XG4gICAgICAgIGQgPSBjO1xuICAgIH1cbiAgICByZXR1cm4gZDtcbn1cbnZhciBMYSA9IDQwOTY7XG52LnByb3RvdHlwZS5zbGljZSA9IGZ1bmN0aW9uIChhLCBiKSB7IHZhciBjID0gdGhpcy5sZW5ndGg7IGEgPSB+fmE7IGIgPSB2b2lkIDAgPT09IGIgPyBjIDogfn5iOyAwID4gYSA/IChhICs9IGMsIDAgPiBhICYmIChhID0gMCkpIDogYSA+IGMgJiYgKGEgPSBjKTsgMCA+IGIgPyAoYiArPSBjLCAwID4gYiAmJiAoYiA9IDApKSA6IGIgPiBjICYmIChiID0gYyk7IGIgPCBhICYmIChiID0gYSk7IGlmICh2LlRZUEVEX0FSUkFZX1NVUFBPUlQpXG4gICAgYiA9IHRoaXMuc3ViYXJyYXkoYSwgYiksIGIuX19wcm90b19fID0gdi5wcm90b3R5cGU7XG5lbHNlIHtcbiAgICBjID0gYiAtIGE7XG4gICAgYiA9IG5ldyB2KGMsIHZvaWQgMCk7XG4gICAgZm9yICh2YXIgZCA9IDA7IGQgPCBjOyArK2QpXG4gICAgICAgIGJbZF0gPSB0aGlzW2QgKyBhXTtcbn0gcmV0dXJuIGI7IH07XG5mdW5jdGlvbiBDKGEsIGIsIGMpIHsgaWYgKDAgIT09IGEgJSAxIHx8IDAgPiBhKVxuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKFwib2Zmc2V0IGlzIG5vdCB1aW50XCIpOyBpZiAoYSArIGIgPiBjKVxuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKFwiVHJ5aW5nIHRvIGFjY2VzcyBiZXlvbmQgYnVmZmVyIGxlbmd0aFwiKTsgfVxudi5wcm90b3R5cGUucmVhZFVJbnRMRSA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7IGEgfD0gMDsgYiB8PSAwOyBjIHx8IEMoYSwgYiwgdGhpcy5sZW5ndGgpOyBjID0gdGhpc1thXTsgZm9yICh2YXIgZCA9IDEsIGUgPSAwOyArK2UgPCBiICYmIChkICo9IDI1Nik7KVxuICAgIGMgKz0gdGhpc1thICsgZV0gKiBkOyByZXR1cm4gYzsgfTtcbnYucHJvdG90eXBlLnJlYWRVSW50QkUgPSBmdW5jdGlvbiAoYSwgYiwgYykgeyBhIHw9IDA7IGIgfD0gMDsgYyB8fCBDKGEsIGIsIHRoaXMubGVuZ3RoKTsgYyA9IHRoaXNbYSArIC0tYl07IGZvciAodmFyIGQgPSAxOyAwIDwgYiAmJiAoZCAqPSAyNTYpOylcbiAgICBjICs9IHRoaXNbYSArIC0tYl0gKiBkOyByZXR1cm4gYzsgfTtcbnYucHJvdG90eXBlLnJlYWRVSW50OCA9IGZ1bmN0aW9uIChhLCBiKSB7IGIgfHwgQyhhLCAxLCB0aGlzLmxlbmd0aCk7IHJldHVybiB0aGlzW2FdOyB9O1xudi5wcm90b3R5cGUucmVhZFVJbnQxNkxFID0gZnVuY3Rpb24gKGEsIGIpIHsgYiB8fCBDKGEsIDIsIHRoaXMubGVuZ3RoKTsgcmV0dXJuIHRoaXNbYV0gfCB0aGlzW2EgKyAxXSA8PCA4OyB9O1xudi5wcm90b3R5cGUucmVhZFVJbnQxNkJFID0gZnVuY3Rpb24gKGEsIGIpIHsgYiB8fCBDKGEsIDIsIHRoaXMubGVuZ3RoKTsgcmV0dXJuIHRoaXNbYV0gPDwgOCB8IHRoaXNbYSArIDFdOyB9O1xudi5wcm90b3R5cGUucmVhZFVJbnQzMkxFID0gZnVuY3Rpb24gKGEsIGIpIHsgYiB8fCBDKGEsIDQsIHRoaXMubGVuZ3RoKTsgcmV0dXJuICh0aGlzW2FdIHwgdGhpc1thICsgMV0gPDwgOCB8IHRoaXNbYSArIDJdIDw8IDE2KSArIDE2Nzc3MjE2ICogdGhpc1thICsgM107IH07XG52LnByb3RvdHlwZS5yZWFkVUludDMyQkUgPSBmdW5jdGlvbiAoYSwgYikgeyBiIHx8IEMoYSwgNCwgdGhpcy5sZW5ndGgpOyByZXR1cm4gMTY3NzcyMTYgKiB0aGlzW2FdICsgKHRoaXNbYSArIDFdIDw8IDE2IHwgdGhpc1thICsgMl0gPDwgOCB8IHRoaXNbYSArIDNdKTsgfTtcbnYucHJvdG90eXBlLnJlYWRJbnRMRSA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7IGEgfD0gMDsgYiB8PSAwOyBjIHx8IEMoYSwgYiwgdGhpcy5sZW5ndGgpOyBjID0gdGhpc1thXTsgZm9yICh2YXIgZCA9IDEsIGUgPSAwOyArK2UgPCBiICYmIChkICo9IDI1Nik7KVxuICAgIGMgKz0gdGhpc1thICsgZV0gKiBkOyBjID49IDEyOCAqIGQgJiYgKGMgLT0gTWF0aC5wb3coMiwgOCAqIGIpKTsgcmV0dXJuIGM7IH07XG52LnByb3RvdHlwZS5yZWFkSW50QkUgPSBmdW5jdGlvbiAoYSwgYiwgYykgeyBhIHw9IDA7IGIgfD0gMDsgYyB8fCBDKGEsIGIsIHRoaXMubGVuZ3RoKTsgYyA9IGI7IGZvciAodmFyIGQgPSAxLCBlID0gdGhpc1thICsgLS1jXTsgMCA8IGMgJiYgKGQgKj0gMjU2KTspXG4gICAgZSArPSB0aGlzW2EgKyAtLWNdICogZDsgZSA+PSAxMjggKiBkICYmIChlIC09IE1hdGgucG93KDIsIDggKiBiKSk7IHJldHVybiBlOyB9O1xudi5wcm90b3R5cGUucmVhZEludDggPSBmdW5jdGlvbiAoYSwgYikgeyBiIHx8IEMoYSwgMSwgdGhpcy5sZW5ndGgpOyByZXR1cm4gdGhpc1thXSAmIDEyOCA/IC0xICogKDI1NSAtIHRoaXNbYV0gKyAxKSA6IHRoaXNbYV07IH07XG52LnByb3RvdHlwZS5yZWFkSW50MTZMRSA9IGZ1bmN0aW9uIChhLCBiKSB7IGIgfHwgQyhhLCAyLCB0aGlzLmxlbmd0aCk7IGEgPSB0aGlzW2FdIHwgdGhpc1thICsgMV0gPDwgODsgcmV0dXJuIGEgJiAzMjc2OCA/IGEgfCA0Mjk0OTAxNzYwIDogYTsgfTtcbnYucHJvdG90eXBlLnJlYWRJbnQxNkJFID0gZnVuY3Rpb24gKGEsIGIpIHsgYiB8fCBDKGEsIDIsIHRoaXMubGVuZ3RoKTsgYSA9IHRoaXNbYSArIDFdIHwgdGhpc1thXSA8PCA4OyByZXR1cm4gYSAmIDMyNzY4ID8gYSB8IDQyOTQ5MDE3NjAgOiBhOyB9O1xudi5wcm90b3R5cGUucmVhZEludDMyTEUgPSBmdW5jdGlvbiAoYSwgYikgeyBiIHx8IEMoYSwgNCwgdGhpcy5sZW5ndGgpOyByZXR1cm4gdGhpc1thXSB8IHRoaXNbYSArIDFdIDw8IDggfCB0aGlzW2EgKyAyXSA8PCAxNiB8IHRoaXNbYSArIDNdIDw8IDI0OyB9O1xudi5wcm90b3R5cGUucmVhZEludDMyQkUgPSBmdW5jdGlvbiAoYSwgYikgeyBiIHx8IEMoYSwgNCwgdGhpcy5sZW5ndGgpOyByZXR1cm4gdGhpc1thXSA8PCAyNCB8IHRoaXNbYSArIDFdIDw8IDE2IHwgdGhpc1thICsgMl0gPDwgOCB8IHRoaXNbYSArIDNdOyB9O1xudi5wcm90b3R5cGUucmVhZEZsb2F0TEUgPSBmdW5jdGlvbiAoYSwgYikgeyBiIHx8IEMoYSwgNCwgdGhpcy5sZW5ndGgpOyByZXR1cm4gcGEodGhpcywgYSwgITAsIDIzLCA0KTsgfTtcbnYucHJvdG90eXBlLnJlYWRGbG9hdEJFID0gZnVuY3Rpb24gKGEsIGIpIHsgYiB8fCBDKGEsIDQsIHRoaXMubGVuZ3RoKTsgcmV0dXJuIHBhKHRoaXMsIGEsICExLCAyMywgNCk7IH07XG52LnByb3RvdHlwZS5yZWFkRG91YmxlTEUgPSBmdW5jdGlvbiAoYSwgYikgeyBiIHx8IEMoYSwgOCwgdGhpcy5sZW5ndGgpOyByZXR1cm4gcGEodGhpcywgYSwgITAsIDUyLCA4KTsgfTtcbnYucHJvdG90eXBlLnJlYWREb3VibGVCRSA9IGZ1bmN0aW9uIChhLCBiKSB7IGIgfHwgQyhhLCA4LCB0aGlzLmxlbmd0aCk7IHJldHVybiBwYSh0aGlzLCBhLCAhMSwgNTIsIDgpOyB9O1xuZnVuY3Rpb24gRChhLCBiLCBjLCBkLCBlLCBmKSB7IGlmICgheihhKSlcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdcImJ1ZmZlclwiIGFyZ3VtZW50IG11c3QgYmUgYSBCdWZmZXIgaW5zdGFuY2UnKTsgaWYgKGIgPiBlIHx8IGIgPCBmKVxuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdcInZhbHVlXCIgYXJndW1lbnQgaXMgb3V0IG9mIGJvdW5kcycpOyBpZiAoYyArIGQgPiBhLmxlbmd0aClcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcihcIkluZGV4IG91dCBvZiByYW5nZVwiKTsgfVxudi5wcm90b3R5cGUud3JpdGVVSW50TEUgPSBmdW5jdGlvbiAoYSwgYiwgYywgZCkgeyBhID0gK2E7IGIgfD0gMDsgYyB8PSAwOyBkIHx8IEQodGhpcywgYSwgYiwgYywgTWF0aC5wb3coMiwgOCAqIGMpIC0gMSwgMCk7IGQgPSAxOyB2YXIgZSA9IDA7IGZvciAodGhpc1tiXSA9IGEgJiAyNTU7ICsrZSA8IGMgJiYgKGQgKj0gMjU2KTspXG4gICAgdGhpc1tiICsgZV0gPSBhIC8gZCAmIDI1NTsgcmV0dXJuIGIgKyBjOyB9O1xudi5wcm90b3R5cGUud3JpdGVVSW50QkUgPSBmdW5jdGlvbiAoYSwgYiwgYywgZCkgeyBhID0gK2E7IGIgfD0gMDsgYyB8PSAwOyBkIHx8IEQodGhpcywgYSwgYiwgYywgTWF0aC5wb3coMiwgOCAqIGMpIC0gMSwgMCk7IGQgPSBjIC0gMTsgdmFyIGUgPSAxOyBmb3IgKHRoaXNbYiArIGRdID0gYSAmIDI1NTsgMCA8PSAtLWQgJiYgKGUgKj0gMjU2KTspXG4gICAgdGhpc1tiICsgZF0gPSBhIC8gZSAmIDI1NTsgcmV0dXJuIGIgKyBjOyB9O1xudi5wcm90b3R5cGUud3JpdGVVSW50OCA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7IGEgPSArYTsgYiB8PSAwOyBjIHx8IEQodGhpcywgYSwgYiwgMSwgMjU1LCAwKTsgdi5UWVBFRF9BUlJBWV9TVVBQT1JUIHx8IChhID0gTWF0aC5mbG9vcihhKSk7IHRoaXNbYl0gPSBhICYgMjU1OyByZXR1cm4gYiArIDE7IH07XG5mdW5jdGlvbiBNYShhLCBiLCBjLCBkKSB7IDAgPiBiICYmIChiID0gNjU1MzUgKyBiICsgMSk7IGZvciAodmFyIGUgPSAwLCBmID0gTWF0aC5taW4oYS5sZW5ndGggLSBjLCAyKTsgZSA8IGY7ICsrZSlcbiAgICBhW2MgKyBlXSA9IChiICYgMjU1IDw8IDggKiAoZCA/IGUgOiAxIC0gZSkpID4+PiA4ICogKGQgPyBlIDogMSAtIGUpOyB9XG52LnByb3RvdHlwZS53cml0ZVVJbnQxNkxFID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgYSA9ICthOyBiIHw9IDA7IGMgfHwgRCh0aGlzLCBhLCBiLCAyLCA2NTUzNSwgMCk7IHYuVFlQRURfQVJSQVlfU1VQUE9SVCA/ICh0aGlzW2JdID0gYSAmIDI1NSwgdGhpc1tiICsgMV0gPSBhID4+PiA4KSA6IE1hKHRoaXMsIGEsIGIsICEwKTsgcmV0dXJuIGIgKyAyOyB9O1xudi5wcm90b3R5cGUud3JpdGVVSW50MTZCRSA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7IGEgPSArYTsgYiB8PSAwOyBjIHx8IEQodGhpcywgYSwgYiwgMiwgNjU1MzUsIDApOyB2LlRZUEVEX0FSUkFZX1NVUFBPUlQgPyAodGhpc1tiXSA9IGEgPj4+IDgsIHRoaXNbYiArIDFdID0gYSAmIDI1NSkgOiBNYSh0aGlzLCBhLCBiLCAhMSk7IHJldHVybiBiICsgMjsgfTtcbmZ1bmN0aW9uIE5hKGEsIGIsIGMsIGQpIHsgMCA+IGIgJiYgKGIgPSA0Mjk0OTY3Mjk1ICsgYiArIDEpOyBmb3IgKHZhciBlID0gMCwgZiA9IE1hdGgubWluKGEubGVuZ3RoIC0gYywgNCk7IGUgPCBmOyArK2UpXG4gICAgYVtjICsgZV0gPSBiID4+PiA4ICogKGQgPyBlIDogMyAtIGUpICYgMjU1OyB9XG52LnByb3RvdHlwZS53cml0ZVVJbnQzMkxFID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgYSA9ICthOyBiIHw9IDA7IGMgfHwgRCh0aGlzLCBhLCBiLCA0LCA0Mjk0OTY3Mjk1LCAwKTsgdi5UWVBFRF9BUlJBWV9TVVBQT1JUID8gKHRoaXNbYiArIDNdID0gYSA+Pj4gMjQsIHRoaXNbYiArIDJdID0gYSA+Pj4gMTYsIHRoaXNbYiArIDFdID0gYSA+Pj4gOCwgdGhpc1tiXSA9IGEgJiAyNTUpIDogTmEodGhpcywgYSwgYiwgITApOyByZXR1cm4gYiArIDQ7IH07XG52LnByb3RvdHlwZS53cml0ZVVJbnQzMkJFID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgYSA9ICthOyBiIHw9IDA7IGMgfHwgRCh0aGlzLCBhLCBiLCA0LCA0Mjk0OTY3Mjk1LCAwKTsgdi5UWVBFRF9BUlJBWV9TVVBQT1JUID8gKHRoaXNbYl0gPSBhID4+PiAyNCwgdGhpc1tiICsgMV0gPSBhID4+PiAxNiwgdGhpc1tiICsgMl0gPSBhID4+PiA4LCB0aGlzW2IgKyAzXSA9IGEgJiAyNTUpIDogTmEodGhpcywgYSwgYiwgITEpOyByZXR1cm4gYiArIDQ7IH07XG52LnByb3RvdHlwZS53cml0ZUludExFID0gZnVuY3Rpb24gKGEsIGIsIGMsIGQpIHsgYSA9ICthOyBiIHw9IDA7IGQgfHwgKGQgPSBNYXRoLnBvdygyLCA4ICogYyAtIDEpLCBEKHRoaXMsIGEsIGIsIGMsIGQgLSAxLCAtZCkpOyBkID0gMDsgdmFyIGUgPSAxLCBmID0gMDsgZm9yICh0aGlzW2JdID0gYSAmIDI1NTsgKytkIDwgYyAmJiAoZSAqPSAyNTYpOylcbiAgICAwID4gYSAmJiAwID09PSBmICYmIDAgIT09IHRoaXNbYiArIGQgLSAxXSAmJiAoZiA9IDEpLCB0aGlzW2IgKyBkXSA9IChhIC8gZSA+PiAwKSAtIGYgJiAyNTU7IHJldHVybiBiICsgYzsgfTtcbnYucHJvdG90eXBlLndyaXRlSW50QkUgPSBmdW5jdGlvbiAoYSwgYiwgYywgZCkgeyBhID0gK2E7IGIgfD0gMDsgZCB8fCAoZCA9IE1hdGgucG93KDIsIDggKiBjIC0gMSksIEQodGhpcywgYSwgYiwgYywgZCAtIDEsIC1kKSk7IGQgPSBjIC0gMTsgdmFyIGUgPSAxLCBmID0gMDsgZm9yICh0aGlzW2IgKyBkXSA9IGEgJiAyNTU7IDAgPD0gLS1kICYmIChlICo9IDI1Nik7KVxuICAgIDAgPiBhICYmIDAgPT09IGYgJiYgMCAhPT0gdGhpc1tiICsgZCArIDFdICYmIChmID0gMSksIHRoaXNbYiArIGRdID0gKGEgLyBlID4+IDApIC0gZiAmIDI1NTsgcmV0dXJuIGIgKyBjOyB9O1xudi5wcm90b3R5cGUud3JpdGVJbnQ4ID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgYSA9ICthOyBiIHw9IDA7IGMgfHwgRCh0aGlzLCBhLCBiLCAxLCAxMjcsIC0xMjgpOyB2LlRZUEVEX0FSUkFZX1NVUFBPUlQgfHwgKGEgPSBNYXRoLmZsb29yKGEpKTsgMCA+IGEgJiYgKGEgPSAyNTUgKyBhICsgMSk7IHRoaXNbYl0gPSBhICYgMjU1OyByZXR1cm4gYiArIDE7IH07XG52LnByb3RvdHlwZS53cml0ZUludDE2TEUgPSBmdW5jdGlvbiAoYSwgYiwgYykgeyBhID0gK2E7IGIgfD0gMDsgYyB8fCBEKHRoaXMsIGEsIGIsIDIsIDMyNzY3LCAtMzI3NjgpOyB2LlRZUEVEX0FSUkFZX1NVUFBPUlQgPyAodGhpc1tiXSA9IGEgJiAyNTUsIHRoaXNbYiArIDFdID0gYSA+Pj4gOCkgOiBNYSh0aGlzLCBhLCBiLCAhMCk7IHJldHVybiBiICsgMjsgfTtcbnYucHJvdG90eXBlLndyaXRlSW50MTZCRSA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7IGEgPSArYTsgYiB8PSAwOyBjIHx8IEQodGhpcywgYSwgYiwgMiwgMzI3NjcsIC0zMjc2OCk7IHYuVFlQRURfQVJSQVlfU1VQUE9SVCA/ICh0aGlzW2JdID0gYSA+Pj4gOCwgdGhpc1tiICsgMV0gPSBhICYgMjU1KSA6IE1hKHRoaXMsIGEsIGIsICExKTsgcmV0dXJuIGIgKyAyOyB9O1xudi5wcm90b3R5cGUud3JpdGVJbnQzMkxFID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgYSA9ICthOyBiIHw9IDA7IGMgfHwgRCh0aGlzLCBhLCBiLCA0LCAyMTQ3NDgzNjQ3LCAtMjE0NzQ4MzY0OCk7IHYuVFlQRURfQVJSQVlfU1VQUE9SVCA/ICh0aGlzW2JdID0gYSAmIDI1NSwgdGhpc1tiICsgMV0gPSBhID4+PiA4LCB0aGlzW2IgKyAyXSA9IGEgPj4+IDE2LCB0aGlzW2IgKyAzXSA9IGEgPj4+IDI0KSA6IE5hKHRoaXMsIGEsIGIsICEwKTsgcmV0dXJuIGIgKyA0OyB9O1xudi5wcm90b3R5cGUud3JpdGVJbnQzMkJFID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgYSA9ICthOyBiIHw9IDA7IGMgfHwgRCh0aGlzLCBhLCBiLCA0LCAyMTQ3NDgzNjQ3LCAtMjE0NzQ4MzY0OCk7IDAgPiBhICYmIChhID0gNDI5NDk2NzI5NSArIGEgKyAxKTsgdi5UWVBFRF9BUlJBWV9TVVBQT1JUID8gKHRoaXNbYl0gPSBhID4+PiAyNCwgdGhpc1tiICsgMV0gPSBhID4+PiAxNiwgdGhpc1tiICsgMl0gPSBhID4+PiA4LCB0aGlzW2IgKyAzXSA9IGEgJiAyNTUpIDogTmEodGhpcywgYSwgYiwgITEpOyByZXR1cm4gYiArIDQ7IH07XG5mdW5jdGlvbiBPYShhLCBiLCBjLCBkKSB7IGlmIChjICsgZCA+IGEubGVuZ3RoKVxuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKFwiSW5kZXggb3V0IG9mIHJhbmdlXCIpOyBpZiAoMCA+IGMpXG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoXCJJbmRleCBvdXQgb2YgcmFuZ2VcIik7IH1cbnYucHJvdG90eXBlLndyaXRlRmxvYXRMRSA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7IGMgfHwgT2EodGhpcywgYSwgYiwgNCk7IHFhKHRoaXMsIGEsIGIsICEwLCAyMywgNCk7IHJldHVybiBiICsgNDsgfTtcbnYucHJvdG90eXBlLndyaXRlRmxvYXRCRSA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7IGMgfHwgT2EodGhpcywgYSwgYiwgNCk7IHFhKHRoaXMsIGEsIGIsICExLCAyMywgNCk7IHJldHVybiBiICsgNDsgfTtcbnYucHJvdG90eXBlLndyaXRlRG91YmxlTEUgPSBmdW5jdGlvbiAoYSwgYiwgYykgeyBjIHx8IE9hKHRoaXMsIGEsIGIsIDgpOyBxYSh0aGlzLCBhLCBiLCAhMCwgNTIsIDgpOyByZXR1cm4gYiArIDg7IH07XG52LnByb3RvdHlwZS53cml0ZURvdWJsZUJFID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgYyB8fCBPYSh0aGlzLCBhLCBiLCA4KTsgcWEodGhpcywgYSwgYiwgITEsIDUyLCA4KTsgcmV0dXJuIGIgKyA4OyB9O1xudi5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIChhLCBiLCBjLCBkKSB7XG4gICAgYyB8fCAoYyA9IDApO1xuICAgIGQgfHwgMCA9PT0gZCB8fCAoZCA9IHRoaXMubGVuZ3RoKTtcbiAgICBiID49IGEubGVuZ3RoICYmIChiID0gYS5sZW5ndGgpO1xuICAgIGIgfHwgKGIgPSAwKTtcbiAgICAwIDwgZCAmJiBkIDwgYyAmJiAoZCA9IGMpO1xuICAgIGlmIChkID09PSBjIHx8IDAgPT09IGEubGVuZ3RoIHx8IDAgPT09IHRoaXMubGVuZ3RoKVxuICAgICAgICByZXR1cm4gMDtcbiAgICBpZiAoMCA+IGIpXG4gICAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKFwidGFyZ2V0U3RhcnQgb3V0IG9mIGJvdW5kc1wiKTtcbiAgICBpZiAoMCA+IGMgfHwgYyA+PSB0aGlzLmxlbmd0aClcbiAgICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoXCJzb3VyY2VTdGFydCBvdXQgb2YgYm91bmRzXCIpO1xuICAgIGlmICgwID4gZClcbiAgICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoXCJzb3VyY2VFbmQgb3V0IG9mIGJvdW5kc1wiKTtcbiAgICBkID4gdGhpcy5sZW5ndGggJiYgKGQgPSB0aGlzLmxlbmd0aCk7XG4gICAgYS5sZW5ndGggLSBiIDwgZCAtIGMgJiYgKGQgPSBhLmxlbmd0aCAtIGIgKyBjKTtcbiAgICB2YXIgZSA9IGQgLSBjO1xuICAgIGlmICh0aGlzID09PSBhICYmIGMgPCBiICYmIGIgPCBkKVxuICAgICAgICBmb3IgKGQgPSBlIC0gMTsgMCA8PSBkOyAtLWQpXG4gICAgICAgICAgICBhW2QgKyBiXSA9IHRoaXNbZCArIGNdO1xuICAgIGVsc2UgaWYgKDFFMyA+IGUgfHxcbiAgICAgICAgIXYuVFlQRURfQVJSQVlfU1VQUE9SVClcbiAgICAgICAgZm9yIChkID0gMDsgZCA8IGU7ICsrZClcbiAgICAgICAgICAgIGFbZCArIGJdID0gdGhpc1tkICsgY107XG4gICAgZWxzZVxuICAgICAgICBVaW50OEFycmF5LnByb3RvdHlwZS5zZXQuY2FsbChhLCB0aGlzLnN1YmFycmF5KGMsIGMgKyBlKSwgYik7XG4gICAgcmV0dXJuIGU7XG59O1xudi5wcm90b3R5cGUuZmlsbCA9IGZ1bmN0aW9uIChhLCBiLCBjLCBkKSB7XG4gICAgaWYgKFwic3RyaW5nXCIgPT09IHR5cGVvZiBhKSB7XG4gICAgICAgIFwic3RyaW5nXCIgPT09IHR5cGVvZiBiID8gKGQgPSBiLCBiID0gMCwgYyA9IHRoaXMubGVuZ3RoKSA6IFwic3RyaW5nXCIgPT09IHR5cGVvZiBjICYmIChkID0gYywgYyA9IHRoaXMubGVuZ3RoKTtcbiAgICAgICAgaWYgKDEgPT09IGEubGVuZ3RoKSB7XG4gICAgICAgICAgICB2YXIgZSA9IGEuY2hhckNvZGVBdCgwKTtcbiAgICAgICAgICAgIDI1NiA+IGUgJiYgKGEgPSBlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodm9pZCAwICE9PSBkICYmIFwic3RyaW5nXCIgIT09IHR5cGVvZiBkKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcImVuY29kaW5nIG11c3QgYmUgYSBzdHJpbmdcIik7XG4gICAgICAgIGlmIChcInN0cmluZ1wiID09PSB0eXBlb2YgZCAmJiAhdi5pc0VuY29kaW5nKGQpKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlVua25vd24gZW5jb2Rpbmc6IFwiICsgZCk7XG4gICAgfVxuICAgIGVsc2VcbiAgICAgICAgXCJudW1iZXJcIiA9PT0gdHlwZW9mIGEgJiYgKGEgJj0gMjU1KTtcbiAgICBpZiAoMCA+IGIgfHwgdGhpcy5sZW5ndGggPCBiIHx8IHRoaXMubGVuZ3RoIDwgYylcbiAgICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoXCJPdXQgb2YgcmFuZ2UgaW5kZXhcIik7XG4gICAgaWYgKGMgPD0gYilcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgYiA+Pj49XG4gICAgICAgIDA7XG4gICAgYyA9IHZvaWQgMCA9PT0gYyA/IHRoaXMubGVuZ3RoIDogYyA+Pj4gMDtcbiAgICBhIHx8IChhID0gMCk7XG4gICAgaWYgKFwibnVtYmVyXCIgPT09IHR5cGVvZiBhKVxuICAgICAgICBmb3IgKGQgPSBiOyBkIDwgYzsgKytkKVxuICAgICAgICAgICAgdGhpc1tkXSA9IGE7XG4gICAgZWxzZVxuICAgICAgICBmb3IgKGEgPSB6KGEpID8gYSA6IERhKChuZXcgdihhLCBkKSkudG9TdHJpbmcoKSksIGUgPSBhLmxlbmd0aCwgZCA9IDA7IGQgPCBjIC0gYjsgKytkKVxuICAgICAgICAgICAgdGhpc1tkICsgYl0gPSBhW2QgJSBlXTtcbiAgICByZXR1cm4gdGhpcztcbn07XG52YXIgUGEgPSAvW14rXFwvMC05QS1aYS16LV9dL2c7XG5mdW5jdGlvbiBEYShhLCBiKSB7XG4gICAgYiA9IGIgfHwgSW5maW5pdHk7XG4gICAgZm9yICh2YXIgYywgZCA9IGEubGVuZ3RoLCBlID0gbnVsbCwgZiA9IFtdLCBnID0gMDsgZyA8IGQ7ICsrZykge1xuICAgICAgICBjID0gYS5jaGFyQ29kZUF0KGcpO1xuICAgICAgICBpZiAoNTUyOTUgPCBjICYmIDU3MzQ0ID4gYykge1xuICAgICAgICAgICAgaWYgKCFlKSB7XG4gICAgICAgICAgICAgICAgaWYgKDU2MzE5IDwgYykge1xuICAgICAgICAgICAgICAgICAgICAtMSA8IChiIC09IDMpICYmIGYucHVzaCgyMzksIDE5MSwgMTg5KTtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGcgKyAxID09PSBkKSB7XG4gICAgICAgICAgICAgICAgICAgIC0xIDwgKGIgLT0gMykgJiYgZi5wdXNoKDIzOSwgMTkxLCAxODkpO1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZSA9IGM7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoNTYzMjAgPiBjKSB7XG4gICAgICAgICAgICAgICAgLTEgPCAoYiAtPSAzKSAmJiBmLnB1c2goMjM5LCAxOTEsIDE4OSk7XG4gICAgICAgICAgICAgICAgZSA9IGM7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjID0gKGUgLSA1NTI5NiA8PCAxMCB8IGMgLSA1NjMyMCkgKyA2NTUzNjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgICAgICBlICYmIC0xIDwgKGIgLT0gMykgJiYgZi5wdXNoKDIzOSwgMTkxLCAxODkpO1xuICAgICAgICBlID0gbnVsbDtcbiAgICAgICAgaWYgKDEyOCA+IGMpIHtcbiAgICAgICAgICAgIGlmICgwID4gLS1iKVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZi5wdXNoKGMpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKDIwNDggPiBjKSB7XG4gICAgICAgICAgICBpZiAoMCA+IChiIC09IDIpKVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZi5wdXNoKGMgPj4gNiB8IDE5MiwgYyAmIDYzIHwgMTI4KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICg2NTUzNiA+IGMpIHtcbiAgICAgICAgICAgIGlmICgwID4gKGIgLT0gMykpXG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBmLnB1c2goYyA+PiAxMiB8IDIyNCwgYyA+PiA2ICYgNjMgfCAxMjgsIGMgJiA2MyB8IDEyOCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoMTExNDExMiA+IGMpIHtcbiAgICAgICAgICAgIGlmICgwID4gKGIgLT0gNCkpXG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBmLnB1c2goYyA+PiAxOCB8IDI0MCwgYyA+PiAxMiAmIDYzIHwgMTI4LCBjID4+IDYgJiA2MyB8IDEyOCwgYyAmIDYzIHwgMTI4KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcIkludmFsaWQgY29kZSBwb2ludFwiKTtcbiAgICB9XG4gICAgcmV0dXJuIGY7XG59XG5mdW5jdGlvbiBLYShhKSB7IGZvciAodmFyIGIgPSBbXSwgYyA9IDA7IGMgPCBhLmxlbmd0aDsgKytjKVxuICAgIGIucHVzaChhLmNoYXJDb2RlQXQoYykgJiAyNTUpOyByZXR1cm4gYjsgfVxuZnVuY3Rpb24gRWEoYSkge1xuICAgIGEgPSAoYS50cmltID8gYS50cmltKCkgOiBhLnJlcGxhY2UoL15cXHMrfFxccyskL2csIFwiXCIpKS5yZXBsYWNlKFBhLCBcIlwiKTtcbiAgICBpZiAoMiA+IGEubGVuZ3RoKVxuICAgICAgICBhID0gXCJcIjtcbiAgICBlbHNlXG4gICAgICAgIGZvciAoOyAwICE9PSBhLmxlbmd0aCAlIDQ7KVxuICAgICAgICAgICAgYSArPSBcIj1cIjtcbiAgICBsYSB8fCBtYSgpO1xuICAgIHZhciBiID0gYS5sZW5ndGg7XG4gICAgaWYgKDAgPCBiICUgNClcbiAgICAgICAgdGhyb3cgRXJyb3IoXCJJbnZhbGlkIHN0cmluZy4gTGVuZ3RoIG11c3QgYmUgYSBtdWx0aXBsZSBvZiA0XCIpO1xuICAgIHZhciBjID0gXCI9XCIgPT09IGFbYiAtIDJdID8gMiA6IFwiPVwiID09PSBhW2IgLSAxXSA/IDEgOiAwO1xuICAgIHZhciBkID0gbmV3IGthKDMgKiBiIC8gNCAtIGMpO1xuICAgIHZhciBlID0gMCA8IGMgPyBiIC0gNCA6IGI7XG4gICAgdmFyIGYgPSAwO1xuICAgIGZvciAoYiA9IDA7IGIgPCBlOyBiICs9IDQpIHtcbiAgICAgICAgdmFyIGcgPSB1W2EuY2hhckNvZGVBdChiKV0gPDwgMTggfCB1W2EuY2hhckNvZGVBdChiICsgMSldIDw8IDEyIHwgdVthLmNoYXJDb2RlQXQoYiArIDIpXSA8PCA2IHwgdVthLmNoYXJDb2RlQXQoYiArIDMpXTtcbiAgICAgICAgZFtmKytdID0gZyA+PiAxNiAmIDI1NTtcbiAgICAgICAgZFtmKytdID0gZyA+PiA4ICYgMjU1O1xuICAgICAgICBkW2YrK10gPSBnICYgMjU1O1xuICAgIH1cbiAgICAyID09PSBjID8gKGcgPSB1W2EuY2hhckNvZGVBdChiKV0gPDwgMiB8XG4gICAgICAgIHVbYS5jaGFyQ29kZUF0KGIgKyAxKV0gPj4gNCwgZFtmKytdID0gZyAmIDI1NSkgOiAxID09PSBjICYmIChnID0gdVthLmNoYXJDb2RlQXQoYildIDw8IDEwIHwgdVthLmNoYXJDb2RlQXQoYiArIDEpXSA8PCA0IHwgdVthLmNoYXJDb2RlQXQoYiArIDIpXSA+PiAyLCBkW2YrK10gPSBnID4+IDggJiAyNTUsIGRbZisrXSA9IGcgJiAyNTUpO1xuICAgIHJldHVybiBkO1xufVxuZnVuY3Rpb24gSmEoYSwgYiwgYywgZCkgeyBmb3IgKHZhciBlID0gMDsgZSA8IGQgJiYgIShlICsgYyA+PSBiLmxlbmd0aCB8fCBlID49IGEubGVuZ3RoKTsgKytlKVxuICAgIGJbZSArIGNdID0gYVtlXTsgcmV0dXJuIGU7IH1cbmZ1bmN0aW9uIENhKGEpIHsgcmV0dXJuIG51bGwgIT0gYSAmJiAoISFhLl9pc0J1ZmZlciB8fCBRYShhKSB8fCBcImZ1bmN0aW9uXCIgPT09IHR5cGVvZiBhLnJlYWRGbG9hdExFICYmIFwiZnVuY3Rpb25cIiA9PT0gdHlwZW9mIGEuc2xpY2UgJiYgUWEoYS5zbGljZSgwLCAwKSkpOyB9XG5mdW5jdGlvbiBRYShhKSB7IHJldHVybiAhIWEuY29uc3RydWN0b3IgJiYgXCJmdW5jdGlvblwiID09PSB0eXBlb2YgYS5jb25zdHJ1Y3Rvci5pc0J1ZmZlciAmJiBhLmNvbnN0cnVjdG9yLmlzQnVmZmVyKGEpOyB9XG52YXIgUmEgPSBPYmplY3QuZnJlZXplKHsgX19wcm90b19fOiBudWxsLCBJTlNQRUNUX01BWF9CWVRFUzogNTAsIGtNYXhMZW5ndGg6IHRhLCBCdWZmZXI6IHYsIFNsb3dCdWZmZXI6IGZ1bmN0aW9uIChhKSB7ICthICE9IGEgJiYgKGEgPSAwKTsgcmV0dXJuIHYuYWxsb2MoK2EpOyB9LCBpc0J1ZmZlcjogQ2EgfSksIEUgPSB2LCBTYSA9IFwidW5kZWZpbmVkXCIgIT09IHR5cGVvZiBnbG9iYWxUaGlzID8gZ2xvYmFsVGhpcyA6IFwidW5kZWZpbmVkXCIgIT09IHR5cGVvZiB3aW5kb3cgPyB3aW5kb3cgOiBcInVuZGVmaW5lZFwiICE9PSB0eXBlb2YgX193ZWJwYWNrX3JlcXVpcmVfXy5nID8gX193ZWJwYWNrX3JlcXVpcmVfXy5nIDogXCJ1bmRlZmluZWRcIiAhPT0gdHlwZW9mIHNlbGYgPyBzZWxmIDoge307XG5mdW5jdGlvbiBUYShhLCBiKSB7IHJldHVybiBiID0geyBleHBvcnRzOiB7fSB9LCBhKGIsIGIuZXhwb3J0cyksIGIuZXhwb3J0czsgfVxuZnVuY3Rpb24gVWEoKSB7IHRocm93IEVycm9yKFwic2V0VGltZW91dCBoYXMgbm90IGJlZW4gZGVmaW5lZFwiKTsgfVxuZnVuY3Rpb24gVmEoKSB7IHRocm93IEVycm9yKFwiY2xlYXJUaW1lb3V0IGhhcyBub3QgYmVlbiBkZWZpbmVkXCIpOyB9XG52YXIgRiA9IFVhLCBHID0gVmE7XG5cImZ1bmN0aW9uXCIgPT09IHR5cGVvZiBqYS5zZXRUaW1lb3V0ICYmIChGID0gc2V0VGltZW91dCk7XG5cImZ1bmN0aW9uXCIgPT09IHR5cGVvZiBqYS5jbGVhclRpbWVvdXQgJiYgKEcgPSBjbGVhclRpbWVvdXQpO1xuZnVuY3Rpb24gV2EoYSkgeyBpZiAoRiA9PT0gc2V0VGltZW91dClcbiAgICByZXR1cm4gc2V0VGltZW91dChhLCAwKTsgaWYgKChGID09PSBVYSB8fCAhRikgJiYgc2V0VGltZW91dClcbiAgICByZXR1cm4gRiA9IHNldFRpbWVvdXQsIHNldFRpbWVvdXQoYSwgMCk7IHRyeSB7XG4gICAgcmV0dXJuIEYoYSwgMCk7XG59XG5jYXRjaCAoYikge1xuICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBGLmNhbGwobnVsbCwgYSwgMCk7XG4gICAgfVxuICAgIGNhdGNoIChjKSB7XG4gICAgICAgIHJldHVybiBGLmNhbGwodGhpcywgYSwgMCk7XG4gICAgfVxufSB9XG5mdW5jdGlvbiBYYShhKSB7IGlmIChHID09PSBjbGVhclRpbWVvdXQpXG4gICAgcmV0dXJuIGNsZWFyVGltZW91dChhKTsgaWYgKChHID09PSBWYSB8fCAhRykgJiYgY2xlYXJUaW1lb3V0KVxuICAgIHJldHVybiBHID0gY2xlYXJUaW1lb3V0LCBjbGVhclRpbWVvdXQoYSk7IHRyeSB7XG4gICAgcmV0dXJuIEcoYSk7XG59XG5jYXRjaCAoYikge1xuICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBHLmNhbGwobnVsbCwgYSk7XG4gICAgfVxuICAgIGNhdGNoIChjKSB7XG4gICAgICAgIHJldHVybiBHLmNhbGwodGhpcywgYSk7XG4gICAgfVxufSB9XG52YXIgSCA9IFtdLCBJID0gITEsIEosIFlhID0gLTE7XG5mdW5jdGlvbiBaYSgpIHsgSSAmJiBKICYmIChJID0gITEsIEoubGVuZ3RoID8gSCA9IEouY29uY2F0KEgpIDogWWEgPSAtMSwgSC5sZW5ndGggJiYgJGEoKSk7IH1cbmZ1bmN0aW9uICRhKCkgeyBpZiAoIUkpIHtcbiAgICB2YXIgYSA9IFdhKFphKTtcbiAgICBJID0gITA7XG4gICAgZm9yICh2YXIgYiA9IEgubGVuZ3RoOyBiOykge1xuICAgICAgICBKID0gSDtcbiAgICAgICAgZm9yIChIID0gW107ICsrWWEgPCBiOylcbiAgICAgICAgICAgIEogJiYgSltZYV0ucnVuKCk7XG4gICAgICAgIFlhID0gLTE7XG4gICAgICAgIGIgPSBILmxlbmd0aDtcbiAgICB9XG4gICAgSiA9IG51bGw7XG4gICAgSSA9ICExO1xuICAgIFhhKGEpO1xufSB9XG5mdW5jdGlvbiBhYihhKSB7IHZhciBiID0gQXJyYXkoYXJndW1lbnRzLmxlbmd0aCAtIDEpOyBpZiAoMSA8IGFyZ3VtZW50cy5sZW5ndGgpXG4gICAgZm9yICh2YXIgYyA9IDE7IGMgPCBhcmd1bWVudHMubGVuZ3RoOyBjKyspXG4gICAgICAgIGJbYyAtIDFdID0gYXJndW1lbnRzW2NdOyBILnB1c2gobmV3IGJiKGEsIGIpKTsgMSAhPT0gSC5sZW5ndGggfHwgSSB8fCBXYSgkYSk7IH1cbmZ1bmN0aW9uIGJiKGEsIGIpIHsgdGhpcy5mdW4gPSBhOyB0aGlzLmFycmF5ID0gYjsgfVxuYmIucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHsgdGhpcy5mdW4uYXBwbHkobnVsbCwgdGhpcy5hcnJheSk7IH07XG5mdW5jdGlvbiBLKCkgeyB9XG52YXIgTCA9IGphLnBlcmZvcm1hbmNlIHx8IHt9LCBjYiA9IEwubm93IHx8IEwubW96Tm93IHx8IEwubXNOb3cgfHwgTC5vTm93IHx8IEwud2Via2l0Tm93IHx8IGZ1bmN0aW9uICgpIHsgcmV0dXJuIChuZXcgRGF0ZSkuZ2V0VGltZSgpOyB9LCBkYiA9IG5ldyBEYXRlLCBlYiA9IHsgbmV4dFRpY2s6IGFiLCB0aXRsZTogXCJicm93c2VyXCIsIGJyb3dzZXI6ICEwLCBlbnY6IHt9LCBhcmd2OiBbXSwgdmVyc2lvbjogXCJcIiwgdmVyc2lvbnM6IHt9LCBvbjogSywgYWRkTGlzdGVuZXI6IEssIG9uY2U6IEssIG9mZjogSywgcmVtb3ZlTGlzdGVuZXI6IEssIHJlbW92ZUFsbExpc3RlbmVyczogSywgZW1pdDogSywgYmluZGluZzogZnVuY3Rpb24gKCkgeyB0aHJvdyBFcnJvcihcInByb2Nlc3MuYmluZGluZyBpcyBub3Qgc3VwcG9ydGVkXCIpOyB9LCBjd2Q6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIFwiL1wiOyB9LCBjaGRpcjogZnVuY3Rpb24gKCkgeyB0aHJvdyBFcnJvcihcInByb2Nlc3MuY2hkaXIgaXMgbm90IHN1cHBvcnRlZFwiKTsgfSwgdW1hc2s6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIDA7IH0sIGhydGltZTogZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgdmFyIGIgPSAuMDAxICpcbiAgICAgICAgICAgIGNiLmNhbGwoTCksIGMgPSBNYXRoLmZsb29yKGIpO1xuICAgICAgICBiID0gTWF0aC5mbG9vcihiICUgMSAqIDFFOSk7XG4gICAgICAgIGEgJiYgKGMgLT0gYVswXSwgYiAtPSBhWzFdLCAwID4gYiAmJiAoYy0tLCBiICs9IDFFOSkpO1xuICAgICAgICByZXR1cm4gW2MsIGJdO1xuICAgIH0sIHBsYXRmb3JtOiBcImJyb3dzZXJcIiwgcmVsZWFzZToge30sIGNvbmZpZzoge30sIHVwdGltZTogZnVuY3Rpb24gKCkgeyByZXR1cm4gKG5ldyBEYXRlIC0gZGIpIC8gMUUzOyB9IH0sIGZiID0gVGEoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICBmdW5jdGlvbiBjKGEsIGIpIHsgZm9yICh2YXIgYyBpbiBhKVxuICAgICAgICBiW2NdID0gYVtjXTsgfVxuICAgIGZ1bmN0aW9uIGQoYSwgYiwgYykgeyByZXR1cm4gZShhLCBiLCBjKTsgfVxuICAgIHZhciBlID0gUmEuQnVmZmVyO1xuICAgIGUuZnJvbSAmJiBlLmFsbG9jICYmIGUuYWxsb2NVbnNhZmUgJiYgZS5hbGxvY1Vuc2FmZVNsb3cgPyBhLmV4cG9ydHMgPSBSYSA6IChjKFJhLCBiKSwgYi5CdWZmZXIgPSBkKTtcbiAgICBkLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoZS5wcm90b3R5cGUpO1xuICAgIGMoZSwgZCk7XG4gICAgZC5mcm9tID0gZnVuY3Rpb24gKGEsIGIsIGMpIHtcbiAgICAgICAgaWYgKFwibnVtYmVyXCIgPT09IHR5cGVvZiBhKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkFyZ3VtZW50IG11c3Qgbm90IGJlIGEgbnVtYmVyXCIpO1xuICAgICAgICByZXR1cm4gZShhLCBiLCBjKTtcbiAgICB9O1xuICAgIGQuYWxsb2MgPSBmdW5jdGlvbiAoYSwgYiwgYykgeyBpZiAoXCJudW1iZXJcIiAhPT0gdHlwZW9mIGEpXG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJBcmd1bWVudCBtdXN0IGJlIGEgbnVtYmVyXCIpOyBhID0gZShhKTsgdm9pZCAwICE9PSBiID8gXCJzdHJpbmdcIiA9PT0gdHlwZW9mIGMgPyBhLmZpbGwoYiwgYykgOiBhLmZpbGwoYikgOiBhLmZpbGwoMCk7IHJldHVybiBhOyB9O1xuICAgIGQuYWxsb2NVbnNhZmUgPSBmdW5jdGlvbiAoYSkgeyBpZiAoXCJudW1iZXJcIiAhPT0gdHlwZW9mIGEpXG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJBcmd1bWVudCBtdXN0IGJlIGEgbnVtYmVyXCIpOyByZXR1cm4gZShhKTsgfTtcbiAgICBkLmFsbG9jVW5zYWZlU2xvdyA9IGZ1bmN0aW9uIChhKSB7IGlmIChcIm51bWJlclwiICE9PSB0eXBlb2YgYSlcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkFyZ3VtZW50IG11c3QgYmUgYSBudW1iZXJcIik7IHJldHVybiBSYS5TbG93QnVmZmVyKGEpOyB9O1xufSksIGdiID0gVGEoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICBmdW5jdGlvbiBjKCkge1xuICAgICAgICB0aHJvdyBFcnJvcihcInNlY3VyZSByYW5kb20gbnVtYmVyIGdlbmVyYXRpb24gbm90IHN1cHBvcnRlZCBieSB0aGlzIGJyb3dzZXJcXG51c2UgY2hyb21lLCBGaXJlRm94IG9yIEludGVybmV0IEV4cGxvcmVyIDExXCIpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBkKGEsIGIpIHsgaWYgKFwibnVtYmVyXCIgIT09IHR5cGVvZiBhIHx8IGEgIT09IGEpXG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJvZmZzZXQgbXVzdCBiZSBhIG51bWJlclwiKTsgaWYgKGEgPiBwIHx8IDAgPiBhKVxuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwib2Zmc2V0IG11c3QgYmUgYSB1aW50MzJcIik7IGlmIChhID4gbiB8fCBhID4gYilcbiAgICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoXCJvZmZzZXQgb3V0IG9mIHJhbmdlXCIpOyB9XG4gICAgZnVuY3Rpb24gZShhLCBiLCBjKSB7IGlmIChcIm51bWJlclwiICE9PSB0eXBlb2YgYSB8fCBhICE9PSBhKVxuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwic2l6ZSBtdXN0IGJlIGEgbnVtYmVyXCIpOyBpZiAoYSA+IHAgfHwgMCA+IGEpXG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJzaXplIG11c3QgYmUgYSB1aW50MzJcIik7IGlmIChhICsgYiA+IGMgfHwgYSA+IG4pXG4gICAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKFwiYnVmZmVyIHRvbyBzbWFsbFwiKTsgfVxuICAgIGZ1bmN0aW9uIGYoYSwgYiwgYywgZikge1xuICAgICAgICBpZiAoIShsLmlzQnVmZmVyKGEpIHx8IGEgaW5zdGFuY2VvZiBTYS5VaW50OEFycmF5KSlcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1wiYnVmXCIgYXJndW1lbnQgbXVzdCBiZSBhIEJ1ZmZlciBvciBVaW50OEFycmF5Jyk7XG4gICAgICAgIGlmIChcImZ1bmN0aW9uXCIgPT09IHR5cGVvZiBiKVxuICAgICAgICAgICAgZiA9IGIsIGIgPSAwLCBjID0gYS5sZW5ndGg7XG4gICAgICAgIGVsc2UgaWYgKFwiZnVuY3Rpb25cIiA9PT0gdHlwZW9mIGMpXG4gICAgICAgICAgICBmID0gYywgYyA9IGEubGVuZ3RoIC0gYjtcbiAgICAgICAgZWxzZSBpZiAoXCJmdW5jdGlvblwiICE9PSB0eXBlb2YgZilcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1wiY2JcIiBhcmd1bWVudCBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcbiAgICAgICAgZChiLCBhLmxlbmd0aCk7XG4gICAgICAgIGUoYywgYiwgYS5sZW5ndGgpO1xuICAgICAgICByZXR1cm4gZyhhLCBiLCBjLCBmKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gZyhhLCBiLCBjLCBkKSB7IGIgPSBuZXcgVWludDhBcnJheShhLmJ1ZmZlciwgYiwgYyk7IHIuZ2V0UmFuZG9tVmFsdWVzKGIpOyBpZiAoZClcbiAgICAgICAgYWIoZnVuY3Rpb24gKCkgeyBkKG51bGwsIGEpOyB9KTtcbiAgICBlbHNlXG4gICAgICAgIHJldHVybiBhOyB9XG4gICAgZnVuY3Rpb24gaChhLCBiLCBjKSB7XG4gICAgICAgIFwidW5kZWZpbmVkXCIgPT09IHR5cGVvZiBiICYmIChiID0gMCk7XG4gICAgICAgIGlmICghKGwuaXNCdWZmZXIoYSkgfHwgYSBpbnN0YW5jZW9mIFNhLlVpbnQ4QXJyYXkpKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignXCJidWZcIiBhcmd1bWVudCBtdXN0IGJlIGEgQnVmZmVyIG9yIFVpbnQ4QXJyYXknKTtcbiAgICAgICAgZChiLCBhLmxlbmd0aCk7XG4gICAgICAgIHZvaWQgMCA9PT0gYyAmJiAoYyA9IGEubGVuZ3RoIC0gYik7XG4gICAgICAgIGUoYywgYiwgYS5sZW5ndGgpO1xuICAgICAgICByZXR1cm4gZyhhLCBiLCBjKTtcbiAgICB9XG4gICAgdmFyIGwgPSBmYi5CdWZmZXIsIG4gPSBmYi5rTWF4TGVuZ3RoLCByID0gU2EuY3J5cHRvIHx8IFNhLm1zQ3J5cHRvLCBwID0gTWF0aC5wb3coMiwgMzIpIC0gMTtcbiAgICByICYmIHIuZ2V0UmFuZG9tVmFsdWVzID8gKGIucmFuZG9tRmlsbCA9IGYsIGIucmFuZG9tRmlsbFN5bmMgPSBoKSA6IChiLnJhbmRvbUZpbGwgPSBjLCBiLnJhbmRvbUZpbGxTeW5jID0gYyk7XG59KSwgaGIgPSBUYShmdW5jdGlvbiAoYSkgeyBhLmV4cG9ydHMgPSBnYjsgfSkucmFuZG9tRmlsbFN5bmMsIGliID0gTWF0aC5mbG9vciguMDAxICogKERhdGUubm93KCkgLSBwZXJmb3JtYW5jZS5ub3coKSkpO1xuZnVuY3Rpb24gTShhKSB7IGlmIChcInN0cmluZ1wiICE9PSB0eXBlb2YgYSlcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiUGF0aCBtdXN0IGJlIGEgc3RyaW5nLiBSZWNlaXZlZCBcIiArIEpTT04uc3RyaW5naWZ5KGEpKTsgfVxuZnVuY3Rpb24gamIoYSwgYikge1xuICAgIGZvciAodmFyIGMgPSBcIlwiLCBkID0gMCwgZSA9IC0xLCBmID0gMCwgZywgaCA9IDA7IGggPD0gYS5sZW5ndGg7ICsraCkge1xuICAgICAgICBpZiAoaCA8IGEubGVuZ3RoKVxuICAgICAgICAgICAgZyA9IGEuY2hhckNvZGVBdChoKTtcbiAgICAgICAgZWxzZSBpZiAoNDcgPT09IGcpXG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgZyA9IDQ3O1xuICAgICAgICBpZiAoNDcgPT09IGcpIHtcbiAgICAgICAgICAgIGlmIChlICE9PSBoIC0gMSAmJiAxICE9PSBmKVxuICAgICAgICAgICAgICAgIGlmIChlICE9PSBoIC0gMSAmJiAyID09PSBmKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgyID4gYy5sZW5ndGggfHwgMiAhPT0gZCB8fCA0NiAhPT0gYy5jaGFyQ29kZUF0KGMubGVuZ3RoIC0gMSkgfHwgNDYgIT09IGMuY2hhckNvZGVBdChjLmxlbmd0aCAtIDIpKVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKDIgPCBjLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlID0gYy5sYXN0SW5kZXhPZihcIi9cIiksIGUgIT09IGMubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtMSA9PT0gZSA/IChjID0gXCJcIiwgZCA9IDApIDogKGMgPSBjLnNsaWNlKDAsIGUpLCBkID0gYy5sZW5ndGggLSAxIC0gYy5sYXN0SW5kZXhPZihcIi9cIikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlID0gaDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZiA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKDIgPT09IGMubGVuZ3RoIHx8IDEgPT09IGMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYyA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZCA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZSA9IGg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZiA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGIgJiYgKGMgPSAwIDwgYy5sZW5ndGggPyBjICsgXCIvLi5cIiA6IFwiLi5cIiwgZCA9IDIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIGMgPVxuICAgICAgICAgICAgICAgICAgICAgICAgMCA8IGMubGVuZ3RoID8gYyArIChcIi9cIiArIGEuc2xpY2UoZSArIDEsIGgpKSA6IGEuc2xpY2UoZSArIDEsIGgpLCBkID0gaCAtIGUgLSAxO1xuICAgICAgICAgICAgZSA9IGg7XG4gICAgICAgICAgICBmID0gMDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgICAgICA0NiA9PT0gZyAmJiAtMSAhPT0gZiA/ICsrZiA6IGYgPSAtMTtcbiAgICB9XG4gICAgcmV0dXJuIGM7XG59XG52YXIga2IgPSB7IHJlc29sdmU6IGZ1bmN0aW9uICgpIHsgZm9yICh2YXIgYSA9IFwiXCIsIGIgPSAhMSwgYywgZCA9IGFyZ3VtZW50cy5sZW5ndGggLSAxOyAtMSA8PSBkICYmICFiOyBkLS0pIHtcbiAgICAgICAgaWYgKDAgPD0gZClcbiAgICAgICAgICAgIHZhciBlID0gYXJndW1lbnRzW2RdO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICB2b2lkIDAgPT09IGMgJiYgKGMgPSBlYi5jd2QoKSksIGUgPSBjO1xuICAgICAgICBNKGUpO1xuICAgICAgICAwICE9PSBlLmxlbmd0aCAmJiAoYSA9IGUgKyBcIi9cIiArIGEsIGIgPSA0NyA9PT0gZS5jaGFyQ29kZUF0KDApKTtcbiAgICB9IGEgPSBqYihhLCAhYik7IHJldHVybiBiID8gMCA8IGEubGVuZ3RoID8gXCIvXCIgKyBhIDogXCIvXCIgOiAwIDwgYS5sZW5ndGggPyBhIDogXCIuXCI7IH0sIG5vcm1hbGl6ZTogZnVuY3Rpb24gKGEpIHsgTShhKTsgaWYgKDAgPT09IGEubGVuZ3RoKVxuICAgICAgICByZXR1cm4gXCIuXCI7IHZhciBiID0gNDcgPT09IGEuY2hhckNvZGVBdCgwKSwgYyA9IDQ3ID09PSBhLmNoYXJDb2RlQXQoYS5sZW5ndGggLSAxKTsgYSA9IGpiKGEsICFiKTsgMCAhPT0gYS5sZW5ndGggfHwgYiB8fCAoYSA9IFwiLlwiKTsgMCA8IGEubGVuZ3RoICYmIGMgJiYgKGEgKz0gXCIvXCIpOyByZXR1cm4gYiA/IFwiL1wiICsgYSA6IGE7IH0sIGlzQWJzb2x1dGU6IGZ1bmN0aW9uIChhKSB7IE0oYSk7IHJldHVybiAwIDwgYS5sZW5ndGggJiYgNDcgPT09IGEuY2hhckNvZGVBdCgwKTsgfSxcbiAgICBqb2luOiBmdW5jdGlvbiAoKSB7IGlmICgwID09PSBhcmd1bWVudHMubGVuZ3RoKVxuICAgICAgICByZXR1cm4gXCIuXCI7IGZvciAodmFyIGEsIGIgPSAwOyBiIDwgYXJndW1lbnRzLmxlbmd0aDsgKytiKSB7XG4gICAgICAgIHZhciBjID0gYXJndW1lbnRzW2JdO1xuICAgICAgICBNKGMpO1xuICAgICAgICAwIDwgYy5sZW5ndGggJiYgKGEgPSB2b2lkIDAgPT09IGEgPyBjIDogYSArIChcIi9cIiArIGMpKTtcbiAgICB9IHJldHVybiB2b2lkIDAgPT09IGEgPyBcIi5cIiA6IGtiLm5vcm1hbGl6ZShhKTsgfSwgcmVsYXRpdmU6IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgIE0oYSk7XG4gICAgICAgIE0oYik7XG4gICAgICAgIGlmIChhID09PSBiKVxuICAgICAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgICAgIGEgPSBrYi5yZXNvbHZlKGEpO1xuICAgICAgICBiID0ga2IucmVzb2x2ZShiKTtcbiAgICAgICAgaWYgKGEgPT09IGIpXG4gICAgICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgICAgZm9yICh2YXIgYyA9IDE7IGMgPCBhLmxlbmd0aCAmJiA0NyA9PT0gYS5jaGFyQ29kZUF0KGMpOyArK2MpXG4gICAgICAgICAgICA7XG4gICAgICAgIGZvciAodmFyIGQgPSBhLmxlbmd0aCwgZSA9IGQgLSBjLCBmID0gMTsgZiA8IGIubGVuZ3RoICYmIDQ3ID09PSBiLmNoYXJDb2RlQXQoZik7ICsrZilcbiAgICAgICAgICAgIDtcbiAgICAgICAgZm9yICh2YXIgZyA9IGIubGVuZ3RoIC0gZiwgaCA9IGUgPCBnID8gZSA6IGcsIGwgPSAtMSwgbiA9IDA7IG4gPD0gaDsgKytuKSB7XG4gICAgICAgICAgICBpZiAobiA9PT0gaCkge1xuICAgICAgICAgICAgICAgIGlmIChnID4gaCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoNDcgPT09IGIuY2hhckNvZGVBdChmICsgbikpXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYi5zbGljZShmICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuICsgMSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICgwID09PSBuKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGIuc2xpY2UoZiArIG4pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIGUgPiBoICYmICg0NyA9PT0gYS5jaGFyQ29kZUF0KGMgKyBuKSA/IGwgPSBuIDogMCA9PT0gbiAmJiAobCA9IDApKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciByID0gYS5jaGFyQ29kZUF0KGMgKyBuKSwgcCA9IGIuY2hhckNvZGVBdChmICsgbik7XG4gICAgICAgICAgICBpZiAociAhPT0gcClcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICA0NyA9PT0gciAmJiAobCA9IG4pO1xuICAgICAgICB9XG4gICAgICAgIGUgPSBcIlwiO1xuICAgICAgICBmb3IgKG4gPSBjICsgbCArIDE7IG4gPD0gZDsgKytuKVxuICAgICAgICAgICAgaWYgKG4gPT09IGQgfHwgNDcgPT09IGEuY2hhckNvZGVBdChuKSlcbiAgICAgICAgICAgICAgICBlID0gMCA9PT0gZS5sZW5ndGggPyBlICsgXCIuLlwiIDogZSArIFwiLy4uXCI7XG4gICAgICAgIGlmICgwIDwgZS5sZW5ndGgpXG4gICAgICAgICAgICByZXR1cm4gZSArIGIuc2xpY2UoZiArIGwpO1xuICAgICAgICBmICs9IGw7XG4gICAgICAgIDQ3ID09PSBiLmNoYXJDb2RlQXQoZikgJiYgKytmO1xuICAgICAgICByZXR1cm4gYi5zbGljZShmKTtcbiAgICB9LCBfbWFrZUxvbmc6IGZ1bmN0aW9uIChhKSB7IHJldHVybiBhOyB9LCBkaXJuYW1lOiBmdW5jdGlvbiAoYSkge1xuICAgICAgICBNKGEpO1xuICAgICAgICBpZiAoMCA9PT0gYS5sZW5ndGgpXG4gICAgICAgICAgICByZXR1cm4gXCIuXCI7XG4gICAgICAgIGZvciAodmFyIGIgPSBhLmNoYXJDb2RlQXQoMCksIGMgPSA0NyA9PT0gYiwgZCA9IC0xLCBlID0gITAsIGYgPSBhLmxlbmd0aCAtIDE7IDEgPD0gZjsgLS1mKVxuICAgICAgICAgICAgaWYgKGIgPSBhLmNoYXJDb2RlQXQoZiksXG4gICAgICAgICAgICAgICAgNDcgPT09IGIpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWUpIHtcbiAgICAgICAgICAgICAgICAgICAgZCA9IGY7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBlID0gITE7XG4gICAgICAgIHJldHVybiAtMSA9PT0gZCA/IGMgPyBcIi9cIiA6IFwiLlwiIDogYyAmJiAxID09PSBkID8gXCIvL1wiIDogYS5zbGljZSgwLCBkKTtcbiAgICB9LCBiYXNlbmFtZTogZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgaWYgKHZvaWQgMCAhPT0gYiAmJiBcInN0cmluZ1wiICE9PSB0eXBlb2YgYilcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1wiZXh0XCIgYXJndW1lbnQgbXVzdCBiZSBhIHN0cmluZycpO1xuICAgICAgICBNKGEpO1xuICAgICAgICB2YXIgYyA9IDAsIGQgPSAtMSwgZSA9ICEwLCBmO1xuICAgICAgICBpZiAodm9pZCAwICE9PSBiICYmIDAgPCBiLmxlbmd0aCAmJiBiLmxlbmd0aCA8PSBhLmxlbmd0aCkge1xuICAgICAgICAgICAgaWYgKGIubGVuZ3RoID09PSBhLmxlbmd0aCAmJiBiID09PSBhKVxuICAgICAgICAgICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgICAgICAgdmFyIGcgPSBiLmxlbmd0aCAtIDEsIGggPSAtMTtcbiAgICAgICAgICAgIGZvciAoZiA9IGEubGVuZ3RoIC0gMTsgMCA8PSBmOyAtLWYpIHtcbiAgICAgICAgICAgICAgICB2YXIgbCA9IGEuY2hhckNvZGVBdChmKTtcbiAgICAgICAgICAgICAgICBpZiAoNDcgPT09IGwpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjID0gZiArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIC0xID09PSBoICYmIChlID0gITEsIGggPSBmICsgMSksIDAgPD0gZyAmJiAobCA9PT0gYi5jaGFyQ29kZUF0KGcpID8gLTEgPT09IC0tZyAmJiAoZCA9IGYpIDogKGcgPSAtMSwgZCA9IGgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGMgPT09IGQgPyBkID1cbiAgICAgICAgICAgICAgICBoIDogLTEgPT09IGQgJiYgKGQgPSBhLmxlbmd0aCk7XG4gICAgICAgICAgICByZXR1cm4gYS5zbGljZShjLCBkKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGYgPSBhLmxlbmd0aCAtIDE7IDAgPD0gZjsgLS1mKVxuICAgICAgICAgICAgaWYgKDQ3ID09PSBhLmNoYXJDb2RlQXQoZikpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWUpIHtcbiAgICAgICAgICAgICAgICAgICAgYyA9IGYgKyAxO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgLTEgPT09IGQgJiYgKGUgPSAhMSwgZCA9IGYgKyAxKTtcbiAgICAgICAgcmV0dXJuIC0xID09PSBkID8gXCJcIiA6IGEuc2xpY2UoYywgZCk7XG4gICAgfSwgZXh0bmFtZTogZnVuY3Rpb24gKGEpIHsgTShhKTsgZm9yICh2YXIgYiA9IC0xLCBjID0gMCwgZCA9IC0xLCBlID0gITAsIGYgPSAwLCBnID0gYS5sZW5ndGggLSAxOyAwIDw9IGc7IC0tZykge1xuICAgICAgICB2YXIgaCA9IGEuY2hhckNvZGVBdChnKTtcbiAgICAgICAgaWYgKDQ3ID09PSBoKSB7XG4gICAgICAgICAgICBpZiAoIWUpIHtcbiAgICAgICAgICAgICAgICBjID0gZyArIDE7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgLTEgPT09IGQgJiYgKGUgPSAhMSwgZCA9IGcgKyAxKSwgNDYgPT09IGggPyAtMSA9PT0gYiA/IGIgPSBnIDogMSAhPT0gZiAmJiAoZiA9IDEpIDogLTEgIT09IGIgJiYgKGYgPSAtMSk7XG4gICAgfSByZXR1cm4gLTEgPT09IGIgfHwgLTEgPT09IGQgfHwgMCA9PT0gZiB8fCAxID09PSBmICYmIGIgPT09IGQgLSAxICYmIGIgPT09IGMgKyAxID8gXCJcIiA6IGEuc2xpY2UoYiwgZCk7IH0sIGZvcm1hdDogZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgaWYgKG51bGwgPT09IGEgfHwgXCJvYmplY3RcIiAhPT0gdHlwZW9mIGEpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdUaGUgXCJwYXRoT2JqZWN0XCIgYXJndW1lbnQgbXVzdCBiZSBvZiB0eXBlIE9iamVjdC4gUmVjZWl2ZWQgdHlwZSAnICtcbiAgICAgICAgICAgICAgICB0eXBlb2YgYSk7XG4gICAgICAgIHZhciBiID0gYS5kaXIgfHwgYS5yb290LCBjID0gYS5iYXNlIHx8IChhLm5hbWUgfHwgXCJcIikgKyAoYS5leHQgfHwgXCJcIik7XG4gICAgICAgIGEgPSBiID8gYiA9PT0gYS5yb290ID8gYiArIGMgOiBiICsgXCIvXCIgKyBjIDogYztcbiAgICAgICAgcmV0dXJuIGE7XG4gICAgfSwgcGFyc2U6IGZ1bmN0aW9uIChhKSB7XG4gICAgICAgIE0oYSk7XG4gICAgICAgIHZhciBiID0geyByb290OiBcIlwiLCBkaXI6IFwiXCIsIGJhc2U6IFwiXCIsIGV4dDogXCJcIiwgbmFtZTogXCJcIiB9O1xuICAgICAgICBpZiAoMCA9PT0gYS5sZW5ndGgpXG4gICAgICAgICAgICByZXR1cm4gYjtcbiAgICAgICAgdmFyIGMgPSBhLmNoYXJDb2RlQXQoMCksIGQgPSA0NyA9PT0gYztcbiAgICAgICAgaWYgKGQpIHtcbiAgICAgICAgICAgIGIucm9vdCA9IFwiL1wiO1xuICAgICAgICAgICAgdmFyIGUgPSAxO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIGUgPSAwO1xuICAgICAgICBmb3IgKHZhciBmID0gLTEsIGcgPSAwLCBoID0gLTEsIGwgPSAhMCwgbiA9IGEubGVuZ3RoIC0gMSwgciA9IDA7IG4gPj0gZTsgLS1uKVxuICAgICAgICAgICAgaWYgKGMgPSBhLmNoYXJDb2RlQXQobiksIDQ3ID09PSBjKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFsKSB7XG4gICAgICAgICAgICAgICAgICAgIGcgPSBuICsgMTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIC0xID09PSBoICYmIChsID0gITEsIGggPSBuICsgMSksIDQ2ID09PSBjID8gLTEgPT09IGYgPyBmID0gbiA6IDEgIT09IHIgJiYgKHIgPSAxKSA6IC0xICE9PSBmICYmIChyID0gLTEpO1xuICAgICAgICAtMSA9PT0gZiB8fCAtMSA9PT0gaCB8fCAwID09PSByIHx8IDEgPT09IHIgJiYgZiA9PT0gaCAtIDEgJiYgZiA9PT0gZyArIDEgPyAtMSAhPT0gaCAmJiAoYi5iYXNlID0gMCA9PT1cbiAgICAgICAgICAgIGcgJiYgZCA/IGIubmFtZSA9IGEuc2xpY2UoMSwgaCkgOiBiLm5hbWUgPSBhLnNsaWNlKGcsIGgpKSA6ICgwID09PSBnICYmIGQgPyAoYi5uYW1lID0gYS5zbGljZSgxLCBmKSwgYi5iYXNlID0gYS5zbGljZSgxLCBoKSkgOiAoYi5uYW1lID0gYS5zbGljZShnLCBmKSwgYi5iYXNlID0gYS5zbGljZShnLCBoKSksIGIuZXh0ID0gYS5zbGljZShmLCBoKSk7XG4gICAgICAgIDAgPCBnID8gYi5kaXIgPSBhLnNsaWNlKDAsIGcgLSAxKSA6IGQgJiYgKGIuZGlyID0gXCIvXCIpO1xuICAgICAgICByZXR1cm4gYjtcbiAgICB9LCBzZXA6IFwiL1wiLCBkZWxpbWl0ZXI6IFwiOlwiLCB3aW4zMjogbnVsbCwgcG9zaXg6IG51bGwgfSwgbGIgPSBrYi5wb3NpeCA9IGtiLCBtYiA9IE9iamVjdC5mcmVlemUoeyBfX3Byb3RvX186IG51bGwsIFwiZGVmYXVsdFwiOiBsYiwgX19tb2R1bGVFeHBvcnRzOiBsYiB9KSwgcGIgPSB7IGhydGltZTogZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGZ1bmN0aW9uIChiKSB7IGIgPSBhKGIpOyByZXR1cm4gMUU5ICogYlswXSArIGJbMV07IH07IH0oZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgdmFyIGIgPSAuMDAxICogcGVyZm9ybWFuY2Uubm93KCksIGMgPSBNYXRoLmZsb29yKGIpICsgaWI7XG4gICAgICAgIGIgPSBNYXRoLmZsb29yKGIgJSAxICogMUU5KTtcbiAgICAgICAgYSAmJiAoYyAtPSBhWzBdLFxuICAgICAgICAgICAgYiAtPSBhWzFdLCAwID4gYiAmJiAoYy0tLCBiICs9IDFFOSkpO1xuICAgICAgICByZXR1cm4gW2MsIGJdO1xuICAgIH0pLCBleGl0OiBmdW5jdGlvbiAoYSkgeyB0aHJvdyBuZXcgbmIoYSk7IH0sIGtpbGw6IGZ1bmN0aW9uIChhKSB7IHRocm93IG5ldyBvYihhKTsgfSwgcmFuZG9tRmlsbFN5bmM6IGhiLCBpc1RUWTogZnVuY3Rpb24gKCkgeyByZXR1cm4gITA7IH0sIHBhdGg6IG1iLCBmczogbnVsbCB9LCBOLCBPID0gaygxKSwgUCA9IGsoMiksIFEgPSBrKDQpLCBSID0gayg4KSwgUyA9IGsoMTYpLCBxYiA9IGsoMzIpLCBUID0gayg2NCksIFYgPSBrKDEyOCksIHNiID0gaygyNTYpLCB0YiA9IGsoNTEyKSwgdWIgPSBrKDEwMjQpLCB2YiA9IGsoMjA0OCksIHdiID0gayg0MDk2KSwgeGIgPSBrKDgxOTIpLCB5YiA9IGsoMTYzODQpLCB6YiA9IGsoMzI3NjgpLCBBYiA9IGsoNjU1MzYpLCBCYiA9IGsoMTMxMDcyKSwgQ2IgPSBrKDI2MjE0NCksIERiID0gayg1MjQyODgpLCBFYiA9IGsoMTA0ODU3NiksIFcgPSBrKDIwOTcxNTIpLCBJYiA9IGsoNDE5NDMwNCksIEpiID0gayg4Mzg4NjA4KSwgS2IgPSBrKDE2Nzc3MjE2KSwgTGIgPSBrKDMzNTU0NDMyKSwgTWIgPSBrKDY3MTA4ODY0KSwgWCA9IGsoMTM0MjE3NzI4KSwgTmIgPSBrKDI2ODQzNTQ1NiksIE9iID0gTyB8IFAgfCBRIHwgUiB8IFMgfCBxYiB8IFQgfCBWIHwgc2IgfCB0YiB8IHViIHwgdmIgfCB3YiB8IHhiIHwgeWIgfCB6YiB8IEFiIHwgQmIgfCBDYiB8IERiIHwgRWIgfCBXIHwgSmIgfCBJYiB8IEtiIHwgTWIgfCBMYiB8IFggfCBOYiwgUGIgPSBPIHwgUCB8IFEgfCBSIHwgUyB8IHFiIHwgVCB8IFYgfCBzYiB8IFcgfCBJYiB8IEpiIHwgWCwgUWIgPSBrKDApLCBSYiA9IFIgfCBTIHwgViB8IHRiIHwgdWIgfCB2YiB8IHdiIHwgeGIgfCB5YiB8IHpiIHwgQWIgfCBCYiB8IENiIHwgRGIgfCBFYiB8IFcgfCBKYiB8IEtiIHwgTWIgfCBMYiB8IFgsIFNiID0gUmIgfCBQYiwgVGIgPSBQIHwgUiB8IFQgfCBXIHwgWCB8IE5iLCBVYiA9IFAgfCBSIHwgVCB8IFcgfCBYLCBWYiA9IGsoMCksIFdiID0geyBFMkJJRzogMSwgRUFDQ0VTOiAyLCBFQUREUklOVVNFOiAzLCBFQUREUk5PVEFWQUlMOiA0LCBFQUZOT1NVUFBPUlQ6IDUsIEVBTFJFQURZOiA3LCBFQUdBSU46IDYsIEVCQURGOiA4LCBFQkFETVNHOiA5LCBFQlVTWTogMTAsIEVDQU5DRUxFRDogMTEsIEVDSElMRDogMTIsIEVDT05OQUJPUlRFRDogMTMsIEVDT05OUkVGVVNFRDogMTQsIEVDT05OUkVTRVQ6IDE1LCBFREVBRExPQ0s6IDE2LCBFREVTVEFERFJSRVE6IDE3LCBFRE9NOiAxOCwgRURRVU9UOiAxOSwgRUVYSVNUOiAyMCwgRUZBVUxUOiAyMSwgRUZCSUc6IDIyLCBFSE9TVERPV046IDIzLCBFSE9TVFVOUkVBQ0g6IDIzLFxuICAgIEVJRFJNOiAyNCwgRUlMU0VROiAyNSwgRUlOUFJPR1JFU1M6IDI2LCBFSU5UUjogMjcsIEVJTlZBTDogMjgsIEVJTzogMjksIEVJU0NPTk46IDMwLCBFSVNESVI6IDMxLCBFTE9PUDogMzIsIEVNRklMRTogMzMsIEVNTElOSzogMzQsIEVNU0dTSVpFOiAzNSwgRU1VTFRJSE9QOiAzNiwgRU5BTUVUT09MT05HOiAzNywgRU5FVERPV046IDM4LCBFTkVUUkVTRVQ6IDM5LCBFTkVUVU5SRUFDSDogNDAsIEVORklMRTogNDEsIEVOT0JVRlM6IDQyLCBFTk9ERVY6IDQzLCBFTk9FTlQ6IDQ0LCBFTk9FWEVDOiA0NSwgRU5PTENLOiA0NiwgRU5PTElOSzogNDcsIEVOT01FTTogNDgsIEVOT01TRzogNDksIEVOT1BST1RPT1BUOiA1MCwgRU5PU1BDOiA1MSwgRU5PU1lTOiA1MiwgRU5PVENPTk46IDUzLCBFTk9URElSOiA1NCwgRU5PVEVNUFRZOiA1NSwgRU5PVFJFQ09WRVJBQkxFOiA1NiwgRU5PVFNPQ0s6IDU3LCBFTk9UVFk6IDU5LCBFTlhJTzogNjAsIEVPVkVSRkxPVzogNjEsIEVPV05FUkRFQUQ6IDYyLCBFUEVSTTogNjMsIEVQSVBFOiA2NCwgRVBST1RPOiA2NSwgRVBST1RPTk9TVVBQT1JUOiA2NiwgRVBST1RPVFlQRTogNjcsIEVSQU5HRTogNjgsXG4gICAgRVJPRlM6IDY5LCBFU1BJUEU6IDcwLCBFU1JDSDogNzEsIEVTVEFMRTogNzIsIEVUSU1FRE9VVDogNzMsIEVUWFRCU1k6IDc0LCBFWERFVjogNzUgfSwgWGIgPSAoTiA9IHt9LCBOWzZdID0gXCJTSUdIVVBcIiwgTls4XSA9IFwiU0lHSU5UXCIsIE5bMTFdID0gXCJTSUdRVUlUXCIsIE5bN10gPSBcIlNJR0lMTFwiLCBOWzE1XSA9IFwiU0lHVFJBUFwiLCBOWzBdID0gXCJTSUdBQlJUXCIsIE5bMl0gPSBcIlNJR0JVU1wiLCBOWzVdID0gXCJTSUdGUEVcIiwgTls5XSA9IFwiU0lHS0lMTFwiLCBOWzIwXSA9IFwiU0lHVVNSMVwiLCBOWzEyXSA9IFwiU0lHU0VHVlwiLCBOWzIxXSA9IFwiU0lHVVNSMlwiLCBOWzEwXSA9IFwiU0lHUElQRVwiLCBOWzFdID0gXCJTSUdBTFJNXCIsIE5bMTRdID0gXCJTSUdURVJNXCIsIE5bM10gPSBcIlNJR0NITERcIiwgTls0XSA9IFwiU0lHQ09OVFwiLCBOWzEzXSA9IFwiU0lHU1RPUFwiLCBOWzE2XSA9IFwiU0lHVFNUUFwiLCBOWzE3XSA9IFwiU0lHVFRJTlwiLCBOWzE4XSA9IFwiU0lHVFRPVVwiLCBOWzE5XSA9IFwiU0lHVVJHXCIsIE5bMjNdID0gXCJTSUdYQ1BVXCIsIE5bMjRdID0gXCJTSUdYRlNaXCIsIE5bMjJdID0gXCJTSUdWVEFMUk1cIiwgTiksIFliID0gTyB8IFAgfCBTIHwgViB8IFcgfCBYLCBaYiA9IE8gfCBUIHwgUyB8IFYgfCBXIHwgWDtcbmZ1bmN0aW9uIFkoYSkgeyB2YXIgYiA9IE1hdGgudHJ1bmMoYSk7IGEgPSBrKE1hdGgucm91bmQoMUU2ICogKGEgLSBiKSkpOyByZXR1cm4gayhiKSAqIGsoMUU2KSArIGE7IH1cbmZ1bmN0aW9uICRiKGEpIHsgXCJudW1iZXJcIiA9PT0gdHlwZW9mIGEgJiYgKGEgPSBNYXRoLnRydW5jKGEpKTsgYSA9IGsoYSk7IHJldHVybiBOdW1iZXIoYSAvIGsoMUU2KSk7IH1cbmZ1bmN0aW9uIFooYSkgeyByZXR1cm4gZnVuY3Rpb24gKCkgeyBmb3IgKHZhciBiID0gW10sIGMgPSAwOyBjIDwgYXJndW1lbnRzLmxlbmd0aDsgYysrKVxuICAgIGJbY10gPSBhcmd1bWVudHNbY107IHRyeSB7XG4gICAgcmV0dXJuIGEuYXBwbHkodm9pZCAwLCBmYShiKSk7XG59XG5jYXRjaCAoZCkge1xuICAgIGlmIChkICYmIGQuY29kZSAmJiBcInN0cmluZ1wiID09PSB0eXBlb2YgZC5jb2RlKVxuICAgICAgICByZXR1cm4gV2JbZC5jb2RlXSB8fCAyODtcbiAgICBpZiAoZCBpbnN0YW5jZW9mIGFjKVxuICAgICAgICByZXR1cm4gZC5lcnJubztcbiAgICB0aHJvdyBkO1xufSB9OyB9XG5mdW5jdGlvbiBiYyhhLCBiKSB7IHZhciBjID0gYS5GRF9NQVAuZ2V0KGIpOyBpZiAoIWMpXG4gICAgdGhyb3cgbmV3IGFjKDgpOyBpZiAodm9pZCAwID09PSBjLmZpbGV0eXBlKSB7XG4gICAgdmFyIGQgPSBhLmJpbmRpbmdzLmZzLmZzdGF0U3luYyhjLnJlYWwpO1xuICAgIGEgPSBjYyhhLCBiLCBkKTtcbiAgICBiID0gYS5yaWdodHNCYXNlO1xuICAgIGQgPSBhLnJpZ2h0c0luaGVyaXRpbmc7XG4gICAgYy5maWxldHlwZSA9IGEuZmlsZXR5cGU7XG4gICAgYy5yaWdodHMgfHwgKGMucmlnaHRzID0geyBiYXNlOiBiLCBpbmhlcml0aW5nOiBkIH0pO1xufSByZXR1cm4gYzsgfVxuZnVuY3Rpb24gY2MoYSwgYiwgYykge1xuICAgIHN3aXRjaCAoITApIHtcbiAgICAgICAgY2FzZSBjLmlzQmxvY2tEZXZpY2UoKTogcmV0dXJuIHsgZmlsZXR5cGU6IDEsIHJpZ2h0c0Jhc2U6IE9iLCByaWdodHNJbmhlcml0aW5nOiBPYiB9O1xuICAgICAgICBjYXNlIGMuaXNDaGFyYWN0ZXJEZXZpY2UoKTogcmV0dXJuIHZvaWQgMCAhPT0gYiAmJiBhLmJpbmRpbmdzLmlzVFRZKGIpID8geyBmaWxldHlwZTogMiwgcmlnaHRzQmFzZTogVWIsIHJpZ2h0c0luaGVyaXRpbmc6IFZiIH0gOiB7IGZpbGV0eXBlOiAyLCByaWdodHNCYXNlOiBPYiwgcmlnaHRzSW5oZXJpdGluZzogT2IgfTtcbiAgICAgICAgY2FzZSBjLmlzRGlyZWN0b3J5KCk6IHJldHVybiB7IGZpbGV0eXBlOiAzLCByaWdodHNCYXNlOiBSYiwgcmlnaHRzSW5oZXJpdGluZzogU2IgfTtcbiAgICAgICAgY2FzZSBjLmlzRklGTygpOiByZXR1cm4geyBmaWxldHlwZTogNiwgcmlnaHRzQmFzZTogVGIsIHJpZ2h0c0luaGVyaXRpbmc6IE9iIH07XG4gICAgICAgIGNhc2UgYy5pc0ZpbGUoKTogcmV0dXJuIHsgZmlsZXR5cGU6IDQsIHJpZ2h0c0Jhc2U6IFBiLCByaWdodHNJbmhlcml0aW5nOiBRYiB9O1xuICAgICAgICBjYXNlIGMuaXNTb2NrZXQoKTogcmV0dXJuIHsgZmlsZXR5cGU6IDYsXG4gICAgICAgICAgICByaWdodHNCYXNlOiBUYiwgcmlnaHRzSW5oZXJpdGluZzogT2IgfTtcbiAgICAgICAgY2FzZSBjLmlzU3ltYm9saWNMaW5rKCk6IHJldHVybiB7IGZpbGV0eXBlOiA3LCByaWdodHNCYXNlOiBrKDApLCByaWdodHNJbmhlcml0aW5nOiBrKDApIH07XG4gICAgICAgIGRlZmF1bHQ6IHJldHVybiB7IGZpbGV0eXBlOiAwLCByaWdodHNCYXNlOiBrKDApLCByaWdodHNJbmhlcml0aW5nOiBrKDApIH07XG4gICAgfVxufVxudmFyIGFjID0gZnVuY3Rpb24gKGEpIHsgZnVuY3Rpb24gYihjKSB7IHZhciBkID0gYS5jYWxsKHRoaXMpIHx8IHRoaXM7IGQuZXJybm8gPSBjOyBPYmplY3Quc2V0UHJvdG90eXBlT2YoZCwgYi5wcm90b3R5cGUpOyByZXR1cm4gZDsgfSBiYShiLCBhKTsgcmV0dXJuIGI7IH0oRXJyb3IpLCBuYiA9IGZ1bmN0aW9uIChhKSB7IGZ1bmN0aW9uIGIoYykgeyB2YXIgZCA9IGEuY2FsbCh0aGlzLCBcIldBU0kgRXhpdCBlcnJvcjogXCIgKyBjKSB8fCB0aGlzOyBkLmNvZGUgPSBjOyBPYmplY3Quc2V0UHJvdG90eXBlT2YoZCwgYi5wcm90b3R5cGUpOyByZXR1cm4gZDsgfSBiYShiLCBhKTsgcmV0dXJuIGI7IH0oRXJyb3IpLCBvYiA9IGZ1bmN0aW9uIChhKSB7IGZ1bmN0aW9uIGIoYykgeyB2YXIgZCA9IGEuY2FsbCh0aGlzLCBcIldBU0kgS2lsbCBzaWduYWw6IFwiICsgYykgfHwgdGhpczsgZC5zaWduYWwgPSBjOyBPYmplY3Quc2V0UHJvdG90eXBlT2YoZCwgYi5wcm90b3R5cGUpOyByZXR1cm4gZDsgfSBiYShiLCBhKTsgcmV0dXJuIGI7IH0oRXJyb3IpLCBkYyA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBhKGEpIHtcbiAgICAgICAgZnVuY3Rpb24gYihhKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKGEpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDE6IHJldHVybiByLmhydGltZSgpO1xuICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFkoRGF0ZS5ub3coKSk7XG4gICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIHIuaHJ0aW1lKCkgLSBlYztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OiByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBkKGEsIGIpIHsgYSA9IGJjKGcsIGEpOyBpZiAoYiAhPT0gaygwKSAmJiAoYS5yaWdodHMuYmFzZSAmIGIpID09PSBrKDApKVxuICAgICAgICAgICAgdGhyb3cgbmV3IGFjKDYzKTsgcmV0dXJuIGE7IH1cbiAgICAgICAgZnVuY3Rpb24gZShhLCBiKSB7IGcucmVmcmVzaE1lbW9yeSgpOyByZXR1cm4gQXJyYXkuZnJvbSh7IGxlbmd0aDogYiB9LCBmdW5jdGlvbiAoYiwgYykgeyBjID0gYSArIDggKiBjOyBiID0gZy52aWV3LmdldFVpbnQzMihjLCAhMCk7IGMgPSBnLnZpZXcuZ2V0VWludDMyKGMgKyA0LCAhMCk7IHJldHVybiBuZXcgVWludDhBcnJheShnLm1lbW9yeS5idWZmZXIsIGIsIGMpOyB9KTsgfVxuICAgICAgICB2YXIgZiwgZyA9IHRoaXMsIGggPSB7fTtcbiAgICAgICAgYSAmJiBhLnByZW9wZW5zID8gaCA9IGEucHJlb3BlbnMgOiBhICYmIGEucHJlb3BlbkRpcmVjdG9yaWVzICYmIChoID0gYS5wcmVvcGVuRGlyZWN0b3JpZXMpO1xuICAgICAgICB2YXIgbCA9IHt9O1xuICAgICAgICBhICYmIGEuZW52ICYmIChsID0gYS5lbnYpO1xuICAgICAgICB2YXIgbiA9IFtdO1xuICAgICAgICBhICYmIGEuYXJncyAmJiAobiA9XG4gICAgICAgICAgICBhLmFyZ3MpO1xuICAgICAgICB2YXIgciA9IHBiO1xuICAgICAgICBhICYmIGEuYmluZGluZ3MgJiYgKHIgPSBhLmJpbmRpbmdzKTtcbiAgICAgICAgdGhpcy52aWV3ID0gdGhpcy5tZW1vcnkgPSB2b2lkIDA7XG4gICAgICAgIHRoaXMuYmluZGluZ3MgPSByO1xuICAgICAgICB0aGlzLkZEX01BUCA9IG5ldyBNYXAoW1swLCB7IHJlYWw6IDAsIGZpbGV0eXBlOiAyLCByaWdodHM6IHsgYmFzZTogWWIsIGluaGVyaXRpbmc6IGsoMCkgfSwgcGF0aDogdm9pZCAwIH1dLCBbMSwgeyByZWFsOiAxLCBmaWxldHlwZTogMiwgcmlnaHRzOiB7IGJhc2U6IFpiLCBpbmhlcml0aW5nOiBrKDApIH0sIHBhdGg6IHZvaWQgMCB9XSwgWzIsIHsgcmVhbDogMiwgZmlsZXR5cGU6IDIsIHJpZ2h0czogeyBiYXNlOiBaYiwgaW5oZXJpdGluZzogaygwKSB9LCBwYXRoOiB2b2lkIDAgfV1dKTtcbiAgICAgICAgdmFyIHAgPSB0aGlzLmJpbmRpbmdzLmZzLCB5ID0gdGhpcy5iaW5kaW5ncy5wYXRoO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgZm9yICh2YXIgdWEgPSBjYShPYmplY3QuZW50cmllcyhoKSksIGVhID0gdWEubmV4dCgpOyAhZWEuZG9uZTsgZWEgPSB1YS5uZXh0KCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmIgPSBkYShlYS52YWx1ZSwgMiksIGZjID0gcmJbMF0sIEZiID0gcmJbMV0sIGdjID0gcC5vcGVuU3luYyhGYiwgcC5jb25zdGFudHMuT19SRE9OTFkpLCBoYyA9IGZhKHRoaXMuRkRfTUFQLmtleXMoKSkucmV2ZXJzZSgpWzBdICsgMTtcbiAgICAgICAgICAgICAgICB0aGlzLkZEX01BUC5zZXQoaGMsIHsgcmVhbDogZ2MsIGZpbGV0eXBlOiAzLCByaWdodHM6IHsgYmFzZTogUmIsIGluaGVyaXRpbmc6IFNiIH0sIGZha2VQYXRoOiBmYywgcGF0aDogRmIgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgIHZhciBHYiA9IHsgZXJyb3I6IHQgfTtcbiAgICAgICAgfVxuICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgZWEgJiYgIWVhLmRvbmUgJiYgKGYgPSB1YS5yZXR1cm4pICYmIGYuY2FsbCh1YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICBpZiAoR2IpXG4gICAgICAgICAgICAgICAgICAgIHRocm93IEdiLmVycm9yO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBlYyA9IHIuaHJ0aW1lKCk7XG4gICAgICAgIHRoaXMud2FzaUltcG9ydCA9IHsgYXJnc19nZXQ6IGZ1bmN0aW9uIChhLCBiKSB7IGcucmVmcmVzaE1lbW9yeSgpOyB2YXIgYyA9IGEsIGQgPSBiOyBuLmZvckVhY2goZnVuY3Rpb24gKGEpIHsgZy52aWV3LnNldFVpbnQzMihjLCBkLCAhMCk7IGMgKz0gNDsgZCArPSBFLmZyb20oZy5tZW1vcnkuYnVmZmVyKS53cml0ZShhICsgXCJcXHgwMFwiLCBkKTsgfSk7IHJldHVybiAwOyB9LCBhcmdzX3NpemVzX2dldDogZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgICAgICAgICBnLnJlZnJlc2hNZW1vcnkoKTtcbiAgICAgICAgICAgICAgICBnLnZpZXcuc2V0VWludDMyKGEsIG4ubGVuZ3RoLCAhMCk7XG4gICAgICAgICAgICAgICAgYSA9IG4ucmVkdWNlKGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBhICsgRS5ieXRlTGVuZ3RoKGIpICsgMTsgfSwgMCk7XG4gICAgICAgICAgICAgICAgZy52aWV3LnNldFVpbnQzMihiLCBhLCAhMCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICB9LCBlbnZpcm9uX2dldDogZnVuY3Rpb24gKGEsIGIpIHsgZy5yZWZyZXNoTWVtb3J5KCk7IHZhciBjID0gYSwgZCA9IGI7IE9iamVjdC5lbnRyaWVzKGwpLmZvckVhY2goZnVuY3Rpb24gKGEpIHsgdmFyIGIgPSBkYShhLCAyKTsgYSA9IGJbMF07IGIgPSBiWzFdOyBnLnZpZXcuc2V0VWludDMyKGMsIGQsICEwKTsgYyArPSA0OyBkICs9IEUuZnJvbShnLm1lbW9yeS5idWZmZXIpLndyaXRlKGEgKyBcIj1cIiArIGIgKyBcIlxceDAwXCIsIGQpOyB9KTsgcmV0dXJuIDA7IH0sIGVudmlyb25fc2l6ZXNfZ2V0OiBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICAgICAgICAgIGcucmVmcmVzaE1lbW9yeSgpO1xuICAgICAgICAgICAgICAgIHZhciBjID0gT2JqZWN0LmVudHJpZXMobCkubWFwKGZ1bmN0aW9uIChhKSB7IGEgPSBkYShhLCAyKTsgcmV0dXJuIGFbMF0gKyBcIj1cIiArIGFbMV0gKyBcIlxceDAwXCI7IH0pLCBkID0gYy5yZWR1Y2UoZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGEgKyBFLmJ5dGVMZW5ndGgoYik7IH0sIDApO1xuICAgICAgICAgICAgICAgIGcudmlldy5zZXRVaW50MzIoYSwgYy5sZW5ndGgsICEwKTtcbiAgICAgICAgICAgICAgICBnLnZpZXcuc2V0VWludDMyKGIsIGQsICEwKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIH0sIGNsb2NrX3Jlc19nZXQ6IGZ1bmN0aW9uIChhLCBiKSB7IHN3aXRjaCAoYSkge1xuICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICB2YXIgYyA9IGsoMSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMDogYyA9IGsoMUUzKTtcbiAgICAgICAgICAgIH0gZy52aWV3LnNldEJpZ1VpbnQ2NChiLCBjKTsgcmV0dXJuIDA7IH0sIGNsb2NrX3RpbWVfZ2V0OiBmdW5jdGlvbiAoYSwgYywgZCkgeyBnLnJlZnJlc2hNZW1vcnkoKTsgYSA9IGIoYSk7IGlmIChudWxsID09PSBhKVxuICAgICAgICAgICAgICAgIHJldHVybiAyODsgZy52aWV3LnNldEJpZ1VpbnQ2NChkLCBrKGEpLCAhMCk7IHJldHVybiAwOyB9LCBmZF9hZHZpc2U6IFooZnVuY3Rpb24gKGEpIHsgZChhLCBWKTsgcmV0dXJuIDUyOyB9KSwgZmRfYWxsb2NhdGU6IFooZnVuY3Rpb24gKGEpIHsgZChhLCBzYik7IHJldHVybiA1MjsgfSksIGZkX2Nsb3NlOiBaKGZ1bmN0aW9uIChhKSB7IHZhciBiID0gZChhLCBrKDApKTsgcC5jbG9zZVN5bmMoYi5yZWFsKTsgZy5GRF9NQVAuZGVsZXRlKGEpOyByZXR1cm4gMDsgfSksIGZkX2RhdGFzeW5jOiBaKGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICAgICAgYSA9XG4gICAgICAgICAgICAgICAgICAgIGQoYSwgTyk7XG4gICAgICAgICAgICAgICAgcC5mZGF0YXN5bmNTeW5jKGEucmVhbCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICB9KSwgZmRfZmRzdGF0X2dldDogWihmdW5jdGlvbiAoYSwgYikgeyBhID0gZChhLCBrKDApKTsgZy5yZWZyZXNoTWVtb3J5KCk7IGcudmlldy5zZXRVaW50OChiLCBhLmZpbGV0eXBlKTsgZy52aWV3LnNldFVpbnQxNihiICsgMiwgMCwgITApOyBnLnZpZXcuc2V0VWludDE2KGIgKyA0LCAwLCAhMCk7IGcudmlldy5zZXRCaWdVaW50NjQoYiArIDgsIGsoYS5yaWdodHMuYmFzZSksICEwKTsgZy52aWV3LnNldEJpZ1VpbnQ2NChiICsgOCArIDgsIGsoYS5yaWdodHMuaW5oZXJpdGluZyksICEwKTsgcmV0dXJuIDA7IH0pLCBmZF9mZHN0YXRfc2V0X2ZsYWdzOiBaKGZ1bmN0aW9uIChhKSB7IGQoYSwgUik7IHJldHVybiA1MjsgfSksIGZkX2Zkc3RhdF9zZXRfcmlnaHRzOiBaKGZ1bmN0aW9uIChhLCBiLCBjKSB7XG4gICAgICAgICAgICAgICAgYSA9IGQoYSwgaygwKSk7XG4gICAgICAgICAgICAgICAgaWYgKChhLnJpZ2h0cy5iYXNlIHwgYikgPiBhLnJpZ2h0cy5iYXNlIHx8IChhLnJpZ2h0cy5pbmhlcml0aW5nIHwgYykgPiBhLnJpZ2h0cy5pbmhlcml0aW5nKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gNjM7XG4gICAgICAgICAgICAgICAgYS5yaWdodHMuYmFzZSA9XG4gICAgICAgICAgICAgICAgICAgIGI7XG4gICAgICAgICAgICAgICAgYS5yaWdodHMuaW5oZXJpdGluZyA9IGM7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICB9KSwgZmRfZmlsZXN0YXRfZ2V0OiBaKGZ1bmN0aW9uIChhLCBiKSB7IGEgPSBkKGEsIFcpOyB2YXIgYyA9IHAuZnN0YXRTeW5jKGEucmVhbCk7IGcucmVmcmVzaE1lbW9yeSgpOyBnLnZpZXcuc2V0QmlnVWludDY0KGIsIGsoYy5kZXYpLCAhMCk7IGIgKz0gODsgZy52aWV3LnNldEJpZ1VpbnQ2NChiLCBrKGMuaW5vKSwgITApOyBiICs9IDg7IGcudmlldy5zZXRVaW50OChiLCBhLmZpbGV0eXBlKTsgYiArPSA4OyBnLnZpZXcuc2V0QmlnVWludDY0KGIsIGsoYy5ubGluayksICEwKTsgYiArPSA4OyBnLnZpZXcuc2V0QmlnVWludDY0KGIsIGsoYy5zaXplKSwgITApOyBiICs9IDg7IGcudmlldy5zZXRCaWdVaW50NjQoYiwgWShjLmF0aW1lTXMpLCAhMCk7IGIgKz0gODsgZy52aWV3LnNldEJpZ1VpbnQ2NChiLCBZKGMubXRpbWVNcyksICEwKTsgZy52aWV3LnNldEJpZ1VpbnQ2NChiICsgOCwgWShjLmN0aW1lTXMpLCAhMCk7IHJldHVybiAwOyB9KSwgZmRfZmlsZXN0YXRfc2V0X3NpemU6IFooZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgICAgICAgICBhID0gZChhLCBJYik7XG4gICAgICAgICAgICAgICAgcC5mdHJ1bmNhdGVTeW5jKGEucmVhbCwgTnVtYmVyKGIpKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIH0pLCBmZF9maWxlc3RhdF9zZXRfdGltZXM6IFooZnVuY3Rpb24gKGEsIGMsIGUsIGcpIHsgYSA9IGQoYSwgSmIpOyB2YXIgZiA9IHAuZnN0YXRTeW5jKGEucmVhbCksIHQgPSBmLmF0aW1lOyBmID0gZi5tdGltZTsgdmFyIHEgPSAkYihiKDApKTsgaWYgKDMgPT09IChnICYgMykgfHwgMTIgPT09IChnICYgMTIpKVxuICAgICAgICAgICAgICAgIHJldHVybiAyODsgMSA9PT0gKGcgJiAxKSA/IHQgPSAkYihjKSA6IDIgPT09IChnICYgMikgJiYgKHQgPSBxKTsgNCA9PT0gKGcgJiA0KSA/IGYgPSAkYihlKSA6IDggPT09IChnICYgOCkgJiYgKGYgPSBxKTsgcC5mdXRpbWVzU3luYyhhLnJlYWwsIG5ldyBEYXRlKHQpLCBuZXcgRGF0ZShmKSk7IHJldHVybiAwOyB9KSwgZmRfcHJlc3RhdF9nZXQ6IFooZnVuY3Rpb24gKGEsIGIpIHsgYSA9IGQoYSwgaygwKSk7IGlmICghYS5wYXRoKVxuICAgICAgICAgICAgICAgIHJldHVybiAyODsgZy5yZWZyZXNoTWVtb3J5KCk7IGcudmlldy5zZXRVaW50OChiLCAwKTsgZy52aWV3LnNldFVpbnQzMihiICsgNCwgRS5ieXRlTGVuZ3RoKGEuZmFrZVBhdGgpLCAhMCk7IHJldHVybiAwOyB9KSwgZmRfcHJlc3RhdF9kaXJfbmFtZTogWihmdW5jdGlvbiAoYSwgYiwgYykge1xuICAgICAgICAgICAgICAgIGEgPVxuICAgICAgICAgICAgICAgICAgICBkKGEsIGsoMCkpO1xuICAgICAgICAgICAgICAgIGlmICghYS5wYXRoKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMjg7XG4gICAgICAgICAgICAgICAgZy5yZWZyZXNoTWVtb3J5KCk7XG4gICAgICAgICAgICAgICAgRS5mcm9tKGcubWVtb3J5LmJ1ZmZlcikud3JpdGUoYS5mYWtlUGF0aCwgYiwgYywgXCJ1dGY4XCIpO1xuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgfSksIGZkX3B3cml0ZTogWihmdW5jdGlvbiAoYSwgYiwgYywgZiwgaCkgeyB2YXIgdCA9IGQoYSwgVCB8IFEpLCBxID0gMDsgZShiLCBjKS5mb3JFYWNoKGZ1bmN0aW9uIChhKSB7IGZvciAodmFyIGIgPSAwOyBiIDwgYS5ieXRlTGVuZ3RoOylcbiAgICAgICAgICAgICAgICBiICs9IHAud3JpdGVTeW5jKHQucmVhbCwgYSwgYiwgYS5ieXRlTGVuZ3RoIC0gYiwgTnVtYmVyKGYpICsgcSArIGIpOyBxICs9IGI7IH0pOyBnLnZpZXcuc2V0VWludDMyKGgsIHEsICEwKTsgcmV0dXJuIDA7IH0pLCBmZF93cml0ZTogWihmdW5jdGlvbiAoYSwgYiwgYywgZikge1xuICAgICAgICAgICAgICAgIHZhciB0ID0gZChhLCBUKSwgcSA9IDA7XG4gICAgICAgICAgICAgICAgZShiLCBjKS5mb3JFYWNoKGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGIgPSAwOyBiIDwgYS5ieXRlTGVuZ3RoOykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBwLndyaXRlU3luYyh0LnJlYWwsIGEsIGIsIGEuYnl0ZUxlbmd0aCAtIGIsIHQub2Zmc2V0ID8gTnVtYmVyKHQub2Zmc2V0KSA6IG51bGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdC5vZmZzZXQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAodC5vZmZzZXQgKz0gayhjKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBiICs9IGM7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcSArPSBiO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGcudmlldy5zZXRVaW50MzIoZiwgcSwgITApO1xuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgfSksIGZkX3ByZWFkOiBaKGZ1bmN0aW9uIChhLCBiLCBjLCBmLCBoKSB7IHZhciB0OyBhID0gZChhLCBQIHwgUSk7IHZhciBxID0gMDsgdHJ5IHtcbiAgICAgICAgICAgICAgICB2YXIgeCA9IGNhKGUoYiwgYykpLCBsID0geC5uZXh0KCk7XG4gICAgICAgICAgICAgICAgYTogZm9yICg7ICFsLmRvbmU7IGwgPSB4Lm5leHQoKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbiA9IGwudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoYiA9IDA7IGIgPCBuLmJ5dGVMZW5ndGg7KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWMgPSBuLmJ5dGVMZW5ndGggLSBiLCBCID0gcC5yZWFkU3luYyhhLnJlYWwsIG4sIGIsIG4uYnl0ZUxlbmd0aCAtIGIsIE51bWJlcihmKSArIHEgKyBiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGIgKz0gQjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHEgKz0gQjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgwID09PSBCIHx8IEIgPCBpYylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhayBhO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHEgKz0gYjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoVSkge1xuICAgICAgICAgICAgICAgIHZhciByID0geyBlcnJvcjogVSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgbCAmJiAhbC5kb25lICYmICh0ID0geC5yZXR1cm4pICYmIHQuY2FsbCh4KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyKVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgci5lcnJvcjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGcudmlldy5zZXRVaW50MzIoaCwgcSwgITApOyByZXR1cm4gMDsgfSksIGZkX3JlYWQ6IFooZnVuY3Rpb24gKGEsIGIsIGMsIGYpIHtcbiAgICAgICAgICAgICAgICB2YXIgdDtcbiAgICAgICAgICAgICAgICBhID0gZChhLCBQKTtcbiAgICAgICAgICAgICAgICB2YXIgcSA9IDAgPT09IGEucmVhbCwgaCA9IDA7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHggPSBjYShlKGIsIGMpKSwgbCA9IHgubmV4dCgpO1xuICAgICAgICAgICAgICAgICAgICBhOiBmb3IgKDsgIWwuZG9uZTsgbCA9IHgubmV4dCgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbiA9IGwudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGIgPSAwOyBiIDwgbi5ieXRlTGVuZ3RoOykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBCID0gbi5ieXRlTGVuZ3RoIC0gYiwgciA9IHAucmVhZFN5bmMoYS5yZWFsLCBuLCBiLCBCLCBxIHx8IHZvaWQgMCA9PT0gYS5vZmZzZXQgPyBudWxsIDogTnVtYmVyKGEub2Zmc2V0KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcSB8fCAoYS5vZmZzZXQgPSAoYS5vZmZzZXQgPyBhLm9mZnNldCA6IGsoMCkpICsgayhyKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYiArPSByO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGggKz0gcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoMCA9PT0gciB8fCByIDwgQilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsgYTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoVSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgeSA9IHsgZXJyb3I6IFUgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsICYmICFsLmRvbmUgJiYgKHQgPSB4LnJldHVybikgJiYgdC5jYWxsKHgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgeS5lcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBnLnZpZXcuc2V0VWludDMyKGYsIGgsICEwKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIH0pLCBmZF9yZWFkZGlyOiBaKGZ1bmN0aW9uIChhLCBiLCBjLCBlLCBmKSB7XG4gICAgICAgICAgICAgICAgYSA9IGQoYSwgeWIpO1xuICAgICAgICAgICAgICAgIGcucmVmcmVzaE1lbW9yeSgpO1xuICAgICAgICAgICAgICAgIHZhciB0ID0gcC5yZWFkZGlyU3luYyhhLnBhdGgsIHsgd2l0aEZpbGVUeXBlczogITAgfSksIHEgPSBiO1xuICAgICAgICAgICAgICAgIGZvciAoZSA9IE51bWJlcihlKTsgZSA8IHQubGVuZ3RoOyBlICs9IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGggPSB0W2VdLCB4ID0gRS5ieXRlTGVuZ3RoKGgubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChiIC0gcSA+IGMpXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgZy52aWV3LnNldEJpZ1VpbnQ2NChiLCBrKGUgKyAxKSwgITApO1xuICAgICAgICAgICAgICAgICAgICBiICs9IDg7XG4gICAgICAgICAgICAgICAgICAgIGlmIChiIC0gcSA+IGMpXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgdmFyIGwgPSBwLnN0YXRTeW5jKHkucmVzb2x2ZShhLnBhdGgsIGgubmFtZSkpO1xuICAgICAgICAgICAgICAgICAgICBnLnZpZXcuc2V0QmlnVWludDY0KGIsIGsobC5pbm8pLCAhMCk7XG4gICAgICAgICAgICAgICAgICAgIGIgKz0gODtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGIgLSBxID4gYylcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBnLnZpZXcuc2V0VWludDMyKGIsIHgsICEwKTtcbiAgICAgICAgICAgICAgICAgICAgYiArPSA0O1xuICAgICAgICAgICAgICAgICAgICBpZiAoYiAtIHEgPiBjKVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoITApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgbC5pc0Jsb2NrRGV2aWNlKCk6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbCA9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIGwuaXNDaGFyYWN0ZXJEZXZpY2UoKTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsID0gMjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgbC5pc0RpcmVjdG9yeSgpOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGwgPSAzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBsLmlzRklGTygpOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGwgPSA2O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBsLmlzRmlsZSgpOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGwgPSA0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBsLmlzU29ja2V0KCk6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbCA9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDY7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIGwuaXNTeW1ib2xpY0xpbmsoKTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsID0gNztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6IGwgPSAwO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGcudmlldy5zZXRVaW50OChiLCBsKTtcbiAgICAgICAgICAgICAgICAgICAgYiArPSAxO1xuICAgICAgICAgICAgICAgICAgICBiICs9IDM7XG4gICAgICAgICAgICAgICAgICAgIGlmIChiICsgeCA+PSBxICsgYylcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBFLmZyb20oZy5tZW1vcnkuYnVmZmVyKS53cml0ZShoLm5hbWUsIGIpO1xuICAgICAgICAgICAgICAgICAgICBiICs9IHg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGcudmlldy5zZXRVaW50MzIoZiwgTWF0aC5taW4oYiAtIHEsIGMpLCAhMCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICB9KSwgZmRfcmVudW1iZXI6IFooZnVuY3Rpb24gKGEsIGIpIHsgZChhLCBrKDApKTsgZChiLCBrKDApKTsgcC5jbG9zZVN5bmMoZy5GRF9NQVAuZ2V0KGEpLnJlYWwpOyBnLkZEX01BUC5zZXQoYSwgZy5GRF9NQVAuZ2V0KGIpKTsgZy5GRF9NQVAuZGVsZXRlKGIpOyByZXR1cm4gMDsgfSksIGZkX3NlZWs6IFooZnVuY3Rpb24gKGEsIGIsIGMsIGUpIHtcbiAgICAgICAgICAgICAgICBhID0gZChhLCBRKTtcbiAgICAgICAgICAgICAgICBnLnJlZnJlc2hNZW1vcnkoKTtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGMpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgYS5vZmZzZXQgPSAoYS5vZmZzZXQgPyBhLm9mZnNldCA6IGsoMCkpICsgayhiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBjID0gcC5mc3RhdFN5bmMoYS5yZWFsKS5zaXplO1xuICAgICAgICAgICAgICAgICAgICAgICAgYS5vZmZzZXQgPVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGsoYykgKyBrKGIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogYS5vZmZzZXQgPSBrKGIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBnLnZpZXcuc2V0QmlnVWludDY0KGUsIGEub2Zmc2V0LCAhMCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICB9KSwgZmRfdGVsbDogWihmdW5jdGlvbiAoYSwgYikgeyBhID0gZChhLCBxYik7IGcucmVmcmVzaE1lbW9yeSgpOyBhLm9mZnNldCB8fCAoYS5vZmZzZXQgPSBrKDApKTsgZy52aWV3LnNldEJpZ1VpbnQ2NChiLCBhLm9mZnNldCwgITApOyByZXR1cm4gMDsgfSksIGZkX3N5bmM6IFooZnVuY3Rpb24gKGEpIHsgYSA9IGQoYSwgUyk7IHAuZnN5bmNTeW5jKGEucmVhbCk7IHJldHVybiAwOyB9KSwgcGF0aF9jcmVhdGVfZGlyZWN0b3J5OiBaKGZ1bmN0aW9uIChhLCBiLCBjKSB7IGEgPSBkKGEsIHRiKTsgaWYgKCFhLnBhdGgpXG4gICAgICAgICAgICAgICAgcmV0dXJuIDI4OyBnLnJlZnJlc2hNZW1vcnkoKTsgYiA9IEUuZnJvbShnLm1lbW9yeS5idWZmZXIsIGIsIGMpLnRvU3RyaW5nKCk7IHAubWtkaXJTeW5jKHkucmVzb2x2ZShhLnBhdGgsIGIpKTsgcmV0dXJuIDA7IH0pLCBwYXRoX2ZpbGVzdGF0X2dldDogWihmdW5jdGlvbiAoYSwgYiwgYywgZSwgZikge1xuICAgICAgICAgICAgICAgIGEgPSBkKGEsIENiKTtcbiAgICAgICAgICAgICAgICBpZiAoIWEucGF0aClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDI4O1xuICAgICAgICAgICAgICAgIGcucmVmcmVzaE1lbW9yeSgpO1xuICAgICAgICAgICAgICAgIGMgPSBFLmZyb20oZy5tZW1vcnkuYnVmZmVyLCBjLCBlKS50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgIGMgPSBwLnN0YXRTeW5jKHkucmVzb2x2ZShhLnBhdGgsIGMpKTtcbiAgICAgICAgICAgICAgICBnLnZpZXcuc2V0QmlnVWludDY0KGYsIGsoYy5kZXYpLCAhMCk7XG4gICAgICAgICAgICAgICAgZiArPSA4O1xuICAgICAgICAgICAgICAgIGcudmlldy5zZXRCaWdVaW50NjQoZiwgayhjLmlubyksICEwKTtcbiAgICAgICAgICAgICAgICBmICs9IDg7XG4gICAgICAgICAgICAgICAgZy52aWV3LnNldFVpbnQ4KGYsIGNjKGcsIHZvaWQgMCwgYykuZmlsZXR5cGUpO1xuICAgICAgICAgICAgICAgIGYgKz0gODtcbiAgICAgICAgICAgICAgICBnLnZpZXcuc2V0QmlnVWludDY0KGYsIGsoYy5ubGluayksICEwKTtcbiAgICAgICAgICAgICAgICBmICs9IDg7XG4gICAgICAgICAgICAgICAgZy52aWV3LnNldEJpZ1VpbnQ2NChmLCBrKGMuc2l6ZSksICEwKTtcbiAgICAgICAgICAgICAgICBmICs9IDg7XG4gICAgICAgICAgICAgICAgZy52aWV3LnNldEJpZ1VpbnQ2NChmLCBZKGMuYXRpbWVNcyksICEwKTtcbiAgICAgICAgICAgICAgICBmICs9IDg7XG4gICAgICAgICAgICAgICAgZy52aWV3LnNldEJpZ1VpbnQ2NChmLCBZKGMubXRpbWVNcyksICEwKTtcbiAgICAgICAgICAgICAgICBnLnZpZXcuc2V0QmlnVWludDY0KGYgKyA4LCBZKGMuY3RpbWVNcyksICEwKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIH0pLCBwYXRoX2ZpbGVzdGF0X3NldF90aW1lczogWihmdW5jdGlvbiAoYSwgYywgZSwgZiwgaCwgbCwgbikge1xuICAgICAgICAgICAgICAgIGEgPSBkKGEsIEViKTtcbiAgICAgICAgICAgICAgICBpZiAoIWEucGF0aClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDI4O1xuICAgICAgICAgICAgICAgIGcucmVmcmVzaE1lbW9yeSgpO1xuICAgICAgICAgICAgICAgIHZhciB0ID0gcC5mc3RhdFN5bmMoYS5yZWFsKTtcbiAgICAgICAgICAgICAgICBjID0gdC5hdGltZTtcbiAgICAgICAgICAgICAgICB0ID0gdC5tdGltZTtcbiAgICAgICAgICAgICAgICB2YXIgcSA9ICRiKGIoMCkpO1xuICAgICAgICAgICAgICAgIGlmICgzID09PSAobiAmIDMpIHx8IDEyID09PSAobiAmIDEyKSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDI4O1xuICAgICAgICAgICAgICAgIDEgPT09IChuICYgMSkgPyBjID0gJGIoaCkgOiAyID09PSAobiAmIDIpICYmIChjID0gcSk7XG4gICAgICAgICAgICAgICAgNCA9PT0gKG4gJiA0KSA/IHQgPSAkYihsKSA6IDggPT09IChuICYgOCkgJiYgKHQgPSBxKTtcbiAgICAgICAgICAgICAgICBlID0gRS5mcm9tKGcubWVtb3J5LmJ1ZmZlciwgZSwgZikudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICBwLnV0aW1lc1N5bmMoeS5yZXNvbHZlKGEucGF0aCwgZSksIG5ldyBEYXRlKGMpLCBuZXcgRGF0ZSh0KSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICB9KSwgcGF0aF9saW5rOiBaKGZ1bmN0aW9uIChhLCBiLCBjLCBlLCBmLCBoLCBsKSB7XG4gICAgICAgICAgICAgICAgYSA9IGQoYSwgdmIpO1xuICAgICAgICAgICAgICAgIGYgPSBkKGYsIHdiKTtcbiAgICAgICAgICAgICAgICBpZiAoIWEucGF0aCB8fCAhZi5wYXRoKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMjg7XG4gICAgICAgICAgICAgICAgZy5yZWZyZXNoTWVtb3J5KCk7XG4gICAgICAgICAgICAgICAgYyA9IEUuZnJvbShnLm1lbW9yeS5idWZmZXIsIGMsIGUpLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgaCA9IEUuZnJvbShnLm1lbW9yeS5idWZmZXIsIGgsIGwpLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgcC5saW5rU3luYyh5LnJlc29sdmUoYS5wYXRoLCBjKSwgeS5yZXNvbHZlKGYucGF0aCwgaCkpO1xuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgfSksIHBhdGhfb3BlbjogWihmdW5jdGlvbiAoYSwgYiwgYywgZSwgZiwgaCwgbCwgbiwgcikge1xuICAgICAgICAgICAgICAgIGIgPSBkKGEsIHhiKTtcbiAgICAgICAgICAgICAgICBoID0gayhoKTtcbiAgICAgICAgICAgICAgICBsID0gayhsKTtcbiAgICAgICAgICAgICAgICBhID0gKGggJiAoUCB8IHliKSkgIT09IGsoMCk7XG4gICAgICAgICAgICAgICAgdmFyIHQgPSAoaCAmIChPIHwgVCB8IHNiIHwgSWIpKSAhPT0gaygwKTtcbiAgICAgICAgICAgICAgICBpZiAodCAmJiBhKVxuICAgICAgICAgICAgICAgICAgICB2YXIgcSA9IHAuY29uc3RhbnRzLk9fUkRXUjtcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIGEgPyBxID0gcC5jb25zdGFudHMuT19SRE9OTFkgOiB0ICYmIChxID0gcC5jb25zdGFudHMuT19XUk9OTFkpO1xuICAgICAgICAgICAgICAgIGEgPSBoIHwgeGI7XG4gICAgICAgICAgICAgICAgaCB8PSBsO1xuICAgICAgICAgICAgICAgIDAgIT09IChmICYgMSkgJiYgKHEgfD0gcC5jb25zdGFudHMuT19DUkVBVCwgYSB8PSB1Yik7XG4gICAgICAgICAgICAgICAgMCAhPT0gKGYgJiAyKSAmJiAocSB8PSBwLmNvbnN0YW50cy5PX0RJUkVDVE9SWSk7XG4gICAgICAgICAgICAgICAgMCAhPT0gKGYgJiA0KSAmJiAocSB8PSBwLmNvbnN0YW50cy5PX0VYQ0wpO1xuICAgICAgICAgICAgICAgIDAgIT09IChmICYgOCkgJiYgKHEgfD0gcC5jb25zdGFudHMuT19UUlVOQywgYSB8PSBEYik7XG4gICAgICAgICAgICAgICAgMCAhPT0gKG4gJiAxKSAmJiAocSB8PSBwLmNvbnN0YW50cy5PX0FQUEVORCk7XG4gICAgICAgICAgICAgICAgMCAhPT0gKG4gJiAyKSAmJiAocSA9IHAuY29uc3RhbnRzLk9fRFNZTkMgPyBxIHwgcC5jb25zdGFudHMuT19EU1lOQyA6XG4gICAgICAgICAgICAgICAgICAgIHEgfCBwLmNvbnN0YW50cy5PX1NZTkMsIGggfD0gTyk7XG4gICAgICAgICAgICAgICAgMCAhPT0gKG4gJiA0KSAmJiAocSB8PSBwLmNvbnN0YW50cy5PX05PTkJMT0NLKTtcbiAgICAgICAgICAgICAgICAwICE9PSAobiAmIDgpICYmIChxID0gcC5jb25zdGFudHMuT19SU1lOQyA/IHEgfCBwLmNvbnN0YW50cy5PX1JTWU5DIDogcSB8IHAuY29uc3RhbnRzLk9fU1lOQywgaCB8PSBTKTtcbiAgICAgICAgICAgICAgICAwICE9PSAobiAmIDE2KSAmJiAocSB8PSBwLmNvbnN0YW50cy5PX1NZTkMsIGggfD0gUyk7XG4gICAgICAgICAgICAgICAgdCAmJiAwID09PSAocSAmIChwLmNvbnN0YW50cy5PX0FQUEVORCB8IHAuY29uc3RhbnRzLk9fVFJVTkMpKSAmJiAoaCB8PSBRKTtcbiAgICAgICAgICAgICAgICBnLnJlZnJlc2hNZW1vcnkoKTtcbiAgICAgICAgICAgICAgICBjID0gRS5mcm9tKGcubWVtb3J5LmJ1ZmZlciwgYywgZSkudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICBjID0geS5yZXNvbHZlKGIucGF0aCwgYyk7XG4gICAgICAgICAgICAgICAgaWYgKHkucmVsYXRpdmUoYi5wYXRoLCBjKS5zdGFydHNXaXRoKFwiLi5cIikpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiA3NjtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgeCA9IHAucmVhbHBhdGhTeW5jKGMpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoeS5yZWxhdGl2ZShiLnBhdGgsIHgpLnN0YXJ0c1dpdGgoXCIuLlwiKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiA3NjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKFUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKFwiRU5PRU5UXCIgPT09IFUuY29kZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHggPSBjO1xuICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBVO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgQiA9IHAuc3RhdFN5bmMoeCkuaXNEaXJlY3RvcnkoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKFUpIHsgfVxuICAgICAgICAgICAgICAgIHEgPSAhdCAmJiBCID8gcC5vcGVuU3luYyh4LCBwLmNvbnN0YW50cy5PX1JET05MWSkgOiBwLm9wZW5TeW5jKHgsIHEpO1xuICAgICAgICAgICAgICAgIEIgPSBmYShnLkZEX01BUC5rZXlzKCkpLnJldmVyc2UoKVswXSArIDE7XG4gICAgICAgICAgICAgICAgZy5GRF9NQVAuc2V0KEIsIHsgcmVhbDogcSwgZmlsZXR5cGU6IHZvaWQgMCwgcmlnaHRzOiB7IGJhc2U6IGEsIGluaGVyaXRpbmc6IGggfSwgcGF0aDogeCB9KTtcbiAgICAgICAgICAgICAgICBiYyhnLCBCKTtcbiAgICAgICAgICAgICAgICBnLnZpZXcuc2V0VWludDMyKHIsIEIsICEwKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIH0pLCBwYXRoX3JlYWRsaW5rOiBaKGZ1bmN0aW9uIChhLCBiLCBjLCBlLCBmLCBoKSB7IGEgPSBkKGEsIHpiKTsgaWYgKCFhLnBhdGgpXG4gICAgICAgICAgICAgICAgcmV0dXJuIDI4OyBnLnJlZnJlc2hNZW1vcnkoKTsgYiA9IEUuZnJvbShnLm1lbW9yeS5idWZmZXIsIGIsIGMpLnRvU3RyaW5nKCk7IGIgPSB5LnJlc29sdmUoYS5wYXRoLCBiKTsgYiA9IHAucmVhZGxpbmtTeW5jKGIpOyBlID0gRS5mcm9tKGcubWVtb3J5LmJ1ZmZlcikud3JpdGUoYiwgZSwgZik7IGcudmlldy5zZXRVaW50MzIoaCwgZSwgITApOyByZXR1cm4gMDsgfSksXG4gICAgICAgICAgICBwYXRoX3JlbW92ZV9kaXJlY3Rvcnk6IFooZnVuY3Rpb24gKGEsIGIsIGMpIHsgYSA9IGQoYSwgTGIpOyBpZiAoIWEucGF0aClcbiAgICAgICAgICAgICAgICByZXR1cm4gMjg7IGcucmVmcmVzaE1lbW9yeSgpOyBiID0gRS5mcm9tKGcubWVtb3J5LmJ1ZmZlciwgYiwgYykudG9TdHJpbmcoKTsgcC5ybWRpclN5bmMoeS5yZXNvbHZlKGEucGF0aCwgYikpOyByZXR1cm4gMDsgfSksIHBhdGhfcmVuYW1lOiBaKGZ1bmN0aW9uIChhLCBiLCBjLCBlLCBmLCBoKSB7IGEgPSBkKGEsIEFiKTsgZSA9IGQoZSwgQmIpOyBpZiAoIWEucGF0aCB8fCAhZS5wYXRoKVxuICAgICAgICAgICAgICAgIHJldHVybiAyODsgZy5yZWZyZXNoTWVtb3J5KCk7IGIgPSBFLmZyb20oZy5tZW1vcnkuYnVmZmVyLCBiLCBjKS50b1N0cmluZygpOyBmID0gRS5mcm9tKGcubWVtb3J5LmJ1ZmZlciwgZiwgaCkudG9TdHJpbmcoKTsgcC5yZW5hbWVTeW5jKHkucmVzb2x2ZShhLnBhdGgsIGIpLCB5LnJlc29sdmUoZS5wYXRoLCBmKSk7IHJldHVybiAwOyB9KSwgcGF0aF9zeW1saW5rOiBaKGZ1bmN0aW9uIChhLCBiLCBjLCBlLCBmKSB7XG4gICAgICAgICAgICAgICAgYyA9IGQoYywgS2IpO1xuICAgICAgICAgICAgICAgIGlmICghYy5wYXRoKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMjg7XG4gICAgICAgICAgICAgICAgZy5yZWZyZXNoTWVtb3J5KCk7XG4gICAgICAgICAgICAgICAgYSA9IEUuZnJvbShnLm1lbW9yeS5idWZmZXIsIGEsIGIpLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgZSA9IEUuZnJvbShnLm1lbW9yeS5idWZmZXIsIGUsIGYpLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgcC5zeW1saW5rU3luYyhhLCB5LnJlc29sdmUoYy5wYXRoLCBlKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICB9KSwgcGF0aF91bmxpbmtfZmlsZTogWihmdW5jdGlvbiAoYSwgYiwgYykgeyBhID0gZChhLCBNYik7IGlmICghYS5wYXRoKVxuICAgICAgICAgICAgICAgIHJldHVybiAyODsgZy5yZWZyZXNoTWVtb3J5KCk7IGIgPSBFLmZyb20oZy5tZW1vcnkuYnVmZmVyLCBiLCBjKS50b1N0cmluZygpOyBwLnVubGlua1N5bmMoeS5yZXNvbHZlKGEucGF0aCwgYikpOyByZXR1cm4gMDsgfSksIHBvbGxfb25lb2ZmOiBmdW5jdGlvbiAoYSwgYywgZCwgZSkge1xuICAgICAgICAgICAgICAgIHZhciBmID0gMCwgaCA9IDA7XG4gICAgICAgICAgICAgICAgZy5yZWZyZXNoTWVtb3J5KCk7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgbCA9IDA7IGwgPCBkOyBsICs9IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG4gPSBnLnZpZXcuZ2V0QmlnVWludDY0KGEsICEwKTtcbiAgICAgICAgICAgICAgICAgICAgYSArPSA4O1xuICAgICAgICAgICAgICAgICAgICB2YXIgcCA9IGcudmlldy5nZXRVaW50OChhKTtcbiAgICAgICAgICAgICAgICAgICAgYSArPSAxO1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhICs9IDc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZy52aWV3LmdldEJpZ1VpbnQ2NChhLCAhMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYSArPSA4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBxID0gZy52aWV3LmdldFVpbnQzMihhLCAhMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYSArPSA0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgKz0gNDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwID0gZy52aWV3LmdldEJpZ1VpbnQ2NChhLCAhMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYSArPSA4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcudmlldy5nZXRCaWdVaW50NjQoYSwgITApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgKz0gODtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdCA9IGcudmlldy5nZXRVaW50MTYoYSwgITApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgKz0gMjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhICs9IDY7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHggPSAxID09PSB0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHEgPSBrKGIocSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bGwgPT09IHEgPyB0ID0gMjggOiAocCA9IHggPyBwIDogcSArIHAsIGggPSBwID4gaCA/IHAgOiBoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnLnZpZXcuc2V0QmlnVWludDY0KGMsIG4sICEwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjICs9IDg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZy52aWV3LnNldFVpbnQxNihjLCB0LCAhMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYyArPSAyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcudmlldy5zZXRVaW50OChjLCAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjICs9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYyArPSA1O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYgKz0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhICs9IDM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZy52aWV3LmdldFVpbnQzMihhLCAhMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYSArPSA0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcudmlldy5zZXRCaWdVaW50NjQoYywgbiwgITApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMgKz0gODtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnLnZpZXcuc2V0VWludDE2KGMsIDUyLCAhMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYyArPSAyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcudmlldy5zZXRVaW50OChjLCBwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjICs9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYyArPSA1O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYgKz0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHJldHVybiAyODtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmb3IgKGcudmlldy5zZXRVaW50MzIoZSwgZiwgITApOyByLmhydGltZSgpIDwgaDspXG4gICAgICAgICAgICAgICAgICAgIDtcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIH0sIHByb2NfZXhpdDogZnVuY3Rpb24gKGEpIHsgci5leGl0KGEpOyByZXR1cm4gMDsgfSwgcHJvY19yYWlzZTogZnVuY3Rpb24gKGEpIHsgaWYgKCEoYSBpbiBYYikpXG4gICAgICAgICAgICAgICAgcmV0dXJuIDI4OyByLmtpbGwoWGJbYV0pOyByZXR1cm4gMDsgfSwgcmFuZG9tX2dldDogZnVuY3Rpb24gKGEsIGIpIHsgZy5yZWZyZXNoTWVtb3J5KCk7IHIucmFuZG9tRmlsbFN5bmMobmV3IFVpbnQ4QXJyYXkoZy5tZW1vcnkuYnVmZmVyKSwgYSwgYik7IHJldHVybiAwOyB9LCBzY2hlZF95aWVsZDogZnVuY3Rpb24gKCkgeyByZXR1cm4gMDsgfSwgc29ja19yZWN2OiBmdW5jdGlvbiAoKSB7IHJldHVybiA1MjsgfSwgc29ja19zZW5kOiBmdW5jdGlvbiAoKSB7IHJldHVybiA1MjsgfSwgc29ja19zaHV0ZG93bjogZnVuY3Rpb24gKCkgeyByZXR1cm4gNTI7IH0gfTtcbiAgICAgICAgYS50cmFjZVN5c2NhbGxzICYmIE9iamVjdC5rZXlzKHRoaXMud2FzaUltcG9ydCkuZm9yRWFjaChmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgdmFyIGIgPSBnLndhc2lJbXBvcnRbYV07XG4gICAgICAgICAgICBnLndhc2lJbXBvcnRbYV0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgYyA9IFtdLCBkID0gMDsgZCA8IGFyZ3VtZW50cy5sZW5ndGg7IGQrKylcbiAgICAgICAgICAgICAgICAgICAgY1tkXSA9IGFyZ3VtZW50c1tkXTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIldBU0k6IHdhc2lJbXBvcnQgY2FsbGVkOiBcIiArIGEgKyBcIiAoXCIgKyBjICsgXCIpXCIpO1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlID0gYi5hcHBseSh2b2lkIDAsIGZhKGMpKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJXQVNJOiAgPT4gXCIgKyBlKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChIYikge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBjb25zb2xlLmxvZyhcIkNhdGNoZWQgZXJyb3I6IFwiICsgSGIpLCBIYjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgYS5wcm90b3R5cGUucmVmcmVzaE1lbW9yeSA9IGZ1bmN0aW9uICgpIHsgdGhpcy52aWV3ICYmIDAgIT09IHRoaXMudmlldy5idWZmZXIuYnl0ZUxlbmd0aCB8fCAodGhpcy52aWV3ID0gbmV3IGlhKHRoaXMubWVtb3J5LmJ1ZmZlcikpOyB9O1xuICAgIGEucHJvdG90eXBlLnNldE1lbW9yeSA9IGZ1bmN0aW9uIChhKSB7IHRoaXMubWVtb3J5ID0gYTsgfTtcbiAgICBhLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uIChhKSB7XG4gICAgICAgIGEgPSBhLmV4cG9ydHM7XG4gICAgICAgIGlmIChudWxsID09PSBhIHx8IFwib2JqZWN0XCIgIT09IHR5cGVvZiBhKVxuICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJpbnN0YW5jZS5leHBvcnRzIG11c3QgYmUgYW4gT2JqZWN0LiBSZWNlaXZlZCBcIiArXG4gICAgICAgICAgICAgICAgYSArIFwiLlwiKTtcbiAgICAgICAgdmFyIGIgPSBhLm1lbW9yeTtcbiAgICAgICAgaWYgKCEoYiBpbnN0YW5jZW9mIFdlYkFzc2VtYmx5Lk1lbW9yeSkpXG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcImluc3RhbmNlLmV4cG9ydHMubWVtb3J5IG11c3QgYmUgYSBXZWJBc3NlbWJseS5NZW1vcnkuIFJlY2NlaXZlZCBcIiArIGIgKyBcIi5cIik7XG4gICAgICAgIHRoaXMuc2V0TWVtb3J5KGIpO1xuICAgICAgICBhLl9zdGFydCAmJiBhLl9zdGFydCgpO1xuICAgIH07XG4gICAgYS5wcm90b3R5cGUuZ2V0SW1wb3J0TmFtZXNwYWNlID0gZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgdmFyIGIsIGQgPSBudWxsO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgZm9yICh2YXIgZSA9IGNhKFdlYkFzc2VtYmx5Lk1vZHVsZS5pbXBvcnRzKGEpKSwgZiA9IGUubmV4dCgpOyAhZi5kb25lOyBmID0gZS5uZXh0KCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgZyA9IGYudmFsdWU7XG4gICAgICAgICAgICAgICAgaWYgKFwiZnVuY3Rpb25cIiA9PT0gZy5raW5kICYmIGcubW9kdWxlLnN0YXJ0c1dpdGgoXCJ3YXNpX1wiKSlcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFkKVxuICAgICAgICAgICAgICAgICAgICAgICAgZCA9IGcubW9kdWxlO1xuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChkICE9PSBnLm1vZHVsZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IEVycm9yKFwiTXVsdGlwbGUgbmFtZXNwYWNlcyBkZXRlY3RlZC5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGwpIHtcbiAgICAgICAgICAgIHZhciBoID0geyBlcnJvcjogbCB9O1xuICAgICAgICB9XG4gICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBmICYmXG4gICAgICAgICAgICAgICAgICAgICFmLmRvbmUgJiYgKGIgPSBlLnJldHVybikgJiYgYi5jYWxsKGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICAgICAgaWYgKGgpXG4gICAgICAgICAgICAgICAgICAgIHRocm93IGguZXJyb3I7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGQ7XG4gICAgfTtcbiAgICBhLnByb3RvdHlwZS5nZXRJbXBvcnRzID0gZnVuY3Rpb24gKGEpIHsgc3dpdGNoICh0aGlzLmdldEltcG9ydE5hbWVzcGFjZShhKSkge1xuICAgICAgICBjYXNlIFwid2FzaV91bnN0YWJsZVwiOiByZXR1cm4geyB3YXNpX3Vuc3RhYmxlOiB0aGlzLndhc2lJbXBvcnQgfTtcbiAgICAgICAgY2FzZSBcIndhc2lfc25hcHNob3RfcHJldmlldzFcIjogcmV0dXJuIHsgd2FzaV9zbmFwc2hvdF9wcmV2aWV3MTogdGhpcy53YXNpSW1wb3J0IH07XG4gICAgICAgIGRlZmF1bHQ6IHRocm93IEVycm9yKFwiQ2FuJ3QgZGV0ZWN0IGEgV0FTSSBuYW1lc3BhY2UgZm9yIHRoZSBXZWJBc3NlbWJseSBNb2R1bGVcIik7XG4gICAgfSB9O1xuICAgIGEuZGVmYXVsdEJpbmRpbmdzID0gcGI7XG4gICAgcmV0dXJuIGE7XG59KCk7XG5leHBvcnRzLldBU0lFcnJvciA9IGFjO1xuZXhwb3J0cy5XQVNJRXhpdEVycm9yID0gbmI7XG5leHBvcnRzLldBU0lLaWxsRXJyb3IgPSBvYjtcbmV4cG9ydHMuV0FTSSA9IGRjO1xuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBkYztcblxuXG4vLyMgc291cmNlVVJMPXdlYnBhY2s6Ly9AZmx1ZW5jZWxhYnMvbWFyaW5lLndvcmtlci1zY3JpcHQvLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0B3YXNtZXIrd2FzaUAwLjEyLjAvbm9kZV9tb2R1bGVzL0B3YXNtZXIvd2FzaS9saWIvaW5kZXguZXNtLmpzPyIpOwoKLyoqKi8gfSksCgovKioqLyAiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0B3YXNtZXIrd2FzaUAwLjEyLjAvbm9kZV9tb2R1bGVzL0B3YXNtZXIvd2FzaS9saWIvaW5kZXguanMiOgovKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiAuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQHdhc21lcit3YXNpQDAuMTIuMC9ub2RlX21vZHVsZXMvQHdhc21lci93YXNpL2xpYi9pbmRleC5qcyAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKiovIChmdW5jdGlvbihfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKZXZhbCgiXG52YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xudmFyIF9fc3ByZWFkQXJyYXkgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXkpIHx8IGZ1bmN0aW9uICh0bywgZnJvbSwgcGFjaykge1xuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XG59O1xuLyogZXNsaW50LWRpc2FibGUgbm8tdW51c2VkLXZhcnMgKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHsgdmFsdWU6IHRydWUgfSkpO1xudmFyIGJpZ2ludF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9wb2x5ZmlsbHMvYmlnaW50ICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0B3YXNtZXIrd2FzaUAwLjEyLjAvbm9kZV9tb2R1bGVzL0B3YXNtZXIvd2FzaS9saWIvcG9seWZpbGxzL2JpZ2ludC5qc1wiKTtcbnZhciBkYXRhdmlld18xID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9wb2x5ZmlsbHMvZGF0YXZpZXcgKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQHdhc21lcit3YXNpQDAuMTIuMC9ub2RlX21vZHVsZXMvQHdhc21lci93YXNpL2xpYi9wb2x5ZmlsbHMvZGF0YXZpZXcuanNcIik7XG52YXIgYnVmZmVyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL3BvbHlmaWxscy9idWZmZXIgKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQHdhc21lcit3YXNpQDAuMTIuMC9ub2RlX21vZHVsZXMvQHdhc21lci93YXNpL2xpYi9wb2x5ZmlsbHMvYnVmZmVyLmpzXCIpO1xuLy8gSW1wb3J0IG91ciBkZWZhdWx0IGJpbmRpbmdzIGRlcGVuZGluZyBvbiB0aGUgZW52aXJvbm1lbnRcbnZhciBkZWZhdWx0QmluZGluZ3M7XG4vKlJPTExVUF9SRVBMQUNFX05PREVcbmltcG9ydCBub2RlQmluZGluZ3MgZnJvbSBcIi4vYmluZGluZ3Mvbm9kZVwiO1xuZGVmYXVsdEJpbmRpbmdzID0gbm9kZUJpbmRpbmdzO1xuUk9MTFVQX1JFUExBQ0VfTk9ERSovXG4vKlJPTExVUF9SRVBMQUNFX0JST1dTRVJcbmltcG9ydCBicm93c2VyQmluZGluZ3MgZnJvbSBcIi4vYmluZGluZ3MvYnJvd3NlclwiO1xuZGVmYXVsdEJpbmRpbmdzID0gYnJvd3NlckJpbmRpbmdzO1xuUk9MTFVQX1JFUExBQ0VfQlJPV1NFUiovXG4vKlxuXG5UaGlzIHByb2plY3QgaXMgYmFzZWQgZnJvbSB0aGUgTm9kZSBpbXBsZW1lbnRhdGlvbiBtYWRlIGJ5IEd1cyBDYXBsYW5cbmh0dHBzOi8vZ2l0aHViLmNvbS9kZXZzbmVrL25vZGUtd2FzaVxuSG93ZXZlciwgSmF2YVNjcmlwdCBXQVNJIGlzIGZvY3VzZWQgb246XG4gKiBCcmluZ2luZyBXQVNJIHRvIHRoZSBCcm93c2Vyc1xuICogTWFrZSBlYXN5IHRvIHBsdWcgZGlmZmVyZW50IGZpbGVzeXN0ZW1zXG4gKiBQcm92aWRlIGEgdHlwZS1zYWZlIGFwaSB1c2luZyBUeXBlc2NyaXB0XG4gKiBQcm92aWRpbmcgbXVsdGlwbGUgb3V0cHV0IHRhcmdldHMgdG8gc3VwcG9ydCBib3RoIGJyb3dzZXJzIGFuZCBub2RlXG4gKiBUaGUgQVBJIGlzIGFkYXB0ZWQgdG8gdGhlIE5vZGUtV0FTSSBBUEk6IGh0dHBzOi8vZ2l0aHViLmNvbS9ub2RlanMvd2FzaS9ibG9iL3dhc2kvbGliL3dhc2kuanNcblxuQ29weXJpZ2h0IDIwMTkgR3VzIENhcGxhblxuXG5QZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG5vZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0b1xuZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGVcbnJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vclxuc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbmZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG5cblRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG5hbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cblxuVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG5GSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbkFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbkxJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HXG5GUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTXG5JTiBUSEUgU09GVFdBUkUuXG5cbiAqL1xudmFyIGNvbnN0YW50c18xID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9jb25zdGFudHMgKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQHdhc21lcit3YXNpQDAuMTIuMC9ub2RlX21vZHVsZXMvQHdhc21lci93YXNpL2xpYi9jb25zdGFudHMuanNcIik7XG52YXIgU1RESU5fREVGQVVMVF9SSUdIVFMgPSBjb25zdGFudHNfMS5XQVNJX1JJR0hUX0ZEX0RBVEFTWU5DIHxcbiAgICBjb25zdGFudHNfMS5XQVNJX1JJR0hUX0ZEX1JFQUQgfFxuICAgIGNvbnN0YW50c18xLldBU0lfUklHSFRfRkRfU1lOQyB8XG4gICAgY29uc3RhbnRzXzEuV0FTSV9SSUdIVF9GRF9BRFZJU0UgfFxuICAgIGNvbnN0YW50c18xLldBU0lfUklHSFRfRkRfRklMRVNUQVRfR0VUIHxcbiAgICBjb25zdGFudHNfMS5XQVNJX1JJR0hUX1BPTExfRkRfUkVBRFdSSVRFO1xudmFyIFNURE9VVF9ERUZBVUxUX1JJR0hUUyA9IGNvbnN0YW50c18xLldBU0lfUklHSFRfRkRfREFUQVNZTkMgfFxuICAgIGNvbnN0YW50c18xLldBU0lfUklHSFRfRkRfV1JJVEUgfFxuICAgIGNvbnN0YW50c18xLldBU0lfUklHSFRfRkRfU1lOQyB8XG4gICAgY29uc3RhbnRzXzEuV0FTSV9SSUdIVF9GRF9BRFZJU0UgfFxuICAgIGNvbnN0YW50c18xLldBU0lfUklHSFRfRkRfRklMRVNUQVRfR0VUIHxcbiAgICBjb25zdGFudHNfMS5XQVNJX1JJR0hUX1BPTExfRkRfUkVBRFdSSVRFO1xudmFyIFNUREVSUl9ERUZBVUxUX1JJR0hUUyA9IFNURE9VVF9ERUZBVUxUX1JJR0hUUztcbnZhciBtc1RvTnMgPSBmdW5jdGlvbiAobXMpIHtcbiAgICB2YXIgbXNJbnQgPSBNYXRoLnRydW5jKG1zKTtcbiAgICB2YXIgZGVjaW1hbCA9IGJpZ2ludF8xLkJpZ0ludFBvbHlmaWxsKE1hdGgucm91bmQoKG1zIC0gbXNJbnQpICogMTAwMDAwMCkpO1xuICAgIHZhciBucyA9IGJpZ2ludF8xLkJpZ0ludFBvbHlmaWxsKG1zSW50KSAqIGJpZ2ludF8xLkJpZ0ludFBvbHlmaWxsKDEwMDAwMDApO1xuICAgIHJldHVybiBucyArIGRlY2ltYWw7XG59O1xudmFyIG5zVG9NcyA9IGZ1bmN0aW9uIChucykge1xuICAgIGlmICh0eXBlb2YgbnMgPT09ICdudW1iZXInKSB7XG4gICAgICAgIG5zID0gTWF0aC50cnVuYyhucyk7XG4gICAgfVxuICAgIHZhciBuc0ludCA9IGJpZ2ludF8xLkJpZ0ludFBvbHlmaWxsKG5zKTtcbiAgICByZXR1cm4gTnVtYmVyKG5zSW50IC8gYmlnaW50XzEuQmlnSW50UG9seWZpbGwoMTAwMDAwMCkpO1xufTtcbnZhciB3cmFwID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgYXJncyA9IFtdO1xuICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIGYuYXBwbHkodm9pZCAwLCBhcmdzKTtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgLy8gSWYgaXQncyBhbiBlcnJvciBmcm9tIHRoZSBmc1xuICAgICAgICBpZiAoZSAmJiBlLmNvZGUgJiYgdHlwZW9mIGUuY29kZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgcmV0dXJuIGNvbnN0YW50c18xLkVSUk9SX01BUFtlLmNvZGVdIHx8IGNvbnN0YW50c18xLldBU0lfRUlOVkFMO1xuICAgICAgICB9XG4gICAgICAgIC8vIElmIGl0J3MgYSBXQVNJIGVycm9yLCB3ZSByZXR1cm4gaXQgZGlyZWN0bHlcbiAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBXQVNJRXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiBlLmVycm5vO1xuICAgICAgICB9XG4gICAgICAgIC8vIE90aGVyd2lzZSB3ZSBsZXQgdGhlIGVycm9yIGJ1YmJsZSB1cFxuICAgICAgICB0aHJvdyBlO1xuICAgIH1cbn07IH07XG52YXIgc3RhdCA9IGZ1bmN0aW9uICh3YXNpLCBmZCkge1xuICAgIHZhciBlbnRyeSA9IHdhc2kuRkRfTUFQLmdldChmZCk7XG4gICAgaWYgKCFlbnRyeSkge1xuICAgICAgICB0aHJvdyBuZXcgV0FTSUVycm9yKGNvbnN0YW50c18xLldBU0lfRUJBREYpO1xuICAgIH1cbiAgICBpZiAoZW50cnkuZmlsZXR5cGUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICB2YXIgc3RhdHMgPSB3YXNpLmJpbmRpbmdzLmZzLmZzdGF0U3luYyhlbnRyeS5yZWFsKTtcbiAgICAgICAgdmFyIF9hID0gdHJhbnNsYXRlRmlsZUF0dHJpYnV0ZXMod2FzaSwgZmQsIHN0YXRzKSwgZmlsZXR5cGUgPSBfYS5maWxldHlwZSwgcmlnaHRzQmFzZSA9IF9hLnJpZ2h0c0Jhc2UsIHJpZ2h0c0luaGVyaXRpbmcgPSBfYS5yaWdodHNJbmhlcml0aW5nO1xuICAgICAgICBlbnRyeS5maWxldHlwZSA9IGZpbGV0eXBlO1xuICAgICAgICBpZiAoIWVudHJ5LnJpZ2h0cykge1xuICAgICAgICAgICAgZW50cnkucmlnaHRzID0ge1xuICAgICAgICAgICAgICAgIGJhc2U6IHJpZ2h0c0Jhc2UsXG4gICAgICAgICAgICAgICAgaW5oZXJpdGluZzogcmlnaHRzSW5oZXJpdGluZ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZW50cnk7XG59O1xudmFyIHRyYW5zbGF0ZUZpbGVBdHRyaWJ1dGVzID0gZnVuY3Rpb24gKHdhc2ksIGZkLCBzdGF0cykge1xuICAgIHN3aXRjaCAodHJ1ZSkge1xuICAgICAgICBjYXNlIHN0YXRzLmlzQmxvY2tEZXZpY2UoKTpcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZmlsZXR5cGU6IGNvbnN0YW50c18xLldBU0lfRklMRVRZUEVfQkxPQ0tfREVWSUNFLFxuICAgICAgICAgICAgICAgIHJpZ2h0c0Jhc2U6IGNvbnN0YW50c18xLlJJR0hUU19CTE9DS19ERVZJQ0VfQkFTRSxcbiAgICAgICAgICAgICAgICByaWdodHNJbmhlcml0aW5nOiBjb25zdGFudHNfMS5SSUdIVFNfQkxPQ0tfREVWSUNFX0lOSEVSSVRJTkdcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2Ugc3RhdHMuaXNDaGFyYWN0ZXJEZXZpY2UoKToge1xuICAgICAgICAgICAgdmFyIGZpbGV0eXBlID0gY29uc3RhbnRzXzEuV0FTSV9GSUxFVFlQRV9DSEFSQUNURVJfREVWSUNFO1xuICAgICAgICAgICAgaWYgKGZkICE9PSB1bmRlZmluZWQgJiYgd2FzaS5iaW5kaW5ncy5pc1RUWShmZCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBmaWxldHlwZTogZmlsZXR5cGUsXG4gICAgICAgICAgICAgICAgICAgIHJpZ2h0c0Jhc2U6IGNvbnN0YW50c18xLlJJR0hUU19UVFlfQkFTRSxcbiAgICAgICAgICAgICAgICAgICAgcmlnaHRzSW5oZXJpdGluZzogY29uc3RhbnRzXzEuUklHSFRTX1RUWV9JTkhFUklUSU5HXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZmlsZXR5cGU6IGZpbGV0eXBlLFxuICAgICAgICAgICAgICAgIHJpZ2h0c0Jhc2U6IGNvbnN0YW50c18xLlJJR0hUU19DSEFSQUNURVJfREVWSUNFX0JBU0UsXG4gICAgICAgICAgICAgICAgcmlnaHRzSW5oZXJpdGluZzogY29uc3RhbnRzXzEuUklHSFRTX0NIQVJBQ1RFUl9ERVZJQ0VfSU5IRVJJVElOR1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIHN0YXRzLmlzRGlyZWN0b3J5KCk6XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGZpbGV0eXBlOiBjb25zdGFudHNfMS5XQVNJX0ZJTEVUWVBFX0RJUkVDVE9SWSxcbiAgICAgICAgICAgICAgICByaWdodHNCYXNlOiBjb25zdGFudHNfMS5SSUdIVFNfRElSRUNUT1JZX0JBU0UsXG4gICAgICAgICAgICAgICAgcmlnaHRzSW5oZXJpdGluZzogY29uc3RhbnRzXzEuUklHSFRTX0RJUkVDVE9SWV9JTkhFUklUSU5HXG4gICAgICAgICAgICB9O1xuICAgICAgICBjYXNlIHN0YXRzLmlzRklGTygpOlxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBmaWxldHlwZTogY29uc3RhbnRzXzEuV0FTSV9GSUxFVFlQRV9TT0NLRVRfU1RSRUFNLFxuICAgICAgICAgICAgICAgIHJpZ2h0c0Jhc2U6IGNvbnN0YW50c18xLlJJR0hUU19TT0NLRVRfQkFTRSxcbiAgICAgICAgICAgICAgICByaWdodHNJbmhlcml0aW5nOiBjb25zdGFudHNfMS5SSUdIVFNfU09DS0VUX0lOSEVSSVRJTkdcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2Ugc3RhdHMuaXNGaWxlKCk6XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGZpbGV0eXBlOiBjb25zdGFudHNfMS5XQVNJX0ZJTEVUWVBFX1JFR1VMQVJfRklMRSxcbiAgICAgICAgICAgICAgICByaWdodHNCYXNlOiBjb25zdGFudHNfMS5SSUdIVFNfUkVHVUxBUl9GSUxFX0JBU0UsXG4gICAgICAgICAgICAgICAgcmlnaHRzSW5oZXJpdGluZzogY29uc3RhbnRzXzEuUklHSFRTX1JFR1VMQVJfRklMRV9JTkhFUklUSU5HXG4gICAgICAgICAgICB9O1xuICAgICAgICBjYXNlIHN0YXRzLmlzU29ja2V0KCk6XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGZpbGV0eXBlOiBjb25zdGFudHNfMS5XQVNJX0ZJTEVUWVBFX1NPQ0tFVF9TVFJFQU0sXG4gICAgICAgICAgICAgICAgcmlnaHRzQmFzZTogY29uc3RhbnRzXzEuUklHSFRTX1NPQ0tFVF9CQVNFLFxuICAgICAgICAgICAgICAgIHJpZ2h0c0luaGVyaXRpbmc6IGNvbnN0YW50c18xLlJJR0hUU19TT0NLRVRfSU5IRVJJVElOR1xuICAgICAgICAgICAgfTtcbiAgICAgICAgY2FzZSBzdGF0cy5pc1N5bWJvbGljTGluaygpOlxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBmaWxldHlwZTogY29uc3RhbnRzXzEuV0FTSV9GSUxFVFlQRV9TWU1CT0xJQ19MSU5LLFxuICAgICAgICAgICAgICAgIHJpZ2h0c0Jhc2U6IGJpZ2ludF8xLkJpZ0ludFBvbHlmaWxsKDApLFxuICAgICAgICAgICAgICAgIHJpZ2h0c0luaGVyaXRpbmc6IGJpZ2ludF8xLkJpZ0ludFBvbHlmaWxsKDApXG4gICAgICAgICAgICB9O1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBmaWxldHlwZTogY29uc3RhbnRzXzEuV0FTSV9GSUxFVFlQRV9VTktOT1dOLFxuICAgICAgICAgICAgICAgIHJpZ2h0c0Jhc2U6IGJpZ2ludF8xLkJpZ0ludFBvbHlmaWxsKDApLFxuICAgICAgICAgICAgICAgIHJpZ2h0c0luaGVyaXRpbmc6IGJpZ2ludF8xLkJpZ0ludFBvbHlmaWxsKDApXG4gICAgICAgICAgICB9O1xuICAgIH1cbn07XG52YXIgV0FTSUVycm9yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhXQVNJRXJyb3IsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gV0FTSUVycm9yKGVycm5vKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmVycm5vID0gZXJybm87XG4gICAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihfdGhpcywgV0FTSUVycm9yLnByb3RvdHlwZSk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgcmV0dXJuIFdBU0lFcnJvcjtcbn0oRXJyb3IpKTtcbmV4cG9ydHMuV0FTSUVycm9yID0gV0FTSUVycm9yO1xudmFyIFdBU0lFeGl0RXJyb3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFdBU0lFeGl0RXJyb3IsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gV0FTSUV4aXRFcnJvcihjb2RlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIFwiV0FTSSBFeGl0IGVycm9yOiBcIi5jb25jYXQoY29kZSkpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmNvZGUgPSBjb2RlO1xuICAgICAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YoX3RoaXMsIFdBU0lFeGl0RXJyb3IucHJvdG90eXBlKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICByZXR1cm4gV0FTSUV4aXRFcnJvcjtcbn0oRXJyb3IpKTtcbmV4cG9ydHMuV0FTSUV4aXRFcnJvciA9IFdBU0lFeGl0RXJyb3I7XG52YXIgV0FTSUtpbGxFcnJvciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoV0FTSUtpbGxFcnJvciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBXQVNJS2lsbEVycm9yKHNpZ25hbCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBcIldBU0kgS2lsbCBzaWduYWw6IFwiLmNvbmNhdChzaWduYWwpKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5zaWduYWwgPSBzaWduYWw7XG4gICAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihfdGhpcywgV0FTSUtpbGxFcnJvci5wcm90b3R5cGUpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIHJldHVybiBXQVNJS2lsbEVycm9yO1xufShFcnJvcikpO1xuZXhwb3J0cy5XQVNJS2lsbEVycm9yID0gV0FTSUtpbGxFcnJvcjtcbnZhciBXQVNJRGVmYXVsdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBXQVNJRGVmYXVsdCh3YXNpQ29uZmlnKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIC8vIERlc3RydWN0dXJlIG91ciB3YXNpQ29uZmlnXG4gICAgICAgIHZhciBwcmVvcGVucyA9IHt9O1xuICAgICAgICBpZiAod2FzaUNvbmZpZyAmJiB3YXNpQ29uZmlnLnByZW9wZW5zKSB7XG4gICAgICAgICAgICBwcmVvcGVucyA9IHdhc2lDb25maWcucHJlb3BlbnM7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAod2FzaUNvbmZpZyAmJiB3YXNpQ29uZmlnLnByZW9wZW5EaXJlY3Rvcmllcykge1xuICAgICAgICAgICAgcHJlb3BlbnMgPSB3YXNpQ29uZmlnXG4gICAgICAgICAgICAgICAgLnByZW9wZW5EaXJlY3RvcmllcztcbiAgICAgICAgfVxuICAgICAgICB2YXIgZW52ID0ge307XG4gICAgICAgIGlmICh3YXNpQ29uZmlnICYmIHdhc2lDb25maWcuZW52KSB7XG4gICAgICAgICAgICBlbnYgPSB3YXNpQ29uZmlnLmVudjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICBpZiAod2FzaUNvbmZpZyAmJiB3YXNpQ29uZmlnLmFyZ3MpIHtcbiAgICAgICAgICAgIGFyZ3MgPSB3YXNpQ29uZmlnLmFyZ3M7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGJpbmRpbmdzID0gZGVmYXVsdEJpbmRpbmdzO1xuICAgICAgICBpZiAod2FzaUNvbmZpZyAmJiB3YXNpQ29uZmlnLmJpbmRpbmdzKSB7XG4gICAgICAgICAgICBiaW5kaW5ncyA9IHdhc2lDb25maWcuYmluZGluZ3M7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICB0aGlzLm1lbW9yeSA9IHVuZGVmaW5lZDtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICB0aGlzLnZpZXcgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuYmluZGluZ3MgPSBiaW5kaW5ncztcbiAgICAgICAgdGhpcy5GRF9NQVAgPSBuZXcgTWFwKFtcbiAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICBjb25zdGFudHNfMS5XQVNJX1NURElOX0ZJTEVOTyxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHJlYWw6IDAsXG4gICAgICAgICAgICAgICAgICAgIGZpbGV0eXBlOiBjb25zdGFudHNfMS5XQVNJX0ZJTEVUWVBFX0NIQVJBQ1RFUl9ERVZJQ0UsXG4gICAgICAgICAgICAgICAgICAgIC8vIG9mZnNldDogQmlnSW50KDApLFxuICAgICAgICAgICAgICAgICAgICByaWdodHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhc2U6IFNURElOX0RFRkFVTFRfUklHSFRTLFxuICAgICAgICAgICAgICAgICAgICAgICAgaW5oZXJpdGluZzogYmlnaW50XzEuQmlnSW50UG9seWZpbGwoMClcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgcGF0aDogdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICBjb25zdGFudHNfMS5XQVNJX1NURE9VVF9GSUxFTk8sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICByZWFsOiAxLFxuICAgICAgICAgICAgICAgICAgICBmaWxldHlwZTogY29uc3RhbnRzXzEuV0FTSV9GSUxFVFlQRV9DSEFSQUNURVJfREVWSUNFLFxuICAgICAgICAgICAgICAgICAgICAvLyBvZmZzZXQ6IEJpZ0ludCgwKSxcbiAgICAgICAgICAgICAgICAgICAgcmlnaHRzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBiYXNlOiBTVERPVVRfREVGQVVMVF9SSUdIVFMsXG4gICAgICAgICAgICAgICAgICAgICAgICBpbmhlcml0aW5nOiBiaWdpbnRfMS5CaWdJbnRQb2x5ZmlsbCgwKVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBwYXRoOiB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgIGNvbnN0YW50c18xLldBU0lfU1RERVJSX0ZJTEVOTyxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHJlYWw6IDIsXG4gICAgICAgICAgICAgICAgICAgIGZpbGV0eXBlOiBjb25zdGFudHNfMS5XQVNJX0ZJTEVUWVBFX0NIQVJBQ1RFUl9ERVZJQ0UsXG4gICAgICAgICAgICAgICAgICAgIC8vIG9mZnNldDogQmlnSW50KDApLFxuICAgICAgICAgICAgICAgICAgICByaWdodHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhc2U6IFNUREVSUl9ERUZBVUxUX1JJR0hUUyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGluaGVyaXRpbmc6IGJpZ2ludF8xLkJpZ0ludFBvbHlmaWxsKDApXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHBhdGg6IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF1cbiAgICAgICAgXSk7XG4gICAgICAgIHZhciBmcyA9IHRoaXMuYmluZGluZ3MuZnM7XG4gICAgICAgIHZhciBwYXRoID0gdGhpcy5iaW5kaW5ncy5wYXRoO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gT2JqZWN0LmVudHJpZXMocHJlb3BlbnMpOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIF9iID0gX2FbX2ldLCBrID0gX2JbMF0sIHYgPSBfYlsxXTtcbiAgICAgICAgICAgIHZhciByZWFsID0gZnMub3BlblN5bmModiwgZnMuY29uc3RhbnRzLk9fUkRPTkxZKTtcbiAgICAgICAgICAgIHZhciBuZXdmZCA9IF9fc3ByZWFkQXJyYXkoW10sIHRoaXMuRkRfTUFQLmtleXMoKSwgdHJ1ZSkucmV2ZXJzZSgpWzBdICsgMTtcbiAgICAgICAgICAgIHRoaXMuRkRfTUFQLnNldChuZXdmZCwge1xuICAgICAgICAgICAgICAgIHJlYWw6IHJlYWwsXG4gICAgICAgICAgICAgICAgZmlsZXR5cGU6IGNvbnN0YW50c18xLldBU0lfRklMRVRZUEVfRElSRUNUT1JZLFxuICAgICAgICAgICAgICAgIC8vIG9mZnNldDogQmlnSW50KDApLFxuICAgICAgICAgICAgICAgIHJpZ2h0czoge1xuICAgICAgICAgICAgICAgICAgICBiYXNlOiBjb25zdGFudHNfMS5SSUdIVFNfRElSRUNUT1JZX0JBU0UsXG4gICAgICAgICAgICAgICAgICAgIGluaGVyaXRpbmc6IGNvbnN0YW50c18xLlJJR0hUU19ESVJFQ1RPUllfSU5IRVJJVElOR1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZmFrZVBhdGg6IGssXG4gICAgICAgICAgICAgICAgcGF0aDogdlxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGdldGlvdnMgPSBmdW5jdGlvbiAoaW92cywgaW92c0xlbikge1xuICAgICAgICAgICAgLy8gaW92cyogLT4gW2lvdiwgaW92LCAuLi5dXG4gICAgICAgICAgICAvLyBfX3dhc2lfY2lvdmVjX3Qge1xuICAgICAgICAgICAgLy8gICB2b2lkKiBidWYsXG4gICAgICAgICAgICAvLyAgIHNpemVfdCBidWZfbGVuLFxuICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgX3RoaXMucmVmcmVzaE1lbW9yeSgpO1xuICAgICAgICAgICAgdmFyIGJ1ZmZlcnMgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiBpb3ZzTGVuIH0sIGZ1bmN0aW9uIChfLCBpKSB7XG4gICAgICAgICAgICAgICAgdmFyIHB0ciA9IGlvdnMgKyBpICogODtcbiAgICAgICAgICAgICAgICB2YXIgYnVmID0gX3RoaXMudmlldy5nZXRVaW50MzIocHRyLCB0cnVlKTtcbiAgICAgICAgICAgICAgICB2YXIgYnVmTGVuID0gX3RoaXMudmlldy5nZXRVaW50MzIocHRyICsgNCwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KF90aGlzLm1lbW9yeS5idWZmZXIsIGJ1ZiwgYnVmTGVuKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGJ1ZmZlcnM7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBDSEVDS19GRCA9IGZ1bmN0aW9uIChmZCwgcmlnaHRzKSB7XG4gICAgICAgICAgICB2YXIgc3RhdHMgPSBzdGF0KF90aGlzLCBmZCk7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhgQ0hFQ0tfRkQ6IHN0YXRzLnJlYWw6ICR7c3RhdHMucmVhbH0sIHN0YXRzLnBhdGg6YCwgc3RhdHMucGF0aCk7XG4gICAgICAgICAgICBpZiAocmlnaHRzICE9PSBiaWdpbnRfMS5CaWdJbnRQb2x5ZmlsbCgwKSAmJiAoc3RhdHMucmlnaHRzLmJhc2UgJiByaWdodHMpID09PSBiaWdpbnRfMS5CaWdJbnRQb2x5ZmlsbCgwKSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBXQVNJRXJyb3IoY29uc3RhbnRzXzEuV0FTSV9FUEVSTSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gc3RhdHM7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBDUFVUSU1FX1NUQVJUID0gYmluZGluZ3MuaHJ0aW1lKCk7XG4gICAgICAgIHZhciBub3cgPSBmdW5jdGlvbiAoY2xvY2tJZCkge1xuICAgICAgICAgICAgc3dpdGNoIChjbG9ja0lkKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBjb25zdGFudHNfMS5XQVNJX0NMT0NLX01PTk9UT05JQzpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGJpbmRpbmdzLmhydGltZSgpO1xuICAgICAgICAgICAgICAgIGNhc2UgY29uc3RhbnRzXzEuV0FTSV9DTE9DS19SRUFMVElNRTpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1zVG9OcyhEYXRlLm5vdygpKTtcbiAgICAgICAgICAgICAgICBjYXNlIGNvbnN0YW50c18xLldBU0lfQ0xPQ0tfUFJPQ0VTU19DUFVUSU1FX0lEOlxuICAgICAgICAgICAgICAgIGNhc2UgY29uc3RhbnRzXzEuV0FTSV9DTE9DS19USFJFQURfQ1BVVElNRV9JRDpcbiAgICAgICAgICAgICAgICAgICAgLy8gcmV0dXJuIGJpbmRpbmdzLmhydGltZShDUFVUSU1FX1NUQVJUKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYmluZGluZ3MuaHJ0aW1lKCkgLSBDUFVUSU1FX1NUQVJUO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLndhc2lJbXBvcnQgPSB7XG4gICAgICAgICAgICBhcmdzX2dldDogZnVuY3Rpb24gKGFyZ3YsIGFyZ3ZCdWYpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5yZWZyZXNoTWVtb3J5KCk7XG4gICAgICAgICAgICAgICAgdmFyIGNvZmZzZXQgPSBhcmd2O1xuICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSBhcmd2QnVmO1xuICAgICAgICAgICAgICAgIGFyZ3MuZm9yRWFjaChmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy52aWV3LnNldFVpbnQzMihjb2Zmc2V0LCBvZmZzZXQsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICBjb2Zmc2V0ICs9IDQ7XG4gICAgICAgICAgICAgICAgICAgIG9mZnNldCArPSBidWZmZXJfMS5kZWZhdWx0LmZyb20oX3RoaXMubWVtb3J5LmJ1ZmZlcikud3JpdGUoXCJcIi5jb25jYXQoYSwgXCJcXDBcIiksIG9mZnNldCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbnN0YW50c18xLldBU0lfRVNVQ0NFU1M7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYXJnc19zaXplc19nZXQ6IGZ1bmN0aW9uIChhcmdjLCBhcmd2QnVmU2l6ZSkge1xuICAgICAgICAgICAgICAgIF90aGlzLnJlZnJlc2hNZW1vcnkoKTtcbiAgICAgICAgICAgICAgICBfdGhpcy52aWV3LnNldFVpbnQzMihhcmdjLCBhcmdzLmxlbmd0aCwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgdmFyIHNpemUgPSBhcmdzLnJlZHVjZShmdW5jdGlvbiAoYWNjLCBhKSB7IHJldHVybiBhY2MgKyBidWZmZXJfMS5kZWZhdWx0LmJ5dGVMZW5ndGgoYSkgKyAxOyB9LCAwKTtcbiAgICAgICAgICAgICAgICBfdGhpcy52aWV3LnNldFVpbnQzMihhcmd2QnVmU2l6ZSwgc2l6ZSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbnN0YW50c18xLldBU0lfRVNVQ0NFU1M7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZW52aXJvbl9nZXQ6IGZ1bmN0aW9uIChlbnZpcm9uLCBlbnZpcm9uQnVmKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMucmVmcmVzaE1lbW9yeSgpO1xuICAgICAgICAgICAgICAgIHZhciBjb2Zmc2V0ID0gZW52aXJvbjtcbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gZW52aXJvbkJ1ZjtcbiAgICAgICAgICAgICAgICBPYmplY3QuZW50cmllcyhlbnYpLmZvckVhY2goZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBrZXkgPSBfYVswXSwgdmFsdWUgPSBfYVsxXTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMudmlldy5zZXRVaW50MzIoY29mZnNldCwgb2Zmc2V0LCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgY29mZnNldCArPSA0O1xuICAgICAgICAgICAgICAgICAgICBvZmZzZXQgKz0gYnVmZmVyXzEuZGVmYXVsdC5mcm9tKF90aGlzLm1lbW9yeS5idWZmZXIpLndyaXRlKFwiXCIuY29uY2F0KGtleSwgXCI9XCIpLmNvbmNhdCh2YWx1ZSwgXCJcXDBcIiksIG9mZnNldCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbnN0YW50c18xLldBU0lfRVNVQ0NFU1M7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZW52aXJvbl9zaXplc19nZXQ6IGZ1bmN0aW9uIChlbnZpcm9uQ291bnQsIGVudmlyb25CdWZTaXplKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMucmVmcmVzaE1lbW9yeSgpO1xuICAgICAgICAgICAgICAgIHZhciBlbnZQcm9jZXNzZWQgPSBPYmplY3QuZW50cmllcyhlbnYpLm1hcChmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGtleSA9IF9hWzBdLCB2YWx1ZSA9IF9hWzFdO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJcIi5jb25jYXQoa2V5LCBcIj1cIikuY29uY2F0KHZhbHVlLCBcIlxcMFwiKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB2YXIgc2l6ZSA9IGVudlByb2Nlc3NlZC5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgZSkgeyByZXR1cm4gYWNjICsgYnVmZmVyXzEuZGVmYXVsdC5ieXRlTGVuZ3RoKGUpOyB9LCAwKTtcbiAgICAgICAgICAgICAgICBfdGhpcy52aWV3LnNldFVpbnQzMihlbnZpcm9uQ291bnQsIGVudlByb2Nlc3NlZC5sZW5ndGgsIHRydWUpO1xuICAgICAgICAgICAgICAgIF90aGlzLnZpZXcuc2V0VWludDMyKGVudmlyb25CdWZTaXplLCBzaXplLCB0cnVlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29uc3RhbnRzXzEuV0FTSV9FU1VDQ0VTUztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjbG9ja19yZXNfZ2V0OiBmdW5jdGlvbiAoY2xvY2tJZCwgcmVzb2x1dGlvbikge1xuICAgICAgICAgICAgICAgIHZhciByZXM7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChjbG9ja0lkKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgY29uc3RhbnRzXzEuV0FTSV9DTE9DS19NT05PVE9OSUM6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgY29uc3RhbnRzXzEuV0FTSV9DTE9DS19QUk9DRVNTX0NQVVRJTUVfSUQ6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgY29uc3RhbnRzXzEuV0FTSV9DTE9DS19USFJFQURfQ1BVVElNRV9JRDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gYmlnaW50XzEuQmlnSW50UG9seWZpbGwoMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXNlIGNvbnN0YW50c18xLldBU0lfQ0xPQ0tfUkVBTFRJTUU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IGJpZ2ludF8xLkJpZ0ludFBvbHlmaWxsKDEwMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgX3RoaXMudmlldy5zZXRCaWdVaW50NjQocmVzb2x1dGlvbiwgcmVzKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29uc3RhbnRzXzEuV0FTSV9FU1VDQ0VTUztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjbG9ja190aW1lX2dldDogZnVuY3Rpb24gKGNsb2NrSWQsIHByZWNpc2lvbiwgdGltZSkge1xuICAgICAgICAgICAgICAgIF90aGlzLnJlZnJlc2hNZW1vcnkoKTtcbiAgICAgICAgICAgICAgICB2YXIgbiA9IG5vdyhjbG9ja0lkKTtcbiAgICAgICAgICAgICAgICBpZiAobiA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29uc3RhbnRzXzEuV0FTSV9FSU5WQUw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF90aGlzLnZpZXcuc2V0QmlnVWludDY0KHRpbWUsIGJpZ2ludF8xLkJpZ0ludFBvbHlmaWxsKG4pLCB0cnVlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29uc3RhbnRzXzEuV0FTSV9FU1VDQ0VTUztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBmZF9hZHZpc2U6IHdyYXAoZnVuY3Rpb24gKGZkLCBvZmZzZXQsIGxlbiwgYWR2aWNlKSB7XG4gICAgICAgICAgICAgICAgQ0hFQ0tfRkQoZmQsIGNvbnN0YW50c18xLldBU0lfUklHSFRfRkRfQURWSVNFKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29uc3RhbnRzXzEuV0FTSV9FTk9TWVM7XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIGZkX2FsbG9jYXRlOiB3cmFwKGZ1bmN0aW9uIChmZCwgb2Zmc2V0LCBsZW4pIHtcbiAgICAgICAgICAgICAgICBDSEVDS19GRChmZCwgY29uc3RhbnRzXzEuV0FTSV9SSUdIVF9GRF9BTExPQ0FURSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbnN0YW50c18xLldBU0lfRU5PU1lTO1xuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBmZF9jbG9zZTogd3JhcChmdW5jdGlvbiAoZmQpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3RhdHMgPSBDSEVDS19GRChmZCwgYmlnaW50XzEuQmlnSW50UG9seWZpbGwoMCkpO1xuICAgICAgICAgICAgICAgIGZzLmNsb3NlU3luYyhzdGF0cy5yZWFsKTtcbiAgICAgICAgICAgICAgICBfdGhpcy5GRF9NQVAuZGVsZXRlKGZkKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29uc3RhbnRzXzEuV0FTSV9FU1VDQ0VTUztcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgZmRfZGF0YXN5bmM6IHdyYXAoZnVuY3Rpb24gKGZkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRzID0gQ0hFQ0tfRkQoZmQsIGNvbnN0YW50c18xLldBU0lfUklHSFRfRkRfREFUQVNZTkMpO1xuICAgICAgICAgICAgICAgIGZzLmZkYXRhc3luY1N5bmMoc3RhdHMucmVhbCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbnN0YW50c18xLldBU0lfRVNVQ0NFU1M7XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIGZkX2Zkc3RhdF9nZXQ6IHdyYXAoZnVuY3Rpb24gKGZkLCBidWZQdHIpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3RhdHMgPSBDSEVDS19GRChmZCwgYmlnaW50XzEuQmlnSW50UG9seWZpbGwoMCkpO1xuICAgICAgICAgICAgICAgIF90aGlzLnJlZnJlc2hNZW1vcnkoKTtcbiAgICAgICAgICAgICAgICBfdGhpcy52aWV3LnNldFVpbnQ4KGJ1ZlB0ciwgc3RhdHMuZmlsZXR5cGUpOyAvLyBGSUxFVFlQRSB1OFxuICAgICAgICAgICAgICAgIF90aGlzLnZpZXcuc2V0VWludDE2KGJ1ZlB0ciArIDIsIDAsIHRydWUpOyAvLyBGREZMQUcgdTE2XG4gICAgICAgICAgICAgICAgX3RoaXMudmlldy5zZXRVaW50MTYoYnVmUHRyICsgNCwgMCwgdHJ1ZSk7IC8vIEZERkxBRyB1MTZcbiAgICAgICAgICAgICAgICBfdGhpcy52aWV3LnNldEJpZ1VpbnQ2NChidWZQdHIgKyA4LCBiaWdpbnRfMS5CaWdJbnRQb2x5ZmlsbChzdGF0cy5yaWdodHMuYmFzZSksIHRydWUpOyAvLyB1NjRcbiAgICAgICAgICAgICAgICBfdGhpcy52aWV3LnNldEJpZ1VpbnQ2NChidWZQdHIgKyA4ICsgOCwgYmlnaW50XzEuQmlnSW50UG9seWZpbGwoc3RhdHMucmlnaHRzLmluaGVyaXRpbmcpLCB0cnVlKTsgLy8gdTY0XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbnN0YW50c18xLldBU0lfRVNVQ0NFU1M7XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIGZkX2Zkc3RhdF9zZXRfZmxhZ3M6IHdyYXAoZnVuY3Rpb24gKGZkLCBmbGFncykge1xuICAgICAgICAgICAgICAgIENIRUNLX0ZEKGZkLCBjb25zdGFudHNfMS5XQVNJX1JJR0hUX0ZEX0ZEU1RBVF9TRVRfRkxBR1MpO1xuICAgICAgICAgICAgICAgIHJldHVybiBjb25zdGFudHNfMS5XQVNJX0VOT1NZUztcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgZmRfZmRzdGF0X3NldF9yaWdodHM6IHdyYXAoZnVuY3Rpb24gKGZkLCBmc1JpZ2h0c0Jhc2UsIGZzUmlnaHRzSW5oZXJpdGluZykge1xuICAgICAgICAgICAgICAgIHZhciBzdGF0cyA9IENIRUNLX0ZEKGZkLCBiaWdpbnRfMS5CaWdJbnRQb2x5ZmlsbCgwKSk7XG4gICAgICAgICAgICAgICAgdmFyIG5yYiA9IHN0YXRzLnJpZ2h0cy5iYXNlIHwgZnNSaWdodHNCYXNlO1xuICAgICAgICAgICAgICAgIGlmIChucmIgPiBzdGF0cy5yaWdodHMuYmFzZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29uc3RhbnRzXzEuV0FTSV9FUEVSTTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG5yaSA9IHN0YXRzLnJpZ2h0cy5pbmhlcml0aW5nIHwgZnNSaWdodHNJbmhlcml0aW5nO1xuICAgICAgICAgICAgICAgIGlmIChucmkgPiBzdGF0cy5yaWdodHMuaW5oZXJpdGluZykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29uc3RhbnRzXzEuV0FTSV9FUEVSTTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3RhdHMucmlnaHRzLmJhc2UgPSBmc1JpZ2h0c0Jhc2U7XG4gICAgICAgICAgICAgICAgc3RhdHMucmlnaHRzLmluaGVyaXRpbmcgPSBmc1JpZ2h0c0luaGVyaXRpbmc7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbnN0YW50c18xLldBU0lfRVNVQ0NFU1M7XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIGZkX2ZpbGVzdGF0X2dldDogd3JhcChmdW5jdGlvbiAoZmQsIGJ1ZlB0cikge1xuICAgICAgICAgICAgICAgIHZhciBzdGF0cyA9IENIRUNLX0ZEKGZkLCBjb25zdGFudHNfMS5XQVNJX1JJR0hUX0ZEX0ZJTEVTVEFUX0dFVCk7XG4gICAgICAgICAgICAgICAgdmFyIHJzdGF0cyA9IGZzLmZzdGF0U3luYyhzdGF0cy5yZWFsKTtcbiAgICAgICAgICAgICAgICBfdGhpcy5yZWZyZXNoTWVtb3J5KCk7XG4gICAgICAgICAgICAgICAgX3RoaXMudmlldy5zZXRCaWdVaW50NjQoYnVmUHRyLCBiaWdpbnRfMS5CaWdJbnRQb2x5ZmlsbChyc3RhdHMuZGV2KSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgYnVmUHRyICs9IDg7XG4gICAgICAgICAgICAgICAgX3RoaXMudmlldy5zZXRCaWdVaW50NjQoYnVmUHRyLCBiaWdpbnRfMS5CaWdJbnRQb2x5ZmlsbChyc3RhdHMuaW5vKSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgYnVmUHRyICs9IDg7XG4gICAgICAgICAgICAgICAgX3RoaXMudmlldy5zZXRVaW50OChidWZQdHIsIHN0YXRzLmZpbGV0eXBlKTtcbiAgICAgICAgICAgICAgICBidWZQdHIgKz0gODtcbiAgICAgICAgICAgICAgICBfdGhpcy52aWV3LnNldEJpZ1VpbnQ2NChidWZQdHIsIGJpZ2ludF8xLkJpZ0ludFBvbHlmaWxsKHJzdGF0cy5ubGluayksIHRydWUpO1xuICAgICAgICAgICAgICAgIGJ1ZlB0ciArPSA4O1xuICAgICAgICAgICAgICAgIF90aGlzLnZpZXcuc2V0QmlnVWludDY0KGJ1ZlB0ciwgYmlnaW50XzEuQmlnSW50UG9seWZpbGwocnN0YXRzLnNpemUpLCB0cnVlKTtcbiAgICAgICAgICAgICAgICBidWZQdHIgKz0gODtcbiAgICAgICAgICAgICAgICBfdGhpcy52aWV3LnNldEJpZ1VpbnQ2NChidWZQdHIsIG1zVG9Ocyhyc3RhdHMuYXRpbWVNcyksIHRydWUpO1xuICAgICAgICAgICAgICAgIGJ1ZlB0ciArPSA4O1xuICAgICAgICAgICAgICAgIF90aGlzLnZpZXcuc2V0QmlnVWludDY0KGJ1ZlB0ciwgbXNUb05zKHJzdGF0cy5tdGltZU1zKSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgYnVmUHRyICs9IDg7XG4gICAgICAgICAgICAgICAgX3RoaXMudmlldy5zZXRCaWdVaW50NjQoYnVmUHRyLCBtc1RvTnMocnN0YXRzLmN0aW1lTXMpLCB0cnVlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29uc3RhbnRzXzEuV0FTSV9FU1VDQ0VTUztcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgZmRfZmlsZXN0YXRfc2V0X3NpemU6IHdyYXAoZnVuY3Rpb24gKGZkLCBzdFNpemUpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3RhdHMgPSBDSEVDS19GRChmZCwgY29uc3RhbnRzXzEuV0FTSV9SSUdIVF9GRF9GSUxFU1RBVF9TRVRfU0laRSk7XG4gICAgICAgICAgICAgICAgZnMuZnRydW5jYXRlU3luYyhzdGF0cy5yZWFsLCBOdW1iZXIoc3RTaXplKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbnN0YW50c18xLldBU0lfRVNVQ0NFU1M7XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIGZkX2ZpbGVzdGF0X3NldF90aW1lczogd3JhcChmdW5jdGlvbiAoZmQsIHN0QXRpbSwgc3RNdGltLCBmc3RmbGFncykge1xuICAgICAgICAgICAgICAgIHZhciBzdGF0cyA9IENIRUNLX0ZEKGZkLCBjb25zdGFudHNfMS5XQVNJX1JJR0hUX0ZEX0ZJTEVTVEFUX1NFVF9USU1FUyk7XG4gICAgICAgICAgICAgICAgdmFyIHJzdGF0cyA9IGZzLmZzdGF0U3luYyhzdGF0cy5yZWFsKTtcbiAgICAgICAgICAgICAgICB2YXIgYXRpbSA9IHJzdGF0cy5hdGltZTtcbiAgICAgICAgICAgICAgICB2YXIgbXRpbSA9IHJzdGF0cy5tdGltZTtcbiAgICAgICAgICAgICAgICB2YXIgbiA9IG5zVG9Ncyhub3coY29uc3RhbnRzXzEuV0FTSV9DTE9DS19SRUFMVElNRSkpO1xuICAgICAgICAgICAgICAgIHZhciBhdGltZmxhZ3MgPSBjb25zdGFudHNfMS5XQVNJX0ZJTEVTVEFUX1NFVF9BVElNIHwgY29uc3RhbnRzXzEuV0FTSV9GSUxFU1RBVF9TRVRfQVRJTV9OT1c7XG4gICAgICAgICAgICAgICAgaWYgKChmc3RmbGFncyAmIGF0aW1mbGFncykgPT09IGF0aW1mbGFncykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29uc3RhbnRzXzEuV0FTSV9FSU5WQUw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBtdGltZmxhZ3MgPSBjb25zdGFudHNfMS5XQVNJX0ZJTEVTVEFUX1NFVF9NVElNIHwgY29uc3RhbnRzXzEuV0FTSV9GSUxFU1RBVF9TRVRfTVRJTV9OT1c7XG4gICAgICAgICAgICAgICAgaWYgKChmc3RmbGFncyAmIG10aW1mbGFncykgPT09IG10aW1mbGFncykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29uc3RhbnRzXzEuV0FTSV9FSU5WQUw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICgoZnN0ZmxhZ3MgJiBjb25zdGFudHNfMS5XQVNJX0ZJTEVTVEFUX1NFVF9BVElNKSA9PT0gY29uc3RhbnRzXzEuV0FTSV9GSUxFU1RBVF9TRVRfQVRJTSkge1xuICAgICAgICAgICAgICAgICAgICBhdGltID0gbnNUb01zKHN0QXRpbSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKChmc3RmbGFncyAmIGNvbnN0YW50c18xLldBU0lfRklMRVNUQVRfU0VUX0FUSU1fTk9XKSA9PT0gY29uc3RhbnRzXzEuV0FTSV9GSUxFU1RBVF9TRVRfQVRJTV9OT1cpIHtcbiAgICAgICAgICAgICAgICAgICAgYXRpbSA9IG47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICgoZnN0ZmxhZ3MgJiBjb25zdGFudHNfMS5XQVNJX0ZJTEVTVEFUX1NFVF9NVElNKSA9PT0gY29uc3RhbnRzXzEuV0FTSV9GSUxFU1RBVF9TRVRfTVRJTSkge1xuICAgICAgICAgICAgICAgICAgICBtdGltID0gbnNUb01zKHN0TXRpbSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKChmc3RmbGFncyAmIGNvbnN0YW50c18xLldBU0lfRklMRVNUQVRfU0VUX01USU1fTk9XKSA9PT0gY29uc3RhbnRzXzEuV0FTSV9GSUxFU1RBVF9TRVRfTVRJTV9OT1cpIHtcbiAgICAgICAgICAgICAgICAgICAgbXRpbSA9IG47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZzLmZ1dGltZXNTeW5jKHN0YXRzLnJlYWwsIG5ldyBEYXRlKGF0aW0pLCBuZXcgRGF0ZShtdGltKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbnN0YW50c18xLldBU0lfRVNVQ0NFU1M7XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIGZkX3ByZXN0YXRfZ2V0OiB3cmFwKGZ1bmN0aW9uIChmZCwgYnVmUHRyKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRzID0gQ0hFQ0tfRkQoZmQsIGJpZ2ludF8xLkJpZ0ludFBvbHlmaWxsKDApKTtcbiAgICAgICAgICAgICAgICBpZiAoIXN0YXRzLnBhdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnN0YW50c18xLldBU0lfRUlOVkFMO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfdGhpcy5yZWZyZXNoTWVtb3J5KCk7XG4gICAgICAgICAgICAgICAgX3RoaXMudmlldy5zZXRVaW50OChidWZQdHIsIGNvbnN0YW50c18xLldBU0lfUFJFT1BFTlRZUEVfRElSKTtcbiAgICAgICAgICAgICAgICBfdGhpcy52aWV3LnNldFVpbnQzMihidWZQdHIgKyA0LCBidWZmZXJfMS5kZWZhdWx0LmJ5dGVMZW5ndGgoc3RhdHMuZmFrZVBhdGgpLCB0cnVlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29uc3RhbnRzXzEuV0FTSV9FU1VDQ0VTUztcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgZmRfcHJlc3RhdF9kaXJfbmFtZTogd3JhcChmdW5jdGlvbiAoZmQsIHBhdGhQdHIsIHBhdGhMZW4pIHtcbiAgICAgICAgICAgICAgICB2YXIgc3RhdHMgPSBDSEVDS19GRChmZCwgYmlnaW50XzEuQmlnSW50UG9seWZpbGwoMCkpO1xuICAgICAgICAgICAgICAgIGlmICghc3RhdHMucGF0aCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29uc3RhbnRzXzEuV0FTSV9FSU5WQUw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF90aGlzLnJlZnJlc2hNZW1vcnkoKTtcbiAgICAgICAgICAgICAgICBidWZmZXJfMS5kZWZhdWx0LmZyb20oX3RoaXMubWVtb3J5LmJ1ZmZlcikud3JpdGUoc3RhdHMuZmFrZVBhdGgsIHBhdGhQdHIsIHBhdGhMZW4sIFwidXRmOFwiKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29uc3RhbnRzXzEuV0FTSV9FU1VDQ0VTUztcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgZmRfcHdyaXRlOiB3cmFwKGZ1bmN0aW9uIChmZCwgaW92cywgaW92c0xlbiwgb2Zmc2V0LCBud3JpdHRlbikge1xuICAgICAgICAgICAgICAgIHZhciBzdGF0cyA9IENIRUNLX0ZEKGZkLCBjb25zdGFudHNfMS5XQVNJX1JJR0hUX0ZEX1dSSVRFIHwgY29uc3RhbnRzXzEuV0FTSV9SSUdIVF9GRF9TRUVLKTtcbiAgICAgICAgICAgICAgICB2YXIgd3JpdHRlbiA9IDA7XG4gICAgICAgICAgICAgICAgZ2V0aW92cyhpb3ZzLCBpb3ZzTGVuKS5mb3JFYWNoKGZ1bmN0aW9uIChpb3YpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHcgPSAwO1xuICAgICAgICAgICAgICAgICAgICB3aGlsZSAodyA8IGlvdi5ieXRlTGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3ICs9IGZzLndyaXRlU3luYyhzdGF0cy5yZWFsLCBpb3YsIHcsIGlvdi5ieXRlTGVuZ3RoIC0gdywgTnVtYmVyKG9mZnNldCkgKyB3cml0dGVuICsgdyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgd3JpdHRlbiArPSB3O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIF90aGlzLnZpZXcuc2V0VWludDMyKG53cml0dGVuLCB3cml0dGVuLCB0cnVlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29uc3RhbnRzXzEuV0FTSV9FU1VDQ0VTUztcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgZmRfd3JpdGU6IHdyYXAoZnVuY3Rpb24gKGZkLCBpb3ZzLCBpb3ZzTGVuLCBud3JpdHRlbikge1xuICAgICAgICAgICAgICAgIHZhciBzdGF0cyA9IENIRUNLX0ZEKGZkLCBjb25zdGFudHNfMS5XQVNJX1JJR0hUX0ZEX1dSSVRFKTtcbiAgICAgICAgICAgICAgICB2YXIgd3JpdHRlbiA9IDA7XG4gICAgICAgICAgICAgICAgZ2V0aW92cyhpb3ZzLCBpb3ZzTGVuKS5mb3JFYWNoKGZ1bmN0aW9uIChpb3YpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHcgPSAwO1xuICAgICAgICAgICAgICAgICAgICB3aGlsZSAodyA8IGlvdi5ieXRlTGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IGZzLndyaXRlU3luYyhzdGF0cy5yZWFsLCBpb3YsIHcsIGlvdi5ieXRlTGVuZ3RoIC0gdywgc3RhdHMub2Zmc2V0ID8gTnVtYmVyKHN0YXRzLm9mZnNldCkgOiBudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGF0cy5vZmZzZXQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHMub2Zmc2V0ICs9IGJpZ2ludF8xLkJpZ0ludFBvbHlmaWxsKGkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdyArPSBpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHdyaXR0ZW4gKz0gdztcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBfdGhpcy52aWV3LnNldFVpbnQzMihud3JpdHRlbiwgd3JpdHRlbiwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbnN0YW50c18xLldBU0lfRVNVQ0NFU1M7XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIGZkX3ByZWFkOiB3cmFwKGZ1bmN0aW9uIChmZCwgaW92cywgaW92c0xlbiwgb2Zmc2V0LCBucmVhZCkge1xuICAgICAgICAgICAgICAgIHZhciBzdGF0cyA9IENIRUNLX0ZEKGZkLCBjb25zdGFudHNfMS5XQVNJX1JJR0hUX0ZEX1JFQUQgfCBjb25zdGFudHNfMS5XQVNJX1JJR0hUX0ZEX1NFRUspO1xuICAgICAgICAgICAgICAgIHZhciByZWFkID0gMDtcbiAgICAgICAgICAgICAgICBvdXRlcjogZm9yICh2YXIgX2kgPSAwLCBfYSA9IGdldGlvdnMoaW92cywgaW92c0xlbik7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpb3YgPSBfYVtfaV07XG4gICAgICAgICAgICAgICAgICAgIHZhciByID0gMDtcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHIgPCBpb3YuYnl0ZUxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxlbmd0aF8xID0gaW92LmJ5dGVMZW5ndGggLSByO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJyID0gZnMucmVhZFN5bmMoc3RhdHMucmVhbCwgaW92LCByLCBpb3YuYnl0ZUxlbmd0aCAtIHIsIE51bWJlcihvZmZzZXQpICsgcmVhZCArIHIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgciArPSBycjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlYWQgKz0gcnI7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB3ZSBkb24ndCByZWFkIGFueXRoaW5nLCBvciB3ZSByZWNlaXZlIGxlc3MgdGhhbiByZXF1ZXN0ZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyciA9PT0gMCB8fCByciA8IGxlbmd0aF8xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsgb3V0ZXI7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmVhZCArPSByO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICA7XG4gICAgICAgICAgICAgICAgX3RoaXMudmlldy5zZXRVaW50MzIobnJlYWQsIHJlYWQsIHRydWUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBjb25zdGFudHNfMS5XQVNJX0VTVUNDRVNTO1xuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBmZF9yZWFkOiB3cmFwKGZ1bmN0aW9uIChmZCwgaW92cywgaW92c0xlbiwgbnJlYWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3RhdHMgPSBDSEVDS19GRChmZCwgY29uc3RhbnRzXzEuV0FTSV9SSUdIVF9GRF9SRUFEKTtcbiAgICAgICAgICAgICAgICB2YXIgSVNfU1RESU4gPSBzdGF0cy5yZWFsID09PSAwO1xuICAgICAgICAgICAgICAgIHZhciByZWFkID0gMDtcbiAgICAgICAgICAgICAgICBvdXRlcjogZm9yICh2YXIgX2kgPSAwLCBfYSA9IGdldGlvdnMoaW92cywgaW92c0xlbik7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpb3YgPSBfYVtfaV07XG4gICAgICAgICAgICAgICAgICAgIHZhciByID0gMDtcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHIgPCBpb3YuYnl0ZUxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxlbmd0aF8yID0gaW92LmJ5dGVMZW5ndGggLSByO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBvc2l0aW9uID0gSVNfU1RESU4gfHwgc3RhdHMub2Zmc2V0ID09PSB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IE51bWJlcihzdGF0cy5vZmZzZXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJyID0gZnMucmVhZFN5bmMoc3RhdHMucmVhbCwgLy8gZmRcbiAgICAgICAgICAgICAgICAgICAgICAgIGlvdiwgLy8gYnVmZmVyXG4gICAgICAgICAgICAgICAgICAgICAgICByLCAvLyBvZmZzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgIGxlbmd0aF8yLCAvLyBsZW5ndGhcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uIC8vIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFJU19TVERJTikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRzLm9mZnNldCA9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChzdGF0cy5vZmZzZXQgPyBzdGF0cy5vZmZzZXQgOiBiaWdpbnRfMS5CaWdJbnRQb2x5ZmlsbCgwKSkgKyBiaWdpbnRfMS5CaWdJbnRQb2x5ZmlsbChycik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByICs9IHJyO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVhZCArPSBycjtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIHdlIGRvbid0IHJlYWQgYW55dGhpbmcsIG9yIHdlIHJlY2VpdmUgbGVzcyB0aGFuIHJlcXVlc3RlZFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJyID09PSAwIHx8IHJyIDwgbGVuZ3RoXzIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhayBvdXRlcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBXZSBzaG91bGQgbm90IG1vZGlmeSB0aGUgb2Zmc2V0IG9mIHN0ZGluXG4gICAgICAgICAgICAgICAgX3RoaXMudmlldy5zZXRVaW50MzIobnJlYWQsIHJlYWQsIHRydWUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBjb25zdGFudHNfMS5XQVNJX0VTVUNDRVNTO1xuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBmZF9yZWFkZGlyOiB3cmFwKGZ1bmN0aW9uIChmZCwgYnVmUHRyLCBidWZMZW4sIGNvb2tpZSwgYnVmdXNlZFB0cikge1xuICAgICAgICAgICAgICAgIHZhciBzdGF0cyA9IENIRUNLX0ZEKGZkLCBjb25zdGFudHNfMS5XQVNJX1JJR0hUX0ZEX1JFQURESVIpO1xuICAgICAgICAgICAgICAgIF90aGlzLnJlZnJlc2hNZW1vcnkoKTtcbiAgICAgICAgICAgICAgICB2YXIgZW50cmllcyA9IGZzLnJlYWRkaXJTeW5jKHN0YXRzLnBhdGgsIHsgd2l0aEZpbGVUeXBlczogdHJ1ZSB9KTtcbiAgICAgICAgICAgICAgICB2YXIgc3RhcnRQdHIgPSBidWZQdHI7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IE51bWJlcihjb29raWUpOyBpIDwgZW50cmllcy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZW50cnkgPSBlbnRyaWVzW2ldO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbmFtZUxlbmd0aCA9IGJ1ZmZlcl8xLmRlZmF1bHQuYnl0ZUxlbmd0aChlbnRyeS5uYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGJ1ZlB0ciAtIHN0YXJ0UHRyID4gYnVmTGVuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBfdGhpcy52aWV3LnNldEJpZ1VpbnQ2NChidWZQdHIsIGJpZ2ludF8xLkJpZ0ludFBvbHlmaWxsKGkgKyAxKSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGJ1ZlB0ciArPSA4O1xuICAgICAgICAgICAgICAgICAgICBpZiAoYnVmUHRyIC0gc3RhcnRQdHIgPiBidWZMZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciByc3RhdHMgPSBmcy5zdGF0U3luYyhwYXRoLnJlc29sdmUoc3RhdHMucGF0aCwgZW50cnkubmFtZSkpO1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy52aWV3LnNldEJpZ1VpbnQ2NChidWZQdHIsIGJpZ2ludF8xLkJpZ0ludFBvbHlmaWxsKHJzdGF0cy5pbm8pLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgYnVmUHRyICs9IDg7XG4gICAgICAgICAgICAgICAgICAgIGlmIChidWZQdHIgLSBzdGFydFB0ciA+IGJ1Zkxlbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgX3RoaXMudmlldy5zZXRVaW50MzIoYnVmUHRyLCBuYW1lTGVuZ3RoLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgYnVmUHRyICs9IDQ7XG4gICAgICAgICAgICAgICAgICAgIGlmIChidWZQdHIgLSBzdGFydFB0ciA+IGJ1Zkxlbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIGZpbGV0eXBlID0gdm9pZCAwO1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgcnN0YXRzLmlzQmxvY2tEZXZpY2UoKTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxldHlwZSA9IGNvbnN0YW50c18xLldBU0lfRklMRVRZUEVfQkxPQ0tfREVWSUNFO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSByc3RhdHMuaXNDaGFyYWN0ZXJEZXZpY2UoKTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxldHlwZSA9IGNvbnN0YW50c18xLldBU0lfRklMRVRZUEVfQ0hBUkFDVEVSX0RFVklDRTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgcnN0YXRzLmlzRGlyZWN0b3J5KCk6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZXR5cGUgPSBjb25zdGFudHNfMS5XQVNJX0ZJTEVUWVBFX0RJUkVDVE9SWTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgcnN0YXRzLmlzRklGTygpOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGV0eXBlID0gY29uc3RhbnRzXzEuV0FTSV9GSUxFVFlQRV9TT0NLRVRfU1RSRUFNO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSByc3RhdHMuaXNGaWxlKCk6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZXR5cGUgPSBjb25zdGFudHNfMS5XQVNJX0ZJTEVUWVBFX1JFR1VMQVJfRklMRTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgcnN0YXRzLmlzU29ja2V0KCk6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZXR5cGUgPSBjb25zdGFudHNfMS5XQVNJX0ZJTEVUWVBFX1NPQ0tFVF9TVFJFQU07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIHJzdGF0cy5pc1N5bWJvbGljTGluaygpOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGV0eXBlID0gY29uc3RhbnRzXzEuV0FTSV9GSUxFVFlQRV9TWU1CT0xJQ19MSU5LO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxldHlwZSA9IGNvbnN0YW50c18xLldBU0lfRklMRVRZUEVfVU5LTk9XTjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBfdGhpcy52aWV3LnNldFVpbnQ4KGJ1ZlB0ciwgZmlsZXR5cGUpO1xuICAgICAgICAgICAgICAgICAgICBidWZQdHIgKz0gMTtcbiAgICAgICAgICAgICAgICAgICAgYnVmUHRyICs9IDM7IC8vIHBhZGRpbmdcbiAgICAgICAgICAgICAgICAgICAgaWYgKGJ1ZlB0ciArIG5hbWVMZW5ndGggPj0gc3RhcnRQdHIgKyBidWZMZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEl0IGRvZXNuJ3QgZml0IGluIHRoZSBidWZmZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciBtZW1vcnlfYnVmZmVyID0gYnVmZmVyXzEuZGVmYXVsdC5mcm9tKF90aGlzLm1lbW9yeS5idWZmZXIpO1xuICAgICAgICAgICAgICAgICAgICBtZW1vcnlfYnVmZmVyLndyaXRlKGVudHJ5Lm5hbWUsIGJ1ZlB0cik7XG4gICAgICAgICAgICAgICAgICAgIGJ1ZlB0ciArPSBuYW1lTGVuZ3RoO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgYnVmdXNlZCA9IGJ1ZlB0ciAtIHN0YXJ0UHRyO1xuICAgICAgICAgICAgICAgIF90aGlzLnZpZXcuc2V0VWludDMyKGJ1ZnVzZWRQdHIsIE1hdGgubWluKGJ1ZnVzZWQsIGJ1ZkxlbiksIHRydWUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBjb25zdGFudHNfMS5XQVNJX0VTVUNDRVNTO1xuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBmZF9yZW51bWJlcjogd3JhcChmdW5jdGlvbiAoZnJvbSwgdG8pIHtcbiAgICAgICAgICAgICAgICBDSEVDS19GRChmcm9tLCBiaWdpbnRfMS5CaWdJbnRQb2x5ZmlsbCgwKSk7XG4gICAgICAgICAgICAgICAgQ0hFQ0tfRkQodG8sIGJpZ2ludF8xLkJpZ0ludFBvbHlmaWxsKDApKTtcbiAgICAgICAgICAgICAgICBmcy5jbG9zZVN5bmMoX3RoaXMuRkRfTUFQLmdldChmcm9tKS5yZWFsKTtcbiAgICAgICAgICAgICAgICBfdGhpcy5GRF9NQVAuc2V0KGZyb20sIF90aGlzLkZEX01BUC5nZXQodG8pKTtcbiAgICAgICAgICAgICAgICBfdGhpcy5GRF9NQVAuZGVsZXRlKHRvKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29uc3RhbnRzXzEuV0FTSV9FU1VDQ0VTUztcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgZmRfc2Vlazogd3JhcChmdW5jdGlvbiAoZmQsIG9mZnNldCwgd2hlbmNlLCBuZXdPZmZzZXRQdHIpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3RhdHMgPSBDSEVDS19GRChmZCwgY29uc3RhbnRzXzEuV0FTSV9SSUdIVF9GRF9TRUVLKTtcbiAgICAgICAgICAgICAgICBfdGhpcy5yZWZyZXNoTWVtb3J5KCk7XG4gICAgICAgICAgICAgICAgc3dpdGNoICh3aGVuY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBjb25zdGFudHNfMS5XQVNJX1dIRU5DRV9DVVI6XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0cy5vZmZzZXQgPVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChzdGF0cy5vZmZzZXQgPyBzdGF0cy5vZmZzZXQgOiBiaWdpbnRfMS5CaWdJbnRQb2x5ZmlsbCgwKSkgKyBiaWdpbnRfMS5CaWdJbnRQb2x5ZmlsbChvZmZzZXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgY29uc3RhbnRzXzEuV0FTSV9XSEVOQ0VfRU5EOlxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNpemUgPSBmcy5mc3RhdFN5bmMoc3RhdHMucmVhbCkuc2l6ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRzLm9mZnNldCA9IGJpZ2ludF8xLkJpZ0ludFBvbHlmaWxsKHNpemUpICsgYmlnaW50XzEuQmlnSW50UG9seWZpbGwob2Zmc2V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIGNvbnN0YW50c18xLldBU0lfV0hFTkNFX1NFVDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRzLm9mZnNldCA9IGJpZ2ludF8xLkJpZ0ludFBvbHlmaWxsKG9mZnNldCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgX3RoaXMudmlldy5zZXRCaWdVaW50NjQobmV3T2Zmc2V0UHRyLCBzdGF0cy5vZmZzZXQsIHRydWUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBjb25zdGFudHNfMS5XQVNJX0VTVUNDRVNTO1xuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBmZF90ZWxsOiB3cmFwKGZ1bmN0aW9uIChmZCwgb2Zmc2V0UHRyKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRzID0gQ0hFQ0tfRkQoZmQsIGNvbnN0YW50c18xLldBU0lfUklHSFRfRkRfVEVMTCk7XG4gICAgICAgICAgICAgICAgX3RoaXMucmVmcmVzaE1lbW9yeSgpO1xuICAgICAgICAgICAgICAgIGlmICghc3RhdHMub2Zmc2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRzLm9mZnNldCA9IGJpZ2ludF8xLkJpZ0ludFBvbHlmaWxsKDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfdGhpcy52aWV3LnNldEJpZ1VpbnQ2NChvZmZzZXRQdHIsIHN0YXRzLm9mZnNldCwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbnN0YW50c18xLldBU0lfRVNVQ0NFU1M7XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIGZkX3N5bmM6IHdyYXAoZnVuY3Rpb24gKGZkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRzID0gQ0hFQ0tfRkQoZmQsIGNvbnN0YW50c18xLldBU0lfUklHSFRfRkRfU1lOQyk7XG4gICAgICAgICAgICAgICAgZnMuZnN5bmNTeW5jKHN0YXRzLnJlYWwpO1xuICAgICAgICAgICAgICAgIHJldHVybiBjb25zdGFudHNfMS5XQVNJX0VTVUNDRVNTO1xuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBwYXRoX2NyZWF0ZV9kaXJlY3Rvcnk6IHdyYXAoZnVuY3Rpb24gKGZkLCBwYXRoUHRyLCBwYXRoTGVuKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRzID0gQ0hFQ0tfRkQoZmQsIGNvbnN0YW50c18xLldBU0lfUklHSFRfUEFUSF9DUkVBVEVfRElSRUNUT1JZKTtcbiAgICAgICAgICAgICAgICBpZiAoIXN0YXRzLnBhdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnN0YW50c18xLldBU0lfRUlOVkFMO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfdGhpcy5yZWZyZXNoTWVtb3J5KCk7XG4gICAgICAgICAgICAgICAgdmFyIHAgPSBidWZmZXJfMS5kZWZhdWx0LmZyb20oX3RoaXMubWVtb3J5LmJ1ZmZlciwgcGF0aFB0ciwgcGF0aExlbikudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICBmcy5ta2RpclN5bmMocGF0aC5yZXNvbHZlKHN0YXRzLnBhdGgsIHApKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29uc3RhbnRzXzEuV0FTSV9FU1VDQ0VTUztcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgcGF0aF9maWxlc3RhdF9nZXQ6IHdyYXAoZnVuY3Rpb24gKGZkLCBmbGFncywgcGF0aFB0ciwgcGF0aExlbiwgYnVmUHRyKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRzID0gQ0hFQ0tfRkQoZmQsIGNvbnN0YW50c18xLldBU0lfUklHSFRfUEFUSF9GSUxFU1RBVF9HRVQpO1xuICAgICAgICAgICAgICAgIGlmICghc3RhdHMucGF0aCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29uc3RhbnRzXzEuV0FTSV9FSU5WQUw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF90aGlzLnJlZnJlc2hNZW1vcnkoKTtcbiAgICAgICAgICAgICAgICB2YXIgcCA9IGJ1ZmZlcl8xLmRlZmF1bHQuZnJvbShfdGhpcy5tZW1vcnkuYnVmZmVyLCBwYXRoUHRyLCBwYXRoTGVuKS50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgIHZhciByc3RhdHMgPSBmcy5zdGF0U3luYyhwYXRoLnJlc29sdmUoc3RhdHMucGF0aCwgcCkpO1xuICAgICAgICAgICAgICAgIF90aGlzLnZpZXcuc2V0QmlnVWludDY0KGJ1ZlB0ciwgYmlnaW50XzEuQmlnSW50UG9seWZpbGwocnN0YXRzLmRldiksIHRydWUpO1xuICAgICAgICAgICAgICAgIGJ1ZlB0ciArPSA4O1xuICAgICAgICAgICAgICAgIF90aGlzLnZpZXcuc2V0QmlnVWludDY0KGJ1ZlB0ciwgYmlnaW50XzEuQmlnSW50UG9seWZpbGwocnN0YXRzLmlubyksIHRydWUpO1xuICAgICAgICAgICAgICAgIGJ1ZlB0ciArPSA4O1xuICAgICAgICAgICAgICAgIF90aGlzLnZpZXcuc2V0VWludDgoYnVmUHRyLCB0cmFuc2xhdGVGaWxlQXR0cmlidXRlcyhfdGhpcywgdW5kZWZpbmVkLCByc3RhdHMpLmZpbGV0eXBlKTtcbiAgICAgICAgICAgICAgICBidWZQdHIgKz0gODtcbiAgICAgICAgICAgICAgICBfdGhpcy52aWV3LnNldEJpZ1VpbnQ2NChidWZQdHIsIGJpZ2ludF8xLkJpZ0ludFBvbHlmaWxsKHJzdGF0cy5ubGluayksIHRydWUpO1xuICAgICAgICAgICAgICAgIGJ1ZlB0ciArPSA4O1xuICAgICAgICAgICAgICAgIF90aGlzLnZpZXcuc2V0QmlnVWludDY0KGJ1ZlB0ciwgYmlnaW50XzEuQmlnSW50UG9seWZpbGwocnN0YXRzLnNpemUpLCB0cnVlKTtcbiAgICAgICAgICAgICAgICBidWZQdHIgKz0gODtcbiAgICAgICAgICAgICAgICBfdGhpcy52aWV3LnNldEJpZ1VpbnQ2NChidWZQdHIsIG1zVG9Ocyhyc3RhdHMuYXRpbWVNcyksIHRydWUpO1xuICAgICAgICAgICAgICAgIGJ1ZlB0ciArPSA4O1xuICAgICAgICAgICAgICAgIF90aGlzLnZpZXcuc2V0QmlnVWludDY0KGJ1ZlB0ciwgbXNUb05zKHJzdGF0cy5tdGltZU1zKSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgYnVmUHRyICs9IDg7XG4gICAgICAgICAgICAgICAgX3RoaXMudmlldy5zZXRCaWdVaW50NjQoYnVmUHRyLCBtc1RvTnMocnN0YXRzLmN0aW1lTXMpLCB0cnVlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29uc3RhbnRzXzEuV0FTSV9FU1VDQ0VTUztcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgcGF0aF9maWxlc3RhdF9zZXRfdGltZXM6IHdyYXAoZnVuY3Rpb24gKGZkLCBkaXJmbGFncywgcGF0aFB0ciwgcGF0aExlbiwgc3RBdGltLCBzdE10aW0sIGZzdGZsYWdzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRzID0gQ0hFQ0tfRkQoZmQsIGNvbnN0YW50c18xLldBU0lfUklHSFRfUEFUSF9GSUxFU1RBVF9TRVRfVElNRVMpO1xuICAgICAgICAgICAgICAgIGlmICghc3RhdHMucGF0aCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29uc3RhbnRzXzEuV0FTSV9FSU5WQUw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF90aGlzLnJlZnJlc2hNZW1vcnkoKTtcbiAgICAgICAgICAgICAgICB2YXIgcnN0YXRzID0gZnMuZnN0YXRTeW5jKHN0YXRzLnJlYWwpO1xuICAgICAgICAgICAgICAgIHZhciBhdGltID0gcnN0YXRzLmF0aW1lO1xuICAgICAgICAgICAgICAgIHZhciBtdGltID0gcnN0YXRzLm10aW1lO1xuICAgICAgICAgICAgICAgIHZhciBuID0gbnNUb01zKG5vdyhjb25zdGFudHNfMS5XQVNJX0NMT0NLX1JFQUxUSU1FKSk7XG4gICAgICAgICAgICAgICAgdmFyIGF0aW1mbGFncyA9IGNvbnN0YW50c18xLldBU0lfRklMRVNUQVRfU0VUX0FUSU0gfCBjb25zdGFudHNfMS5XQVNJX0ZJTEVTVEFUX1NFVF9BVElNX05PVztcbiAgICAgICAgICAgICAgICBpZiAoKGZzdGZsYWdzICYgYXRpbWZsYWdzKSA9PT0gYXRpbWZsYWdzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb25zdGFudHNfMS5XQVNJX0VJTlZBTDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG10aW1mbGFncyA9IGNvbnN0YW50c18xLldBU0lfRklMRVNUQVRfU0VUX01USU0gfCBjb25zdGFudHNfMS5XQVNJX0ZJTEVTVEFUX1NFVF9NVElNX05PVztcbiAgICAgICAgICAgICAgICBpZiAoKGZzdGZsYWdzICYgbXRpbWZsYWdzKSA9PT0gbXRpbWZsYWdzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb25zdGFudHNfMS5XQVNJX0VJTlZBTDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKChmc3RmbGFncyAmIGNvbnN0YW50c18xLldBU0lfRklMRVNUQVRfU0VUX0FUSU0pID09PSBjb25zdGFudHNfMS5XQVNJX0ZJTEVTVEFUX1NFVF9BVElNKSB7XG4gICAgICAgICAgICAgICAgICAgIGF0aW0gPSBuc1RvTXMoc3RBdGltKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoKGZzdGZsYWdzICYgY29uc3RhbnRzXzEuV0FTSV9GSUxFU1RBVF9TRVRfQVRJTV9OT1cpID09PSBjb25zdGFudHNfMS5XQVNJX0ZJTEVTVEFUX1NFVF9BVElNX05PVykge1xuICAgICAgICAgICAgICAgICAgICBhdGltID0gbjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKChmc3RmbGFncyAmIGNvbnN0YW50c18xLldBU0lfRklMRVNUQVRfU0VUX01USU0pID09PSBjb25zdGFudHNfMS5XQVNJX0ZJTEVTVEFUX1NFVF9NVElNKSB7XG4gICAgICAgICAgICAgICAgICAgIG10aW0gPSBuc1RvTXMoc3RNdGltKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoKGZzdGZsYWdzICYgY29uc3RhbnRzXzEuV0FTSV9GSUxFU1RBVF9TRVRfTVRJTV9OT1cpID09PSBjb25zdGFudHNfMS5XQVNJX0ZJTEVTVEFUX1NFVF9NVElNX05PVykge1xuICAgICAgICAgICAgICAgICAgICBtdGltID0gbjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHAgPSBidWZmZXJfMS5kZWZhdWx0LmZyb20oX3RoaXMubWVtb3J5LmJ1ZmZlciwgcGF0aFB0ciwgcGF0aExlbikudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICBmcy51dGltZXNTeW5jKHBhdGgucmVzb2x2ZShzdGF0cy5wYXRoLCBwKSwgbmV3IERhdGUoYXRpbSksIG5ldyBEYXRlKG10aW0pKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29uc3RhbnRzXzEuV0FTSV9FU1VDQ0VTUztcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgcGF0aF9saW5rOiB3cmFwKGZ1bmN0aW9uIChvbGRGZCwgb2xkRmxhZ3MsIG9sZFBhdGgsIG9sZFBhdGhMZW4sIG5ld0ZkLCBuZXdQYXRoLCBuZXdQYXRoTGVuKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9zdGF0cyA9IENIRUNLX0ZEKG9sZEZkLCBjb25zdGFudHNfMS5XQVNJX1JJR0hUX1BBVEhfTElOS19TT1VSQ0UpO1xuICAgICAgICAgICAgICAgIHZhciBuc3RhdHMgPSBDSEVDS19GRChuZXdGZCwgY29uc3RhbnRzXzEuV0FTSV9SSUdIVF9QQVRIX0xJTktfVEFSR0VUKTtcbiAgICAgICAgICAgICAgICBpZiAoIW9zdGF0cy5wYXRoIHx8ICFuc3RhdHMucGF0aCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29uc3RhbnRzXzEuV0FTSV9FSU5WQUw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF90aGlzLnJlZnJlc2hNZW1vcnkoKTtcbiAgICAgICAgICAgICAgICB2YXIgb3AgPSBidWZmZXJfMS5kZWZhdWx0LmZyb20oX3RoaXMubWVtb3J5LmJ1ZmZlciwgb2xkUGF0aCwgb2xkUGF0aExlbikudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICB2YXIgbnAgPSBidWZmZXJfMS5kZWZhdWx0LmZyb20oX3RoaXMubWVtb3J5LmJ1ZmZlciwgbmV3UGF0aCwgbmV3UGF0aExlbikudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICBmcy5saW5rU3luYyhwYXRoLnJlc29sdmUob3N0YXRzLnBhdGgsIG9wKSwgcGF0aC5yZXNvbHZlKG5zdGF0cy5wYXRoLCBucCkpO1xuICAgICAgICAgICAgICAgIHJldHVybiBjb25zdGFudHNfMS5XQVNJX0VTVUNDRVNTO1xuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBwYXRoX29wZW46IHdyYXAoZnVuY3Rpb24gKGRpcmZkLCBkaXJmbGFncywgcGF0aFB0ciwgcGF0aExlbiwgb2ZsYWdzLCBmc1JpZ2h0c0Jhc2UsIGZzUmlnaHRzSW5oZXJpdGluZywgZnNGbGFncywgZmQpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3RhdHMgPSBDSEVDS19GRChkaXJmZCwgY29uc3RhbnRzXzEuV0FTSV9SSUdIVF9QQVRIX09QRU4pO1xuICAgICAgICAgICAgICAgIGZzUmlnaHRzQmFzZSA9IGJpZ2ludF8xLkJpZ0ludFBvbHlmaWxsKGZzUmlnaHRzQmFzZSk7XG4gICAgICAgICAgICAgICAgZnNSaWdodHNJbmhlcml0aW5nID0gYmlnaW50XzEuQmlnSW50UG9seWZpbGwoZnNSaWdodHNJbmhlcml0aW5nKTtcbiAgICAgICAgICAgICAgICB2YXIgcmVhZCA9IChmc1JpZ2h0c0Jhc2UgJiAoY29uc3RhbnRzXzEuV0FTSV9SSUdIVF9GRF9SRUFEIHwgY29uc3RhbnRzXzEuV0FTSV9SSUdIVF9GRF9SRUFERElSKSkgIT09XG4gICAgICAgICAgICAgICAgICAgIGJpZ2ludF8xLkJpZ0ludFBvbHlmaWxsKDApO1xuICAgICAgICAgICAgICAgIHZhciB3cml0ZSA9IChmc1JpZ2h0c0Jhc2UgJlxuICAgICAgICAgICAgICAgICAgICAoY29uc3RhbnRzXzEuV0FTSV9SSUdIVF9GRF9EQVRBU1lOQyB8XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdGFudHNfMS5XQVNJX1JJR0hUX0ZEX1dSSVRFIHxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0YW50c18xLldBU0lfUklHSFRfRkRfQUxMT0NBVEUgfFxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3RhbnRzXzEuV0FTSV9SSUdIVF9GRF9GSUxFU1RBVF9TRVRfU0laRSkpICE9PVxuICAgICAgICAgICAgICAgICAgICBiaWdpbnRfMS5CaWdJbnRQb2x5ZmlsbCgwKTtcbiAgICAgICAgICAgICAgICB2YXIgbm9mbGFncztcbiAgICAgICAgICAgICAgICBpZiAod3JpdGUgJiYgcmVhZCkge1xuICAgICAgICAgICAgICAgICAgICBub2ZsYWdzID0gZnMuY29uc3RhbnRzLk9fUkRXUjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAocmVhZCkge1xuICAgICAgICAgICAgICAgICAgICBub2ZsYWdzID0gZnMuY29uc3RhbnRzLk9fUkRPTkxZO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh3cml0ZSkge1xuICAgICAgICAgICAgICAgICAgICBub2ZsYWdzID0gZnMuY29uc3RhbnRzLk9fV1JPTkxZO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBmc1JpZ2h0c0Jhc2UgaXMgbmVlZGVkIGhlcmUgYnV0IHBlcmhhcHMgd2Ugc2hvdWxkIGRvIGl0IGluIG5lZWRlZEluaGVyaXRpbmdcbiAgICAgICAgICAgICAgICB2YXIgbmVlZGVkQmFzZSA9IGZzUmlnaHRzQmFzZSB8IGNvbnN0YW50c18xLldBU0lfUklHSFRfUEFUSF9PUEVOO1xuICAgICAgICAgICAgICAgIHZhciBuZWVkZWRJbmhlcml0aW5nID0gZnNSaWdodHNCYXNlIHwgZnNSaWdodHNJbmhlcml0aW5nO1xuICAgICAgICAgICAgICAgIGlmICgob2ZsYWdzICYgY29uc3RhbnRzXzEuV0FTSV9PX0NSRUFUKSAhPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBub2ZsYWdzIHw9IGZzLmNvbnN0YW50cy5PX0NSRUFUO1xuICAgICAgICAgICAgICAgICAgICBuZWVkZWRCYXNlIHw9IGNvbnN0YW50c18xLldBU0lfUklHSFRfUEFUSF9DUkVBVEVfRklMRTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKChvZmxhZ3MgJiBjb25zdGFudHNfMS5XQVNJX09fRElSRUNUT1JZKSAhPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBub2ZsYWdzIHw9IGZzLmNvbnN0YW50cy5PX0RJUkVDVE9SWTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKChvZmxhZ3MgJiBjb25zdGFudHNfMS5XQVNJX09fRVhDTCkgIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgbm9mbGFncyB8PSBmcy5jb25zdGFudHMuT19FWENMO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoKG9mbGFncyAmIGNvbnN0YW50c18xLldBU0lfT19UUlVOQykgIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgbm9mbGFncyB8PSBmcy5jb25zdGFudHMuT19UUlVOQztcbiAgICAgICAgICAgICAgICAgICAgbmVlZGVkQmFzZSB8PSBjb25zdGFudHNfMS5XQVNJX1JJR0hUX1BBVEhfRklMRVNUQVRfU0VUX1NJWkU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIENvbnZlcnQgZmlsZSBkZXNjcmlwdG9yIGZsYWdzLlxuICAgICAgICAgICAgICAgIGlmICgoZnNGbGFncyAmIGNvbnN0YW50c18xLldBU0lfRkRGTEFHX0FQUEVORCkgIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgbm9mbGFncyB8PSBmcy5jb25zdGFudHMuT19BUFBFTkQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICgoZnNGbGFncyAmIGNvbnN0YW50c18xLldBU0lfRkRGTEFHX0RTWU5DKSAhPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZnMuY29uc3RhbnRzLk9fRFNZTkMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZmxhZ3MgfD0gZnMuY29uc3RhbnRzLk9fRFNZTkM7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2ZsYWdzIHw9IGZzLmNvbnN0YW50cy5PX1NZTkM7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbmVlZGVkSW5oZXJpdGluZyB8PSBjb25zdGFudHNfMS5XQVNJX1JJR0hUX0ZEX0RBVEFTWU5DO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoKGZzRmxhZ3MgJiBjb25zdGFudHNfMS5XQVNJX0ZERkxBR19OT05CTE9DSykgIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgbm9mbGFncyB8PSBmcy5jb25zdGFudHMuT19OT05CTE9DSztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKChmc0ZsYWdzICYgY29uc3RhbnRzXzEuV0FTSV9GREZMQUdfUlNZTkMpICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChmcy5jb25zdGFudHMuT19SU1lOQykge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9mbGFncyB8PSBmcy5jb25zdGFudHMuT19SU1lOQztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZmxhZ3MgfD0gZnMuY29uc3RhbnRzLk9fU1lOQztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBuZWVkZWRJbmhlcml0aW5nIHw9IGNvbnN0YW50c18xLldBU0lfUklHSFRfRkRfU1lOQztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKChmc0ZsYWdzICYgY29uc3RhbnRzXzEuV0FTSV9GREZMQUdfU1lOQykgIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgbm9mbGFncyB8PSBmcy5jb25zdGFudHMuT19TWU5DO1xuICAgICAgICAgICAgICAgICAgICBuZWVkZWRJbmhlcml0aW5nIHw9IGNvbnN0YW50c18xLldBU0lfUklHSFRfRkRfU1lOQztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHdyaXRlICYmXG4gICAgICAgICAgICAgICAgICAgIChub2ZsYWdzICYgKGZzLmNvbnN0YW50cy5PX0FQUEVORCB8IGZzLmNvbnN0YW50cy5PX1RSVU5DKSkgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgbmVlZGVkSW5oZXJpdGluZyB8PSBjb25zdGFudHNfMS5XQVNJX1JJR0hUX0ZEX1NFRUs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF90aGlzLnJlZnJlc2hNZW1vcnkoKTtcbiAgICAgICAgICAgICAgICB2YXIgcCA9IGJ1ZmZlcl8xLmRlZmF1bHQuZnJvbShfdGhpcy5tZW1vcnkuYnVmZmVyLCBwYXRoUHRyLCBwYXRoTGVuKS50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgIHZhciBmdWxsVW5yZXNvbHZlZCA9IHBhdGgucmVzb2x2ZShzdGF0cy5wYXRoLCBwKTtcbiAgICAgICAgICAgICAgICBpZiAocGF0aC5yZWxhdGl2ZShzdGF0cy5wYXRoLCBmdWxsVW5yZXNvbHZlZCkuc3RhcnRzV2l0aChcIi4uXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb25zdGFudHNfMS5XQVNJX0VOT1RDQVBBQkxFO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgZnVsbDtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBmdWxsID0gZnMucmVhbHBhdGhTeW5jKGZ1bGxVbnJlc29sdmVkKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhdGgucmVsYXRpdmUoc3RhdHMucGF0aCwgZnVsbCkuc3RhcnRzV2l0aChcIi4uXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29uc3RhbnRzXzEuV0FTSV9FTk9UQ0FQQUJMRTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZS5jb2RlID09PSBcIkVOT0VOVFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmdWxsID0gZnVsbFVucmVzb2x2ZWQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8qIGNoZWNrIGlmIHRoZSBmaWxlIGlzIGEgZGlyZWN0b3J5ICh1bmxlc3Mgb3BlbmluZyBmb3Igd3JpdGUsXG4gICAgICAgICAgICAgICAgICogaW4gd2hpY2ggY2FzZSB0aGUgZmlsZSBtYXkgbm90IGV4aXN0IGFuZCBzaG91bGQgYmUgY3JlYXRlZCkgKi9cbiAgICAgICAgICAgICAgICB2YXIgaXNEaXJlY3Rvcnk7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgaXNEaXJlY3RvcnkgPSBmcy5zdGF0U3luYyhmdWxsKS5pc0RpcmVjdG9yeSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZSkgeyB9XG4gICAgICAgICAgICAgICAgdmFyIHJlYWxmZDtcbiAgICAgICAgICAgICAgICBpZiAoIXdyaXRlICYmIGlzRGlyZWN0b3J5KSB7XG4gICAgICAgICAgICAgICAgICAgIHJlYWxmZCA9IGZzLm9wZW5TeW5jKGZ1bGwsIGZzLmNvbnN0YW50cy5PX1JET05MWSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZWFsZmQgPSBmcy5vcGVuU3luYyhmdWxsLCBub2ZsYWdzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG5ld2ZkID0gX19zcHJlYWRBcnJheShbXSwgX3RoaXMuRkRfTUFQLmtleXMoKSwgdHJ1ZSkucmV2ZXJzZSgpWzBdICsgMTtcbiAgICAgICAgICAgICAgICBfdGhpcy5GRF9NQVAuc2V0KG5ld2ZkLCB7XG4gICAgICAgICAgICAgICAgICAgIHJlYWw6IHJlYWxmZCxcbiAgICAgICAgICAgICAgICAgICAgZmlsZXR5cGU6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICAgLy8gb2Zmc2V0OiBCaWdJbnQoMCksXG4gICAgICAgICAgICAgICAgICAgIHJpZ2h0czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmFzZTogbmVlZGVkQmFzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGluaGVyaXRpbmc6IG5lZWRlZEluaGVyaXRpbmdcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgcGF0aDogZnVsbFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHN0YXQoX3RoaXMsIG5ld2ZkKTtcbiAgICAgICAgICAgICAgICBfdGhpcy52aWV3LnNldFVpbnQzMihmZCwgbmV3ZmQsIHRydWUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBjb25zdGFudHNfMS5XQVNJX0VTVUNDRVNTO1xuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBwYXRoX3JlYWRsaW5rOiB3cmFwKGZ1bmN0aW9uIChmZCwgcGF0aFB0ciwgcGF0aExlbiwgYnVmLCBidWZMZW4sIGJ1ZnVzZWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3RhdHMgPSBDSEVDS19GRChmZCwgY29uc3RhbnRzXzEuV0FTSV9SSUdIVF9QQVRIX1JFQURMSU5LKTtcbiAgICAgICAgICAgICAgICBpZiAoIXN0YXRzLnBhdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnN0YW50c18xLldBU0lfRUlOVkFMO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfdGhpcy5yZWZyZXNoTWVtb3J5KCk7XG4gICAgICAgICAgICAgICAgdmFyIHAgPSBidWZmZXJfMS5kZWZhdWx0LmZyb20oX3RoaXMubWVtb3J5LmJ1ZmZlciwgcGF0aFB0ciwgcGF0aExlbikudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICB2YXIgZnVsbCA9IHBhdGgucmVzb2x2ZShzdGF0cy5wYXRoLCBwKTtcbiAgICAgICAgICAgICAgICB2YXIgciA9IGZzLnJlYWRsaW5rU3luYyhmdWxsKTtcbiAgICAgICAgICAgICAgICB2YXIgdXNlZCA9IGJ1ZmZlcl8xLmRlZmF1bHQuZnJvbShfdGhpcy5tZW1vcnkuYnVmZmVyKS53cml0ZShyLCBidWYsIGJ1Zkxlbik7XG4gICAgICAgICAgICAgICAgX3RoaXMudmlldy5zZXRVaW50MzIoYnVmdXNlZCwgdXNlZCwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbnN0YW50c18xLldBU0lfRVNVQ0NFU1M7XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHBhdGhfcmVtb3ZlX2RpcmVjdG9yeTogd3JhcChmdW5jdGlvbiAoZmQsIHBhdGhQdHIsIHBhdGhMZW4pIHtcbiAgICAgICAgICAgICAgICB2YXIgc3RhdHMgPSBDSEVDS19GRChmZCwgY29uc3RhbnRzXzEuV0FTSV9SSUdIVF9QQVRIX1JFTU9WRV9ESVJFQ1RPUlkpO1xuICAgICAgICAgICAgICAgIGlmICghc3RhdHMucGF0aCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29uc3RhbnRzXzEuV0FTSV9FSU5WQUw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF90aGlzLnJlZnJlc2hNZW1vcnkoKTtcbiAgICAgICAgICAgICAgICB2YXIgcCA9IGJ1ZmZlcl8xLmRlZmF1bHQuZnJvbShfdGhpcy5tZW1vcnkuYnVmZmVyLCBwYXRoUHRyLCBwYXRoTGVuKS50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgIGZzLnJtZGlyU3luYyhwYXRoLnJlc29sdmUoc3RhdHMucGF0aCwgcCkpO1xuICAgICAgICAgICAgICAgIHJldHVybiBjb25zdGFudHNfMS5XQVNJX0VTVUNDRVNTO1xuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBwYXRoX3JlbmFtZTogd3JhcChmdW5jdGlvbiAob2xkRmQsIG9sZFBhdGgsIG9sZFBhdGhMZW4sIG5ld0ZkLCBuZXdQYXRoLCBuZXdQYXRoTGVuKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9zdGF0cyA9IENIRUNLX0ZEKG9sZEZkLCBjb25zdGFudHNfMS5XQVNJX1JJR0hUX1BBVEhfUkVOQU1FX1NPVVJDRSk7XG4gICAgICAgICAgICAgICAgdmFyIG5zdGF0cyA9IENIRUNLX0ZEKG5ld0ZkLCBjb25zdGFudHNfMS5XQVNJX1JJR0hUX1BBVEhfUkVOQU1FX1RBUkdFVCk7XG4gICAgICAgICAgICAgICAgaWYgKCFvc3RhdHMucGF0aCB8fCAhbnN0YXRzLnBhdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnN0YW50c18xLldBU0lfRUlOVkFMO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfdGhpcy5yZWZyZXNoTWVtb3J5KCk7XG4gICAgICAgICAgICAgICAgdmFyIG9wID0gYnVmZmVyXzEuZGVmYXVsdC5mcm9tKF90aGlzLm1lbW9yeS5idWZmZXIsIG9sZFBhdGgsIG9sZFBhdGhMZW4pLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgdmFyIG5wID0gYnVmZmVyXzEuZGVmYXVsdC5mcm9tKF90aGlzLm1lbW9yeS5idWZmZXIsIG5ld1BhdGgsIG5ld1BhdGhMZW4pLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgZnMucmVuYW1lU3luYyhwYXRoLnJlc29sdmUob3N0YXRzLnBhdGgsIG9wKSwgcGF0aC5yZXNvbHZlKG5zdGF0cy5wYXRoLCBucCkpO1xuICAgICAgICAgICAgICAgIHJldHVybiBjb25zdGFudHNfMS5XQVNJX0VTVUNDRVNTO1xuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBwYXRoX3N5bWxpbms6IHdyYXAoZnVuY3Rpb24gKG9sZFBhdGgsIG9sZFBhdGhMZW4sIGZkLCBuZXdQYXRoLCBuZXdQYXRoTGVuKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRzID0gQ0hFQ0tfRkQoZmQsIGNvbnN0YW50c18xLldBU0lfUklHSFRfUEFUSF9TWU1MSU5LKTtcbiAgICAgICAgICAgICAgICBpZiAoIXN0YXRzLnBhdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnN0YW50c18xLldBU0lfRUlOVkFMO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfdGhpcy5yZWZyZXNoTWVtb3J5KCk7XG4gICAgICAgICAgICAgICAgdmFyIG9wID0gYnVmZmVyXzEuZGVmYXVsdC5mcm9tKF90aGlzLm1lbW9yeS5idWZmZXIsIG9sZFBhdGgsIG9sZFBhdGhMZW4pLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgdmFyIG5wID0gYnVmZmVyXzEuZGVmYXVsdC5mcm9tKF90aGlzLm1lbW9yeS5idWZmZXIsIG5ld1BhdGgsIG5ld1BhdGhMZW4pLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgZnMuc3ltbGlua1N5bmMob3AsIHBhdGgucmVzb2x2ZShzdGF0cy5wYXRoLCBucCkpO1xuICAgICAgICAgICAgICAgIHJldHVybiBjb25zdGFudHNfMS5XQVNJX0VTVUNDRVNTO1xuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBwYXRoX3VubGlua19maWxlOiB3cmFwKGZ1bmN0aW9uIChmZCwgcGF0aFB0ciwgcGF0aExlbikge1xuICAgICAgICAgICAgICAgIHZhciBzdGF0cyA9IENIRUNLX0ZEKGZkLCBjb25zdGFudHNfMS5XQVNJX1JJR0hUX1BBVEhfVU5MSU5LX0ZJTEUpO1xuICAgICAgICAgICAgICAgIGlmICghc3RhdHMucGF0aCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29uc3RhbnRzXzEuV0FTSV9FSU5WQUw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF90aGlzLnJlZnJlc2hNZW1vcnkoKTtcbiAgICAgICAgICAgICAgICB2YXIgcCA9IGJ1ZmZlcl8xLmRlZmF1bHQuZnJvbShfdGhpcy5tZW1vcnkuYnVmZmVyLCBwYXRoUHRyLCBwYXRoTGVuKS50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgIGZzLnVubGlua1N5bmMocGF0aC5yZXNvbHZlKHN0YXRzLnBhdGgsIHApKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29uc3RhbnRzXzEuV0FTSV9FU1VDQ0VTUztcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgcG9sbF9vbmVvZmY6IGZ1bmN0aW9uIChzaW4sIHNvdXQsIG5zdWJzY3JpcHRpb25zLCBuZXZlbnRzKSB7XG4gICAgICAgICAgICAgICAgdmFyIGV2ZW50YyA9IDA7XG4gICAgICAgICAgICAgICAgdmFyIHdhaXRFbmQgPSAwO1xuICAgICAgICAgICAgICAgIF90aGlzLnJlZnJlc2hNZW1vcnkoKTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5zdWJzY3JpcHRpb25zOyBpICs9IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVzZXJkYXRhID0gX3RoaXMudmlldy5nZXRCaWdVaW50NjQoc2luLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgc2luICs9IDg7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0eXBlID0gX3RoaXMudmlldy5nZXRVaW50OChzaW4pO1xuICAgICAgICAgICAgICAgICAgICBzaW4gKz0gMTtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIGNvbnN0YW50c18xLldBU0lfRVZFTlRUWVBFX0NMT0NLOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2luICs9IDc7IC8vIHBhZGRpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWRlbnRpZmllciA9IF90aGlzLnZpZXcuZ2V0QmlnVWludDY0KHNpbiwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2luICs9IDg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNsb2NraWQgPSBfdGhpcy52aWV3LmdldFVpbnQzMihzaW4sIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpbiArPSA0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpbiArPSA0OyAvLyBwYWRkaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRpbWVzdGFtcCA9IF90aGlzLnZpZXcuZ2V0QmlnVWludDY0KHNpbiwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2luICs9IDg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByZWNpc2lvbiA9IF90aGlzLnZpZXcuZ2V0QmlnVWludDY0KHNpbiwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2luICs9IDg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YmNsb2NrZmxhZ3MgPSBfdGhpcy52aWV3LmdldFVpbnQxNihzaW4sIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpbiArPSAyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpbiArPSA2OyAvLyBwYWRkaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFic29sdXRlID0gc3ViY2xvY2tmbGFncyA9PT0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IGNvbnN0YW50c18xLldBU0lfRVNVQ0NFU1M7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG4gPSBiaWdpbnRfMS5CaWdJbnRQb2x5ZmlsbChub3coY2xvY2tpZCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUgPSBjb25zdGFudHNfMS5XQVNJX0VJTlZBTDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbmQgPSBhYnNvbHV0ZSA/IHRpbWVzdGFtcCA6IG4gKyB0aW1lc3RhbXA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhaXRFbmQgPVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kID4gd2FpdEVuZCA/IGVuZCA6IHdhaXRFbmQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnZpZXcuc2V0QmlnVWludDY0KHNvdXQsIHVzZXJkYXRhLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3V0ICs9IDg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMudmlldy5zZXRVaW50MTYoc291dCwgZSwgdHJ1ZSk7IC8vIGVycm9yXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc291dCArPSAyOyAvLyBwYWQgb2Zmc2V0IDJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy52aWV3LnNldFVpbnQ4KHNvdXQsIGNvbnN0YW50c18xLldBU0lfRVZFTlRUWVBFX0NMT0NLKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3V0ICs9IDE7IC8vIHBhZCBvZmZzZXQgM1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXQgKz0gNTsgLy8gcGFkZGluZyB0byA4XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRjICs9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIGNvbnN0YW50c18xLldBU0lfRVZFTlRUWVBFX0ZEX1JFQUQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIGNvbnN0YW50c18xLldBU0lfRVZFTlRUWVBFX0ZEX1dSSVRFOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2luICs9IDM7IC8vIHBhZGRpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmQgPSBfdGhpcy52aWV3LmdldFVpbnQzMihzaW4sIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpbiArPSA0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnZpZXcuc2V0QmlnVWludDY0KHNvdXQsIHVzZXJkYXRhLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3V0ICs9IDg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMudmlldy5zZXRVaW50MTYoc291dCwgY29uc3RhbnRzXzEuV0FTSV9FTk9TWVMsIHRydWUpOyAvLyBlcnJvclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXQgKz0gMjsgLy8gcGFkIG9mZnNldCAyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMudmlldy5zZXRVaW50OChzb3V0LCB0eXBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3V0ICs9IDE7IC8vIHBhZCBvZmZzZXQgM1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXQgKz0gNTsgLy8gcGFkZGluZyB0byA4XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRjICs9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjb25zdGFudHNfMS5XQVNJX0VJTlZBTDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfdGhpcy52aWV3LnNldFVpbnQzMihuZXZlbnRzLCBldmVudGMsIHRydWUpO1xuICAgICAgICAgICAgICAgIHdoaWxlIChiaW5kaW5ncy5ocnRpbWUoKSA8IHdhaXRFbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gbm90aGluZ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gY29uc3RhbnRzXzEuV0FTSV9FU1VDQ0VTUztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBwcm9jX2V4aXQ6IGZ1bmN0aW9uIChydmFsKSB7XG4gICAgICAgICAgICAgICAgYmluZGluZ3MuZXhpdChydmFsKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29uc3RhbnRzXzEuV0FTSV9FU1VDQ0VTUztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBwcm9jX3JhaXNlOiBmdW5jdGlvbiAoc2lnKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEoc2lnIGluIGNvbnN0YW50c18xLlNJR05BTF9NQVApKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb25zdGFudHNfMS5XQVNJX0VJTlZBTDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYmluZGluZ3Mua2lsbChjb25zdGFudHNfMS5TSUdOQUxfTUFQW3NpZ10pO1xuICAgICAgICAgICAgICAgIHJldHVybiBjb25zdGFudHNfMS5XQVNJX0VTVUNDRVNTO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJhbmRvbV9nZXQ6IGZ1bmN0aW9uIChidWZQdHIsIGJ1Zkxlbikge1xuICAgICAgICAgICAgICAgIF90aGlzLnJlZnJlc2hNZW1vcnkoKTtcbiAgICAgICAgICAgICAgICBiaW5kaW5ncy5yYW5kb21GaWxsU3luYyhuZXcgVWludDhBcnJheShfdGhpcy5tZW1vcnkuYnVmZmVyKSwgYnVmUHRyLCBidWZMZW4pO1xuICAgICAgICAgICAgICAgIHJldHVybiBjb25zdGFudHNfMS5XQVNJX0VTVUNDRVNTO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNjaGVkX3lpZWxkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgLy8gU2luZ2xlIHRocmVhZGVkIGVudmlyb25tZW50XG4gICAgICAgICAgICAgICAgLy8gVGhpcyBpcyBhIG5vLW9wIGluIEpTXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbnN0YW50c18xLldBU0lfRVNVQ0NFU1M7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc29ja19yZWN2OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbnN0YW50c18xLldBU0lfRU5PU1lTO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNvY2tfc2VuZDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjb25zdGFudHNfMS5XQVNJX0VOT1NZUztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzb2NrX3NodXRkb3duOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbnN0YW50c18xLldBU0lfRU5PU1lTO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICAvLyBXcmFwIGVhY2ggb2YgdGhlIGltcG9ydHMgdG8gc2hvdyB0aGUgY2FsbHMgaW4gdGhlIGNvbnNvbGVcbiAgICAgICAgaWYgKHdhc2lDb25maWcudHJhY2VTeXNjYWxscykge1xuICAgICAgICAgICAgT2JqZWN0LmtleXModGhpcy53YXNpSW1wb3J0KS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgICAgICAgICB2YXIgcHJldkltcG9ydCA9IF90aGlzLndhc2lJbXBvcnRba2V5XTtcbiAgICAgICAgICAgICAgICBfdGhpcy53YXNpSW1wb3J0W2tleV0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJXQVNJOiB3YXNpSW1wb3J0IGNhbGxlZDogXCIuY29uY2F0KGtleSwgXCIgKFwiKS5jb25jYXQoYXJncywgXCIpXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBwcmV2SW1wb3J0LmFwcGx5KHZvaWQgMCwgYXJncyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIldBU0k6ICA9PiBcIi5jb25jYXQocmVzdWx0KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNhdGNoZWQgZXJyb3I6IFwiLmNvbmNhdChlKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIFdBU0lEZWZhdWx0LnByb3RvdHlwZS5yZWZyZXNoTWVtb3J5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGlmICghdGhpcy52aWV3IHx8IHRoaXMudmlldy5idWZmZXIuYnl0ZUxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy52aWV3ID0gbmV3IGRhdGF2aWV3XzEuRGF0YVZpZXdQb2x5ZmlsbCh0aGlzLm1lbW9yeS5idWZmZXIpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBXQVNJRGVmYXVsdC5wcm90b3R5cGUuc2V0TWVtb3J5ID0gZnVuY3Rpb24gKG1lbW9yeSkge1xuICAgICAgICB0aGlzLm1lbW9yeSA9IG1lbW9yeTtcbiAgICB9O1xuICAgIFdBU0lEZWZhdWx0LnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uIChpbnN0YW5jZSkge1xuICAgICAgICB2YXIgZXhwb3J0cyA9IGluc3RhbmNlLmV4cG9ydHM7XG4gICAgICAgIGlmIChleHBvcnRzID09PSBudWxsIHx8IHR5cGVvZiBleHBvcnRzICE9PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJpbnN0YW5jZS5leHBvcnRzIG11c3QgYmUgYW4gT2JqZWN0LiBSZWNlaXZlZCBcIi5jb25jYXQoZXhwb3J0cywgXCIuXCIpKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbWVtb3J5ID0gZXhwb3J0cy5tZW1vcnk7XG4gICAgICAgIGlmICghKG1lbW9yeSBpbnN0YW5jZW9mIFdlYkFzc2VtYmx5Lk1lbW9yeSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImluc3RhbmNlLmV4cG9ydHMubWVtb3J5IG11c3QgYmUgYSBXZWJBc3NlbWJseS5NZW1vcnkuIFJlY2NlaXZlZCBcIi5jb25jYXQobWVtb3J5LCBcIi5cIikpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2V0TWVtb3J5KG1lbW9yeSk7XG4gICAgICAgIGlmIChleHBvcnRzLl9zdGFydCkge1xuICAgICAgICAgICAgZXhwb3J0cy5fc3RhcnQoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgV0FTSURlZmF1bHQucHJvdG90eXBlLmdldEltcG9ydE5hbWVzcGFjZSA9IGZ1bmN0aW9uIChtb2R1bGUpIHtcbiAgICAgICAgdmFyIG5hbWVzcGFjZSA9IG51bGw7XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBXZWJBc3NlbWJseS5Nb2R1bGUuaW1wb3J0cyhtb2R1bGUpOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGltcCA9IF9hW19pXTtcbiAgICAgICAgICAgIC8vIFdlIG9ubHkgY2hlY2sgZm9yIHRoZSBmdW5jdGlvbnNcbiAgICAgICAgICAgIGlmIChpbXAua2luZCAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBXZSBhbGxvdyBmdW5jdGlvbnMgaW4gb3RoZXIgbmFtZXNwYWNlcyBvdGhlciB0aGFuIHdhc2lcbiAgICAgICAgICAgIGlmICghaW1wLm1vZHVsZS5zdGFydHNXaXRoKFwid2FzaV9cIikpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghbmFtZXNwYWNlKSB7XG4gICAgICAgICAgICAgICAgbmFtZXNwYWNlID0gaW1wLm1vZHVsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChuYW1lc3BhY2UgIT09IGltcC5tb2R1bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTXVsdGlwbGUgbmFtZXNwYWNlcyBkZXRlY3RlZC5cIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuYW1lc3BhY2U7XG4gICAgfTtcbiAgICBXQVNJRGVmYXVsdC5wcm90b3R5cGUuZ2V0SW1wb3J0cyA9IGZ1bmN0aW9uIChtb2R1bGUpIHtcbiAgICAgICAgdmFyIG5hbWVzcGFjZSA9IHRoaXMuZ2V0SW1wb3J0TmFtZXNwYWNlKG1vZHVsZSk7XG4gICAgICAgIHN3aXRjaCAobmFtZXNwYWNlKSB7XG4gICAgICAgICAgICBjYXNlIFwid2FzaV91bnN0YWJsZVwiOlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHdhc2lfdW5zdGFibGU6IHRoaXMud2FzaUltcG9ydFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjYXNlIFwid2FzaV9zbmFwc2hvdF9wcmV2aWV3MVwiOlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHdhc2lfc25hcHNob3RfcHJldmlldzE6IHRoaXMud2FzaUltcG9ydFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbid0IGRldGVjdCBhIFdBU0kgbmFtZXNwYWNlIGZvciB0aGUgV2ViQXNzZW1ibHkgTW9kdWxlXCIpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gV0FTSURlZmF1bHQ7XG59KCkpO1xuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBXQVNJRGVmYXVsdDtcbldBU0lEZWZhdWx0LmRlZmF1bHRCaW5kaW5ncyA9IGRlZmF1bHRCaW5kaW5ncztcbi8vIEFsc28gZXhwb3J0IGl0IGFzIGEgZmllbGQgaW4gdGhlIGV4cG9ydCBvYmplY3RcbmV4cG9ydHMuV0FTSSA9IFdBU0lEZWZhdWx0O1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL0BmbHVlbmNlbGFicy9tYXJpbmUud29ya2VyLXNjcmlwdC8uLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQHdhc21lcit3YXNpQDAuMTIuMC9ub2RlX21vZHVsZXMvQHdhc21lci93YXNpL2xpYi9pbmRleC5qcz8iKTsKCi8qKiovIH0pLAoKLyoqKi8gIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9Ad2FzbWVyK3dhc2lAMC4xMi4wL25vZGVfbW9kdWxlcy9Ad2FzbWVyL3dhc2kvbGliL3BvbHlmaWxscy9iaWdpbnQuanMiOgovKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAhKioqIC4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9Ad2FzbWVyK3dhc2lAMC4xMi4wL25vZGVfbW9kdWxlcy9Ad2FzbWVyL3dhc2kvbGliL3BvbHlmaWxscy9iaWdpbnQuanMgKioqIQogIFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pID0+IHsKCmV2YWwoIlxuLy8gQSB2ZXJ5IHNpbXBsZSB3b3JrYXJvdW5kIGZvciBCaWcgaW50LiBXb3JrcyBpbiBjb25qdW5jdGlvbiB3aXRoIG91ciBjdXN0b21cbi8vIERhdGF2aWV3IHdvcmthcm91bmQgYXQgLi9kYXRhdmlldy50c1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoeyB2YWx1ZTogdHJ1ZSB9KSk7XG52YXIgZ2xvYmFsT2JqID0gdHlwZW9mIGdsb2JhbFRoaXMgIT09IFwidW5kZWZpbmVkXCJcbiAgICA/IGdsb2JhbFRoaXNcbiAgICA6IHR5cGVvZiBfX3dlYnBhY2tfcmVxdWlyZV9fLmcgIT09IFwidW5kZWZpbmVkXCJcbiAgICAgICAgPyBfX3dlYnBhY2tfcmVxdWlyZV9fLmdcbiAgICAgICAgOiB7fTtcbmV4cG9ydHMuQmlnSW50UG9seWZpbGwgPSB0eXBlb2YgQmlnSW50ICE9PSBcInVuZGVmaW5lZFwiID8gQmlnSW50IDogZ2xvYmFsT2JqLkJpZ0ludCB8fCBOdW1iZXI7XG5cblxuLy8jIHNvdXJjZVVSTD13ZWJwYWNrOi8vQGZsdWVuY2VsYWJzL21hcmluZS53b3JrZXItc2NyaXB0Ly4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9Ad2FzbWVyK3dhc2lAMC4xMi4wL25vZGVfbW9kdWxlcy9Ad2FzbWVyL3dhc2kvbGliL3BvbHlmaWxscy9iaWdpbnQuanM/Iik7CgovKioqLyB9KSwKCi8qKiovICIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQHdhc21lcit3YXNpQDAuMTIuMC9ub2RlX21vZHVsZXMvQHdhc21lci93YXNpL2xpYi9wb2x5ZmlsbHMvYnJvd3Nlci1ocnRpbWUuanMiOgovKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0B3YXNtZXIrd2FzaUAwLjEyLjAvbm9kZV9tb2R1bGVzL0B3YXNtZXIvd2FzaS9saWIvcG9seWZpbGxzL2Jyb3dzZXItaHJ0aW1lLmpzICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpID0+IHsKCmV2YWwoIlxuLy8gaHJ0aW1lIHBvbHlmaWxsIGZvciB0aGUgYnJvd3NlclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoeyB2YWx1ZTogdHJ1ZSB9KSk7XG52YXIgYmFzZU5vdyA9IE1hdGguZmxvb3IoKERhdGUubm93KCkgLSBwZXJmb3JtYW5jZS5ub3coKSkgKiAxZS0zKTtcbmZ1bmN0aW9uIGhydGltZShwcmV2aW91c1RpbWVzdGFtcCkge1xuICAgIC8vIGluaXRpbGFpemUgb3VyIHZhcmlhYmxlc1xuICAgIHZhciBjbG9ja3RpbWUgPSBwZXJmb3JtYW5jZS5ub3coKSAqIDFlLTM7XG4gICAgdmFyIHNlY29uZHMgPSBNYXRoLmZsb29yKGNsb2NrdGltZSkgKyBiYXNlTm93O1xuICAgIHZhciBuYW5vc2Vjb25kcyA9IE1hdGguZmxvb3IoKGNsb2NrdGltZSAlIDEpICogMWU5KTtcbiAgICAvLyBDb21wYXJlIHRvIHRoZSBwcnZpb3VzIHRpbWVzdGFtcCBpZiB3ZSBoYXZlIG9uZVxuICAgIGlmIChwcmV2aW91c1RpbWVzdGFtcCkge1xuICAgICAgICBzZWNvbmRzID0gc2Vjb25kcyAtIHByZXZpb3VzVGltZXN0YW1wWzBdO1xuICAgICAgICBuYW5vc2Vjb25kcyA9IG5hbm9zZWNvbmRzIC0gcHJldmlvdXNUaW1lc3RhbXBbMV07XG4gICAgICAgIGlmIChuYW5vc2Vjb25kcyA8IDApIHtcbiAgICAgICAgICAgIHNlY29uZHMtLTtcbiAgICAgICAgICAgIG5hbm9zZWNvbmRzICs9IDFlOTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyBSZXR1cm4gb3VyIHNlY29uZHMgdHVwbGVcbiAgICByZXR1cm4gW3NlY29uZHMsIG5hbm9zZWNvbmRzXTtcbn1cbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gaHJ0aW1lO1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL0BmbHVlbmNlbGFicy9tYXJpbmUud29ya2VyLXNjcmlwdC8uLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQHdhc21lcit3YXNpQDAuMTIuMC9ub2RlX21vZHVsZXMvQHdhc21lci93YXNpL2xpYi9wb2x5ZmlsbHMvYnJvd3Nlci1ocnRpbWUuanM/Iik7CgovKioqLyB9KSwKCi8qKiovICIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQHdhc21lcit3YXNpQDAuMTIuMC9ub2RlX21vZHVsZXMvQHdhc21lci93YXNpL2xpYi9wb2x5ZmlsbHMvYnVmZmVyLmpzIjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiAuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQHdhc21lcit3YXNpQDAuMTIuMC9ub2RlX21vZHVsZXMvQHdhc21lci93YXNpL2xpYi9wb2x5ZmlsbHMvYnVmZmVyLmpzICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSA9PiB7CgpldmFsKCJcbi8vIFJldHVybiBvdXIgYnVmZmVyIGRlcGVuZGluZyBvbiBicm93c2VyIG9yIG5vZGVcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHsgdmFsdWU6IHRydWUgfSkpO1xuLypST0xMVVBfUkVQTEFDRV9CUk9XU0VSXG4vLyBAdHMtaWdub3JlXG5pbXBvcnQgeyBCdWZmZXIgfSBmcm9tIFwiYnVmZmVyLWVzNlwiO1xuUk9MTFVQX1JFUExBQ0VfQlJPV1NFUiovXG52YXIgaXNvbW9ycGhpY0J1ZmZlciA9IEJ1ZmZlcjtcbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gaXNvbW9ycGhpY0J1ZmZlcjtcblxuXG4vLyMgc291cmNlVVJMPXdlYnBhY2s6Ly9AZmx1ZW5jZWxhYnMvbWFyaW5lLndvcmtlci1zY3JpcHQvLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0B3YXNtZXIrd2FzaUAwLjEyLjAvbm9kZV9tb2R1bGVzL0B3YXNtZXIvd2FzaS9saWIvcG9seWZpbGxzL2J1ZmZlci5qcz8iKTsKCi8qKiovIH0pLAoKLyoqKi8gIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9Ad2FzbWVyK3dhc2lAMC4xMi4wL25vZGVfbW9kdWxlcy9Ad2FzbWVyL3dhc2kvbGliL3BvbHlmaWxscy9kYXRhdmlldy5qcyI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiAuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQHdhc21lcit3YXNpQDAuMTIuMC9ub2RlX21vZHVsZXMvQHdhc21lci93YXNpL2xpYi9wb2x5ZmlsbHMvZGF0YXZpZXcuanMgKioqIQogIFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgPT4gewoKZXZhbCgiXG4vLyBBIHZlcnkgc2ltcGxlIHdvcmthcm91bmQgZm9yIEJpZyBpbnQuIFdvcmtzIGluIGNvbmp1bmN0aW9uIHdpdGggb3VyIGN1c3RvbVxuLy8gQmlnSW50IHdvcmthcm91bmQgYXQgLi9iaWdpbnQudHNcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHsgdmFsdWU6IHRydWUgfSkpO1xudmFyIGJpZ2ludF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9iaWdpbnQgKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQHdhc21lcit3YXNpQDAuMTIuMC9ub2RlX21vZHVsZXMvQHdhc21lci93YXNpL2xpYi9wb2x5ZmlsbHMvYmlnaW50LmpzXCIpO1xudmFyIGV4cG9ydGVkRGF0YVZpZXcgPSBEYXRhVmlldztcbmlmICghZXhwb3J0ZWREYXRhVmlldy5wcm90b3R5cGUuc2V0QmlnVWludDY0KSB7XG4gICAgLy8gVGFrZW4gZnJvbSBodHRwczovL2dpc3QuZ2l0aHViLmNvbS9ncmF1cC84MTVjOWFjNjVjMmJhYzhhNTYzOTFmMGNhMjM2MzZmY1xuICAgIGV4cG9ydGVkRGF0YVZpZXcucHJvdG90eXBlLnNldEJpZ1VpbnQ2NCA9IGZ1bmN0aW9uIChieXRlT2Zmc2V0LCB2YWx1ZSwgbGl0dGxlRW5kaWFuKSB7XG4gICAgICAgIHZhciBsb3dXb3JkO1xuICAgICAgICB2YXIgaGlnaFdvcmQ7XG4gICAgICAgIGlmICh2YWx1ZSA8IE1hdGgucG93KDIsIDMyKSkge1xuICAgICAgICAgICAgbG93V29yZCA9IE51bWJlcih2YWx1ZSk7XG4gICAgICAgICAgICBoaWdoV29yZCA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgYmlnTnVtYmVyQXNCaW5hcnlTdHIgPSB2YWx1ZS50b1N0cmluZygyKTtcbiAgICAgICAgICAgIC8vIENvbnZlcnQgdGhlIGFib3ZlIGJpbmFyeSBzdHIgdG8gNjQgYml0IChhY3R1YWxseSA1MiBiaXQgd2lsbCB3b3JrKSBieSBwYWRkaW5nIHplcm9zIGluIHRoZSBsZWZ0XG4gICAgICAgICAgICB2YXIgYmlnTnVtYmVyQXNCaW5hcnlTdHIyID0gXCJcIjtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNjQgLSBiaWdOdW1iZXJBc0JpbmFyeVN0ci5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGJpZ051bWJlckFzQmluYXJ5U3RyMiArPSBcIjBcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJpZ051bWJlckFzQmluYXJ5U3RyMiArPSBiaWdOdW1iZXJBc0JpbmFyeVN0cjtcbiAgICAgICAgICAgIGhpZ2hXb3JkID0gcGFyc2VJbnQoYmlnTnVtYmVyQXNCaW5hcnlTdHIyLnN1YnN0cmluZygwLCAzMiksIDIpO1xuICAgICAgICAgICAgbG93V29yZCA9IHBhcnNlSW50KGJpZ051bWJlckFzQmluYXJ5U3RyMi5zdWJzdHJpbmcoMzIpLCAyKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNldFVpbnQzMihieXRlT2Zmc2V0ICsgKGxpdHRsZUVuZGlhbiA/IDAgOiA0KSwgbG93V29yZCwgbGl0dGxlRW5kaWFuKTtcbiAgICAgICAgdGhpcy5zZXRVaW50MzIoYnl0ZU9mZnNldCArIChsaXR0bGVFbmRpYW4gPyA0IDogMCksIGhpZ2hXb3JkLCBsaXR0bGVFbmRpYW4pO1xuICAgIH07XG4gICAgZXhwb3J0ZWREYXRhVmlldy5wcm90b3R5cGUuZ2V0QmlnVWludDY0ID0gZnVuY3Rpb24gKGJ5dGVPZmZzZXQsIGxpdHRsZUVuZGlhbikge1xuICAgICAgICB2YXIgbG93V29yZCA9IHRoaXMuZ2V0VWludDMyKGJ5dGVPZmZzZXQgKyAobGl0dGxlRW5kaWFuID8gMCA6IDQpLCBsaXR0bGVFbmRpYW4pO1xuICAgICAgICB2YXIgaGlnaFdvcmQgPSB0aGlzLmdldFVpbnQzMihieXRlT2Zmc2V0ICsgKGxpdHRsZUVuZGlhbiA/IDQgOiAwKSwgbGl0dGxlRW5kaWFuKTtcbiAgICAgICAgdmFyIGxvd1dvcmRBc0JpbmFyeVN0ciA9IGxvd1dvcmQudG9TdHJpbmcoMik7XG4gICAgICAgIHZhciBoaWdoV29yZEFzQmluYXJ5U3RyID0gaGlnaFdvcmQudG9TdHJpbmcoMik7XG4gICAgICAgIC8vIENvbnZlcnQgdGhlIGFib3ZlIGJpbmFyeSBzdHIgdG8gNjQgYml0IChhY3R1YWxseSA1MiBiaXQgd2lsbCB3b3JrKSBieSBwYWRkaW5nIHplcm9zIGluIHRoZSBsZWZ0XG4gICAgICAgIHZhciBsb3dXb3JkQXNCaW5hcnlTdHJQYWRkZWQgPSBcIlwiO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDMyIC0gbG93V29yZEFzQmluYXJ5U3RyLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBsb3dXb3JkQXNCaW5hcnlTdHJQYWRkZWQgKz0gXCIwXCI7XG4gICAgICAgIH1cbiAgICAgICAgbG93V29yZEFzQmluYXJ5U3RyUGFkZGVkICs9IGxvd1dvcmRBc0JpbmFyeVN0cjtcbiAgICAgICAgcmV0dXJuIGJpZ2ludF8xLkJpZ0ludFBvbHlmaWxsKFwiMGJcIiArIGhpZ2hXb3JkQXNCaW5hcnlTdHIgKyBsb3dXb3JkQXNCaW5hcnlTdHJQYWRkZWQpO1xuICAgIH07XG59XG5leHBvcnRzLkRhdGFWaWV3UG9seWZpbGwgPSBleHBvcnRlZERhdGFWaWV3O1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL0BmbHVlbmNlbGFicy9tYXJpbmUud29ya2VyLXNjcmlwdC8uLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQHdhc21lcit3YXNpQDAuMTIuMC9ub2RlX21vZHVsZXMvQHdhc21lci93YXNpL2xpYi9wb2x5ZmlsbHMvZGF0YXZpZXcuanM/Iik7CgovKioqLyB9KSwKCi8qKiovICIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQHdhc21lcit3YXNpQDAuMTIuMC9ub2RlX21vZHVsZXMvQHdhc21lci93YXNpL2xpYi9wb2x5ZmlsbHMvaHJ0aW1lLmJpZ2ludC5qcyI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAhKioqIC4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9Ad2FzbWVyK3dhc2lAMC4xMi4wL25vZGVfbW9kdWxlcy9Ad2FzbWVyL3dhc2kvbGliL3BvbHlmaWxscy9ocnRpbWUuYmlnaW50LmpzICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykgPT4gewoKZXZhbCgiXG4vLyBTaW1wbHkgcG9seWZpbGwgZm9yIGhydGltZVxuLy8gaHR0cHM6Ly9ub2RlanMub3JnL2FwaS9wcm9jZXNzLmh0bWwjcHJvY2Vzc19wcm9jZXNzX2hydGltZV90aW1lXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7IHZhbHVlOiB0cnVlIH0pKTtcbnZhciBOU19QRVJfU0VDID0gMWU5O1xudmFyIGdldEJpZ0ludEhydGltZSA9IGZ1bmN0aW9uIChuYXRpdmVIcnRpbWUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRpbWUpIHtcbiAgICAgICAgdmFyIGRpZmYgPSBuYXRpdmVIcnRpbWUodGltZSk7XG4gICAgICAgIC8vIFJldHVybiB0aGUgdGltZVxuICAgICAgICByZXR1cm4gKGRpZmZbMF0gKiBOU19QRVJfU0VDICsgZGlmZlsxXSk7XG4gICAgfTtcbn07XG5leHBvcnRzW1wiZGVmYXVsdFwiXSA9IGdldEJpZ0ludEhydGltZTtcblxuXG4vLyMgc291cmNlVVJMPXdlYnBhY2s6Ly9AZmx1ZW5jZWxhYnMvbWFyaW5lLndvcmtlci1zY3JpcHQvLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0B3YXNtZXIrd2FzaUAwLjEyLjAvbm9kZV9tb2R1bGVzL0B3YXNtZXIvd2FzaS9saWIvcG9seWZpbGxzL2hydGltZS5iaWdpbnQuanM/Iik7CgovKioqLyB9KSwKCi8qKiovICIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQHdhc21lcit3YXNtZnNAMC4xMi4wL25vZGVfbW9kdWxlcy9Ad2FzbWVyL3dhc21mcy9saWIvaW5kZXguZXNtLmpzIjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiAuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQHdhc21lcit3YXNtZnNAMC4xMi4wL25vZGVfbW9kdWxlcy9Ad2FzbWVyL3dhc21mcy9saWIvaW5kZXguZXNtLmpzICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSA9PiB7CgpldmFsKCJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHsgdmFsdWU6IHRydWUgfSkpO1xuZXhwb3J0cy5XYXNtRnMgPSB2b2lkIDA7XG4vKlxuICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG5Db3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZVxudGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGVcbkxpY2Vuc2UgYXQgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG5cblRISVMgQ09ERSBJUyBQUk9WSURFRCBPTiBBTiAqQVMgSVMqIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcbktJTkQsIEVJVEhFUiBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBXSVRIT1VUIExJTUlUQVRJT04gQU5ZIElNUExJRURcbldBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBUSVRMRSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UsXG5NRVJDSEFOVEFCTElUWSBPUiBOT04tSU5GUklOR0VNRU5ULlxuXG5TZWUgdGhlIEFwYWNoZSBWZXJzaW9uIDIuMCBMaWNlbnNlIGZvciBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcbmFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogaHR0cHM6Ly9tdGhzLmJlL3B1bnljb2RlIHYxLjQuMSBieSBAbWF0aGlhcyAqL1xuZnVuY3Rpb24gYmEoYSwgYiwgYywgZCkgeyByZXR1cm4gbmV3IChjIHx8IChjID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChlLCBmKSB7IGZ1bmN0aW9uIGcoYSkgeyB0cnkge1xuICAgIGsoZC5uZXh0KGEpKTtcbn1cbmNhdGNoIChuKSB7XG4gICAgZihuKTtcbn0gfSBmdW5jdGlvbiBoKGEpIHsgdHJ5IHtcbiAgICBrKGRbXCJ0aHJvd1wiXShhKSk7XG59XG5jYXRjaCAobikge1xuICAgIGYobik7XG59IH0gZnVuY3Rpb24gayhhKSB7IGEuZG9uZSA/IGUoYS52YWx1ZSkgOiAobmV3IGMoZnVuY3Rpb24gKGIpIHsgYihhLnZhbHVlKTsgfSkpLnRoZW4oZywgaCk7IH0gaygoZCA9IGQuYXBwbHkoYSwgYiB8fCBbXSkpLm5leHQoKSk7IH0pOyB9XG5mdW5jdGlvbiBjYShhLCBiKSB7XG4gICAgZnVuY3Rpb24gYyhhKSB7IHJldHVybiBmdW5jdGlvbiAoYikgeyByZXR1cm4gZChbYSwgYl0pOyB9OyB9XG4gICAgZnVuY3Rpb24gZChjKSB7XG4gICAgICAgIGlmIChmKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XG4gICAgICAgIGZvciAoOyBlOylcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgaWYgKGYgPSAxLCBnICYmIChoID0gY1swXSAmIDIgPyBnW1wicmV0dXJuXCJdIDogY1swXSA/IGdbXCJ0aHJvd1wiXSB8fCAoKGggPSBnW1wicmV0dXJuXCJdKSAmJiBoLmNhbGwoZyksIDApIDogZy5uZXh0KSAmJiAhKGggPSBoLmNhbGwoZywgY1sxXSkpLmRvbmUpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBoO1xuICAgICAgICAgICAgICAgIGlmIChnID0gMCwgaClcbiAgICAgICAgICAgICAgICAgICAgYyA9IFtjWzBdICYgMiwgaC52YWx1ZV07XG4gICAgICAgICAgICAgICAgc3dpdGNoIChjWzBdKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgaCA9IGM7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gZS5sYWJlbCsrLCB7IHZhbHVlOiBjWzFdLCBkb25lOiAhMSB9O1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgICAgICBlLmxhYmVsKys7XG4gICAgICAgICAgICAgICAgICAgICAgICBnID0gY1sxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSBbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgICAgICAgICAgICAgYyA9IGUub3BzLnBvcCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZS50cnlzLnBvcCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShoID0gZS50cnlzLCBoID0gMCA8IGgubGVuZ3RoICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaFtoLmxlbmd0aCAtIDFdKSAmJiAoNiA9PT0gY1swXSB8fCAyID09PSBjWzBdKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKDMgPT09IGNbMF0gJiYgKCFoIHx8IGNbMV0gPiBoWzBdICYmIGNbMV0gPCBoWzNdKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLmxhYmVsID0gY1sxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKDYgPT09IGNbMF0gJiYgZS5sYWJlbCA8IGhbMV0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5sYWJlbCA9IGhbMV0sIGggPSBjO1xuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoaCAmJiBlLmxhYmVsIDwgaFsyXSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLmxhYmVsID0gaFsyXSwgZS5vcHMucHVzaChjKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhbMl0gJiYgZS5vcHMucG9wKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS50cnlzLnBvcCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjID0gYi5jYWxsKGEsIGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKG4pIHtcbiAgICAgICAgICAgICAgICBjID0gWzYsIG5dLCBnID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgICAgIGYgPSBoID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgaWYgKGNbMF0gJiA1KVxuICAgICAgICAgICAgdGhyb3cgY1sxXTtcbiAgICAgICAgcmV0dXJuIHsgdmFsdWU6IGNbMF0gPyBjWzFdIDogdm9pZCAwLCBkb25lOiAhMCB9O1xuICAgIH1cbiAgICB2YXIgZSA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uICgpIHsgaWYgKGhbMF0gJiAxKVxuICAgICAgICAgICAgdGhyb3cgaFsxXTsgcmV0dXJuIGhbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIGcsIGgsIGs7XG4gICAgcmV0dXJuIGsgPSB7IG5leHQ6IGMoMCksIFwidGhyb3dcIjogYygxKSwgXCJyZXR1cm5cIjogYygyKSB9LCBcImZ1bmN0aW9uXCIgPT09XG4gICAgICAgIHR5cGVvZiBTeW1ib2wgJiYgKGtbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0pLCBrO1xufVxuZnVuY3Rpb24gZGEoYSkgeyB2YXIgYiA9IFwiZnVuY3Rpb25cIiA9PT0gdHlwZW9mIFN5bWJvbCAmJiBhW1N5bWJvbC5pdGVyYXRvcl0sIGMgPSAwOyByZXR1cm4gYiA/IGIuY2FsbChhKSA6IHsgbmV4dDogZnVuY3Rpb24gKCkgeyBhICYmIGMgPj0gYS5sZW5ndGggJiYgKGEgPSB2b2lkIDApOyByZXR1cm4geyB2YWx1ZTogYSAmJiBhW2MrK10sIGRvbmU6ICFhIH07IH0gfTsgfVxuZnVuY3Rpb24gZWEoYSwgYikgeyB2YXIgYyA9IFwiZnVuY3Rpb25cIiA9PT0gdHlwZW9mIFN5bWJvbCAmJiBhW1N5bWJvbC5pdGVyYXRvcl07IGlmICghYylcbiAgICByZXR1cm4gYTsgYSA9IGMuY2FsbChhKTsgdmFyIGQsIGUgPSBbXTsgdHJ5IHtcbiAgICBmb3IgKDsgKHZvaWQgMCA9PT0gYiB8fCAwIDwgYi0tKSAmJiAhKGQgPSBhLm5leHQoKSkuZG9uZTspXG4gICAgICAgIGUucHVzaChkLnZhbHVlKTtcbn1cbmNhdGNoIChnKSB7XG4gICAgdmFyIGYgPSB7IGVycm9yOiBnIH07XG59XG5maW5hbGx5IHtcbiAgICB0cnkge1xuICAgICAgICBkICYmICFkLmRvbmUgJiYgKGMgPSBhW1wicmV0dXJuXCJdKSAmJiBjLmNhbGwoYSk7XG4gICAgfVxuICAgIGZpbmFsbHkge1xuICAgICAgICBpZiAoZilcbiAgICAgICAgICAgIHRocm93IGYuZXJyb3I7XG4gICAgfVxufSByZXR1cm4gZTsgfVxuZnVuY3Rpb24gaWEoKSB7IGZvciAodmFyIGEgPSBbXSwgYiA9IDA7IGIgPCBhcmd1bWVudHMubGVuZ3RoOyBiKyspXG4gICAgYSA9IGEuY29uY2F0KGVhKGFyZ3VtZW50c1tiXSkpOyByZXR1cm4gYTsgfVxudmFyIGwgPSBcInVuZGVmaW5lZFwiICE9PSB0eXBlb2YgZ2xvYmFsVGhpcyA/IGdsb2JhbFRoaXMgOiBcInVuZGVmaW5lZFwiICE9PSB0eXBlb2Ygd2luZG93ID8gd2luZG93IDogXCJ1bmRlZmluZWRcIiAhPT0gdHlwZW9mIF9fd2VicGFja19yZXF1aXJlX18uZyA/IF9fd2VicGFja19yZXF1aXJlX18uZyA6IFwidW5kZWZpbmVkXCIgIT09IHR5cGVvZiBzZWxmID8gc2VsZiA6IHt9O1xuZnVuY3Rpb24gdChhKSB7IHJldHVybiBhICYmIGEuX19lc01vZHVsZSAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYSwgXCJkZWZhdWx0XCIpID8gYVtcImRlZmF1bHRcIl0gOiBhOyB9XG5mdW5jdGlvbiB1KGEsIGIpIHsgcmV0dXJuIGIgPSB7IGV4cG9ydHM6IHt9IH0sIGEoYiwgYi5leHBvcnRzKSwgYi5leHBvcnRzOyB9XG52YXIgdyA9IHUoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoYiwgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6ICEwIH0pO1xuICAgIGIuY29uc3RhbnRzID0geyBPX1JET05MWTogMCwgT19XUk9OTFk6IDEsIE9fUkRXUjogMiwgU19JRk1UOiA2MTQ0MCwgU19JRlJFRzogMzI3NjgsIFNfSUZESVI6IDE2Mzg0LCBTX0lGQ0hSOiA4MTkyLCBTX0lGQkxLOiAyNDU3NiwgU19JRklGTzogNDA5NiwgU19JRkxOSzogNDA5NjAsIFNfSUZTT0NLOiA0OTE1MiwgT19DUkVBVDogNjQsIE9fRVhDTDogMTI4LCBPX05PQ1RUWTogMjU2LCBPX1RSVU5DOiA1MTIsIE9fQVBQRU5EOiAxMDI0LCBPX0RJUkVDVE9SWTogNjU1MzYsIE9fTk9BVElNRTogMjYyMTQ0LCBPX05PRk9MTE9XOiAxMzEwNzIsIE9fU1lOQzogMTA1MjY3MiwgT19ESVJFQ1Q6IDE2Mzg0LCBPX05PTkJMT0NLOiAyMDQ4LCBTX0lSV1hVOiA0NDgsIFNfSVJVU1I6IDI1NiwgU19JV1VTUjogMTI4LCBTX0lYVVNSOiA2NCwgU19JUldYRzogNTYsIFNfSVJHUlA6IDMyLCBTX0lXR1JQOiAxNiwgU19JWEdSUDogOCwgU19JUldYTzogNywgU19JUk9USDogNCwgU19JV09USDogMixcbiAgICAgICAgU19JWE9USDogMSwgRl9PSzogMCwgUl9PSzogNCwgV19PSzogMiwgWF9PSzogMSwgVVZfRlNfU1lNTElOS19ESVI6IDEsIFVWX0ZTX1NZTUxJTktfSlVOQ1RJT046IDIsIFVWX0ZTX0NPUFlGSUxFX0VYQ0w6IDEsIFVWX0ZTX0NPUFlGSUxFX0ZJQ0xPTkU6IDIsIFVWX0ZTX0NPUFlGSUxFX0ZJQ0xPTkVfRk9SQ0U6IDQsIENPUFlGSUxFX0VYQ0w6IDEsIENPUFlGSUxFX0ZJQ0xPTkU6IDIsIENPUFlGSUxFX0ZJQ0xPTkVfRk9SQ0U6IDQgfTtcbn0pO1xudCh3KTtcbnZhciBqYSA9IHUoZnVuY3Rpb24gKGEsIGIpIHsgYi5kZWZhdWx0ID0gXCJmdW5jdGlvblwiID09PSB0eXBlb2YgQmlnSW50ID8gQmlnSW50IDogZnVuY3Rpb24gKCkgeyB0aHJvdyBFcnJvcihcIkJpZ0ludCBpcyBub3Qgc3VwcG9ydGVkIGluIHRoaXMgZW52aXJvbm1lbnQuXCIpOyB9OyB9KSwga2EgPSB1KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGIsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiAhMCB9KTtcbiAgICB2YXIgYyA9IHcuY29uc3RhbnRzLlNfSUZNVCwgZCA9IHcuY29uc3RhbnRzLlNfSUZESVIsIGUgPSB3LmNvbnN0YW50cy5TX0lGUkVHLCBmID0gdy5jb25zdGFudHMuU19JRkJMSywgZyA9IHcuY29uc3RhbnRzLlNfSUZDSFIsIGggPSB3LmNvbnN0YW50cy5TX0lGTE5LLCBrID0gdy5jb25zdGFudHMuU19JRklGTywgcCA9IHcuY29uc3RhbnRzLlNfSUZTT0NLO1xuICAgIGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIGEoKSB7IH1cbiAgICAgICAgYS5idWlsZCA9IGZ1bmN0aW9uIChiLCBjKSB7XG4gICAgICAgICAgICB2b2lkIDAgPT09IGMgJiYgKGMgPSAhMSk7XG4gICAgICAgICAgICB2YXIgZCA9IG5ldyBhLCBlID0gYi5naWQsIGYgPSBiLmF0aW1lLCBnID0gYi5tdGltZSwgaCA9IGIuY3RpbWU7XG4gICAgICAgICAgICBjID0gYyA/IGphLmRlZmF1bHQgOiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gYTsgfTtcbiAgICAgICAgICAgIGQudWlkID0gYyhiLnVpZCk7XG4gICAgICAgICAgICBkLmdpZCA9IGMoZSk7XG4gICAgICAgICAgICBkLnJkZXYgPSBjKDApO1xuICAgICAgICAgICAgZC5ibGtzaXplID0gYyg0MDk2KTtcbiAgICAgICAgICAgIGQuaW5vID0gYyhiLmlubyk7XG4gICAgICAgICAgICBkLnNpemUgPSBjKGIuZ2V0U2l6ZSgpKTtcbiAgICAgICAgICAgIGQuYmxvY2tzID0gYygxKTtcbiAgICAgICAgICAgIGQuYXRpbWUgPSBmO1xuICAgICAgICAgICAgZC5tdGltZSA9IGc7XG4gICAgICAgICAgICBkLmN0aW1lID0gaDtcbiAgICAgICAgICAgIGQuYmlydGh0aW1lID0gaDtcbiAgICAgICAgICAgIGQuYXRpbWVNcyA9IGMoZi5nZXRUaW1lKCkpO1xuICAgICAgICAgICAgZC5tdGltZU1zID0gYyhnLmdldFRpbWUoKSk7XG4gICAgICAgICAgICBlID0gYyhoLmdldFRpbWUoKSk7XG4gICAgICAgICAgICBkLmN0aW1lTXMgPSBlO1xuICAgICAgICAgICAgZC5iaXJ0aHRpbWVNcyA9IGU7XG4gICAgICAgICAgICBkLmRldiA9IGMoMCk7XG4gICAgICAgICAgICBkLm1vZGUgPSBjKGIubW9kZSk7XG4gICAgICAgICAgICBkLm5saW5rID0gYyhiLm5saW5rKTtcbiAgICAgICAgICAgIHJldHVybiBkO1xuICAgICAgICB9O1xuICAgICAgICBhLnByb3RvdHlwZS5fY2hlY2tNb2RlUHJvcGVydHkgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gKE51bWJlcih0aGlzLm1vZGUpICYgYykgPT09IGE7IH07XG4gICAgICAgIGEucHJvdG90eXBlLmlzRGlyZWN0b3J5ID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5fY2hlY2tNb2RlUHJvcGVydHkoZCk7IH07XG4gICAgICAgIGEucHJvdG90eXBlLmlzRmlsZSA9XG4gICAgICAgICAgICBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLl9jaGVja01vZGVQcm9wZXJ0eShlKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuaXNCbG9ja0RldmljZSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX2NoZWNrTW9kZVByb3BlcnR5KGYpOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5pc0NoYXJhY3RlckRldmljZSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX2NoZWNrTW9kZVByb3BlcnR5KGcpOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5pc1N5bWJvbGljTGluayA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX2NoZWNrTW9kZVByb3BlcnR5KGgpOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5pc0ZJRk8gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLl9jaGVja01vZGVQcm9wZXJ0eShrKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuaXNTb2NrZXQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLl9jaGVja01vZGVQcm9wZXJ0eShwKTsgfTtcbiAgICAgICAgcmV0dXJuIGE7XG4gICAgfSgpO1xuICAgIGIuU3RhdHMgPSBhO1xuICAgIGIuZGVmYXVsdCA9IGE7XG59KTtcbnQoa2EpO1xudmFyIGxhID0gXCJ1bmRlZmluZWRcIiAhPT0gdHlwZW9mIF9fd2VicGFja19yZXF1aXJlX18uZyA/IF9fd2VicGFja19yZXF1aXJlX18uZyA6IFwidW5kZWZpbmVkXCIgIT09IHR5cGVvZiBzZWxmID8gc2VsZiA6IFwidW5kZWZpbmVkXCIgIT09IHR5cGVvZiB3aW5kb3cgPyB3aW5kb3cgOiB7fSwgeCA9IFtdLCB5ID0gW10sIG1hID0gXCJ1bmRlZmluZWRcIiAhPT0gdHlwZW9mIFVpbnQ4QXJyYXkgPyBVaW50OEFycmF5IDogQXJyYXksIG9hID0gITE7XG5mdW5jdGlvbiBwYSgpIHsgb2EgPSAhMDsgZm9yICh2YXIgYSA9IDA7IDY0ID4gYTsgKythKVxuICAgIHhbYV0gPSBcIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky9cIlthXSwgeVtcIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky9cIi5jaGFyQ29kZUF0KGEpXSA9IGE7IHlbNDVdID0gNjI7IHlbOTVdID0gNjM7IH1cbmZ1bmN0aW9uIHFhKGEsIGIsIGMpIHsgZm9yICh2YXIgZCA9IFtdLCBlID0gYjsgZSA8IGM7IGUgKz0gMylcbiAgICBiID0gKGFbZV0gPDwgMTYpICsgKGFbZSArIDFdIDw8IDgpICsgYVtlICsgMl0sIGQucHVzaCh4W2IgPj4gMTggJiA2M10gKyB4W2IgPj4gMTIgJiA2M10gKyB4W2IgPj4gNiAmIDYzXSArIHhbYiAmIDYzXSk7IHJldHVybiBkLmpvaW4oXCJcIik7IH1cbmZ1bmN0aW9uIHJhKGEpIHsgb2EgfHwgcGEoKTsgZm9yICh2YXIgYiA9IGEubGVuZ3RoLCBjID0gYiAlIDMsIGQgPSBcIlwiLCBlID0gW10sIGYgPSAwLCBnID0gYiAtIGM7IGYgPCBnOyBmICs9IDE2MzgzKVxuICAgIGUucHVzaChxYShhLCBmLCBmICsgMTYzODMgPiBnID8gZyA6IGYgKyAxNjM4MykpOyAxID09PSBjID8gKGEgPSBhW2IgLSAxXSwgZCArPSB4W2EgPj4gMl0sIGQgKz0geFthIDw8IDQgJiA2M10sIGQgKz0gXCI9PVwiKSA6IDIgPT09IGMgJiYgKGEgPSAoYVtiIC0gMl0gPDwgOCkgKyBhW2IgLSAxXSwgZCArPSB4W2EgPj4gMTBdLCBkICs9IHhbYSA+PiA0ICYgNjNdLCBkICs9IHhbYSA8PCAyICYgNjNdLCBkICs9IFwiPVwiKTsgZS5wdXNoKGQpOyByZXR1cm4gZS5qb2luKFwiXCIpOyB9XG5mdW5jdGlvbiBzYShhLCBiLCBjLCBkLCBlKSB7IHZhciBmID0gOCAqIGUgLSBkIC0gMTsgdmFyIGcgPSAoMSA8PCBmKSAtIDEsIGggPSBnID4+IDEsIGsgPSAtNzsgZSA9IGMgPyBlIC0gMSA6IDA7IHZhciBwID0gYyA/IC0xIDogMSwgbiA9IGFbYiArIGVdOyBlICs9IHA7IGMgPSBuICYgKDEgPDwgLWspIC0gMTsgbiA+Pj0gLWs7IGZvciAoayArPSBmOyAwIDwgazsgYyA9IDI1NiAqIGMgKyBhW2IgKyBlXSwgZSArPSBwLCBrIC09IDgpXG4gICAgOyBmID0gYyAmICgxIDw8IC1rKSAtIDE7IGMgPj49IC1rOyBmb3IgKGsgKz0gZDsgMCA8IGs7IGYgPSAyNTYgKiBmICsgYVtiICsgZV0sIGUgKz0gcCwgayAtPSA4KVxuICAgIDsgaWYgKDAgPT09IGMpXG4gICAgYyA9IDEgLSBoO1xuZWxzZSB7XG4gICAgaWYgKGMgPT09IGcpXG4gICAgICAgIHJldHVybiBmID8gTmFOIDogSW5maW5pdHkgKiAobiA/IC0xIDogMSk7XG4gICAgZiArPSBNYXRoLnBvdygyLCBkKTtcbiAgICBjIC09IGg7XG59IHJldHVybiAobiA/IC0xIDogMSkgKiBmICogTWF0aC5wb3coMiwgYyAtIGQpOyB9XG5mdW5jdGlvbiB0YShhLCBiLCBjLCBkLCBlLCBmKSB7XG4gICAgdmFyIGcsIGggPSA4ICogZiAtIGUgLSAxLCBrID0gKDEgPDwgaCkgLSAxLCBwID0gayA+PiAxLCBuID0gMjMgPT09IGUgPyBNYXRoLnBvdygyLCAtMjQpIC0gTWF0aC5wb3coMiwgLTc3KSA6IDA7XG4gICAgZiA9IGQgPyAwIDogZiAtIDE7XG4gICAgdmFyIHEgPSBkID8gMSA6IC0xLCBCID0gMCA+IGIgfHwgMCA9PT0gYiAmJiAwID4gMSAvIGIgPyAxIDogMDtcbiAgICBiID0gTWF0aC5hYnMoYik7XG4gICAgaXNOYU4oYikgfHwgSW5maW5pdHkgPT09IGIgPyAoYiA9IGlzTmFOKGIpID8gMSA6IDAsIGQgPSBrKSA6IChkID0gTWF0aC5mbG9vcihNYXRoLmxvZyhiKSAvIE1hdGguTE4yKSwgMSA+IGIgKiAoZyA9IE1hdGgucG93KDIsIC1kKSkgJiYgKGQtLSwgZyAqPSAyKSwgYiA9IDEgPD0gZCArIHAgPyBiICsgbiAvIGcgOiBiICsgbiAqIE1hdGgucG93KDIsIDEgLSBwKSwgMiA8PSBiICogZyAmJiAoZCsrLCBnIC89IDIpLCBkICsgcCA+PSBrID8gKGIgPSAwLCBkID0gaykgOiAxIDw9IGQgKyBwID8gKGIgPSAoYiAqIGcgLSAxKSAqIE1hdGgucG93KDIsIGUpLCBkICs9IHApIDogKGIgPSBiICogTWF0aC5wb3coMiwgcCAtIDEpICogTWF0aC5wb3coMiwgZSksIGQgPSAwKSk7XG4gICAgZm9yICg7IDggPD0gZTsgYVtjICsgZl0gPSBiICYgMjU1LCBmICs9IHEsIGIgLz0gMjU2LCBlIC09IDgpXG4gICAgICAgIDtcbiAgICBkID0gZCA8PCBlIHwgYjtcbiAgICBmb3IgKGggKz0gZTsgMCA8IGg7IGFbYyArIGZdID0gZCAmIDI1NSxcbiAgICAgICAgZiArPSBxLCBkIC89IDI1NiwgaCAtPSA4KVxuICAgICAgICA7XG4gICAgYVtjICsgZiAtIHFdIHw9IDEyOCAqIEI7XG59XG52YXIgd2EgPSB7fS50b1N0cmluZywgeWEgPSBBcnJheS5pc0FycmF5IHx8IGZ1bmN0aW9uIChhKSB7IHJldHVybiBcIltvYmplY3QgQXJyYXldXCIgPT0gd2EuY2FsbChhKTsgfTtcbnouVFlQRURfQVJSQVlfU1VQUE9SVCA9IHZvaWQgMCAhPT0gbGEuVFlQRURfQVJSQVlfU1VQUE9SVCA/IGxhLlRZUEVEX0FSUkFZX1NVUFBPUlQgOiAhMDtcbnZhciB6YSA9IHouVFlQRURfQVJSQVlfU1VQUE9SVCA/IDIxNDc0ODM2NDcgOiAxMDczNzQxODIzO1xuZnVuY3Rpb24gQWEoYSwgYikgeyBpZiAoKHouVFlQRURfQVJSQVlfU1VQUE9SVCA/IDIxNDc0ODM2NDcgOiAxMDczNzQxODIzKSA8IGIpXG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoXCJJbnZhbGlkIHR5cGVkIGFycmF5IGxlbmd0aFwiKTsgei5UWVBFRF9BUlJBWV9TVVBQT1JUID8gKGEgPSBuZXcgVWludDhBcnJheShiKSwgYS5fX3Byb3RvX18gPSB6LnByb3RvdHlwZSkgOiAobnVsbCA9PT0gYSAmJiAoYSA9IG5ldyB6KGIpKSwgYS5sZW5ndGggPSBiKTsgcmV0dXJuIGE7IH1cbmZ1bmN0aW9uIHooYSwgYiwgYykgeyBpZiAoISh6LlRZUEVEX0FSUkFZX1NVUFBPUlQgfHwgdGhpcyBpbnN0YW5jZW9mIHopKVxuICAgIHJldHVybiBuZXcgeihhLCBiLCBjKTsgaWYgKFwibnVtYmVyXCIgPT09IHR5cGVvZiBhKSB7XG4gICAgaWYgKFwic3RyaW5nXCIgPT09IHR5cGVvZiBiKVxuICAgICAgICB0aHJvdyBFcnJvcihcIklmIGVuY29kaW5nIGlzIHNwZWNpZmllZCB0aGVuIHRoZSBmaXJzdCBhcmd1bWVudCBtdXN0IGJlIGEgc3RyaW5nXCIpO1xuICAgIHJldHVybiBCYSh0aGlzLCBhKTtcbn0gcmV0dXJuIENhKHRoaXMsIGEsIGIsIGMpOyB9XG56LnBvb2xTaXplID0gODE5MjtcbnouX2F1Z21lbnQgPSBmdW5jdGlvbiAoYSkgeyBhLl9fcHJvdG9fXyA9IHoucHJvdG90eXBlOyByZXR1cm4gYTsgfTtcbmZ1bmN0aW9uIENhKGEsIGIsIGMsIGQpIHtcbiAgICBpZiAoXCJudW1iZXJcIiA9PT0gdHlwZW9mIGIpXG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1widmFsdWVcIiBhcmd1bWVudCBtdXN0IG5vdCBiZSBhIG51bWJlcicpO1xuICAgIGlmIChcInVuZGVmaW5lZFwiICE9PSB0eXBlb2YgQXJyYXlCdWZmZXIgJiYgYiBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7XG4gICAgICAgIGIuYnl0ZUxlbmd0aDtcbiAgICAgICAgaWYgKDAgPiBjIHx8IGIuYnl0ZUxlbmd0aCA8IGMpXG4gICAgICAgICAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcihcIidvZmZzZXQnIGlzIG91dCBvZiBib3VuZHNcIik7XG4gICAgICAgIGlmIChiLmJ5dGVMZW5ndGggPCBjICsgKGQgfHwgMCkpXG4gICAgICAgICAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcihcIidsZW5ndGgnIGlzIG91dCBvZiBib3VuZHNcIik7XG4gICAgICAgIGIgPSB2b2lkIDAgPT09IGMgJiYgdm9pZCAwID09PSBkID8gbmV3IFVpbnQ4QXJyYXkoYikgOiB2b2lkIDAgPT09IGQgPyBuZXcgVWludDhBcnJheShiLCBjKSA6IG5ldyBVaW50OEFycmF5KGIsIGMsIGQpO1xuICAgICAgICB6LlRZUEVEX0FSUkFZX1NVUFBPUlQgPyAoYSA9IGIsIGEuX19wcm90b19fID0gei5wcm90b3R5cGUpIDogYSA9IERhKGEsIGIpO1xuICAgICAgICByZXR1cm4gYTtcbiAgICB9XG4gICAgaWYgKFwic3RyaW5nXCIgPT09XG4gICAgICAgIHR5cGVvZiBiKSB7XG4gICAgICAgIGQgPSBhO1xuICAgICAgICBhID0gYztcbiAgICAgICAgaWYgKFwic3RyaW5nXCIgIT09IHR5cGVvZiBhIHx8IFwiXCIgPT09IGEpXG4gICAgICAgICAgICBhID0gXCJ1dGY4XCI7XG4gICAgICAgIGlmICghei5pc0VuY29kaW5nKGEpKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignXCJlbmNvZGluZ1wiIG11c3QgYmUgYSB2YWxpZCBzdHJpbmcgZW5jb2RpbmcnKTtcbiAgICAgICAgYyA9IEVhKGIsIGEpIHwgMDtcbiAgICAgICAgZCA9IEFhKGQsIGMpO1xuICAgICAgICBiID0gZC53cml0ZShiLCBhKTtcbiAgICAgICAgYiAhPT0gYyAmJiAoZCA9IGQuc2xpY2UoMCwgYikpO1xuICAgICAgICByZXR1cm4gZDtcbiAgICB9XG4gICAgcmV0dXJuIEZhKGEsIGIpO1xufVxuei5mcm9tID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgcmV0dXJuIENhKG51bGwsIGEsIGIsIGMpOyB9O1xuei5UWVBFRF9BUlJBWV9TVVBQT1JUICYmICh6LnByb3RvdHlwZS5fX3Byb3RvX18gPSBVaW50OEFycmF5LnByb3RvdHlwZSwgei5fX3Byb3RvX18gPSBVaW50OEFycmF5KTtcbmZ1bmN0aW9uIEdhKGEpIHsgaWYgKFwibnVtYmVyXCIgIT09IHR5cGVvZiBhKVxuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1wic2l6ZVwiIGFyZ3VtZW50IG11c3QgYmUgYSBudW1iZXInKTsgaWYgKDAgPiBhKVxuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdcInNpemVcIiBhcmd1bWVudCBtdXN0IG5vdCBiZSBuZWdhdGl2ZScpOyB9XG56LmFsbG9jID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgR2EoYSk7IGEgPSAwID49IGEgPyBBYShudWxsLCBhKSA6IHZvaWQgMCAhPT0gYiA/IFwic3RyaW5nXCIgPT09IHR5cGVvZiBjID8gQWEobnVsbCwgYSkuZmlsbChiLCBjKSA6IEFhKG51bGwsIGEpLmZpbGwoYikgOiBBYShudWxsLCBhKTsgcmV0dXJuIGE7IH07XG5mdW5jdGlvbiBCYShhLCBiKSB7IEdhKGIpOyBhID0gQWEoYSwgMCA+IGIgPyAwIDogTWEoYikgfCAwKTsgaWYgKCF6LlRZUEVEX0FSUkFZX1NVUFBPUlQpXG4gICAgZm9yICh2YXIgYyA9IDA7IGMgPCBiOyArK2MpXG4gICAgICAgIGFbY10gPSAwOyByZXR1cm4gYTsgfVxuei5hbGxvY1Vuc2FmZSA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiBCYShudWxsLCBhKTsgfTtcbnouYWxsb2NVbnNhZmVTbG93ID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIEJhKG51bGwsIGEpOyB9O1xuZnVuY3Rpb24gRGEoYSwgYikgeyB2YXIgYyA9IDAgPiBiLmxlbmd0aCA/IDAgOiBNYShiLmxlbmd0aCkgfCAwOyBhID0gQWEoYSwgYyk7IGZvciAodmFyIGQgPSAwOyBkIDwgYzsgZCArPSAxKVxuICAgIGFbZF0gPSBiW2RdICYgMjU1OyByZXR1cm4gYTsgfVxuZnVuY3Rpb24gRmEoYSwgYikgeyBpZiAoQShiKSkge1xuICAgIHZhciBjID0gTWEoYi5sZW5ndGgpIHwgMDtcbiAgICBhID0gQWEoYSwgYyk7XG4gICAgaWYgKDAgPT09IGEubGVuZ3RoKVxuICAgICAgICByZXR1cm4gYTtcbiAgICBiLmNvcHkoYSwgMCwgMCwgYyk7XG4gICAgcmV0dXJuIGE7XG59IGlmIChiKSB7XG4gICAgaWYgKFwidW5kZWZpbmVkXCIgIT09IHR5cGVvZiBBcnJheUJ1ZmZlciAmJiBiLmJ1ZmZlciBpbnN0YW5jZW9mIEFycmF5QnVmZmVyIHx8IFwibGVuZ3RoXCIgaW4gYilcbiAgICAgICAgcmV0dXJuIChjID0gXCJudW1iZXJcIiAhPT0gdHlwZW9mIGIubGVuZ3RoKSB8fCAoYyA9IGIubGVuZ3RoLCBjID0gYyAhPT0gYyksIGMgPyBBYShhLCAwKSA6IERhKGEsIGIpO1xuICAgIGlmIChcIkJ1ZmZlclwiID09PSBiLnR5cGUgJiYgeWEoYi5kYXRhKSlcbiAgICAgICAgcmV0dXJuIERhKGEsIGIuZGF0YSk7XG59IHRocm93IG5ldyBUeXBlRXJyb3IoXCJGaXJzdCBhcmd1bWVudCBtdXN0IGJlIGEgc3RyaW5nLCBCdWZmZXIsIEFycmF5QnVmZmVyLCBBcnJheSwgb3IgYXJyYXktbGlrZSBvYmplY3QuXCIpOyB9XG5mdW5jdGlvbiBNYShhKSB7IGlmIChhID49ICh6LlRZUEVEX0FSUkFZX1NVUFBPUlQgPyAyMTQ3NDgzNjQ3IDogMTA3Mzc0MTgyMykpXG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoXCJBdHRlbXB0IHRvIGFsbG9jYXRlIEJ1ZmZlciBsYXJnZXIgdGhhbiBtYXhpbXVtIHNpemU6IDB4XCIgKyAoei5UWVBFRF9BUlJBWV9TVVBQT1JUID8gMjE0NzQ4MzY0NyA6IDEwNzM3NDE4MjMpLnRvU3RyaW5nKDE2KSArIFwiIGJ5dGVzXCIpOyByZXR1cm4gYSB8IDA7IH1cbnouaXNCdWZmZXIgPSBOYTtcbmZ1bmN0aW9uIEEoYSkgeyByZXR1cm4gIShudWxsID09IGEgfHwgIWEuX2lzQnVmZmVyKTsgfVxuei5jb21wYXJlID0gZnVuY3Rpb24gKGEsIGIpIHsgaWYgKCFBKGEpIHx8ICFBKGIpKVxuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJBcmd1bWVudHMgbXVzdCBiZSBCdWZmZXJzXCIpOyBpZiAoYSA9PT0gYilcbiAgICByZXR1cm4gMDsgZm9yICh2YXIgYyA9IGEubGVuZ3RoLCBkID0gYi5sZW5ndGgsIGUgPSAwLCBmID0gTWF0aC5taW4oYywgZCk7IGUgPCBmOyArK2UpXG4gICAgaWYgKGFbZV0gIT09IGJbZV0pIHtcbiAgICAgICAgYyA9IGFbZV07XG4gICAgICAgIGQgPSBiW2VdO1xuICAgICAgICBicmVhaztcbiAgICB9IHJldHVybiBjIDwgZCA/IC0xIDogZCA8IGMgPyAxIDogMDsgfTtcbnouaXNFbmNvZGluZyA9IGZ1bmN0aW9uIChhKSB7IHN3aXRjaCAoU3RyaW5nKGEpLnRvTG93ZXJDYXNlKCkpIHtcbiAgICBjYXNlIFwiaGV4XCI6XG4gICAgY2FzZSBcInV0ZjhcIjpcbiAgICBjYXNlIFwidXRmLThcIjpcbiAgICBjYXNlIFwiYXNjaWlcIjpcbiAgICBjYXNlIFwibGF0aW4xXCI6XG4gICAgY2FzZSBcImJpbmFyeVwiOlxuICAgIGNhc2UgXCJiYXNlNjRcIjpcbiAgICBjYXNlIFwidWNzMlwiOlxuICAgIGNhc2UgXCJ1Y3MtMlwiOlxuICAgIGNhc2UgXCJ1dGYxNmxlXCI6XG4gICAgY2FzZSBcInV0Zi0xNmxlXCI6IHJldHVybiAhMDtcbiAgICBkZWZhdWx0OiByZXR1cm4gITE7XG59IH07XG56LmNvbmNhdCA9IGZ1bmN0aW9uIChhLCBiKSB7IGlmICgheWEoYSkpXG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignXCJsaXN0XCIgYXJndW1lbnQgbXVzdCBiZSBhbiBBcnJheSBvZiBCdWZmZXJzJyk7IGlmICgwID09PSBhLmxlbmd0aClcbiAgICByZXR1cm4gei5hbGxvYygwKTsgdmFyIGM7IGlmICh2b2lkIDAgPT09IGIpXG4gICAgZm9yIChjID0gYiA9IDA7IGMgPCBhLmxlbmd0aDsgKytjKVxuICAgICAgICBiICs9IGFbY10ubGVuZ3RoOyBiID0gei5hbGxvY1Vuc2FmZShiKTsgdmFyIGQgPSAwOyBmb3IgKGMgPSAwOyBjIDwgYS5sZW5ndGg7ICsrYykge1xuICAgIHZhciBlID0gYVtjXTtcbiAgICBpZiAoIUEoZSkpXG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1wibGlzdFwiIGFyZ3VtZW50IG11c3QgYmUgYW4gQXJyYXkgb2YgQnVmZmVycycpO1xuICAgIGUuY29weShiLCBkKTtcbiAgICBkICs9IGUubGVuZ3RoO1xufSByZXR1cm4gYjsgfTtcbmZ1bmN0aW9uIEVhKGEsIGIpIHtcbiAgICBpZiAoQShhKSlcbiAgICAgICAgcmV0dXJuIGEubGVuZ3RoO1xuICAgIGlmIChcInVuZGVmaW5lZFwiICE9PSB0eXBlb2YgQXJyYXlCdWZmZXIgJiYgXCJmdW5jdGlvblwiID09PSB0eXBlb2YgQXJyYXlCdWZmZXIuaXNWaWV3ICYmIChBcnJheUJ1ZmZlci5pc1ZpZXcoYSkgfHwgYSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSlcbiAgICAgICAgcmV0dXJuIGEuYnl0ZUxlbmd0aDtcbiAgICBcInN0cmluZ1wiICE9PSB0eXBlb2YgYSAmJiAoYSA9IFwiXCIgKyBhKTtcbiAgICB2YXIgYyA9IGEubGVuZ3RoO1xuICAgIGlmICgwID09PSBjKVxuICAgICAgICByZXR1cm4gMDtcbiAgICBmb3IgKHZhciBkID0gITE7OylcbiAgICAgICAgc3dpdGNoIChiKSB7XG4gICAgICAgICAgICBjYXNlIFwiYXNjaWlcIjpcbiAgICAgICAgICAgIGNhc2UgXCJsYXRpbjFcIjpcbiAgICAgICAgICAgIGNhc2UgXCJiaW5hcnlcIjogcmV0dXJuIGM7XG4gICAgICAgICAgICBjYXNlIFwidXRmOFwiOlxuICAgICAgICAgICAgY2FzZSBcInV0Zi04XCI6XG4gICAgICAgICAgICBjYXNlIHZvaWQgMDogcmV0dXJuIE9hKGEpLmxlbmd0aDtcbiAgICAgICAgICAgIGNhc2UgXCJ1Y3MyXCI6XG4gICAgICAgICAgICBjYXNlIFwidWNzLTJcIjpcbiAgICAgICAgICAgIGNhc2UgXCJ1dGYxNmxlXCI6XG4gICAgICAgICAgICBjYXNlIFwidXRmLTE2bGVcIjogcmV0dXJuIDIgKiBjO1xuICAgICAgICAgICAgY2FzZSBcImhleFwiOiByZXR1cm4gYyA+Pj4gMTtcbiAgICAgICAgICAgIGNhc2UgXCJiYXNlNjRcIjogcmV0dXJuIFBhKGEpLmxlbmd0aDtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgaWYgKGQpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBPYShhKS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgYiA9IChcIlwiICsgYikudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgICBkID0gITA7XG4gICAgICAgIH1cbn1cbnouYnl0ZUxlbmd0aCA9IEVhO1xuZnVuY3Rpb24gUWEoYSwgYiwgYykge1xuICAgIHZhciBkID0gITE7XG4gICAgaWYgKHZvaWQgMCA9PT0gYiB8fCAwID4gYilcbiAgICAgICAgYiA9IDA7XG4gICAgaWYgKGIgPiB0aGlzLmxlbmd0aClcbiAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgaWYgKHZvaWQgMCA9PT0gYyB8fCBjID4gdGhpcy5sZW5ndGgpXG4gICAgICAgIGMgPSB0aGlzLmxlbmd0aDtcbiAgICBpZiAoMCA+PSBjKVxuICAgICAgICByZXR1cm4gXCJcIjtcbiAgICBjID4+Pj0gMDtcbiAgICBiID4+Pj0gMDtcbiAgICBpZiAoYyA8PSBiKVxuICAgICAgICByZXR1cm4gXCJcIjtcbiAgICBmb3IgKGEgfHwgKGEgPSBcInV0ZjhcIik7OylcbiAgICAgICAgc3dpdGNoIChhKSB7XG4gICAgICAgICAgICBjYXNlIFwiaGV4XCI6XG4gICAgICAgICAgICAgICAgYSA9IGI7XG4gICAgICAgICAgICAgICAgYiA9IGM7XG4gICAgICAgICAgICAgICAgYyA9IHRoaXMubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGlmICghYSB8fCAwID4gYSlcbiAgICAgICAgICAgICAgICAgICAgYSA9IDA7XG4gICAgICAgICAgICAgICAgaWYgKCFiIHx8IDAgPiBiIHx8IGIgPiBjKVxuICAgICAgICAgICAgICAgICAgICBiID0gYztcbiAgICAgICAgICAgICAgICBkID0gXCJcIjtcbiAgICAgICAgICAgICAgICBmb3IgKGMgPSBhOyBjIDwgYjsgKytjKVxuICAgICAgICAgICAgICAgICAgICBhID0gZCwgZCA9IHRoaXNbY10sIGQgPSAxNiA+IGQgPyBcIjBcIiArIGQudG9TdHJpbmcoMTYpIDogZC50b1N0cmluZygxNiksIGQgPSBhICsgZDtcbiAgICAgICAgICAgICAgICByZXR1cm4gZDtcbiAgICAgICAgICAgIGNhc2UgXCJ1dGY4XCI6XG4gICAgICAgICAgICBjYXNlIFwidXRmLThcIjogcmV0dXJuIFJhKHRoaXMsIGIsIGMpO1xuICAgICAgICAgICAgY2FzZSBcImFzY2lpXCI6XG4gICAgICAgICAgICAgICAgYSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgZm9yIChjID0gTWF0aC5taW4odGhpcy5sZW5ndGgsIGMpOyBiIDwgYzsgKytiKVxuICAgICAgICAgICAgICAgICAgICBhICs9IFN0cmluZy5mcm9tQ2hhckNvZGUodGhpc1tiXSAmIDEyNyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICBjYXNlIFwibGF0aW4xXCI6XG4gICAgICAgICAgICBjYXNlIFwiYmluYXJ5XCI6XG4gICAgICAgICAgICAgICAgYSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgZm9yIChjID0gTWF0aC5taW4odGhpcy5sZW5ndGgsIGMpOyBiIDwgYzsgKytiKVxuICAgICAgICAgICAgICAgICAgICBhICs9IFN0cmluZy5mcm9tQ2hhckNvZGUodGhpc1tiXSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICBjYXNlIFwiYmFzZTY0XCI6IHJldHVybiBiID0gMCA9PT0gYiAmJiBjID09PSB0aGlzLmxlbmd0aCA/IHJhKHRoaXMpIDogcmEodGhpcy5zbGljZShiLCBjKSksIGI7XG4gICAgICAgICAgICBjYXNlIFwidWNzMlwiOlxuICAgICAgICAgICAgY2FzZSBcInVjcy0yXCI6XG4gICAgICAgICAgICBjYXNlIFwidXRmMTZsZVwiOlxuICAgICAgICAgICAgY2FzZSBcInV0Zi0xNmxlXCI6XG4gICAgICAgICAgICAgICAgYiA9IHRoaXMuc2xpY2UoYiwgYyk7XG4gICAgICAgICAgICAgICAgYyA9IFwiXCI7XG4gICAgICAgICAgICAgICAgZm9yIChhID0gMDsgYSA8IGIubGVuZ3RoOyBhICs9IDIpXG4gICAgICAgICAgICAgICAgICAgIGMgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShiW2FdICsgMjU2ICogYlthICsgMV0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBjO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBpZiAoZClcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlVua25vd24gZW5jb2Rpbmc6IFwiICsgYSk7XG4gICAgICAgICAgICAgICAgYSA9IChhICsgXCJcIikudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgICBkID0gITA7XG4gICAgICAgIH1cbn1cbnoucHJvdG90eXBlLl9pc0J1ZmZlciA9ICEwO1xuZnVuY3Rpb24gU2EoYSwgYiwgYykgeyB2YXIgZCA9IGFbYl07IGFbYl0gPSBhW2NdOyBhW2NdID0gZDsgfVxuei5wcm90b3R5cGUuc3dhcDE2ID0gZnVuY3Rpb24gKCkgeyB2YXIgYSA9IHRoaXMubGVuZ3RoOyBpZiAoMCAhPT0gYSAlIDIpXG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoXCJCdWZmZXIgc2l6ZSBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgMTYtYml0c1wiKTsgZm9yICh2YXIgYiA9IDA7IGIgPCBhOyBiICs9IDIpXG4gICAgU2EodGhpcywgYiwgYiArIDEpOyByZXR1cm4gdGhpczsgfTtcbnoucHJvdG90eXBlLnN3YXAzMiA9IGZ1bmN0aW9uICgpIHsgdmFyIGEgPSB0aGlzLmxlbmd0aDsgaWYgKDAgIT09IGEgJSA0KVxuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKFwiQnVmZmVyIHNpemUgbXVzdCBiZSBhIG11bHRpcGxlIG9mIDMyLWJpdHNcIik7IGZvciAodmFyIGIgPSAwOyBiIDwgYTsgYiArPSA0KVxuICAgIFNhKHRoaXMsIGIsIGIgKyAzKSwgU2EodGhpcywgYiArIDEsIGIgKyAyKTsgcmV0dXJuIHRoaXM7IH07XG56LnByb3RvdHlwZS5zd2FwNjQgPSBmdW5jdGlvbiAoKSB7IHZhciBhID0gdGhpcy5sZW5ndGg7IGlmICgwICE9PSBhICUgOClcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcihcIkJ1ZmZlciBzaXplIG11c3QgYmUgYSBtdWx0aXBsZSBvZiA2NC1iaXRzXCIpOyBmb3IgKHZhciBiID0gMDsgYiA8IGE7IGIgKz0gOClcbiAgICBTYSh0aGlzLCBiLCBiICsgNyksIFNhKHRoaXMsIGIgKyAxLCBiICsgNiksIFNhKHRoaXMsIGIgKyAyLCBiICsgNSksIFNhKHRoaXMsIGIgKyAzLCBiICsgNCk7IHJldHVybiB0aGlzOyB9O1xuei5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7IHZhciBhID0gdGhpcy5sZW5ndGggfCAwOyByZXR1cm4gMCA9PT0gYSA/IFwiXCIgOiAwID09PSBhcmd1bWVudHMubGVuZ3RoID8gUmEodGhpcywgMCwgYSkgOiBRYS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOyB9O1xuei5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKGEpIHsgaWYgKCFBKGEpKVxuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJBcmd1bWVudCBtdXN0IGJlIGEgQnVmZmVyXCIpOyByZXR1cm4gdGhpcyA9PT0gYSA/ICEwIDogMCA9PT0gei5jb21wYXJlKHRoaXMsIGEpOyB9O1xuei5wcm90b3R5cGUuaW5zcGVjdCA9IGZ1bmN0aW9uICgpIHsgdmFyIGEgPSBcIlwiOyAwIDwgdGhpcy5sZW5ndGggJiYgKGEgPSB0aGlzLnRvU3RyaW5nKFwiaGV4XCIsIDAsIDUwKS5tYXRjaCgvLnsyfS9nKS5qb2luKFwiIFwiKSwgNTAgPCB0aGlzLmxlbmd0aCAmJiAoYSArPSBcIiAuLi4gXCIpKTsgcmV0dXJuIFwiPEJ1ZmZlciBcIiArIGEgKyBcIj5cIjsgfTtcbnoucHJvdG90eXBlLmNvbXBhcmUgPSBmdW5jdGlvbiAoYSwgYiwgYywgZCwgZSkge1xuICAgIGlmICghQShhKSlcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkFyZ3VtZW50IG11c3QgYmUgYSBCdWZmZXJcIik7XG4gICAgdm9pZCAwID09PSBiICYmIChiID0gMCk7XG4gICAgdm9pZCAwID09PSBjICYmIChjID0gYSA/IGEubGVuZ3RoIDogMCk7XG4gICAgdm9pZCAwID09PSBkICYmIChkID0gMCk7XG4gICAgdm9pZCAwID09PSBlICYmIChlID0gdGhpcy5sZW5ndGgpO1xuICAgIGlmICgwID4gYiB8fCBjID4gYS5sZW5ndGggfHwgMCA+IGQgfHwgZSA+IHRoaXMubGVuZ3RoKVxuICAgICAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcihcIm91dCBvZiByYW5nZSBpbmRleFwiKTtcbiAgICBpZiAoZCA+PSBlICYmIGIgPj0gYylcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgaWYgKGQgPj0gZSlcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIGlmIChiID49IGMpXG4gICAgICAgIHJldHVybiAxO1xuICAgIGIgPj4+PSAwO1xuICAgIGMgPj4+PSAwO1xuICAgIGQgPj4+PSAwO1xuICAgIGUgPj4+PSAwO1xuICAgIGlmICh0aGlzID09PSBhKVxuICAgICAgICByZXR1cm4gMDtcbiAgICB2YXIgZiA9IGUgLSBkLCBnID0gYyAtIGIsIGggPSBNYXRoLm1pbihmLCBnKTtcbiAgICBkID0gdGhpcy5zbGljZShkLCBlKTtcbiAgICBhID0gYS5zbGljZShiLCBjKTtcbiAgICBmb3IgKGIgPSAwOyBiIDwgaDsgKytiKVxuICAgICAgICBpZiAoZFtiXSAhPT0gYVtiXSkge1xuICAgICAgICAgICAgZiA9IGRbYl07XG4gICAgICAgICAgICBnID0gYVtiXTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgcmV0dXJuIGYgPFxuICAgICAgICBnID8gLTEgOiBnIDwgZiA/IDEgOiAwO1xufTtcbmZ1bmN0aW9uIFRhKGEsIGIsIGMsIGQsIGUpIHtcbiAgICBpZiAoMCA9PT0gYS5sZW5ndGgpXG4gICAgICAgIHJldHVybiAtMTtcbiAgICBcInN0cmluZ1wiID09PSB0eXBlb2YgYyA/IChkID0gYywgYyA9IDApIDogMjE0NzQ4MzY0NyA8IGMgPyBjID0gMjE0NzQ4MzY0NyA6IC0yMTQ3NDgzNjQ4ID4gYyAmJiAoYyA9IC0yMTQ3NDgzNjQ4KTtcbiAgICBjID0gK2M7XG4gICAgaXNOYU4oYykgJiYgKGMgPSBlID8gMCA6IGEubGVuZ3RoIC0gMSk7XG4gICAgMCA+IGMgJiYgKGMgPSBhLmxlbmd0aCArIGMpO1xuICAgIGlmIChjID49IGEubGVuZ3RoKSB7XG4gICAgICAgIGlmIChlKVxuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICBjID0gYS5sZW5ndGggLSAxO1xuICAgIH1cbiAgICBlbHNlIGlmICgwID4gYylcbiAgICAgICAgaWYgKGUpXG4gICAgICAgICAgICBjID0gMDtcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgIFwic3RyaW5nXCIgPT09IHR5cGVvZiBiICYmIChiID0gei5mcm9tKGIsIGQpKTtcbiAgICBpZiAoQShiKSlcbiAgICAgICAgcmV0dXJuIDAgPT09IGIubGVuZ3RoID8gLTEgOiBVYShhLCBiLCBjLCBkLCBlKTtcbiAgICBpZiAoXCJudW1iZXJcIiA9PT0gdHlwZW9mIGIpXG4gICAgICAgIHJldHVybiBiICY9IDI1NSwgei5UWVBFRF9BUlJBWV9TVVBQT1JUICYmIFwiZnVuY3Rpb25cIiA9PT0gdHlwZW9mIFVpbnQ4QXJyYXkucHJvdG90eXBlLmluZGV4T2YgPyBlID8gVWludDhBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKGEsIGIsIGMpIDpcbiAgICAgICAgICAgIFVpbnQ4QXJyYXkucHJvdG90eXBlLmxhc3RJbmRleE9mLmNhbGwoYSwgYiwgYykgOiBVYShhLCBbYl0sIGMsIGQsIGUpO1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJ2YWwgbXVzdCBiZSBzdHJpbmcsIG51bWJlciBvciBCdWZmZXJcIik7XG59XG5mdW5jdGlvbiBVYShhLCBiLCBjLCBkLCBlKSB7IGZ1bmN0aW9uIGYoYSwgYikgeyByZXR1cm4gMSA9PT0gZyA/IGFbYl0gOiBhLnJlYWRVSW50MTZCRShiICogZyk7IH0gdmFyIGcgPSAxLCBoID0gYS5sZW5ndGgsIGsgPSBiLmxlbmd0aDsgaWYgKHZvaWQgMCAhPT0gZCAmJiAoZCA9IFN0cmluZyhkKS50b0xvd2VyQ2FzZSgpLCBcInVjczJcIiA9PT0gZCB8fCBcInVjcy0yXCIgPT09IGQgfHwgXCJ1dGYxNmxlXCIgPT09IGQgfHwgXCJ1dGYtMTZsZVwiID09PSBkKSkge1xuICAgIGlmICgyID4gYS5sZW5ndGggfHwgMiA+IGIubGVuZ3RoKVxuICAgICAgICByZXR1cm4gLTE7XG4gICAgZyA9IDI7XG4gICAgaCAvPSAyO1xuICAgIGsgLz0gMjtcbiAgICBjIC89IDI7XG59IGlmIChlKVxuICAgIGZvciAoZCA9IC0xOyBjIDwgaDsgYysrKVxuICAgICAgICBpZiAoZihhLCBjKSA9PT0gZihiLCAtMSA9PT0gZCA/IDAgOiBjIC0gZCkpIHtcbiAgICAgICAgICAgIGlmICgtMSA9PT0gZCAmJiAoZCA9IGMpLCBjIC0gZCArIDEgPT09IGspXG4gICAgICAgICAgICAgICAgcmV0dXJuIGQgKiBnO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIC0xICE9PSBkICYmIChjIC09IGMgLSBkKSwgZCA9IC0xO1xuZWxzZVxuICAgIGZvciAoYyArIGsgPiBoICYmIChjID0gaCAtIGspOyAwIDw9IGM7IGMtLSkge1xuICAgICAgICBoID0gITA7XG4gICAgICAgIGZvciAoZCA9IDA7IGQgPCBrOyBkKyspXG4gICAgICAgICAgICBpZiAoZihhLCBjICsgZCkgIT09IGYoYiwgZCkpIHtcbiAgICAgICAgICAgICAgICBoID0gITE7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIGlmIChoKVxuICAgICAgICAgICAgcmV0dXJuIGM7XG4gICAgfSByZXR1cm4gLTE7IH1cbnoucHJvdG90eXBlLmluY2x1ZGVzID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgcmV0dXJuIC0xICE9PSB0aGlzLmluZGV4T2YoYSwgYiwgYyk7IH07XG56LnByb3RvdHlwZS5pbmRleE9mID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgcmV0dXJuIFRhKHRoaXMsIGEsIGIsIGMsICEwKTsgfTtcbnoucHJvdG90eXBlLmxhc3RJbmRleE9mID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgcmV0dXJuIFRhKHRoaXMsIGEsIGIsIGMsICExKTsgfTtcbnoucHJvdG90eXBlLndyaXRlID0gZnVuY3Rpb24gKGEsIGIsIGMsIGQpIHtcbiAgICBpZiAodm9pZCAwID09PSBiKVxuICAgICAgICBkID0gXCJ1dGY4XCIsIGMgPSB0aGlzLmxlbmd0aCwgYiA9IDA7XG4gICAgZWxzZSBpZiAodm9pZCAwID09PSBjICYmIFwic3RyaW5nXCIgPT09IHR5cGVvZiBiKVxuICAgICAgICBkID0gYiwgYyA9IHRoaXMubGVuZ3RoLCBiID0gMDtcbiAgICBlbHNlIGlmIChpc0Zpbml0ZShiKSlcbiAgICAgICAgYiB8PSAwLCBpc0Zpbml0ZShjKSA/IChjIHw9IDAsIHZvaWQgMCA9PT0gZCAmJiAoZCA9IFwidXRmOFwiKSkgOiAoZCA9IGMsIGMgPSB2b2lkIDApO1xuICAgIGVsc2VcbiAgICAgICAgdGhyb3cgRXJyb3IoXCJCdWZmZXIud3JpdGUoc3RyaW5nLCBlbmNvZGluZywgb2Zmc2V0WywgbGVuZ3RoXSkgaXMgbm8gbG9uZ2VyIHN1cHBvcnRlZFwiKTtcbiAgICB2YXIgZSA9IHRoaXMubGVuZ3RoIC0gYjtcbiAgICBpZiAodm9pZCAwID09PSBjIHx8IGMgPiBlKVxuICAgICAgICBjID0gZTtcbiAgICBpZiAoMCA8IGEubGVuZ3RoICYmICgwID4gYyB8fCAwID4gYikgfHwgYiA+IHRoaXMubGVuZ3RoKVxuICAgICAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcihcIkF0dGVtcHQgdG8gd3JpdGUgb3V0c2lkZSBidWZmZXIgYm91bmRzXCIpO1xuICAgIGQgfHwgKGQgPSBcInV0ZjhcIik7XG4gICAgZm9yIChlID0gITE7OylcbiAgICAgICAgc3dpdGNoIChkKSB7XG4gICAgICAgICAgICBjYXNlIFwiaGV4XCI6XG4gICAgICAgICAgICAgICAgYToge1xuICAgICAgICAgICAgICAgICAgICBiID1cbiAgICAgICAgICAgICAgICAgICAgICAgIE51bWJlcihiKSB8fCAwO1xuICAgICAgICAgICAgICAgICAgICBkID0gdGhpcy5sZW5ndGggLSBiO1xuICAgICAgICAgICAgICAgICAgICBjID8gKGMgPSBOdW1iZXIoYyksIGMgPiBkICYmIChjID0gZCkpIDogYyA9IGQ7XG4gICAgICAgICAgICAgICAgICAgIGQgPSBhLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKDAgIT09IGQgJSAyKVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkludmFsaWQgaGV4IHN0cmluZ1wiKTtcbiAgICAgICAgICAgICAgICAgICAgYyA+IGQgLyAyICYmIChjID0gZCAvIDIpO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGQgPSAwOyBkIDwgYzsgKytkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlID0gcGFyc2VJbnQoYS5zdWJzdHIoMiAqIGQsIDIpLCAxNik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNOYU4oZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhID0gZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhayBhO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1tiICsgZF0gPSBlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGEgPSBkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgIGNhc2UgXCJ1dGY4XCI6XG4gICAgICAgICAgICBjYXNlIFwidXRmLThcIjogcmV0dXJuIFZhKE9hKGEsIHRoaXMubGVuZ3RoIC0gYiksIHRoaXMsIGIsIGMpO1xuICAgICAgICAgICAgY2FzZSBcImFzY2lpXCI6IHJldHVybiBWYShXYShhKSwgdGhpcywgYiwgYyk7XG4gICAgICAgICAgICBjYXNlIFwibGF0aW4xXCI6XG4gICAgICAgICAgICBjYXNlIFwiYmluYXJ5XCI6IHJldHVybiBWYShXYShhKSwgdGhpcywgYiwgYyk7XG4gICAgICAgICAgICBjYXNlIFwiYmFzZTY0XCI6IHJldHVybiBWYShQYShhKSwgdGhpcywgYiwgYyk7XG4gICAgICAgICAgICBjYXNlIFwidWNzMlwiOlxuICAgICAgICAgICAgY2FzZSBcInVjcy0yXCI6XG4gICAgICAgICAgICBjYXNlIFwidXRmMTZsZVwiOlxuICAgICAgICAgICAgY2FzZSBcInV0Zi0xNmxlXCI6XG4gICAgICAgICAgICAgICAgZCA9IGE7XG4gICAgICAgICAgICAgICAgZSA9IHRoaXMubGVuZ3RoIC1cbiAgICAgICAgICAgICAgICAgICAgYjtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBmID0gW10sIGcgPSAwOyBnIDwgZC5sZW5ndGggJiYgISgwID4gKGUgLT0gMikpOyArK2cpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGggPSBkLmNoYXJDb2RlQXQoZyk7XG4gICAgICAgICAgICAgICAgICAgIGEgPSBoID4+IDg7XG4gICAgICAgICAgICAgICAgICAgIGggJT0gMjU2O1xuICAgICAgICAgICAgICAgICAgICBmLnB1c2goaCk7XG4gICAgICAgICAgICAgICAgICAgIGYucHVzaChhKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIFZhKGYsIHRoaXMsIGIsIGMpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBpZiAoZSlcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlVua25vd24gZW5jb2Rpbmc6IFwiICsgZCk7XG4gICAgICAgICAgICAgICAgZCA9IChcIlwiICsgZCkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgICBlID0gITA7XG4gICAgICAgIH1cbn07XG56LnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB7IHR5cGU6IFwiQnVmZmVyXCIsIGRhdGE6IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKHRoaXMuX2FyciB8fCB0aGlzLCAwKSB9OyB9O1xuZnVuY3Rpb24gUmEoYSwgYiwgYykge1xuICAgIGMgPSBNYXRoLm1pbihhLmxlbmd0aCwgYyk7XG4gICAgZm9yICh2YXIgZCA9IFtdOyBiIDwgYzspIHtcbiAgICAgICAgdmFyIGUgPSBhW2JdLCBmID0gbnVsbCwgZyA9IDIzOSA8IGUgPyA0IDogMjIzIDwgZSA/IDMgOiAxOTEgPCBlID8gMiA6IDE7XG4gICAgICAgIGlmIChiICsgZyA8PSBjKVxuICAgICAgICAgICAgc3dpdGNoIChnKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAxMjggPiBlICYmIChmID0gZSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgdmFyIGggPSBhW2IgKyAxXTtcbiAgICAgICAgICAgICAgICAgICAgMTI4ID09PSAoaCAmIDE5MikgJiYgKGUgPSAoZSAmIDMxKSA8PCA2IHwgaCAmIDYzLCAxMjcgPCBlICYmIChmID0gZSkpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgIGggPSBhW2IgKyAxXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGsgPSBhW2IgKyAyXTtcbiAgICAgICAgICAgICAgICAgICAgMTI4ID09PSAoaCAmIDE5MikgJiYgMTI4ID09PSAoayAmIDE5MikgJiYgKGUgPSAoZSAmIDE1KSA8PCAxMiB8IChoICYgNjMpIDw8IDYgfCBrICYgNjMsIDIwNDcgPCBlICYmICg1NTI5NiA+IGUgfHwgNTczNDMgPCBlKSAmJiAoZiA9IGUpKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICBoID0gYVtiICsgMV07XG4gICAgICAgICAgICAgICAgICAgIGsgPSBhW2IgKyAyXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHAgPSBhW2IgKyAzXTtcbiAgICAgICAgICAgICAgICAgICAgMTI4ID09PSAoaCAmIDE5MikgJiYgMTI4ID09PSAoayAmIDE5MikgJiYgMTI4ID09PSAocCAmIDE5MikgJiYgKGUgPSAoZSAmIDE1KSA8PCAxOCB8IChoICYgNjMpIDw8IDEyIHwgKGsgJiA2MykgPDwgNiB8IHAgJiA2MywgNjU1MzUgPCBlICYmIDExMTQxMTIgPiBlICYmIChmID1cbiAgICAgICAgICAgICAgICAgICAgICAgIGUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgbnVsbCA9PT0gZiA/IChmID0gNjU1MzMsIGcgPSAxKSA6IDY1NTM1IDwgZiAmJiAoZiAtPSA2NTUzNiwgZC5wdXNoKGYgPj4+IDEwICYgMTAyMyB8IDU1Mjk2KSwgZiA9IDU2MzIwIHwgZiAmIDEwMjMpO1xuICAgICAgICBkLnB1c2goZik7XG4gICAgICAgIGIgKz0gZztcbiAgICB9XG4gICAgYSA9IGQubGVuZ3RoO1xuICAgIGlmIChhIDw9IGFiKVxuICAgICAgICBkID0gU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShTdHJpbmcsIGQpO1xuICAgIGVsc2Uge1xuICAgICAgICBjID0gXCJcIjtcbiAgICAgICAgZm9yIChiID0gMDsgYiA8IGE7KVxuICAgICAgICAgICAgYyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KFN0cmluZywgZC5zbGljZShiLCBiICs9IGFiKSk7XG4gICAgICAgIGQgPSBjO1xuICAgIH1cbiAgICByZXR1cm4gZDtcbn1cbnZhciBhYiA9IDQwOTY7XG56LnByb3RvdHlwZS5zbGljZSA9IGZ1bmN0aW9uIChhLCBiKSB7IHZhciBjID0gdGhpcy5sZW5ndGg7IGEgPSB+fmE7IGIgPSB2b2lkIDAgPT09IGIgPyBjIDogfn5iOyAwID4gYSA/IChhICs9IGMsIDAgPiBhICYmIChhID0gMCkpIDogYSA+IGMgJiYgKGEgPSBjKTsgMCA+IGIgPyAoYiArPSBjLCAwID4gYiAmJiAoYiA9IDApKSA6IGIgPiBjICYmIChiID0gYyk7IGIgPCBhICYmIChiID0gYSk7IGlmICh6LlRZUEVEX0FSUkFZX1NVUFBPUlQpXG4gICAgYiA9IHRoaXMuc3ViYXJyYXkoYSwgYiksIGIuX19wcm90b19fID0gei5wcm90b3R5cGU7XG5lbHNlIHtcbiAgICBjID0gYiAtIGE7XG4gICAgYiA9IG5ldyB6KGMsIHZvaWQgMCk7XG4gICAgZm9yICh2YXIgZCA9IDA7IGQgPCBjOyArK2QpXG4gICAgICAgIGJbZF0gPSB0aGlzW2QgKyBhXTtcbn0gcmV0dXJuIGI7IH07XG5mdW5jdGlvbiBDKGEsIGIsIGMpIHsgaWYgKDAgIT09IGEgJSAxIHx8IDAgPiBhKVxuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKFwib2Zmc2V0IGlzIG5vdCB1aW50XCIpOyBpZiAoYSArIGIgPiBjKVxuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKFwiVHJ5aW5nIHRvIGFjY2VzcyBiZXlvbmQgYnVmZmVyIGxlbmd0aFwiKTsgfVxuei5wcm90b3R5cGUucmVhZFVJbnRMRSA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7IGEgfD0gMDsgYiB8PSAwOyBjIHx8IEMoYSwgYiwgdGhpcy5sZW5ndGgpOyBjID0gdGhpc1thXTsgZm9yICh2YXIgZCA9IDEsIGUgPSAwOyArK2UgPCBiICYmIChkICo9IDI1Nik7KVxuICAgIGMgKz0gdGhpc1thICsgZV0gKiBkOyByZXR1cm4gYzsgfTtcbnoucHJvdG90eXBlLnJlYWRVSW50QkUgPSBmdW5jdGlvbiAoYSwgYiwgYykgeyBhIHw9IDA7IGIgfD0gMDsgYyB8fCBDKGEsIGIsIHRoaXMubGVuZ3RoKTsgYyA9IHRoaXNbYSArIC0tYl07IGZvciAodmFyIGQgPSAxOyAwIDwgYiAmJiAoZCAqPSAyNTYpOylcbiAgICBjICs9IHRoaXNbYSArIC0tYl0gKiBkOyByZXR1cm4gYzsgfTtcbnoucHJvdG90eXBlLnJlYWRVSW50OCA9IGZ1bmN0aW9uIChhLCBiKSB7IGIgfHwgQyhhLCAxLCB0aGlzLmxlbmd0aCk7IHJldHVybiB0aGlzW2FdOyB9O1xuei5wcm90b3R5cGUucmVhZFVJbnQxNkxFID0gZnVuY3Rpb24gKGEsIGIpIHsgYiB8fCBDKGEsIDIsIHRoaXMubGVuZ3RoKTsgcmV0dXJuIHRoaXNbYV0gfCB0aGlzW2EgKyAxXSA8PCA4OyB9O1xuei5wcm90b3R5cGUucmVhZFVJbnQxNkJFID0gZnVuY3Rpb24gKGEsIGIpIHsgYiB8fCBDKGEsIDIsIHRoaXMubGVuZ3RoKTsgcmV0dXJuIHRoaXNbYV0gPDwgOCB8IHRoaXNbYSArIDFdOyB9O1xuei5wcm90b3R5cGUucmVhZFVJbnQzMkxFID0gZnVuY3Rpb24gKGEsIGIpIHsgYiB8fCBDKGEsIDQsIHRoaXMubGVuZ3RoKTsgcmV0dXJuICh0aGlzW2FdIHwgdGhpc1thICsgMV0gPDwgOCB8IHRoaXNbYSArIDJdIDw8IDE2KSArIDE2Nzc3MjE2ICogdGhpc1thICsgM107IH07XG56LnByb3RvdHlwZS5yZWFkVUludDMyQkUgPSBmdW5jdGlvbiAoYSwgYikgeyBiIHx8IEMoYSwgNCwgdGhpcy5sZW5ndGgpOyByZXR1cm4gMTY3NzcyMTYgKiB0aGlzW2FdICsgKHRoaXNbYSArIDFdIDw8IDE2IHwgdGhpc1thICsgMl0gPDwgOCB8IHRoaXNbYSArIDNdKTsgfTtcbnoucHJvdG90eXBlLnJlYWRJbnRMRSA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7IGEgfD0gMDsgYiB8PSAwOyBjIHx8IEMoYSwgYiwgdGhpcy5sZW5ndGgpOyBjID0gdGhpc1thXTsgZm9yICh2YXIgZCA9IDEsIGUgPSAwOyArK2UgPCBiICYmIChkICo9IDI1Nik7KVxuICAgIGMgKz0gdGhpc1thICsgZV0gKiBkOyBjID49IDEyOCAqIGQgJiYgKGMgLT0gTWF0aC5wb3coMiwgOCAqIGIpKTsgcmV0dXJuIGM7IH07XG56LnByb3RvdHlwZS5yZWFkSW50QkUgPSBmdW5jdGlvbiAoYSwgYiwgYykgeyBhIHw9IDA7IGIgfD0gMDsgYyB8fCBDKGEsIGIsIHRoaXMubGVuZ3RoKTsgYyA9IGI7IGZvciAodmFyIGQgPSAxLCBlID0gdGhpc1thICsgLS1jXTsgMCA8IGMgJiYgKGQgKj0gMjU2KTspXG4gICAgZSArPSB0aGlzW2EgKyAtLWNdICogZDsgZSA+PSAxMjggKiBkICYmIChlIC09IE1hdGgucG93KDIsIDggKiBiKSk7IHJldHVybiBlOyB9O1xuei5wcm90b3R5cGUucmVhZEludDggPSBmdW5jdGlvbiAoYSwgYikgeyBiIHx8IEMoYSwgMSwgdGhpcy5sZW5ndGgpOyByZXR1cm4gdGhpc1thXSAmIDEyOCA/IC0xICogKDI1NSAtIHRoaXNbYV0gKyAxKSA6IHRoaXNbYV07IH07XG56LnByb3RvdHlwZS5yZWFkSW50MTZMRSA9IGZ1bmN0aW9uIChhLCBiKSB7IGIgfHwgQyhhLCAyLCB0aGlzLmxlbmd0aCk7IGEgPSB0aGlzW2FdIHwgdGhpc1thICsgMV0gPDwgODsgcmV0dXJuIGEgJiAzMjc2OCA/IGEgfCA0Mjk0OTAxNzYwIDogYTsgfTtcbnoucHJvdG90eXBlLnJlYWRJbnQxNkJFID0gZnVuY3Rpb24gKGEsIGIpIHsgYiB8fCBDKGEsIDIsIHRoaXMubGVuZ3RoKTsgYSA9IHRoaXNbYSArIDFdIHwgdGhpc1thXSA8PCA4OyByZXR1cm4gYSAmIDMyNzY4ID8gYSB8IDQyOTQ5MDE3NjAgOiBhOyB9O1xuei5wcm90b3R5cGUucmVhZEludDMyTEUgPSBmdW5jdGlvbiAoYSwgYikgeyBiIHx8IEMoYSwgNCwgdGhpcy5sZW5ndGgpOyByZXR1cm4gdGhpc1thXSB8IHRoaXNbYSArIDFdIDw8IDggfCB0aGlzW2EgKyAyXSA8PCAxNiB8IHRoaXNbYSArIDNdIDw8IDI0OyB9O1xuei5wcm90b3R5cGUucmVhZEludDMyQkUgPSBmdW5jdGlvbiAoYSwgYikgeyBiIHx8IEMoYSwgNCwgdGhpcy5sZW5ndGgpOyByZXR1cm4gdGhpc1thXSA8PCAyNCB8IHRoaXNbYSArIDFdIDw8IDE2IHwgdGhpc1thICsgMl0gPDwgOCB8IHRoaXNbYSArIDNdOyB9O1xuei5wcm90b3R5cGUucmVhZEZsb2F0TEUgPSBmdW5jdGlvbiAoYSwgYikgeyBiIHx8IEMoYSwgNCwgdGhpcy5sZW5ndGgpOyByZXR1cm4gc2EodGhpcywgYSwgITAsIDIzLCA0KTsgfTtcbnoucHJvdG90eXBlLnJlYWRGbG9hdEJFID0gZnVuY3Rpb24gKGEsIGIpIHsgYiB8fCBDKGEsIDQsIHRoaXMubGVuZ3RoKTsgcmV0dXJuIHNhKHRoaXMsIGEsICExLCAyMywgNCk7IH07XG56LnByb3RvdHlwZS5yZWFkRG91YmxlTEUgPSBmdW5jdGlvbiAoYSwgYikgeyBiIHx8IEMoYSwgOCwgdGhpcy5sZW5ndGgpOyByZXR1cm4gc2EodGhpcywgYSwgITAsIDUyLCA4KTsgfTtcbnoucHJvdG90eXBlLnJlYWREb3VibGVCRSA9IGZ1bmN0aW9uIChhLCBiKSB7IGIgfHwgQyhhLCA4LCB0aGlzLmxlbmd0aCk7IHJldHVybiBzYSh0aGlzLCBhLCAhMSwgNTIsIDgpOyB9O1xuZnVuY3Rpb24gRShhLCBiLCBjLCBkLCBlLCBmKSB7IGlmICghQShhKSlcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdcImJ1ZmZlclwiIGFyZ3VtZW50IG11c3QgYmUgYSBCdWZmZXIgaW5zdGFuY2UnKTsgaWYgKGIgPiBlIHx8IGIgPCBmKVxuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdcInZhbHVlXCIgYXJndW1lbnQgaXMgb3V0IG9mIGJvdW5kcycpOyBpZiAoYyArIGQgPiBhLmxlbmd0aClcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcihcIkluZGV4IG91dCBvZiByYW5nZVwiKTsgfVxuei5wcm90b3R5cGUud3JpdGVVSW50TEUgPSBmdW5jdGlvbiAoYSwgYiwgYywgZCkgeyBhID0gK2E7IGIgfD0gMDsgYyB8PSAwOyBkIHx8IEUodGhpcywgYSwgYiwgYywgTWF0aC5wb3coMiwgOCAqIGMpIC0gMSwgMCk7IGQgPSAxOyB2YXIgZSA9IDA7IGZvciAodGhpc1tiXSA9IGEgJiAyNTU7ICsrZSA8IGMgJiYgKGQgKj0gMjU2KTspXG4gICAgdGhpc1tiICsgZV0gPSBhIC8gZCAmIDI1NTsgcmV0dXJuIGIgKyBjOyB9O1xuei5wcm90b3R5cGUud3JpdGVVSW50QkUgPSBmdW5jdGlvbiAoYSwgYiwgYywgZCkgeyBhID0gK2E7IGIgfD0gMDsgYyB8PSAwOyBkIHx8IEUodGhpcywgYSwgYiwgYywgTWF0aC5wb3coMiwgOCAqIGMpIC0gMSwgMCk7IGQgPSBjIC0gMTsgdmFyIGUgPSAxOyBmb3IgKHRoaXNbYiArIGRdID0gYSAmIDI1NTsgMCA8PSAtLWQgJiYgKGUgKj0gMjU2KTspXG4gICAgdGhpc1tiICsgZF0gPSBhIC8gZSAmIDI1NTsgcmV0dXJuIGIgKyBjOyB9O1xuei5wcm90b3R5cGUud3JpdGVVSW50OCA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7IGEgPSArYTsgYiB8PSAwOyBjIHx8IEUodGhpcywgYSwgYiwgMSwgMjU1LCAwKTsgei5UWVBFRF9BUlJBWV9TVVBQT1JUIHx8IChhID0gTWF0aC5mbG9vcihhKSk7IHRoaXNbYl0gPSBhICYgMjU1OyByZXR1cm4gYiArIDE7IH07XG5mdW5jdGlvbiBiYihhLCBiLCBjLCBkKSB7IDAgPiBiICYmIChiID0gNjU1MzUgKyBiICsgMSk7IGZvciAodmFyIGUgPSAwLCBmID0gTWF0aC5taW4oYS5sZW5ndGggLSBjLCAyKTsgZSA8IGY7ICsrZSlcbiAgICBhW2MgKyBlXSA9IChiICYgMjU1IDw8IDggKiAoZCA/IGUgOiAxIC0gZSkpID4+PiA4ICogKGQgPyBlIDogMSAtIGUpOyB9XG56LnByb3RvdHlwZS53cml0ZVVJbnQxNkxFID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgYSA9ICthOyBiIHw9IDA7IGMgfHwgRSh0aGlzLCBhLCBiLCAyLCA2NTUzNSwgMCk7IHouVFlQRURfQVJSQVlfU1VQUE9SVCA/ICh0aGlzW2JdID0gYSAmIDI1NSwgdGhpc1tiICsgMV0gPSBhID4+PiA4KSA6IGJiKHRoaXMsIGEsIGIsICEwKTsgcmV0dXJuIGIgKyAyOyB9O1xuei5wcm90b3R5cGUud3JpdGVVSW50MTZCRSA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7IGEgPSArYTsgYiB8PSAwOyBjIHx8IEUodGhpcywgYSwgYiwgMiwgNjU1MzUsIDApOyB6LlRZUEVEX0FSUkFZX1NVUFBPUlQgPyAodGhpc1tiXSA9IGEgPj4+IDgsIHRoaXNbYiArIDFdID0gYSAmIDI1NSkgOiBiYih0aGlzLCBhLCBiLCAhMSk7IHJldHVybiBiICsgMjsgfTtcbmZ1bmN0aW9uIGNiKGEsIGIsIGMsIGQpIHsgMCA+IGIgJiYgKGIgPSA0Mjk0OTY3Mjk1ICsgYiArIDEpOyBmb3IgKHZhciBlID0gMCwgZiA9IE1hdGgubWluKGEubGVuZ3RoIC0gYywgNCk7IGUgPCBmOyArK2UpXG4gICAgYVtjICsgZV0gPSBiID4+PiA4ICogKGQgPyBlIDogMyAtIGUpICYgMjU1OyB9XG56LnByb3RvdHlwZS53cml0ZVVJbnQzMkxFID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgYSA9ICthOyBiIHw9IDA7IGMgfHwgRSh0aGlzLCBhLCBiLCA0LCA0Mjk0OTY3Mjk1LCAwKTsgei5UWVBFRF9BUlJBWV9TVVBQT1JUID8gKHRoaXNbYiArIDNdID0gYSA+Pj4gMjQsIHRoaXNbYiArIDJdID0gYSA+Pj4gMTYsIHRoaXNbYiArIDFdID0gYSA+Pj4gOCwgdGhpc1tiXSA9IGEgJiAyNTUpIDogY2IodGhpcywgYSwgYiwgITApOyByZXR1cm4gYiArIDQ7IH07XG56LnByb3RvdHlwZS53cml0ZVVJbnQzMkJFID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgYSA9ICthOyBiIHw9IDA7IGMgfHwgRSh0aGlzLCBhLCBiLCA0LCA0Mjk0OTY3Mjk1LCAwKTsgei5UWVBFRF9BUlJBWV9TVVBQT1JUID8gKHRoaXNbYl0gPSBhID4+PiAyNCwgdGhpc1tiICsgMV0gPSBhID4+PiAxNiwgdGhpc1tiICsgMl0gPSBhID4+PiA4LCB0aGlzW2IgKyAzXSA9IGEgJiAyNTUpIDogY2IodGhpcywgYSwgYiwgITEpOyByZXR1cm4gYiArIDQ7IH07XG56LnByb3RvdHlwZS53cml0ZUludExFID0gZnVuY3Rpb24gKGEsIGIsIGMsIGQpIHsgYSA9ICthOyBiIHw9IDA7IGQgfHwgKGQgPSBNYXRoLnBvdygyLCA4ICogYyAtIDEpLCBFKHRoaXMsIGEsIGIsIGMsIGQgLSAxLCAtZCkpOyBkID0gMDsgdmFyIGUgPSAxLCBmID0gMDsgZm9yICh0aGlzW2JdID0gYSAmIDI1NTsgKytkIDwgYyAmJiAoZSAqPSAyNTYpOylcbiAgICAwID4gYSAmJiAwID09PSBmICYmIDAgIT09IHRoaXNbYiArIGQgLSAxXSAmJiAoZiA9IDEpLCB0aGlzW2IgKyBkXSA9IChhIC8gZSA+PiAwKSAtIGYgJiAyNTU7IHJldHVybiBiICsgYzsgfTtcbnoucHJvdG90eXBlLndyaXRlSW50QkUgPSBmdW5jdGlvbiAoYSwgYiwgYywgZCkgeyBhID0gK2E7IGIgfD0gMDsgZCB8fCAoZCA9IE1hdGgucG93KDIsIDggKiBjIC0gMSksIEUodGhpcywgYSwgYiwgYywgZCAtIDEsIC1kKSk7IGQgPSBjIC0gMTsgdmFyIGUgPSAxLCBmID0gMDsgZm9yICh0aGlzW2IgKyBkXSA9IGEgJiAyNTU7IDAgPD0gLS1kICYmIChlICo9IDI1Nik7KVxuICAgIDAgPiBhICYmIDAgPT09IGYgJiYgMCAhPT0gdGhpc1tiICsgZCArIDFdICYmIChmID0gMSksIHRoaXNbYiArIGRdID0gKGEgLyBlID4+IDApIC0gZiAmIDI1NTsgcmV0dXJuIGIgKyBjOyB9O1xuei5wcm90b3R5cGUud3JpdGVJbnQ4ID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgYSA9ICthOyBiIHw9IDA7IGMgfHwgRSh0aGlzLCBhLCBiLCAxLCAxMjcsIC0xMjgpOyB6LlRZUEVEX0FSUkFZX1NVUFBPUlQgfHwgKGEgPSBNYXRoLmZsb29yKGEpKTsgMCA+IGEgJiYgKGEgPSAyNTUgKyBhICsgMSk7IHRoaXNbYl0gPSBhICYgMjU1OyByZXR1cm4gYiArIDE7IH07XG56LnByb3RvdHlwZS53cml0ZUludDE2TEUgPSBmdW5jdGlvbiAoYSwgYiwgYykgeyBhID0gK2E7IGIgfD0gMDsgYyB8fCBFKHRoaXMsIGEsIGIsIDIsIDMyNzY3LCAtMzI3NjgpOyB6LlRZUEVEX0FSUkFZX1NVUFBPUlQgPyAodGhpc1tiXSA9IGEgJiAyNTUsIHRoaXNbYiArIDFdID0gYSA+Pj4gOCkgOiBiYih0aGlzLCBhLCBiLCAhMCk7IHJldHVybiBiICsgMjsgfTtcbnoucHJvdG90eXBlLndyaXRlSW50MTZCRSA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7IGEgPSArYTsgYiB8PSAwOyBjIHx8IEUodGhpcywgYSwgYiwgMiwgMzI3NjcsIC0zMjc2OCk7IHouVFlQRURfQVJSQVlfU1VQUE9SVCA/ICh0aGlzW2JdID0gYSA+Pj4gOCwgdGhpc1tiICsgMV0gPSBhICYgMjU1KSA6IGJiKHRoaXMsIGEsIGIsICExKTsgcmV0dXJuIGIgKyAyOyB9O1xuei5wcm90b3R5cGUud3JpdGVJbnQzMkxFID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgYSA9ICthOyBiIHw9IDA7IGMgfHwgRSh0aGlzLCBhLCBiLCA0LCAyMTQ3NDgzNjQ3LCAtMjE0NzQ4MzY0OCk7IHouVFlQRURfQVJSQVlfU1VQUE9SVCA/ICh0aGlzW2JdID0gYSAmIDI1NSwgdGhpc1tiICsgMV0gPSBhID4+PiA4LCB0aGlzW2IgKyAyXSA9IGEgPj4+IDE2LCB0aGlzW2IgKyAzXSA9IGEgPj4+IDI0KSA6IGNiKHRoaXMsIGEsIGIsICEwKTsgcmV0dXJuIGIgKyA0OyB9O1xuei5wcm90b3R5cGUud3JpdGVJbnQzMkJFID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgYSA9ICthOyBiIHw9IDA7IGMgfHwgRSh0aGlzLCBhLCBiLCA0LCAyMTQ3NDgzNjQ3LCAtMjE0NzQ4MzY0OCk7IDAgPiBhICYmIChhID0gNDI5NDk2NzI5NSArIGEgKyAxKTsgei5UWVBFRF9BUlJBWV9TVVBQT1JUID8gKHRoaXNbYl0gPSBhID4+PiAyNCwgdGhpc1tiICsgMV0gPSBhID4+PiAxNiwgdGhpc1tiICsgMl0gPSBhID4+PiA4LCB0aGlzW2IgKyAzXSA9IGEgJiAyNTUpIDogY2IodGhpcywgYSwgYiwgITEpOyByZXR1cm4gYiArIDQ7IH07XG5mdW5jdGlvbiBkYihhLCBiLCBjLCBkKSB7IGlmIChjICsgZCA+IGEubGVuZ3RoKVxuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKFwiSW5kZXggb3V0IG9mIHJhbmdlXCIpOyBpZiAoMCA+IGMpXG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoXCJJbmRleCBvdXQgb2YgcmFuZ2VcIik7IH1cbnoucHJvdG90eXBlLndyaXRlRmxvYXRMRSA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7IGMgfHwgZGIodGhpcywgYSwgYiwgNCk7IHRhKHRoaXMsIGEsIGIsICEwLCAyMywgNCk7IHJldHVybiBiICsgNDsgfTtcbnoucHJvdG90eXBlLndyaXRlRmxvYXRCRSA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7IGMgfHwgZGIodGhpcywgYSwgYiwgNCk7IHRhKHRoaXMsIGEsIGIsICExLCAyMywgNCk7IHJldHVybiBiICsgNDsgfTtcbnoucHJvdG90eXBlLndyaXRlRG91YmxlTEUgPSBmdW5jdGlvbiAoYSwgYiwgYykgeyBjIHx8IGRiKHRoaXMsIGEsIGIsIDgpOyB0YSh0aGlzLCBhLCBiLCAhMCwgNTIsIDgpOyByZXR1cm4gYiArIDg7IH07XG56LnByb3RvdHlwZS53cml0ZURvdWJsZUJFID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgYyB8fCBkYih0aGlzLCBhLCBiLCA4KTsgdGEodGhpcywgYSwgYiwgITEsIDUyLCA4KTsgcmV0dXJuIGIgKyA4OyB9O1xuei5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIChhLCBiLCBjLCBkKSB7XG4gICAgYyB8fCAoYyA9IDApO1xuICAgIGQgfHwgMCA9PT0gZCB8fCAoZCA9IHRoaXMubGVuZ3RoKTtcbiAgICBiID49IGEubGVuZ3RoICYmIChiID0gYS5sZW5ndGgpO1xuICAgIGIgfHwgKGIgPSAwKTtcbiAgICAwIDwgZCAmJiBkIDwgYyAmJiAoZCA9IGMpO1xuICAgIGlmIChkID09PSBjIHx8IDAgPT09IGEubGVuZ3RoIHx8IDAgPT09IHRoaXMubGVuZ3RoKVxuICAgICAgICByZXR1cm4gMDtcbiAgICBpZiAoMCA+IGIpXG4gICAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKFwidGFyZ2V0U3RhcnQgb3V0IG9mIGJvdW5kc1wiKTtcbiAgICBpZiAoMCA+IGMgfHwgYyA+PSB0aGlzLmxlbmd0aClcbiAgICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoXCJzb3VyY2VTdGFydCBvdXQgb2YgYm91bmRzXCIpO1xuICAgIGlmICgwID4gZClcbiAgICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoXCJzb3VyY2VFbmQgb3V0IG9mIGJvdW5kc1wiKTtcbiAgICBkID4gdGhpcy5sZW5ndGggJiYgKGQgPSB0aGlzLmxlbmd0aCk7XG4gICAgYS5sZW5ndGggLSBiIDwgZCAtIGMgJiYgKGQgPSBhLmxlbmd0aCAtIGIgKyBjKTtcbiAgICB2YXIgZSA9IGQgLSBjO1xuICAgIGlmICh0aGlzID09PSBhICYmIGMgPCBiICYmIGIgPCBkKVxuICAgICAgICBmb3IgKGQgPSBlIC0gMTsgMCA8PSBkOyAtLWQpXG4gICAgICAgICAgICBhW2QgKyBiXSA9IHRoaXNbZCArIGNdO1xuICAgIGVsc2UgaWYgKDFFMyA+IGUgfHxcbiAgICAgICAgIXouVFlQRURfQVJSQVlfU1VQUE9SVClcbiAgICAgICAgZm9yIChkID0gMDsgZCA8IGU7ICsrZClcbiAgICAgICAgICAgIGFbZCArIGJdID0gdGhpc1tkICsgY107XG4gICAgZWxzZVxuICAgICAgICBVaW50OEFycmF5LnByb3RvdHlwZS5zZXQuY2FsbChhLCB0aGlzLnN1YmFycmF5KGMsIGMgKyBlKSwgYik7XG4gICAgcmV0dXJuIGU7XG59O1xuei5wcm90b3R5cGUuZmlsbCA9IGZ1bmN0aW9uIChhLCBiLCBjLCBkKSB7XG4gICAgaWYgKFwic3RyaW5nXCIgPT09IHR5cGVvZiBhKSB7XG4gICAgICAgIFwic3RyaW5nXCIgPT09IHR5cGVvZiBiID8gKGQgPSBiLCBiID0gMCwgYyA9IHRoaXMubGVuZ3RoKSA6IFwic3RyaW5nXCIgPT09IHR5cGVvZiBjICYmIChkID0gYywgYyA9IHRoaXMubGVuZ3RoKTtcbiAgICAgICAgaWYgKDEgPT09IGEubGVuZ3RoKSB7XG4gICAgICAgICAgICB2YXIgZSA9IGEuY2hhckNvZGVBdCgwKTtcbiAgICAgICAgICAgIDI1NiA+IGUgJiYgKGEgPSBlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodm9pZCAwICE9PSBkICYmIFwic3RyaW5nXCIgIT09IHR5cGVvZiBkKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcImVuY29kaW5nIG11c3QgYmUgYSBzdHJpbmdcIik7XG4gICAgICAgIGlmIChcInN0cmluZ1wiID09PSB0eXBlb2YgZCAmJiAhei5pc0VuY29kaW5nKGQpKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlVua25vd24gZW5jb2Rpbmc6IFwiICsgZCk7XG4gICAgfVxuICAgIGVsc2VcbiAgICAgICAgXCJudW1iZXJcIiA9PT0gdHlwZW9mIGEgJiYgKGEgJj0gMjU1KTtcbiAgICBpZiAoMCA+IGIgfHwgdGhpcy5sZW5ndGggPCBiIHx8IHRoaXMubGVuZ3RoIDwgYylcbiAgICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoXCJPdXQgb2YgcmFuZ2UgaW5kZXhcIik7XG4gICAgaWYgKGMgPD0gYilcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgYiA+Pj49XG4gICAgICAgIDA7XG4gICAgYyA9IHZvaWQgMCA9PT0gYyA/IHRoaXMubGVuZ3RoIDogYyA+Pj4gMDtcbiAgICBhIHx8IChhID0gMCk7XG4gICAgaWYgKFwibnVtYmVyXCIgPT09IHR5cGVvZiBhKVxuICAgICAgICBmb3IgKGQgPSBiOyBkIDwgYzsgKytkKVxuICAgICAgICAgICAgdGhpc1tkXSA9IGE7XG4gICAgZWxzZVxuICAgICAgICBmb3IgKGEgPSBBKGEpID8gYSA6IE9hKChuZXcgeihhLCBkKSkudG9TdHJpbmcoKSksIGUgPSBhLmxlbmd0aCwgZCA9IDA7IGQgPCBjIC0gYjsgKytkKVxuICAgICAgICAgICAgdGhpc1tkICsgYl0gPSBhW2QgJSBlXTtcbiAgICByZXR1cm4gdGhpcztcbn07XG52YXIgZWIgPSAvW14rXFwvMC05QS1aYS16LV9dL2c7XG5mdW5jdGlvbiBPYShhLCBiKSB7XG4gICAgYiA9IGIgfHwgSW5maW5pdHk7XG4gICAgZm9yICh2YXIgYywgZCA9IGEubGVuZ3RoLCBlID0gbnVsbCwgZiA9IFtdLCBnID0gMDsgZyA8IGQ7ICsrZykge1xuICAgICAgICBjID0gYS5jaGFyQ29kZUF0KGcpO1xuICAgICAgICBpZiAoNTUyOTUgPCBjICYmIDU3MzQ0ID4gYykge1xuICAgICAgICAgICAgaWYgKCFlKSB7XG4gICAgICAgICAgICAgICAgaWYgKDU2MzE5IDwgYykge1xuICAgICAgICAgICAgICAgICAgICAtMSA8IChiIC09IDMpICYmIGYucHVzaCgyMzksIDE5MSwgMTg5KTtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGcgKyAxID09PSBkKSB7XG4gICAgICAgICAgICAgICAgICAgIC0xIDwgKGIgLT0gMykgJiYgZi5wdXNoKDIzOSwgMTkxLCAxODkpO1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZSA9IGM7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoNTYzMjAgPiBjKSB7XG4gICAgICAgICAgICAgICAgLTEgPCAoYiAtPSAzKSAmJiBmLnB1c2goMjM5LCAxOTEsIDE4OSk7XG4gICAgICAgICAgICAgICAgZSA9IGM7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjID0gKGUgLSA1NTI5NiA8PCAxMCB8IGMgLSA1NjMyMCkgKyA2NTUzNjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgICAgICBlICYmIC0xIDwgKGIgLT0gMykgJiYgZi5wdXNoKDIzOSwgMTkxLCAxODkpO1xuICAgICAgICBlID0gbnVsbDtcbiAgICAgICAgaWYgKDEyOCA+IGMpIHtcbiAgICAgICAgICAgIGlmICgwID4gLS1iKVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZi5wdXNoKGMpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKDIwNDggPiBjKSB7XG4gICAgICAgICAgICBpZiAoMCA+IChiIC09IDIpKVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZi5wdXNoKGMgPj4gNiB8IDE5MiwgYyAmIDYzIHwgMTI4KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICg2NTUzNiA+IGMpIHtcbiAgICAgICAgICAgIGlmICgwID4gKGIgLT0gMykpXG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBmLnB1c2goYyA+PiAxMiB8IDIyNCwgYyA+PiA2ICYgNjMgfCAxMjgsIGMgJiA2MyB8IDEyOCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoMTExNDExMiA+IGMpIHtcbiAgICAgICAgICAgIGlmICgwID4gKGIgLT0gNCkpXG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBmLnB1c2goYyA+PiAxOCB8IDI0MCwgYyA+PiAxMiAmIDYzIHwgMTI4LCBjID4+IDYgJiA2MyB8IDEyOCwgYyAmIDYzIHwgMTI4KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcIkludmFsaWQgY29kZSBwb2ludFwiKTtcbiAgICB9XG4gICAgcmV0dXJuIGY7XG59XG5mdW5jdGlvbiBXYShhKSB7IGZvciAodmFyIGIgPSBbXSwgYyA9IDA7IGMgPCBhLmxlbmd0aDsgKytjKVxuICAgIGIucHVzaChhLmNoYXJDb2RlQXQoYykgJiAyNTUpOyByZXR1cm4gYjsgfVxuZnVuY3Rpb24gUGEoYSkge1xuICAgIGEgPSAoYS50cmltID8gYS50cmltKCkgOiBhLnJlcGxhY2UoL15cXHMrfFxccyskL2csIFwiXCIpKS5yZXBsYWNlKGViLCBcIlwiKTtcbiAgICBpZiAoMiA+IGEubGVuZ3RoKVxuICAgICAgICBhID0gXCJcIjtcbiAgICBlbHNlXG4gICAgICAgIGZvciAoOyAwICE9PSBhLmxlbmd0aCAlIDQ7KVxuICAgICAgICAgICAgYSArPSBcIj1cIjtcbiAgICBvYSB8fCBwYSgpO1xuICAgIHZhciBiID0gYS5sZW5ndGg7XG4gICAgaWYgKDAgPCBiICUgNClcbiAgICAgICAgdGhyb3cgRXJyb3IoXCJJbnZhbGlkIHN0cmluZy4gTGVuZ3RoIG11c3QgYmUgYSBtdWx0aXBsZSBvZiA0XCIpO1xuICAgIHZhciBjID0gXCI9XCIgPT09IGFbYiAtIDJdID8gMiA6IFwiPVwiID09PSBhW2IgLSAxXSA/IDEgOiAwO1xuICAgIHZhciBkID0gbmV3IG1hKDMgKiBiIC8gNCAtIGMpO1xuICAgIHZhciBlID0gMCA8IGMgPyBiIC0gNCA6IGI7XG4gICAgdmFyIGYgPSAwO1xuICAgIGZvciAoYiA9IDA7IGIgPCBlOyBiICs9IDQpIHtcbiAgICAgICAgdmFyIGcgPSB5W2EuY2hhckNvZGVBdChiKV0gPDwgMTggfCB5W2EuY2hhckNvZGVBdChiICsgMSldIDw8IDEyIHwgeVthLmNoYXJDb2RlQXQoYiArIDIpXSA8PCA2IHwgeVthLmNoYXJDb2RlQXQoYiArIDMpXTtcbiAgICAgICAgZFtmKytdID0gZyA+PiAxNiAmIDI1NTtcbiAgICAgICAgZFtmKytdID0gZyA+PiA4ICYgMjU1O1xuICAgICAgICBkW2YrK10gPSBnICYgMjU1O1xuICAgIH1cbiAgICAyID09PSBjID8gKGcgPSB5W2EuY2hhckNvZGVBdChiKV0gPDwgMiB8XG4gICAgICAgIHlbYS5jaGFyQ29kZUF0KGIgKyAxKV0gPj4gNCwgZFtmKytdID0gZyAmIDI1NSkgOiAxID09PSBjICYmIChnID0geVthLmNoYXJDb2RlQXQoYildIDw8IDEwIHwgeVthLmNoYXJDb2RlQXQoYiArIDEpXSA8PCA0IHwgeVthLmNoYXJDb2RlQXQoYiArIDIpXSA+PiAyLCBkW2YrK10gPSBnID4+IDggJiAyNTUsIGRbZisrXSA9IGcgJiAyNTUpO1xuICAgIHJldHVybiBkO1xufVxuZnVuY3Rpb24gVmEoYSwgYiwgYywgZCkgeyBmb3IgKHZhciBlID0gMDsgZSA8IGQgJiYgIShlICsgYyA+PSBiLmxlbmd0aCB8fCBlID49IGEubGVuZ3RoKTsgKytlKVxuICAgIGJbZSArIGNdID0gYVtlXTsgcmV0dXJuIGU7IH1cbmZ1bmN0aW9uIE5hKGEpIHsgcmV0dXJuIG51bGwgIT0gYSAmJiAoISFhLl9pc0J1ZmZlciB8fCBmYihhKSB8fCBcImZ1bmN0aW9uXCIgPT09IHR5cGVvZiBhLnJlYWRGbG9hdExFICYmIFwiZnVuY3Rpb25cIiA9PT0gdHlwZW9mIGEuc2xpY2UgJiYgZmIoYS5zbGljZSgwLCAwKSkpOyB9XG5mdW5jdGlvbiBmYihhKSB7IHJldHVybiAhIWEuY29uc3RydWN0b3IgJiYgXCJmdW5jdGlvblwiID09PSB0eXBlb2YgYS5jb25zdHJ1Y3Rvci5pc0J1ZmZlciAmJiBhLmNvbnN0cnVjdG9yLmlzQnVmZmVyKGEpOyB9XG52YXIgZ2IgPSBPYmplY3QuZnJlZXplKHsgX19wcm90b19fOiBudWxsLCBJTlNQRUNUX01BWF9CWVRFUzogNTAsIGtNYXhMZW5ndGg6IHphLCBCdWZmZXI6IHosIFNsb3dCdWZmZXI6IGZ1bmN0aW9uIChhKSB7ICthICE9IGEgJiYgKGEgPSAwKTsgcmV0dXJuIHouYWxsb2MoK2EpOyB9LCBpc0J1ZmZlcjogTmEgfSksIEYgPSB1KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgZnVuY3Rpb24gYyhhKSB7IGZvciAodmFyIGIgPSBbXSwgYyA9IDE7IGMgPCBhcmd1bWVudHMubGVuZ3RoOyBjKyspXG4gICAgICAgIGJbYyAtIDFdID0gYXJndW1lbnRzW2NdOyByZXR1cm4gbmV3IChnYi5CdWZmZXIuYmluZC5hcHBseShnYi5CdWZmZXIsIGQoW3ZvaWQgMCwgYV0sIGIpKSk7IH1cbiAgICB2YXIgZCA9IGwgJiYgbC5fX3NwcmVhZEFycmF5cyB8fCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZvciAodmFyIGEgPSAwLCBiID0gMCwgYyA9IGFyZ3VtZW50cy5sZW5ndGg7IGIgPCBjOyBiKyspXG4gICAgICAgICAgICBhICs9IGFyZ3VtZW50c1tiXS5sZW5ndGg7XG4gICAgICAgIGEgPSBBcnJheShhKTtcbiAgICAgICAgdmFyIGQgPSAwO1xuICAgICAgICBmb3IgKGIgPSAwOyBiIDwgYzsgYisrKVxuICAgICAgICAgICAgZm9yICh2YXIgayA9IGFyZ3VtZW50c1tiXSwgcCA9IDAsIG4gPSBrLmxlbmd0aDsgcCA8IG47IHArKywgZCsrKVxuICAgICAgICAgICAgICAgIGFbZF0gPSBrW3BdO1xuICAgICAgICByZXR1cm4gYTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShiLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogITAgfSk7XG4gICAgYi5CdWZmZXIgPSBnYi5CdWZmZXI7XG4gICAgYi5idWZmZXJBbGxvY1Vuc2FmZSA9IGdiLkJ1ZmZlci5hbGxvY1Vuc2FmZSB8fCBjO1xuICAgIGIuYnVmZmVyRnJvbSA9IGdiLkJ1ZmZlci5mcm9tIHx8IGM7XG59KTtcbnQoRik7XG5mdW5jdGlvbiBoYigpIHsgdGhyb3cgRXJyb3IoXCJzZXRUaW1lb3V0IGhhcyBub3QgYmVlbiBkZWZpbmVkXCIpOyB9XG5mdW5jdGlvbiBpYigpIHsgdGhyb3cgRXJyb3IoXCJjbGVhclRpbWVvdXQgaGFzIG5vdCBiZWVuIGRlZmluZWRcIik7IH1cbnZhciBqYiA9IGhiLCBrYiA9IGliO1xuXCJmdW5jdGlvblwiID09PSB0eXBlb2YgbGEuc2V0VGltZW91dCAmJiAoamIgPSBzZXRUaW1lb3V0KTtcblwiZnVuY3Rpb25cIiA9PT0gdHlwZW9mIGxhLmNsZWFyVGltZW91dCAmJiAoa2IgPSBjbGVhclRpbWVvdXQpO1xuZnVuY3Rpb24gcGIoYSkgeyBpZiAoamIgPT09IHNldFRpbWVvdXQpXG4gICAgcmV0dXJuIHNldFRpbWVvdXQoYSwgMCk7IGlmICgoamIgPT09IGhiIHx8ICFqYikgJiYgc2V0VGltZW91dClcbiAgICByZXR1cm4gamIgPSBzZXRUaW1lb3V0LCBzZXRUaW1lb3V0KGEsIDApOyB0cnkge1xuICAgIHJldHVybiBqYihhLCAwKTtcbn1cbmNhdGNoIChiKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIGpiLmNhbGwobnVsbCwgYSwgMCk7XG4gICAgfVxuICAgIGNhdGNoIChjKSB7XG4gICAgICAgIHJldHVybiBqYi5jYWxsKHRoaXMsIGEsIDApO1xuICAgIH1cbn0gfVxuZnVuY3Rpb24gcmIoYSkgeyBpZiAoa2IgPT09IGNsZWFyVGltZW91dClcbiAgICByZXR1cm4gY2xlYXJUaW1lb3V0KGEpOyBpZiAoKGtiID09PSBpYiB8fCAha2IpICYmIGNsZWFyVGltZW91dClcbiAgICByZXR1cm4ga2IgPSBjbGVhclRpbWVvdXQsIGNsZWFyVGltZW91dChhKTsgdHJ5IHtcbiAgICByZXR1cm4ga2IoYSk7XG59XG5jYXRjaCAoYikge1xuICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBrYi5jYWxsKG51bGwsIGEpO1xuICAgIH1cbiAgICBjYXRjaCAoYykge1xuICAgICAgICByZXR1cm4ga2IuY2FsbCh0aGlzLCBhKTtcbiAgICB9XG59IH1cbnZhciBzYiA9IFtdLCB0YiA9ICExLCB1YiwgdmIgPSAtMTtcbmZ1bmN0aW9uIHdiKCkgeyB0YiAmJiB1YiAmJiAodGIgPSAhMSwgdWIubGVuZ3RoID8gc2IgPSB1Yi5jb25jYXQoc2IpIDogdmIgPSAtMSwgc2IubGVuZ3RoICYmIHhiKCkpOyB9XG5mdW5jdGlvbiB4YigpIHsgaWYgKCF0Yikge1xuICAgIHZhciBhID0gcGIod2IpO1xuICAgIHRiID0gITA7XG4gICAgZm9yICh2YXIgYiA9IHNiLmxlbmd0aDsgYjspIHtcbiAgICAgICAgdWIgPSBzYjtcbiAgICAgICAgZm9yIChzYiA9IFtdOyArK3ZiIDwgYjspXG4gICAgICAgICAgICB1YiAmJiB1Ylt2Yl0ucnVuKCk7XG4gICAgICAgIHZiID0gLTE7XG4gICAgICAgIGIgPSBzYi5sZW5ndGg7XG4gICAgfVxuICAgIHViID0gbnVsbDtcbiAgICB0YiA9ICExO1xuICAgIHJiKGEpO1xufSB9XG5mdW5jdGlvbiBHKGEpIHsgdmFyIGIgPSBBcnJheShhcmd1bWVudHMubGVuZ3RoIC0gMSk7IGlmICgxIDwgYXJndW1lbnRzLmxlbmd0aClcbiAgICBmb3IgKHZhciBjID0gMTsgYyA8IGFyZ3VtZW50cy5sZW5ndGg7IGMrKylcbiAgICAgICAgYltjIC0gMV0gPSBhcmd1bWVudHNbY107IHNiLnB1c2gobmV3IHliKGEsIGIpKTsgMSAhPT0gc2IubGVuZ3RoIHx8IHRiIHx8IHBiKHhiKTsgfVxuZnVuY3Rpb24geWIoYSwgYikgeyB0aGlzLmZ1biA9IGE7IHRoaXMuYXJyYXkgPSBiOyB9XG55Yi5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkgeyB0aGlzLmZ1bi5hcHBseShudWxsLCB0aGlzLmFycmF5KTsgfTtcbmZ1bmN0aW9uIHpiKCkgeyB9XG52YXIgcGVyZm9ybWFuY2UgPSBsYS5wZXJmb3JtYW5jZSB8fCB7fSwgQWIgPSBwZXJmb3JtYW5jZS5ub3cgfHwgcGVyZm9ybWFuY2UubW96Tm93IHx8IHBlcmZvcm1hbmNlLm1zTm93IHx8IHBlcmZvcm1hbmNlLm9Ob3cgfHwgcGVyZm9ybWFuY2Uud2Via2l0Tm93IHx8IGZ1bmN0aW9uICgpIHsgcmV0dXJuIChuZXcgRGF0ZSkuZ2V0VGltZSgpOyB9LCBCYiA9IG5ldyBEYXRlLCBDYiA9IHsgbmV4dFRpY2s6IEcsIHRpdGxlOiBcImJyb3dzZXJcIiwgYnJvd3NlcjogITAsIGVudjoge30sIGFyZ3Y6IFtdLCB2ZXJzaW9uOiBcIlwiLCB2ZXJzaW9uczoge30sIG9uOiB6YiwgYWRkTGlzdGVuZXI6IHpiLCBvbmNlOiB6Yiwgb2ZmOiB6YiwgcmVtb3ZlTGlzdGVuZXI6IHpiLCByZW1vdmVBbGxMaXN0ZW5lcnM6IHpiLCBlbWl0OiB6YiwgYmluZGluZzogZnVuY3Rpb24gKCkgeyB0aHJvdyBFcnJvcihcInByb2Nlc3MuYmluZGluZyBpcyBub3Qgc3VwcG9ydGVkXCIpOyB9LCBjd2Q6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIFwiL1wiOyB9LCBjaGRpcjogZnVuY3Rpb24gKCkgeyB0aHJvdyBFcnJvcihcInByb2Nlc3MuY2hkaXIgaXMgbm90IHN1cHBvcnRlZFwiKTsgfSxcbiAgICB1bWFzazogZnVuY3Rpb24gKCkgeyByZXR1cm4gMDsgfSwgaHJ0aW1lOiBmdW5jdGlvbiAoYSkgeyB2YXIgYiA9IC4wMDEgKiBBYi5jYWxsKHBlcmZvcm1hbmNlKSwgYyA9IE1hdGguZmxvb3IoYik7IGIgPSBNYXRoLmZsb29yKGIgJSAxICogMUU5KTsgYSAmJiAoYyAtPSBhWzBdLCBiIC09IGFbMV0sIDAgPiBiICYmIChjLS0sIGIgKz0gMUU5KSk7IHJldHVybiBbYywgYl07IH0sIHBsYXRmb3JtOiBcImJyb3dzZXJcIiwgcmVsZWFzZToge30sIGNvbmZpZzoge30sIHVwdGltZTogZnVuY3Rpb24gKCkgeyByZXR1cm4gKG5ldyBEYXRlIC0gQmIpIC8gMUUzOyB9IH0sIERiID0gXCJmdW5jdGlvblwiID09PSB0eXBlb2YgT2JqZWN0LmNyZWF0ZSA/IGZ1bmN0aW9uIChhLCBiKSB7IGEuc3VwZXJfID0gYjsgYS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKGIucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBhLCBlbnVtZXJhYmxlOiAhMSwgd3JpdGFibGU6ICEwLCBjb25maWd1cmFibGU6ICEwIH0gfSk7IH0gOiBmdW5jdGlvbiAoYSwgYikge1xuICAgIGZ1bmN0aW9uIGMoKSB7IH1cbiAgICBhLnN1cGVyXyA9IGI7XG4gICAgYy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZTtcbiAgICBhLnByb3RvdHlwZSA9IG5ldyBjO1xuICAgIGEucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gYTtcbn0sIEViID0gLyVbc2RqJV0vZztcbmZ1bmN0aW9uIEZiKGEpIHsgaWYgKCFHYihhKSkge1xuICAgIGZvciAodmFyIGIgPSBbXSwgYyA9IDA7IGMgPCBhcmd1bWVudHMubGVuZ3RoOyBjKyspXG4gICAgICAgIGIucHVzaChIKGFyZ3VtZW50c1tjXSkpO1xuICAgIHJldHVybiBiLmpvaW4oXCIgXCIpO1xufSBjID0gMTsgdmFyIGQgPSBhcmd1bWVudHMsIGUgPSBkLmxlbmd0aDsgYiA9IFN0cmluZyhhKS5yZXBsYWNlKEViLCBmdW5jdGlvbiAoYSkgeyBpZiAoXCIlJVwiID09PSBhKVxuICAgIHJldHVybiBcIiVcIjsgaWYgKGMgPj0gZSlcbiAgICByZXR1cm4gYTsgc3dpdGNoIChhKSB7XG4gICAgY2FzZSBcIiVzXCI6IHJldHVybiBTdHJpbmcoZFtjKytdKTtcbiAgICBjYXNlIFwiJWRcIjogcmV0dXJuIE51bWJlcihkW2MrK10pO1xuICAgIGNhc2UgXCIlalwiOiB0cnkge1xuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoZFtjKytdKTtcbiAgICB9XG4gICAgY2F0Y2ggKGgpIHtcbiAgICAgICAgcmV0dXJuIFwiW0NpcmN1bGFyXVwiO1xuICAgIH1cbiAgICBkZWZhdWx0OiByZXR1cm4gYTtcbn0gfSk7IGZvciAodmFyIGYgPSBkW2NdOyBjIDwgZTsgZiA9IGRbKytjXSlcbiAgICBiID0gbnVsbCAhPT0gZiAmJiBIYihmKSA/IGIgKyAoXCIgXCIgKyBIKGYpKSA6IGIgKyAoXCIgXCIgKyBmKTsgcmV0dXJuIGI7IH1cbmZ1bmN0aW9uIEliKGEsIGIpIHsgaWYgKEpiKGxhLnByb2Nlc3MpKVxuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7IHJldHVybiBJYihhLCBiKS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOyB9OyBpZiAoITAgPT09IENiLm5vRGVwcmVjYXRpb24pXG4gICAgcmV0dXJuIGE7IHZhciBjID0gITE7IHJldHVybiBmdW5jdGlvbiAoKSB7IGlmICghYykge1xuICAgIGlmIChDYi50aHJvd0RlcHJlY2F0aW9uKVxuICAgICAgICB0aHJvdyBFcnJvcihiKTtcbiAgICBDYi50cmFjZURlcHJlY2F0aW9uID8gY29uc29sZS50cmFjZShiKSA6IGNvbnNvbGUuZXJyb3IoYik7XG4gICAgYyA9ICEwO1xufSByZXR1cm4gYS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOyB9OyB9XG52YXIgS2IgPSB7fSwgTGI7XG5mdW5jdGlvbiBNYihhKSB7IEpiKExiKSAmJiAoTGIgPSBDYi5lbnYuTk9ERV9ERUJVRyB8fCBcIlwiKTsgYSA9IGEudG9VcHBlckNhc2UoKTsgS2JbYV0gfHwgKChuZXcgUmVnRXhwKFwiXFxcXGJcIiArIGEgKyBcIlxcXFxiXCIsIFwiaVwiKSkudGVzdChMYikgPyBLYlthXSA9IGZ1bmN0aW9uICgpIHsgdmFyIGIgPSBGYi5hcHBseShudWxsLCBhcmd1bWVudHMpOyBjb25zb2xlLmVycm9yKFwiJXMgJWQ6ICVzXCIsIGEsIDAsIGIpOyB9IDogS2JbYV0gPSBmdW5jdGlvbiAoKSB7IH0pOyByZXR1cm4gS2JbYV07IH1cbmZ1bmN0aW9uIEgoYSwgYikgeyB2YXIgYyA9IHsgc2VlbjogW10sIHN0eWxpemU6IE5iIH07IDMgPD0gYXJndW1lbnRzLmxlbmd0aCAmJiAoYy5kZXB0aCA9IGFyZ3VtZW50c1syXSk7IDQgPD0gYXJndW1lbnRzLmxlbmd0aCAmJiAoYy5jb2xvcnMgPSBhcmd1bWVudHNbM10pOyBPYihiKSA/IGMuc2hvd0hpZGRlbiA9IGIgOiBiICYmIFBiKGMsIGIpOyBKYihjLnNob3dIaWRkZW4pICYmIChjLnNob3dIaWRkZW4gPSAhMSk7IEpiKGMuZGVwdGgpICYmIChjLmRlcHRoID0gMik7IEpiKGMuY29sb3JzKSAmJiAoYy5jb2xvcnMgPSAhMSk7IEpiKGMuY3VzdG9tSW5zcGVjdCkgJiYgKGMuY3VzdG9tSW5zcGVjdCA9ICEwKTsgYy5jb2xvcnMgJiYgKGMuc3R5bGl6ZSA9IFFiKTsgcmV0dXJuIFJiKGMsIGEsIGMuZGVwdGgpOyB9XG5ILmNvbG9ycyA9IHsgYm9sZDogWzEsIDIyXSwgaXRhbGljOiBbMywgMjNdLCB1bmRlcmxpbmU6IFs0LCAyNF0sIGludmVyc2U6IFs3LCAyN10sIHdoaXRlOiBbMzcsIDM5XSwgZ3JleTogWzkwLCAzOV0sIGJsYWNrOiBbMzAsIDM5XSwgYmx1ZTogWzM0LCAzOV0sIGN5YW46IFszNiwgMzldLCBncmVlbjogWzMyLCAzOV0sIG1hZ2VudGE6IFszNSwgMzldLCByZWQ6IFszMSwgMzldLCB5ZWxsb3c6IFszMywgMzldIH07XG5ILnN0eWxlcyA9IHsgc3BlY2lhbDogXCJjeWFuXCIsIG51bWJlcjogXCJ5ZWxsb3dcIiwgXCJib29sZWFuXCI6IFwieWVsbG93XCIsIHVuZGVmaW5lZDogXCJncmV5XCIsIFwibnVsbFwiOiBcImJvbGRcIiwgc3RyaW5nOiBcImdyZWVuXCIsIGRhdGU6IFwibWFnZW50YVwiLCByZWdleHA6IFwicmVkXCIgfTtcbmZ1bmN0aW9uIFFiKGEsIGIpIHsgcmV0dXJuIChiID0gSC5zdHlsZXNbYl0pID8gXCJcXHUwMDFiW1wiICsgSC5jb2xvcnNbYl1bMF0gKyBcIm1cIiArIGEgKyBcIlxcdTAwMWJbXCIgKyBILmNvbG9yc1tiXVsxXSArIFwibVwiIDogYTsgfVxuZnVuY3Rpb24gTmIoYSkgeyByZXR1cm4gYTsgfVxuZnVuY3Rpb24gU2IoYSkgeyB2YXIgYiA9IHt9OyBhLmZvckVhY2goZnVuY3Rpb24gKGEpIHsgYlthXSA9ICEwOyB9KTsgcmV0dXJuIGI7IH1cbmZ1bmN0aW9uIFJiKGEsIGIsIGMpIHtcbiAgICBpZiAoYS5jdXN0b21JbnNwZWN0ICYmIGIgJiYgVGIoYi5pbnNwZWN0KSAmJiBiLmluc3BlY3QgIT09IEggJiYgKCFiLmNvbnN0cnVjdG9yIHx8IGIuY29uc3RydWN0b3IucHJvdG90eXBlICE9PSBiKSkge1xuICAgICAgICB2YXIgZCA9IGIuaW5zcGVjdChjLCBhKTtcbiAgICAgICAgR2IoZCkgfHwgKGQgPSBSYihhLCBkLCBjKSk7XG4gICAgICAgIHJldHVybiBkO1xuICAgIH1cbiAgICBpZiAoZCA9IFViKGEsIGIpKVxuICAgICAgICByZXR1cm4gZDtcbiAgICB2YXIgZSA9IE9iamVjdC5rZXlzKGIpLCBmID0gU2IoZSk7XG4gICAgYS5zaG93SGlkZGVuICYmIChlID0gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoYikpO1xuICAgIGlmIChWYihiKSAmJiAoMCA8PSBlLmluZGV4T2YoXCJtZXNzYWdlXCIpIHx8IDAgPD0gZS5pbmRleE9mKFwiZGVzY3JpcHRpb25cIikpKVxuICAgICAgICByZXR1cm4gWmIoYik7XG4gICAgaWYgKDAgPT09IGUubGVuZ3RoKSB7XG4gICAgICAgIGlmIChUYihiKSlcbiAgICAgICAgICAgIHJldHVybiBhLnN0eWxpemUoXCJbRnVuY3Rpb25cIiArIChiLm5hbWUgPyBcIjogXCIgKyBiLm5hbWUgOiBcIlwiKSArIFwiXVwiLCBcInNwZWNpYWxcIik7XG4gICAgICAgIGlmIChhYyhiKSlcbiAgICAgICAgICAgIHJldHVybiBhLnN0eWxpemUoUmVnRXhwLnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGIpLCBcInJlZ2V4cFwiKTtcbiAgICAgICAgaWYgKGJjKGIpKVxuICAgICAgICAgICAgcmV0dXJuIGEuc3R5bGl6ZShEYXRlLnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGIpLCBcImRhdGVcIik7XG4gICAgICAgIGlmIChWYihiKSlcbiAgICAgICAgICAgIHJldHVybiBaYihiKTtcbiAgICB9XG4gICAgZCA9IFwiXCI7XG4gICAgdmFyIGcgPSAhMSwgaCA9IFtcIntcIiwgXCJ9XCJdO1xuICAgIGNjKGIpICYmIChnID0gITAsIGggPSBbXCJbXCIsIFwiXVwiXSk7XG4gICAgVGIoYikgJiYgKGQgPSBcIiBbRnVuY3Rpb25cIiArIChiLm5hbWUgPyBcIjogXCIgKyBiLm5hbWUgOiBcIlwiKSArIFwiXVwiKTtcbiAgICBhYyhiKSAmJiAoZCA9IFwiIFwiICsgUmVnRXhwLnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGIpKTtcbiAgICBiYyhiKSAmJiAoZCA9IFwiIFwiICsgRGF0ZS5wcm90b3R5cGUudG9VVENTdHJpbmcuY2FsbChiKSk7XG4gICAgVmIoYikgJiYgKGQgPSBcIiBcIiArIFpiKGIpKTtcbiAgICBpZiAoMCA9PT0gZS5sZW5ndGggJiYgKCFnIHx8IDAgPT0gYi5sZW5ndGgpKVxuICAgICAgICByZXR1cm4gaFswXSArIGQgKyBoWzFdO1xuICAgIGlmICgwID4gYylcbiAgICAgICAgcmV0dXJuIGFjKGIpID8gYS5zdHlsaXplKFJlZ0V4cC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChiKSwgXCJyZWdleHBcIikgOiBhLnN0eWxpemUoXCJbT2JqZWN0XVwiLCBcInNwZWNpYWxcIik7XG4gICAgYS5zZWVuLnB1c2goYik7XG4gICAgZSA9IGcgP1xuICAgICAgICBkYyhhLCBiLCBjLCBmLCBlKSA6IGUubWFwKGZ1bmN0aW9uIChkKSB7IHJldHVybiBlYyhhLCBiLCBjLCBmLCBkLCBnKTsgfSk7XG4gICAgYS5zZWVuLnBvcCgpO1xuICAgIHJldHVybiBmYyhlLCBkLCBoKTtcbn1cbmZ1bmN0aW9uIFViKGEsIGIpIHsgaWYgKEpiKGIpKVxuICAgIHJldHVybiBhLnN0eWxpemUoXCJ1bmRlZmluZWRcIiwgXCJ1bmRlZmluZWRcIik7IGlmIChHYihiKSlcbiAgICByZXR1cm4gYiA9IFwiJ1wiICsgSlNPTi5zdHJpbmdpZnkoYikucmVwbGFjZSgvXlwifFwiJC9nLCBcIlwiKS5yZXBsYWNlKC8nL2csIFwiXFxcXCdcIikucmVwbGFjZSgvXFxcXFwiL2csICdcIicpICsgXCInXCIsIGEuc3R5bGl6ZShiLCBcInN0cmluZ1wiKTsgaWYgKGdjKGIpKVxuICAgIHJldHVybiBhLnN0eWxpemUoXCJcIiArIGIsIFwibnVtYmVyXCIpOyBpZiAoT2IoYikpXG4gICAgcmV0dXJuIGEuc3R5bGl6ZShcIlwiICsgYiwgXCJib29sZWFuXCIpOyBpZiAobnVsbCA9PT0gYilcbiAgICByZXR1cm4gYS5zdHlsaXplKFwibnVsbFwiLCBcIm51bGxcIik7IH1cbmZ1bmN0aW9uIFpiKGEpIHsgcmV0dXJuIFwiW1wiICsgRXJyb3IucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoYSkgKyBcIl1cIjsgfVxuZnVuY3Rpb24gZGMoYSwgYiwgYywgZCwgZSkgeyBmb3IgKHZhciBmID0gW10sIGcgPSAwLCBoID0gYi5sZW5ndGg7IGcgPCBoOyArK2cpXG4gICAgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIFN0cmluZyhnKSkgPyBmLnB1c2goZWMoYSwgYiwgYywgZCwgU3RyaW5nKGcpLCAhMCkpIDogZi5wdXNoKFwiXCIpOyBlLmZvckVhY2goZnVuY3Rpb24gKGUpIHsgZS5tYXRjaCgvXlxcZCskLykgfHwgZi5wdXNoKGVjKGEsIGIsIGMsIGQsIGUsICEwKSk7IH0pOyByZXR1cm4gZjsgfVxuZnVuY3Rpb24gZWMoYSwgYiwgYywgZCwgZSwgZikge1xuICAgIHZhciBnLCBoO1xuICAgIGIgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGIsIGUpIHx8IHsgdmFsdWU6IGJbZV0gfTtcbiAgICBiLmdldCA/IGggPSBiLnNldCA/IGEuc3R5bGl6ZShcIltHZXR0ZXIvU2V0dGVyXVwiLCBcInNwZWNpYWxcIikgOiBhLnN0eWxpemUoXCJbR2V0dGVyXVwiLCBcInNwZWNpYWxcIikgOiBiLnNldCAmJiAoaCA9IGEuc3R5bGl6ZShcIltTZXR0ZXJdXCIsIFwic3BlY2lhbFwiKSk7XG4gICAgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGQsIGUpIHx8IChnID0gXCJbXCIgKyBlICsgXCJdXCIpO1xuICAgIGggfHwgKDAgPiBhLnNlZW4uaW5kZXhPZihiLnZhbHVlKSA/IChoID0gbnVsbCA9PT0gYyA/IFJiKGEsIGIudmFsdWUsIG51bGwpIDogUmIoYSwgYi52YWx1ZSwgYyAtIDEpLCAtMSA8IGguaW5kZXhPZihcIlxcblwiKSAmJiAoaCA9IGYgPyBoLnNwbGl0KFwiXFxuXCIpLm1hcChmdW5jdGlvbiAoYSkgeyByZXR1cm4gXCIgIFwiICsgYTsgfSkuam9pbihcIlxcblwiKS5zdWJzdHIoMikgOiBcIlxcblwiICsgaC5zcGxpdChcIlxcblwiKS5tYXAoZnVuY3Rpb24gKGEpIHsgcmV0dXJuIFwiICAgXCIgKyBhOyB9KS5qb2luKFwiXFxuXCIpKSkgOlxuICAgICAgICBoID0gYS5zdHlsaXplKFwiW0NpcmN1bGFyXVwiLCBcInNwZWNpYWxcIikpO1xuICAgIGlmIChKYihnKSkge1xuICAgICAgICBpZiAoZiAmJiBlLm1hdGNoKC9eXFxkKyQvKSlcbiAgICAgICAgICAgIHJldHVybiBoO1xuICAgICAgICBnID0gSlNPTi5zdHJpbmdpZnkoXCJcIiArIGUpO1xuICAgICAgICBnLm1hdGNoKC9eXCIoW2EtekEtWl9dW2EtekEtWl8wLTldKilcIiQvKSA/IChnID0gZy5zdWJzdHIoMSwgZy5sZW5ndGggLSAyKSwgZyA9IGEuc3R5bGl6ZShnLCBcIm5hbWVcIikpIDogKGcgPSBnLnJlcGxhY2UoLycvZywgXCJcXFxcJ1wiKS5yZXBsYWNlKC9cXFxcXCIvZywgJ1wiJykucmVwbGFjZSgvKF5cInxcIiQpL2csIFwiJ1wiKSwgZyA9IGEuc3R5bGl6ZShnLCBcInN0cmluZ1wiKSk7XG4gICAgfVxuICAgIHJldHVybiBnICsgXCI6IFwiICsgaDtcbn1cbmZ1bmN0aW9uIGZjKGEsIGIsIGMpIHsgcmV0dXJuIDYwIDwgYS5yZWR1Y2UoZnVuY3Rpb24gKGEsIGIpIHsgYi5pbmRleE9mKFwiXFxuXCIpOyByZXR1cm4gYSArIGIucmVwbGFjZSgvXFx1MDAxYlxcW1xcZFxcZD9tL2csIFwiXCIpLmxlbmd0aCArIDE7IH0sIDApID8gY1swXSArIChcIlwiID09PSBiID8gXCJcIiA6IGIgKyBcIlxcbiBcIikgKyBcIiBcIiArIGEuam9pbihcIixcXG4gIFwiKSArIFwiIFwiICsgY1sxXSA6IGNbMF0gKyBiICsgXCIgXCIgKyBhLmpvaW4oXCIsIFwiKSArIFwiIFwiICsgY1sxXTsgfVxuZnVuY3Rpb24gY2MoYSkgeyByZXR1cm4gQXJyYXkuaXNBcnJheShhKTsgfVxuZnVuY3Rpb24gT2IoYSkgeyByZXR1cm4gXCJib29sZWFuXCIgPT09IHR5cGVvZiBhOyB9XG5mdW5jdGlvbiBnYyhhKSB7IHJldHVybiBcIm51bWJlclwiID09PSB0eXBlb2YgYTsgfVxuZnVuY3Rpb24gR2IoYSkgeyByZXR1cm4gXCJzdHJpbmdcIiA9PT0gdHlwZW9mIGE7IH1cbmZ1bmN0aW9uIEpiKGEpIHsgcmV0dXJuIHZvaWQgMCA9PT0gYTsgfVxuZnVuY3Rpb24gYWMoYSkgeyByZXR1cm4gSGIoYSkgJiYgXCJbb2JqZWN0IFJlZ0V4cF1cIiA9PT0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGEpOyB9XG5mdW5jdGlvbiBIYihhKSB7IHJldHVybiBcIm9iamVjdFwiID09PSB0eXBlb2YgYSAmJiBudWxsICE9PSBhOyB9XG5mdW5jdGlvbiBiYyhhKSB7IHJldHVybiBIYihhKSAmJiBcIltvYmplY3QgRGF0ZV1cIiA9PT0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGEpOyB9XG5mdW5jdGlvbiBWYihhKSB7IHJldHVybiBIYihhKSAmJiAoXCJbb2JqZWN0IEVycm9yXVwiID09PSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoYSkgfHwgYSBpbnN0YW5jZW9mIEVycm9yKTsgfVxuZnVuY3Rpb24gVGIoYSkgeyByZXR1cm4gXCJmdW5jdGlvblwiID09PSB0eXBlb2YgYTsgfVxuZnVuY3Rpb24gaGMoYSkgeyByZXR1cm4gbnVsbCA9PT0gYSB8fCBcImJvb2xlYW5cIiA9PT0gdHlwZW9mIGEgfHwgXCJudW1iZXJcIiA9PT0gdHlwZW9mIGEgfHwgXCJzdHJpbmdcIiA9PT0gdHlwZW9mIGEgfHwgXCJzeW1ib2xcIiA9PT0gdHlwZW9mIGEgfHwgXCJ1bmRlZmluZWRcIiA9PT0gdHlwZW9mIGE7IH1cbmZ1bmN0aW9uIGljKGEpIHsgcmV0dXJuIDEwID4gYSA/IFwiMFwiICsgYS50b1N0cmluZygxMCkgOiBhLnRvU3RyaW5nKDEwKTsgfVxudmFyIGpjID0gXCJKYW4gRmViIE1hciBBcHIgTWF5IEp1biBKdWwgQXVnIFNlcCBPY3QgTm92IERlY1wiLnNwbGl0KFwiIFwiKTtcbmZ1bmN0aW9uIGtjKCkgeyB2YXIgYSA9IG5ldyBEYXRlLCBiID0gW2ljKGEuZ2V0SG91cnMoKSksIGljKGEuZ2V0TWludXRlcygpKSwgaWMoYS5nZXRTZWNvbmRzKCkpXS5qb2luKFwiOlwiKTsgcmV0dXJuIFthLmdldERhdGUoKSwgamNbYS5nZXRNb250aCgpXSwgYl0uam9pbihcIiBcIik7IH1cbmZ1bmN0aW9uIFBiKGEsIGIpIHsgaWYgKCFiIHx8ICFIYihiKSlcbiAgICByZXR1cm4gYTsgZm9yICh2YXIgYyA9IE9iamVjdC5rZXlzKGIpLCBkID0gYy5sZW5ndGg7IGQtLTspXG4gICAgYVtjW2RdXSA9IGJbY1tkXV07IHJldHVybiBhOyB9XG52YXIgbGMgPSB7IGluaGVyaXRzOiBEYiwgX2V4dGVuZDogUGIsIGxvZzogZnVuY3Rpb24gKCkgeyBjb25zb2xlLmxvZyhcIiVzIC0gJXNcIiwga2MoKSwgRmIuYXBwbHkobnVsbCwgYXJndW1lbnRzKSk7IH0sIGlzQnVmZmVyOiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gTmEoYSk7IH0sIGlzUHJpbWl0aXZlOiBoYywgaXNGdW5jdGlvbjogVGIsIGlzRXJyb3I6IFZiLCBpc0RhdGU6IGJjLCBpc09iamVjdDogSGIsIGlzUmVnRXhwOiBhYywgaXNVbmRlZmluZWQ6IEpiLCBpc1N5bWJvbDogZnVuY3Rpb24gKGEpIHsgcmV0dXJuIFwic3ltYm9sXCIgPT09IHR5cGVvZiBhOyB9LCBpc1N0cmluZzogR2IsIGlzTnVtYmVyOiBnYywgaXNOdWxsT3JVbmRlZmluZWQ6IGZ1bmN0aW9uIChhKSB7IHJldHVybiBudWxsID09IGE7IH0sIGlzTnVsbDogZnVuY3Rpb24gKGEpIHsgcmV0dXJuIG51bGwgPT09IGE7IH0sIGlzQm9vbGVhbjogT2IsIGlzQXJyYXk6IGNjLCBpbnNwZWN0OiBILCBkZXByZWNhdGU6IEliLCBmb3JtYXQ6IEZiLCBkZWJ1Z2xvZzogTWIgfTtcbmZ1bmN0aW9uIG1jKGEsIGIpIHsgaWYgKGEgPT09IGIpXG4gICAgcmV0dXJuIDA7IGZvciAodmFyIGMgPSBhLmxlbmd0aCwgZCA9IGIubGVuZ3RoLCBlID0gMCwgZiA9IE1hdGgubWluKGMsIGQpOyBlIDwgZjsgKytlKVxuICAgIGlmIChhW2VdICE9PSBiW2VdKSB7XG4gICAgICAgIGMgPSBhW2VdO1xuICAgICAgICBkID0gYltlXTtcbiAgICAgICAgYnJlYWs7XG4gICAgfSByZXR1cm4gYyA8IGQgPyAtMSA6IGQgPCBjID8gMSA6IDA7IH1cbnZhciBuYyA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHksIG9jID0gT2JqZWN0LmtleXMgfHwgZnVuY3Rpb24gKGEpIHsgdmFyIGIgPSBbXSwgYzsgZm9yIChjIGluIGEpXG4gICAgbmMuY2FsbChhLCBjKSAmJiBiLnB1c2goYyk7IHJldHVybiBiOyB9LCBwYyA9IEFycmF5LnByb3RvdHlwZS5zbGljZSwgcWM7XG5mdW5jdGlvbiByYygpIHsgcmV0dXJuIFwidW5kZWZpbmVkXCIgIT09IHR5cGVvZiBxYyA/IHFjIDogcWMgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBcImZvb1wiID09PSBmdW5jdGlvbiAoKSB7IH0ubmFtZTsgfSgpOyB9XG5mdW5jdGlvbiBzYyhhKSB7IHJldHVybiBOYShhKSB8fCBcImZ1bmN0aW9uXCIgIT09IHR5cGVvZiBsYS5BcnJheUJ1ZmZlciA/ICExIDogXCJmdW5jdGlvblwiID09PSB0eXBlb2YgQXJyYXlCdWZmZXIuaXNWaWV3ID8gQXJyYXlCdWZmZXIuaXNWaWV3KGEpIDogYSA/IGEgaW5zdGFuY2VvZiBEYXRhVmlldyB8fCBhLmJ1ZmZlciAmJiBhLmJ1ZmZlciBpbnN0YW5jZW9mIEFycmF5QnVmZmVyID8gITAgOiAhMSA6ICExOyB9XG5mdW5jdGlvbiBJKGEsIGIpIHsgYSB8fCBKKGEsICEwLCBiLCBcIj09XCIsIHRjKTsgfVxudmFyIHVjID0gL1xccypmdW5jdGlvblxccysoW15cXChcXHNdKilcXHMqLztcbmZ1bmN0aW9uIHZjKGEpIHsgaWYgKFRiKGEpKVxuICAgIHJldHVybiByYygpID8gYS5uYW1lIDogKGEgPSBhLnRvU3RyaW5nKCkubWF0Y2godWMpKSAmJiBhWzFdOyB9XG5JLkFzc2VydGlvbkVycm9yID0gd2M7XG5mdW5jdGlvbiB3YyhhKSB7IHRoaXMubmFtZSA9IFwiQXNzZXJ0aW9uRXJyb3JcIjsgdGhpcy5hY3R1YWwgPSBhLmFjdHVhbDsgdGhpcy5leHBlY3RlZCA9IGEuZXhwZWN0ZWQ7IHRoaXMub3BlcmF0b3IgPSBhLm9wZXJhdG9yOyBhLm1lc3NhZ2UgPyAodGhpcy5tZXNzYWdlID0gYS5tZXNzYWdlLCB0aGlzLmdlbmVyYXRlZE1lc3NhZ2UgPSAhMSkgOiAodGhpcy5tZXNzYWdlID0geGMoeWModGhpcy5hY3R1YWwpLCAxMjgpICsgXCIgXCIgKyB0aGlzLm9wZXJhdG9yICsgXCIgXCIgKyB4Yyh5Yyh0aGlzLmV4cGVjdGVkKSwgMTI4KSwgdGhpcy5nZW5lcmF0ZWRNZXNzYWdlID0gITApOyB2YXIgYiA9IGEuc3RhY2tTdGFydEZ1bmN0aW9uIHx8IEo7IEVycm9yLmNhcHR1cmVTdGFja1RyYWNlID8gRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UodGhpcywgYikgOiAoYSA9IEVycm9yKCksIGEuc3RhY2sgJiYgKGEgPSBhLnN0YWNrLCBiID0gdmMoYiksIGIgPSBhLmluZGV4T2YoXCJcXG5cIiArIGIpLCAwIDw9IGIgJiYgKGIgPSBhLmluZGV4T2YoXCJcXG5cIiwgYiArIDEpLCBhID0gYS5zdWJzdHJpbmcoYiArIDEpKSwgdGhpcy5zdGFjayA9IGEpKTsgfVxuRGIod2MsIEVycm9yKTtcbmZ1bmN0aW9uIHhjKGEsIGIpIHsgcmV0dXJuIFwic3RyaW5nXCIgPT09IHR5cGVvZiBhID8gYS5sZW5ndGggPCBiID8gYSA6IGEuc2xpY2UoMCwgYikgOiBhOyB9XG5mdW5jdGlvbiB5YyhhKSB7IGlmIChyYygpIHx8ICFUYihhKSlcbiAgICByZXR1cm4gSChhKTsgYSA9IHZjKGEpOyByZXR1cm4gXCJbRnVuY3Rpb25cIiArIChhID8gXCI6IFwiICsgYSA6IFwiXCIpICsgXCJdXCI7IH1cbmZ1bmN0aW9uIEooYSwgYiwgYywgZCwgZSkgeyB0aHJvdyBuZXcgd2MoeyBtZXNzYWdlOiBjLCBhY3R1YWw6IGEsIGV4cGVjdGVkOiBiLCBvcGVyYXRvcjogZCwgc3RhY2tTdGFydEZ1bmN0aW9uOiBlIH0pOyB9XG5JLmZhaWwgPSBKO1xuZnVuY3Rpb24gdGMoYSwgYikgeyBhIHx8IEooYSwgITAsIGIsIFwiPT1cIiwgdGMpOyB9XG5JLm9rID0gdGM7XG5JLmVxdWFsID0gemM7XG5mdW5jdGlvbiB6YyhhLCBiLCBjKSB7IGEgIT0gYiAmJiBKKGEsIGIsIGMsIFwiPT1cIiwgemMpOyB9XG5JLm5vdEVxdWFsID0gQWM7XG5mdW5jdGlvbiBBYyhhLCBiLCBjKSB7IGEgPT0gYiAmJiBKKGEsIGIsIGMsIFwiIT1cIiwgQWMpOyB9XG5JLmRlZXBFcXVhbCA9IEJjO1xuZnVuY3Rpb24gQmMoYSwgYiwgYykgeyBDYyhhLCBiLCAhMSkgfHwgSihhLCBiLCBjLCBcImRlZXBFcXVhbFwiLCBCYyk7IH1cbkkuZGVlcFN0cmljdEVxdWFsID0gRGM7XG5mdW5jdGlvbiBEYyhhLCBiLCBjKSB7IENjKGEsIGIsICEwKSB8fCBKKGEsIGIsIGMsIFwiZGVlcFN0cmljdEVxdWFsXCIsIERjKTsgfVxuZnVuY3Rpb24gQ2MoYSwgYiwgYywgZCkge1xuICAgIGlmIChhID09PSBiKVxuICAgICAgICByZXR1cm4gITA7XG4gICAgaWYgKE5hKGEpICYmIE5hKGIpKVxuICAgICAgICByZXR1cm4gMCA9PT0gbWMoYSwgYik7XG4gICAgaWYgKGJjKGEpICYmIGJjKGIpKVxuICAgICAgICByZXR1cm4gYS5nZXRUaW1lKCkgPT09IGIuZ2V0VGltZSgpO1xuICAgIGlmIChhYyhhKSAmJiBhYyhiKSlcbiAgICAgICAgcmV0dXJuIGEuc291cmNlID09PSBiLnNvdXJjZSAmJiBhLmdsb2JhbCA9PT0gYi5nbG9iYWwgJiYgYS5tdWx0aWxpbmUgPT09IGIubXVsdGlsaW5lICYmIGEubGFzdEluZGV4ID09PSBiLmxhc3RJbmRleCAmJiBhLmlnbm9yZUNhc2UgPT09IGIuaWdub3JlQ2FzZTtcbiAgICBpZiAobnVsbCAhPT0gYSAmJiBcIm9iamVjdFwiID09PSB0eXBlb2YgYSB8fCBudWxsICE9PSBiICYmIFwib2JqZWN0XCIgPT09IHR5cGVvZiBiKSB7XG4gICAgICAgIGlmICghc2MoYSkgfHwgIXNjKGIpIHx8IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChhKSAhPT0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGIpIHx8IGEgaW5zdGFuY2VvZiBGbG9hdDMyQXJyYXkgfHwgYSBpbnN0YW5jZW9mIEZsb2F0NjRBcnJheSkge1xuICAgICAgICAgICAgaWYgKE5hKGEpICE9PSBOYShiKSlcbiAgICAgICAgICAgICAgICByZXR1cm4gITE7XG4gICAgICAgICAgICBkID0gZCB8fCB7IGFjdHVhbDogW10sIGV4cGVjdGVkOiBbXSB9O1xuICAgICAgICAgICAgdmFyIGUgPSBkLmFjdHVhbC5pbmRleE9mKGEpO1xuICAgICAgICAgICAgaWYgKC0xICE9PSBlICYmIGUgPT09IGQuZXhwZWN0ZWQuaW5kZXhPZihiKSlcbiAgICAgICAgICAgICAgICByZXR1cm4gITA7XG4gICAgICAgICAgICBkLmFjdHVhbC5wdXNoKGEpO1xuICAgICAgICAgICAgZC5leHBlY3RlZC5wdXNoKGIpO1xuICAgICAgICAgICAgcmV0dXJuIEVjKGEsIGIsIGMsIGQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAwID09PSBtYyhuZXcgVWludDhBcnJheShhLmJ1ZmZlciksIG5ldyBVaW50OEFycmF5KGIuYnVmZmVyKSk7XG4gICAgfVxuICAgIHJldHVybiBjID8gYSA9PT0gYiA6IGEgPT0gYjtcbn1cbmZ1bmN0aW9uIEZjKGEpIHsgcmV0dXJuIFwiW29iamVjdCBBcmd1bWVudHNdXCIgPT0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGEpOyB9XG5mdW5jdGlvbiBFYyhhLCBiLCBjLCBkKSB7IGlmIChudWxsID09PSBhIHx8IHZvaWQgMCA9PT0gYSB8fCBudWxsID09PSBiIHx8IHZvaWQgMCA9PT0gYilcbiAgICByZXR1cm4gITE7IGlmIChoYyhhKSB8fCBoYyhiKSlcbiAgICByZXR1cm4gYSA9PT0gYjsgaWYgKGMgJiYgT2JqZWN0LmdldFByb3RvdHlwZU9mKGEpICE9PSBPYmplY3QuZ2V0UHJvdG90eXBlT2YoYikpXG4gICAgcmV0dXJuICExOyB2YXIgZSA9IEZjKGEpLCBmID0gRmMoYik7IGlmIChlICYmICFmIHx8ICFlICYmIGYpXG4gICAgcmV0dXJuICExOyBpZiAoZSlcbiAgICByZXR1cm4gYSA9IHBjLmNhbGwoYSksIGIgPSBwYy5jYWxsKGIpLCBDYyhhLCBiLCBjKTsgZSA9IG9jKGEpOyB2YXIgZyA9IG9jKGIpOyBpZiAoZS5sZW5ndGggIT09IGcubGVuZ3RoKVxuICAgIHJldHVybiAhMTsgZS5zb3J0KCk7IGcuc29ydCgpOyBmb3IgKGYgPSBlLmxlbmd0aCAtIDE7IDAgPD0gZjsgZi0tKVxuICAgIGlmIChlW2ZdICE9PSBnW2ZdKVxuICAgICAgICByZXR1cm4gITE7IGZvciAoZiA9IGUubGVuZ3RoIC0gMTsgMCA8PSBmOyBmLS0pXG4gICAgaWYgKGcgPSBlW2ZdLCAhQ2MoYVtnXSwgYltnXSwgYywgZCkpXG4gICAgICAgIHJldHVybiAhMTsgcmV0dXJuICEwOyB9XG5JLm5vdERlZXBFcXVhbCA9IEdjO1xuZnVuY3Rpb24gR2MoYSwgYiwgYykgeyBDYyhhLCBiLCAhMSkgJiYgSihhLCBiLCBjLCBcIm5vdERlZXBFcXVhbFwiLCBHYyk7IH1cbkkubm90RGVlcFN0cmljdEVxdWFsID0gSGM7XG5mdW5jdGlvbiBIYyhhLCBiLCBjKSB7IENjKGEsIGIsICEwKSAmJiBKKGEsIGIsIGMsIFwibm90RGVlcFN0cmljdEVxdWFsXCIsIEhjKTsgfVxuSS5zdHJpY3RFcXVhbCA9IEljO1xuZnVuY3Rpb24gSWMoYSwgYiwgYykgeyBhICE9PSBiICYmIEooYSwgYiwgYywgXCI9PT1cIiwgSWMpOyB9XG5JLm5vdFN0cmljdEVxdWFsID0gSmM7XG5mdW5jdGlvbiBKYyhhLCBiLCBjKSB7IGEgPT09IGIgJiYgSihhLCBiLCBjLCBcIiE9PVwiLCBKYyk7IH1cbmZ1bmN0aW9uIEtjKGEsIGIpIHsgaWYgKCFhIHx8ICFiKVxuICAgIHJldHVybiAhMTsgaWYgKFwiW29iamVjdCBSZWdFeHBdXCIgPT0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGIpKVxuICAgIHJldHVybiBiLnRlc3QoYSk7IHRyeSB7XG4gICAgaWYgKGEgaW5zdGFuY2VvZiBiKVxuICAgICAgICByZXR1cm4gITA7XG59XG5jYXRjaCAoYykgeyB9IHJldHVybiBFcnJvci5pc1Byb3RvdHlwZU9mKGIpID8gITEgOiAhMCA9PT0gYi5jYWxsKHt9LCBhKTsgfVxuZnVuY3Rpb24gTGMoYSwgYiwgYywgZCkgeyBpZiAoXCJmdW5jdGlvblwiICE9PSB0eXBlb2YgYilcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdcImJsb2NrXCIgYXJndW1lbnQgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7IFwic3RyaW5nXCIgPT09IHR5cGVvZiBjICYmIChkID0gYywgYyA9IG51bGwpOyB0cnkge1xuICAgIGIoKTtcbn1cbmNhdGNoIChoKSB7XG4gICAgdmFyIGUgPSBoO1xufSBiID0gZTsgZCA9IChjICYmIGMubmFtZSA/IFwiIChcIiArIGMubmFtZSArIFwiKS5cIiA6IFwiLlwiKSArIChkID8gXCIgXCIgKyBkIDogXCIuXCIpOyBhICYmICFiICYmIEooYiwgYywgXCJNaXNzaW5nIGV4cGVjdGVkIGV4Y2VwdGlvblwiICsgZCk7IGUgPSBcInN0cmluZ1wiID09PSB0eXBlb2YgZDsgdmFyIGYgPSAhYSAmJiBWYihiKSwgZyA9ICFhICYmIGIgJiYgIWM7IChmICYmIGUgJiYgS2MoYiwgYykgfHwgZykgJiYgSihiLCBjLCBcIkdvdCB1bndhbnRlZCBleGNlcHRpb25cIiArIGQpOyBpZiAoYSAmJiBiICYmIGMgJiYgIUtjKGIsIGMpIHx8ICFhICYmIGIpXG4gICAgdGhyb3cgYjsgfVxuSS50aHJvd3MgPSBNYztcbmZ1bmN0aW9uIE1jKGEsIGIsIGMpIHsgTGMoITAsIGEsIGIsIGMpOyB9XG5JLmRvZXNOb3RUaHJvdyA9IE5jO1xuZnVuY3Rpb24gTmMoYSwgYiwgYykgeyBMYyghMSwgYSwgYiwgYyk7IH1cbkkuaWZFcnJvciA9IE9jO1xuZnVuY3Rpb24gT2MoYSkgeyBpZiAoYSlcbiAgICB0aHJvdyBhOyB9XG52YXIgUGMgPSB1KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgZnVuY3Rpb24gYyhhKSB7IHJldHVybiBmdW5jdGlvbiAoYSkgeyBmdW5jdGlvbiBiKGIpIHsgZm9yICh2YXIgYyA9IFtdLCBlID0gMTsgZSA8IGFyZ3VtZW50cy5sZW5ndGg7IGUrKylcbiAgICAgICAgY1tlIC0gMV0gPSBhcmd1bWVudHNbZV07IGMgPSBhLmNhbGwodGhpcywgZChiLCBjKSkgfHwgdGhpczsgYy5jb2RlID0gYjsgY1toXSA9IGI7IGMubmFtZSA9IGEucHJvdG90eXBlLm5hbWUgKyBcIiBbXCIgKyBjW2hdICsgXCJdXCI7IHJldHVybiBjOyB9IGcoYiwgYSk7IHJldHVybiBiOyB9KGEpOyB9XG4gICAgZnVuY3Rpb24gZChhLCBiKSB7IEkuc3RyaWN0RXF1YWwodHlwZW9mIGEsIFwic3RyaW5nXCIpOyB2YXIgYyA9IGtbYV07IEkoYywgXCJBbiBpbnZhbGlkIGVycm9yIG1lc3NhZ2Uga2V5IHdhcyB1c2VkOiBcIiArIGEgKyBcIi5cIik7IGlmIChcImZ1bmN0aW9uXCIgPT09IHR5cGVvZiBjKVxuICAgICAgICBhID0gYztcbiAgICBlbHNlIHtcbiAgICAgICAgYSA9IGxjLmZvcm1hdDtcbiAgICAgICAgaWYgKHZvaWQgMCA9PT0gYiB8fCAwID09PSBiLmxlbmd0aClcbiAgICAgICAgICAgIHJldHVybiBjO1xuICAgICAgICBiLnVuc2hpZnQoYyk7XG4gICAgfSByZXR1cm4gU3RyaW5nKGEuYXBwbHkobnVsbCwgYikpOyB9XG4gICAgZnVuY3Rpb24gZShhLCBiKSB7XG4gICAgICAgIGtbYV0gPVxuICAgICAgICAgICAgXCJmdW5jdGlvblwiID09PSB0eXBlb2YgYiA/IGIgOiBTdHJpbmcoYik7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGYoYSwgYikgeyBJKGEsIFwiZXhwZWN0ZWQgaXMgcmVxdWlyZWRcIik7IEkoXCJzdHJpbmdcIiA9PT0gdHlwZW9mIGIsIFwidGhpbmcgaXMgcmVxdWlyZWRcIik7IGlmIChBcnJheS5pc0FycmF5KGEpKSB7XG4gICAgICAgIHZhciBjID0gYS5sZW5ndGg7XG4gICAgICAgIEkoMCA8IGMsIFwiQXQgbGVhc3Qgb25lIGV4cGVjdGVkIHZhbHVlIG5lZWRzIHRvIGJlIHNwZWNpZmllZFwiKTtcbiAgICAgICAgYSA9IGEubWFwKGZ1bmN0aW9uIChhKSB7IHJldHVybiBTdHJpbmcoYSk7IH0pO1xuICAgICAgICByZXR1cm4gMiA8IGMgPyBcIm9uZSBvZiBcIiArIGIgKyBcIiBcIiArIGEuc2xpY2UoMCwgYyAtIDEpLmpvaW4oXCIsIFwiKSArIFwiLCBvciBcIiArIGFbYyAtIDFdIDogMiA9PT0gYyA/IFwib25lIG9mIFwiICsgYiArIFwiIFwiICsgYVswXSArIFwiIG9yIFwiICsgYVsxXSA6IFwib2YgXCIgKyBiICsgXCIgXCIgKyBhWzBdO1xuICAgIH0gcmV0dXJuIFwib2YgXCIgKyBiICsgXCIgXCIgKyBTdHJpbmcoYSk7IH1cbiAgICB2YXIgZyA9IGwgJiYgbC5fX2V4dGVuZHMgfHwgZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBhKGIsIGMpIHtcbiAgICAgICAgICAgIGEgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZlxuICAgICAgICAgICAgICAgIEFycmF5ICYmIGZ1bmN0aW9uIChhLCBiKSB7IGEuX19wcm90b19fID0gYjsgfSB8fCBmdW5jdGlvbiAoYSwgYikgeyBmb3IgKHZhciBjIGluIGIpXG4gICAgICAgICAgICAgICAgYi5oYXNPd25Qcm9wZXJ0eShjKSAmJiAoYVtjXSA9IGJbY10pOyB9O1xuICAgICAgICAgICAgcmV0dXJuIGEoYiwgYyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChiLCBjKSB7IGZ1bmN0aW9uIGQoKSB7IHRoaXMuY29uc3RydWN0b3IgPSBiOyB9IGEoYiwgYyk7IGIucHJvdG90eXBlID0gbnVsbCA9PT0gYyA/IE9iamVjdC5jcmVhdGUoYykgOiAoZC5wcm90b3R5cGUgPSBjLnByb3RvdHlwZSwgbmV3IGQpOyB9O1xuICAgIH0oKTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoYiwgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6ICEwIH0pO1xuICAgIHZhciBoID0gXCJ1bmRlZmluZWRcIiA9PT0gdHlwZW9mIFN5bWJvbCA/IFwiX2tDb2RlXCIgOiBTeW1ib2woXCJjb2RlXCIpLCBrID0ge307XG4gICAgYSA9IGZ1bmN0aW9uIChhKSB7XG4gICAgICAgIGZ1bmN0aW9uIGMoYykge1xuICAgICAgICAgICAgaWYgKFwib2JqZWN0XCIgIT09IHR5cGVvZiBjIHx8IG51bGwgPT09IGMpXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IGIuVHlwZUVycm9yKFwiRVJSX0lOVkFMSURfQVJHX1RZUEVcIiwgXCJvcHRpb25zXCIsIFwib2JqZWN0XCIpO1xuICAgICAgICAgICAgdmFyIGQgPSBjLm1lc3NhZ2UgP1xuICAgICAgICAgICAgICAgIGEuY2FsbCh0aGlzLCBjLm1lc3NhZ2UpIHx8IHRoaXMgOiBhLmNhbGwodGhpcywgbGMuaW5zcGVjdChjLmFjdHVhbCkuc2xpY2UoMCwgMTI4KSArIFwiIFwiICsgKGMub3BlcmF0b3IgKyBcIiBcIiArIGxjLmluc3BlY3QoYy5leHBlY3RlZCkuc2xpY2UoMCwgMTI4KSkpIHx8IHRoaXM7XG4gICAgICAgICAgICBkLmdlbmVyYXRlZE1lc3NhZ2UgPSAhYy5tZXNzYWdlO1xuICAgICAgICAgICAgZC5uYW1lID0gXCJBc3NlcnRpb25FcnJvciBbRVJSX0FTU0VSVElPTl1cIjtcbiAgICAgICAgICAgIGQuY29kZSA9IFwiRVJSX0FTU0VSVElPTlwiO1xuICAgICAgICAgICAgZC5hY3R1YWwgPSBjLmFjdHVhbDtcbiAgICAgICAgICAgIGQuZXhwZWN0ZWQgPSBjLmV4cGVjdGVkO1xuICAgICAgICAgICAgZC5vcGVyYXRvciA9IGMub3BlcmF0b3I7XG4gICAgICAgICAgICBiLkVycm9yLmNhcHR1cmVTdGFja1RyYWNlKGQsIGMuc3RhY2tTdGFydEZ1bmN0aW9uKTtcbiAgICAgICAgICAgIHJldHVybiBkO1xuICAgICAgICB9XG4gICAgICAgIGcoYywgYSk7XG4gICAgICAgIHJldHVybiBjO1xuICAgIH0obC5FcnJvcik7XG4gICAgYi5Bc3NlcnRpb25FcnJvciA9IGE7XG4gICAgYi5tZXNzYWdlID0gZDtcbiAgICBiLkUgPSBlO1xuICAgIGIuRXJyb3IgPSBjKGwuRXJyb3IpO1xuICAgIGIuVHlwZUVycm9yID0gYyhsLlR5cGVFcnJvcik7XG4gICAgYi5SYW5nZUVycm9yID0gYyhsLlJhbmdlRXJyb3IpO1xuICAgIGUoXCJFUlJfQVJHX05PVF9JVEVSQUJMRVwiLCBcIiVzIG11c3QgYmUgaXRlcmFibGVcIik7XG4gICAgZShcIkVSUl9BU1NFUlRJT05cIiwgXCIlc1wiKTtcbiAgICBlKFwiRVJSX0JVRkZFUl9PVVRfT0ZfQk9VTkRTXCIsIGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBiID8gXCJBdHRlbXB0IHRvIHdyaXRlIG91dHNpZGUgYnVmZmVyIGJvdW5kc1wiIDogJ1wiJyArIGEgKyAnXCIgaXMgb3V0c2lkZSBvZiBidWZmZXIgYm91bmRzJzsgfSk7XG4gICAgZShcIkVSUl9DSElMRF9DTE9TRURfQkVGT1JFX1JFUExZXCIsIFwiQ2hpbGQgY2xvc2VkIGJlZm9yZSByZXBseSByZWNlaXZlZFwiKTtcbiAgICBlKFwiRVJSX0NPTlNPTEVfV1JJVEFCTEVfU1RSRUFNXCIsIFwiQ29uc29sZSBleHBlY3RzIGEgd3JpdGFibGUgc3RyZWFtIGluc3RhbmNlIGZvciAlc1wiKTtcbiAgICBlKFwiRVJSX0NQVV9VU0FHRVwiLCBcIlVuYWJsZSB0byBvYnRhaW4gY3B1IHVzYWdlICVzXCIpO1xuICAgIGUoXCJFUlJfRE5TX1NFVF9TRVJWRVJTX0ZBSUxFRFwiLCBmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gJ2MtYXJlcyBmYWlsZWQgdG8gc2V0IHNlcnZlcnM6IFwiJyArIGEgKyAnXCIgWycgKyBiICsgXCJdXCI7IH0pO1xuICAgIGUoXCJFUlJfRkFMU1lfVkFMVUVfUkVKRUNUSU9OXCIsIFwiUHJvbWlzZSB3YXMgcmVqZWN0ZWQgd2l0aCBmYWxzeSB2YWx1ZVwiKTtcbiAgICBlKFwiRVJSX0VOQ09ESU5HX05PVF9TVVBQT1JURURcIiwgZnVuY3Rpb24gKGEpIHsgcmV0dXJuICdUaGUgXCInICsgYSArICdcIiBlbmNvZGluZyBpcyBub3Qgc3VwcG9ydGVkJzsgfSk7XG4gICAgZShcIkVSUl9FTkNPRElOR19JTlZBTElEX0VOQ09ERURfREFUQVwiLCBmdW5jdGlvbiAoYSkgeyByZXR1cm4gXCJUaGUgZW5jb2RlZCBkYXRhIHdhcyBub3QgdmFsaWQgZm9yIGVuY29kaW5nIFwiICsgYTsgfSk7XG4gICAgZShcIkVSUl9IVFRQX0hFQURFUlNfU0VOVFwiLCBcIkNhbm5vdCByZW5kZXIgaGVhZGVycyBhZnRlciB0aGV5IGFyZSBzZW50IHRvIHRoZSBjbGllbnRcIik7XG4gICAgZShcIkVSUl9IVFRQX0lOVkFMSURfU1RBVFVTX0NPREVcIiwgXCJJbnZhbGlkIHN0YXR1cyBjb2RlOiAlc1wiKTtcbiAgICBlKFwiRVJSX0hUVFBfVFJBSUxFUl9JTlZBTElEXCIsIFwiVHJhaWxlcnMgYXJlIGludmFsaWQgd2l0aCB0aGlzIHRyYW5zZmVyIGVuY29kaW5nXCIpO1xuICAgIGUoXCJFUlJfSU5ERVhfT1VUX09GX1JBTkdFXCIsIFwiSW5kZXggb3V0IG9mIHJhbmdlXCIpO1xuICAgIGUoXCJFUlJfSU5WQUxJRF9BUkdfVFlQRVwiLCBmdW5jdGlvbiAoYSwgYiwgYykgeyBJKGEsIFwibmFtZSBpcyByZXF1aXJlZFwiKTsgaWYgKGIuaW5jbHVkZXMoXCJub3QgXCIpKSB7XG4gICAgICAgIHZhciBkID0gXCJtdXN0IG5vdCBiZVwiO1xuICAgICAgICBiID0gYi5zcGxpdChcIm5vdCBcIilbMV07XG4gICAgfVxuICAgIGVsc2VcbiAgICAgICAgZCA9IFwibXVzdCBiZVwiOyBpZiAoQXJyYXkuaXNBcnJheShhKSlcbiAgICAgICAgZCA9IFwiVGhlIFwiICsgYS5tYXAoZnVuY3Rpb24gKGEpIHsgcmV0dXJuICdcIicgKyBhICsgJ1wiJzsgfSkuam9pbihcIiwgXCIpICsgXCIgYXJndW1lbnRzIFwiICsgZCArIFwiIFwiICsgZihiLCBcInR5cGVcIik7XG4gICAgZWxzZSBpZiAoYS5pbmNsdWRlcyhcIiBhcmd1bWVudFwiKSlcbiAgICAgICAgZCA9IFwiVGhlIFwiICsgYSArIFwiIFwiICsgZCArIFwiIFwiICsgZihiLCBcInR5cGVcIik7XG4gICAgZWxzZSB7XG4gICAgICAgIHZhciBlID0gYS5pbmNsdWRlcyhcIi5cIikgPyBcInByb3BlcnR5XCIgOiBcImFyZ3VtZW50XCI7XG4gICAgICAgIGQgPSAnVGhlIFwiJyArIGEgKyAnXCIgJyArIGUgKyBcIiBcIiArIGQgKyBcIiBcIiArIGYoYiwgXCJ0eXBlXCIpO1xuICAgIH0gMyA8PSBhcmd1bWVudHMubGVuZ3RoICYmIChkICs9IFwiLiBSZWNlaXZlZCB0eXBlIFwiICsgKG51bGwgIT09IGMgPyB0eXBlb2YgYyA6IFwibnVsbFwiKSk7IHJldHVybiBkOyB9KTtcbiAgICBlKFwiRVJSX0lOVkFMSURfQVJSQVlfTEVOR1RIXCIsIGZ1bmN0aW9uIChhLCBiLCBjKSB7IEkuc3RyaWN0RXF1YWwodHlwZW9mIGMsIFwibnVtYmVyXCIpOyByZXR1cm4gJ1RoZSBhcnJheSBcIicgKyBhICsgJ1wiIChsZW5ndGggJyArIGMgKyBcIikgbXVzdCBiZSBvZiBsZW5ndGggXCIgKyBiICsgXCIuXCI7IH0pO1xuICAgIGUoXCJFUlJfSU5WQUxJRF9CVUZGRVJfU0laRVwiLCBcIkJ1ZmZlciBzaXplIG11c3QgYmUgYSBtdWx0aXBsZSBvZiAlc1wiKTtcbiAgICBlKFwiRVJSX0lOVkFMSURfQ0FMTEJBQ0tcIiwgXCJDYWxsYmFjayBtdXN0IGJlIGEgZnVuY3Rpb25cIik7XG4gICAgZShcIkVSUl9JTlZBTElEX0NIQVJcIiwgXCJJbnZhbGlkIGNoYXJhY3RlciBpbiAlc1wiKTtcbiAgICBlKFwiRVJSX0lOVkFMSURfQ1VSU09SX1BPU1wiLCBcIkNhbm5vdCBzZXQgY3Vyc29yIHJvdyB3aXRob3V0IHNldHRpbmcgaXRzIGNvbHVtblwiKTtcbiAgICBlKFwiRVJSX0lOVkFMSURfRkRcIiwgJ1wiZmRcIiBtdXN0IGJlIGEgcG9zaXRpdmUgaW50ZWdlcjogJXMnKTtcbiAgICBlKFwiRVJSX0lOVkFMSURfRklMRV9VUkxfSE9TVFwiLCAnRmlsZSBVUkwgaG9zdCBtdXN0IGJlIFwibG9jYWxob3N0XCIgb3IgZW1wdHkgb24gJXMnKTtcbiAgICBlKFwiRVJSX0lOVkFMSURfRklMRV9VUkxfUEFUSFwiLCBcIkZpbGUgVVJMIHBhdGggJXNcIik7XG4gICAgZShcIkVSUl9JTlZBTElEX0hBTkRMRV9UWVBFXCIsIFwiVGhpcyBoYW5kbGUgdHlwZSBjYW5ub3QgYmUgc2VudFwiKTtcbiAgICBlKFwiRVJSX0lOVkFMSURfSVBfQUREUkVTU1wiLCBcIkludmFsaWQgSVAgYWRkcmVzczogJXNcIik7XG4gICAgZShcIkVSUl9JTlZBTElEX09QVF9WQUxVRVwiLCBmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gJ1RoZSB2YWx1ZSBcIicgKyBTdHJpbmcoYikgKyAnXCIgaXMgaW52YWxpZCBmb3Igb3B0aW9uIFwiJyArIGEgKyAnXCInOyB9KTtcbiAgICBlKFwiRVJSX0lOVkFMSURfT1BUX1ZBTFVFX0VOQ09ESU5HXCIsIGZ1bmN0aW9uIChhKSB7IHJldHVybiAnVGhlIHZhbHVlIFwiJyArIFN0cmluZyhhKSArICdcIiBpcyBpbnZhbGlkIGZvciBvcHRpb24gXCJlbmNvZGluZ1wiJzsgfSk7XG4gICAgZShcIkVSUl9JTlZBTElEX1JFUExfRVZBTF9DT05GSUdcIiwgJ0Nhbm5vdCBzcGVjaWZ5IGJvdGggXCJicmVha0V2YWxPblNpZ2ludFwiIGFuZCBcImV2YWxcIiBmb3IgUkVQTCcpO1xuICAgIGUoXCJFUlJfSU5WQUxJRF9TWU5DX0ZPUktfSU5QVVRcIiwgXCJBc3luY2hyb25vdXMgZm9ya3MgZG8gbm90IHN1cHBvcnQgQnVmZmVyLCBVaW50OEFycmF5IG9yIHN0cmluZyBpbnB1dDogJXNcIik7XG4gICAgZShcIkVSUl9JTlZBTElEX1RISVNcIiwgJ1ZhbHVlIG9mIFwidGhpc1wiIG11c3QgYmUgb2YgdHlwZSAlcycpO1xuICAgIGUoXCJFUlJfSU5WQUxJRF9UVVBMRVwiLCBcIiVzIG11c3QgYmUgYW4gaXRlcmFibGUgJXMgdHVwbGVcIik7XG4gICAgZShcIkVSUl9JTlZBTElEX1VSTFwiLCBcIkludmFsaWQgVVJMOiAlc1wiKTtcbiAgICBlKFwiRVJSX0lOVkFMSURfVVJMX1NDSEVNRVwiLCBmdW5jdGlvbiAoYSkgeyByZXR1cm4gXCJUaGUgVVJMIG11c3QgYmUgXCIgKyBmKGEsIFwic2NoZW1lXCIpOyB9KTtcbiAgICBlKFwiRVJSX0lQQ19DSEFOTkVMX0NMT1NFRFwiLCBcIkNoYW5uZWwgY2xvc2VkXCIpO1xuICAgIGUoXCJFUlJfSVBDX0RJU0NPTk5FQ1RFRFwiLCBcIklQQyBjaGFubmVsIGlzIGFscmVhZHkgZGlzY29ubmVjdGVkXCIpO1xuICAgIGUoXCJFUlJfSVBDX09ORV9QSVBFXCIsIFwiQ2hpbGQgcHJvY2VzcyBjYW4gaGF2ZSBvbmx5IG9uZSBJUEMgcGlwZVwiKTtcbiAgICBlKFwiRVJSX0lQQ19TWU5DX0ZPUktcIiwgXCJJUEMgY2Fubm90IGJlIHVzZWQgd2l0aCBzeW5jaHJvbm91cyBmb3Jrc1wiKTtcbiAgICBlKFwiRVJSX01JU1NJTkdfQVJHU1wiLCBmdW5jdGlvbiAoKSB7IGZvciAodmFyIGEgPSBbXSwgYiA9IDA7IGIgPCBhcmd1bWVudHMubGVuZ3RoOyBiKyspXG4gICAgICAgIGFbYl0gPSBhcmd1bWVudHNbYl07IEkoMCA8IGEubGVuZ3RoLCBcIkF0IGxlYXN0IG9uZSBhcmcgbmVlZHMgdG8gYmUgc3BlY2lmaWVkXCIpOyBiID0gXCJUaGUgXCI7IHZhciBjID0gYS5sZW5ndGg7IGEgPSBhLm1hcChmdW5jdGlvbiAoYSkgeyByZXR1cm4gJ1wiJyArIGEgKyAnXCInOyB9KTsgc3dpdGNoIChjKSB7XG4gICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgIGIgKz0gYVswXSArIFwiIGFyZ3VtZW50XCI7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgYiArPSBhWzBdICsgXCIgYW5kIFwiICsgYVsxXSArIFwiIGFyZ3VtZW50c1wiO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6IGIgKz0gYS5zbGljZSgwLCBjIC0gMSkuam9pbihcIiwgXCIpLCBiICs9IFwiLCBhbmQgXCIgKyBhW2MgLSAxXSArIFwiIGFyZ3VtZW50c1wiO1xuICAgIH0gcmV0dXJuIGIgKyBcIiBtdXN0IGJlIHNwZWNpZmllZFwiOyB9KTtcbiAgICBlKFwiRVJSX01VTFRJUExFX0NBTExCQUNLXCIsIFwiQ2FsbGJhY2sgY2FsbGVkIG11bHRpcGxlIHRpbWVzXCIpO1xuICAgIGUoXCJFUlJfTkFQSV9DT05TX0ZVTkNUSU9OXCIsIFwiQ29uc3RydWN0b3IgbXVzdCBiZSBhIGZ1bmN0aW9uXCIpO1xuICAgIGUoXCJFUlJfTkFQSV9DT05TX1BST1RPVFlQRV9PQkpFQ1RcIiwgXCJDb25zdHJ1Y3Rvci5wcm90b3R5cGUgbXVzdCBiZSBhbiBvYmplY3RcIik7XG4gICAgZShcIkVSUl9OT19DUllQVE9cIiwgXCJOb2RlLmpzIGlzIG5vdCBjb21waWxlZCB3aXRoIE9wZW5TU0wgY3J5cHRvIHN1cHBvcnRcIik7XG4gICAgZShcIkVSUl9OT19MT05HRVJfU1VQUE9SVEVEXCIsIFwiJXMgaXMgbm8gbG9uZ2VyIHN1cHBvcnRlZFwiKTtcbiAgICBlKFwiRVJSX1BBUlNFX0hJU1RPUllfREFUQVwiLCBcIkNvdWxkIG5vdCBwYXJzZSBoaXN0b3J5IGRhdGEgaW4gJXNcIik7XG4gICAgZShcIkVSUl9TT0NLRVRfQUxSRUFEWV9CT1VORFwiLCBcIlNvY2tldCBpcyBhbHJlYWR5IGJvdW5kXCIpO1xuICAgIGUoXCJFUlJfU09DS0VUX0JBRF9QT1JUXCIsIFwiUG9ydCBzaG91bGQgYmUgPiAwIGFuZCA8IDY1NTM2XCIpO1xuICAgIGUoXCJFUlJfU09DS0VUX0JBRF9UWVBFXCIsIFwiQmFkIHNvY2tldCB0eXBlIHNwZWNpZmllZC4gVmFsaWQgdHlwZXMgYXJlOiB1ZHA0LCB1ZHA2XCIpO1xuICAgIGUoXCJFUlJfU09DS0VUX0NBTk5PVF9TRU5EXCIsIFwiVW5hYmxlIHRvIHNlbmQgZGF0YVwiKTtcbiAgICBlKFwiRVJSX1NPQ0tFVF9DTE9TRURcIiwgXCJTb2NrZXQgaXMgY2xvc2VkXCIpO1xuICAgIGUoXCJFUlJfU09DS0VUX0RHUkFNX05PVF9SVU5OSU5HXCIsIFwiTm90IHJ1bm5pbmdcIik7XG4gICAgZShcIkVSUl9TVERFUlJfQ0xPU0VcIiwgXCJwcm9jZXNzLnN0ZGVyciBjYW5ub3QgYmUgY2xvc2VkXCIpO1xuICAgIGUoXCJFUlJfU1RET1VUX0NMT1NFXCIsIFwicHJvY2Vzcy5zdGRvdXQgY2Fubm90IGJlIGNsb3NlZFwiKTtcbiAgICBlKFwiRVJSX1NUUkVBTV9XUkFQXCIsIFwiU3RyZWFtIGhhcyBTdHJpbmdEZWNvZGVyIHNldCBvciBpcyBpbiBvYmplY3RNb2RlXCIpO1xuICAgIGUoXCJFUlJfVExTX0NFUlRfQUxUTkFNRV9JTlZBTElEXCIsIFwiSG9zdG5hbWUvSVAgZG9lcyBub3QgbWF0Y2ggY2VydGlmaWNhdGUncyBhbHRuYW1lczogJXNcIik7XG4gICAgZShcIkVSUl9UTFNfREhfUEFSQU1fU0laRVwiLCBmdW5jdGlvbiAoYSkgeyByZXR1cm4gXCJESCBwYXJhbWV0ZXIgc2l6ZSBcIiArIGEgKyBcIiBpcyBsZXNzIHRoYW4gMjA0OFwiOyB9KTtcbiAgICBlKFwiRVJSX1RMU19IQU5EU0hBS0VfVElNRU9VVFwiLCBcIlRMUyBoYW5kc2hha2UgdGltZW91dFwiKTtcbiAgICBlKFwiRVJSX1RMU19SRU5FR09USUFUSU9OX0ZBSUxFRFwiLCBcIkZhaWxlZCB0byByZW5lZ290aWF0ZVwiKTtcbiAgICBlKFwiRVJSX1RMU19SRVFVSVJFRF9TRVJWRVJfTkFNRVwiLCAnXCJzZXJ2ZXJuYW1lXCIgaXMgcmVxdWlyZWQgcGFyYW1ldGVyIGZvciBTZXJ2ZXIuYWRkQ29udGV4dCcpO1xuICAgIGUoXCJFUlJfVExTX1NFU1NJT05fQVRUQUNLXCIsIFwiVFNMIHNlc3Npb24gcmVuZWdvdGlhdGlvbiBhdHRhY2sgZGV0ZWN0ZWRcIik7XG4gICAgZShcIkVSUl9UUkFOU0ZPUk1fQUxSRUFEWV9UUkFOU0ZPUk1JTkdcIiwgXCJDYWxsaW5nIHRyYW5zZm9ybSBkb25lIHdoZW4gc3RpbGwgdHJhbnNmb3JtaW5nXCIpO1xuICAgIGUoXCJFUlJfVFJBTlNGT1JNX1dJVEhfTEVOR1RIXzBcIiwgXCJDYWxsaW5nIHRyYW5zZm9ybSBkb25lIHdoZW4gd3JpdGFibGVTdGF0ZS5sZW5ndGggIT0gMFwiKTtcbiAgICBlKFwiRVJSX1VOS05PV05fRU5DT0RJTkdcIiwgXCJVbmtub3duIGVuY29kaW5nOiAlc1wiKTtcbiAgICBlKFwiRVJSX1VOS05PV05fU0lHTkFMXCIsIFwiVW5rbm93biBzaWduYWw6ICVzXCIpO1xuICAgIGUoXCJFUlJfVU5LTk9XTl9TVERJTl9UWVBFXCIsIFwiVW5rbm93biBzdGRpbiBmaWxlIHR5cGVcIik7XG4gICAgZShcIkVSUl9VTktOT1dOX1NUUkVBTV9UWVBFXCIsIFwiVW5rbm93biBzdHJlYW0gZmlsZSB0eXBlXCIpO1xuICAgIGUoXCJFUlJfVjhCUkVBS0lURVJBVE9SXCIsIFwiRnVsbCBJQ1UgZGF0YSBub3QgaW5zdGFsbGVkLiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL25vZGVqcy9ub2RlL3dpa2kvSW50bFwiKTtcbn0pO1xudChQYyk7XG52YXIgSyA9IHUoZnVuY3Rpb24gKGEsIGIpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGIsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiAhMCB9KTsgYi5FTkNPRElOR19VVEY4ID0gXCJ1dGY4XCI7IGIuYXNzZXJ0RW5jb2RpbmcgPSBmdW5jdGlvbiAoYSkgeyBpZiAoYSAmJiAhRi5CdWZmZXIuaXNFbmNvZGluZyhhKSlcbiAgICB0aHJvdyBuZXcgUGMuVHlwZUVycm9yKFwiRVJSX0lOVkFMSURfT1BUX1ZBTFVFX0VOQ09ESU5HXCIsIGEpOyB9OyBiLnN0clRvRW5jb2RpbmcgPSBmdW5jdGlvbiAoYSwgZCkgeyByZXR1cm4gZCAmJiBkICE9PSBiLkVOQ09ESU5HX1VURjggPyBcImJ1ZmZlclwiID09PSBkID8gbmV3IEYuQnVmZmVyKGEpIDogKG5ldyBGLkJ1ZmZlcihhKSkudG9TdHJpbmcoZCkgOiBhOyB9OyB9KTtcbnQoSyk7XG52YXIgUWMgPSB1KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGIsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiAhMCB9KTtcbiAgICB2YXIgYyA9IHcuY29uc3RhbnRzLlNfSUZNVCwgZCA9IHcuY29uc3RhbnRzLlNfSUZESVIsIGUgPSB3LmNvbnN0YW50cy5TX0lGUkVHLCBmID0gdy5jb25zdGFudHMuU19JRkJMSywgZyA9IHcuY29uc3RhbnRzLlNfSUZDSFIsIGggPSB3LmNvbnN0YW50cy5TX0lGTE5LLCBrID0gdy5jb25zdGFudHMuU19JRklGTywgcCA9IHcuY29uc3RhbnRzLlNfSUZTT0NLO1xuICAgIGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIGEoKSB7IHRoaXMubmFtZSA9IFwiXCI7IHRoaXMubW9kZSA9IDA7IH1cbiAgICAgICAgYS5idWlsZCA9IGZ1bmN0aW9uIChiLCBjKSB7IHZhciBkID0gbmV3IGEsIGUgPSBiLmdldE5vZGUoKS5tb2RlOyBkLm5hbWUgPSBLLnN0clRvRW5jb2RpbmcoYi5nZXROYW1lKCksIGMpOyBkLm1vZGUgPSBlOyByZXR1cm4gZDsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuX2NoZWNrTW9kZVByb3BlcnR5ID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuICh0aGlzLm1vZGUgJiBjKSA9PT0gYTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuaXNEaXJlY3RvcnkgPVxuICAgICAgICAgICAgZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5fY2hlY2tNb2RlUHJvcGVydHkoZCk7IH07XG4gICAgICAgIGEucHJvdG90eXBlLmlzRmlsZSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX2NoZWNrTW9kZVByb3BlcnR5KGUpOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5pc0Jsb2NrRGV2aWNlID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5fY2hlY2tNb2RlUHJvcGVydHkoZik7IH07XG4gICAgICAgIGEucHJvdG90eXBlLmlzQ2hhcmFjdGVyRGV2aWNlID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5fY2hlY2tNb2RlUHJvcGVydHkoZyk7IH07XG4gICAgICAgIGEucHJvdG90eXBlLmlzU3ltYm9saWNMaW5rID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5fY2hlY2tNb2RlUHJvcGVydHkoaCk7IH07XG4gICAgICAgIGEucHJvdG90eXBlLmlzRklGTyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX2NoZWNrTW9kZVByb3BlcnR5KGspOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5pc1NvY2tldCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX2NoZWNrTW9kZVByb3BlcnR5KHApOyB9O1xuICAgICAgICByZXR1cm4gYTtcbiAgICB9KCk7XG4gICAgYi5EaXJlbnQgPSBhO1xuICAgIGIuZGVmYXVsdCA9IGE7XG59KTtcbnQoUWMpO1xuZnVuY3Rpb24gUmMoYSwgYikgeyBmb3IgKHZhciBjID0gMCwgZCA9IGEubGVuZ3RoIC0gMTsgMCA8PSBkOyBkLS0pIHtcbiAgICB2YXIgZSA9IGFbZF07XG4gICAgXCIuXCIgPT09IGUgPyBhLnNwbGljZShkLCAxKSA6IFwiLi5cIiA9PT0gZSA/IChhLnNwbGljZShkLCAxKSwgYysrKSA6IGMgJiYgKGEuc3BsaWNlKGQsIDEpLCBjLS0pO1xufSBpZiAoYilcbiAgICBmb3IgKDsgYy0tOyBjKVxuICAgICAgICBhLnVuc2hpZnQoXCIuLlwiKTsgcmV0dXJuIGE7IH1cbnZhciBTYyA9IC9eKFxcLz98KShbXFxzXFxTXSo/KSgoPzpcXC57MSwyfXxbXlxcL10rP3wpKFxcLlteLlxcL10qfCkpKD86W1xcL10qKSQvO1xuZnVuY3Rpb24gVGMoKSB7IGZvciAodmFyIGEgPSBcIlwiLCBiID0gITEsIGMgPSBhcmd1bWVudHMubGVuZ3RoIC0gMTsgLTEgPD0gYyAmJiAhYjsgYy0tKSB7XG4gICAgdmFyIGQgPSAwIDw9IGMgPyBhcmd1bWVudHNbY10gOiBcIi9cIjtcbiAgICBpZiAoXCJzdHJpbmdcIiAhPT0gdHlwZW9mIGQpXG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJBcmd1bWVudHMgdG8gcGF0aC5yZXNvbHZlIG11c3QgYmUgc3RyaW5nc1wiKTtcbiAgICBkICYmIChhID0gZCArIFwiL1wiICsgYSwgYiA9IFwiL1wiID09PSBkLmNoYXJBdCgwKSk7XG59IGEgPSBSYyhVYyhhLnNwbGl0KFwiL1wiKSwgZnVuY3Rpb24gKGEpIHsgcmV0dXJuICEhYTsgfSksICFiKS5qb2luKFwiL1wiKTsgcmV0dXJuIChiID8gXCIvXCIgOiBcIlwiKSArIGEgfHwgXCIuXCI7IH1cbmZ1bmN0aW9uIFZjKGEpIHsgdmFyIGIgPSBXYyhhKSwgYyA9IFwiL1wiID09PSBYYyhhLCAtMSk7IChhID0gUmMoVWMoYS5zcGxpdChcIi9cIiksIGZ1bmN0aW9uIChhKSB7IHJldHVybiAhIWE7IH0pLCAhYikuam9pbihcIi9cIikpIHx8IGIgfHwgKGEgPSBcIi5cIik7IGEgJiYgYyAmJiAoYSArPSBcIi9cIik7IHJldHVybiAoYiA/IFwiL1wiIDogXCJcIikgKyBhOyB9XG5mdW5jdGlvbiBXYyhhKSB7IHJldHVybiBcIi9cIiA9PT0gYS5jaGFyQXQoMCk7IH1cbmZ1bmN0aW9uIFljKGEsIGIpIHsgZnVuY3Rpb24gYyhhKSB7IGZvciAodmFyIGIgPSAwOyBiIDwgYS5sZW5ndGggJiYgXCJcIiA9PT0gYVtiXTsgYisrKVxuICAgIDsgZm9yICh2YXIgYyA9IGEubGVuZ3RoIC0gMTsgMCA8PSBjICYmIFwiXCIgPT09IGFbY107IGMtLSlcbiAgICA7IHJldHVybiBiID4gYyA/IFtdIDogYS5zbGljZShiLCBjIC0gYiArIDEpOyB9IGEgPSBUYyhhKS5zdWJzdHIoMSk7IGIgPSBUYyhiKS5zdWJzdHIoMSk7IGEgPSBjKGEuc3BsaXQoXCIvXCIpKTsgYiA9IGMoYi5zcGxpdChcIi9cIikpOyBmb3IgKHZhciBkID0gTWF0aC5taW4oYS5sZW5ndGgsIGIubGVuZ3RoKSwgZSA9IGQsIGYgPSAwOyBmIDwgZDsgZisrKVxuICAgIGlmIChhW2ZdICE9PSBiW2ZdKSB7XG4gICAgICAgIGUgPSBmO1xuICAgICAgICBicmVhaztcbiAgICB9IGQgPSBbXTsgZm9yIChmID0gZTsgZiA8IGEubGVuZ3RoOyBmKyspXG4gICAgZC5wdXNoKFwiLi5cIik7IGQgPSBkLmNvbmNhdChiLnNsaWNlKGUpKTsgcmV0dXJuIGQuam9pbihcIi9cIik7IH1cbnZhciBaYyA9IHsgZXh0bmFtZTogZnVuY3Rpb24gKGEpIHsgcmV0dXJuIFNjLmV4ZWMoYSkuc2xpY2UoMSlbM107IH0sIGJhc2VuYW1lOiBmdW5jdGlvbiAoYSwgYikgeyBhID0gU2MuZXhlYyhhKS5zbGljZSgxKVsyXTsgYiAmJiBhLnN1YnN0cigtMSAqIGIubGVuZ3RoKSA9PT0gYiAmJiAoYSA9IGEuc3Vic3RyKDAsIGEubGVuZ3RoIC0gYi5sZW5ndGgpKTsgcmV0dXJuIGE7IH0sIGRpcm5hbWU6IGZ1bmN0aW9uIChhKSB7IHZhciBiID0gU2MuZXhlYyhhKS5zbGljZSgxKTsgYSA9IGJbMF07IGIgPSBiWzFdOyBpZiAoIWEgJiYgIWIpXG4gICAgICAgIHJldHVybiBcIi5cIjsgYiAmJiAoYiA9IGIuc3Vic3RyKDAsIGIubGVuZ3RoIC0gMSkpOyByZXR1cm4gYSArIGI7IH0sIHNlcDogXCIvXCIsIGRlbGltaXRlcjogXCI6XCIsIHJlbGF0aXZlOiBZYywgam9pbjogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYSA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMCk7XG4gICAgICAgIHJldHVybiBWYyhVYyhhLCBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgaWYgKFwic3RyaW5nXCIgIT09IHR5cGVvZiBhKVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJBcmd1bWVudHMgdG8gcGF0aC5qb2luIG11c3QgYmUgc3RyaW5nc1wiKTtcbiAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICB9KS5qb2luKFwiL1wiKSk7XG4gICAgfSwgaXNBYnNvbHV0ZTogV2MsIG5vcm1hbGl6ZTogVmMsIHJlc29sdmU6IFRjIH07XG5mdW5jdGlvbiBVYyhhLCBiKSB7IGlmIChhLmZpbHRlcilcbiAgICByZXR1cm4gYS5maWx0ZXIoYik7IGZvciAodmFyIGMgPSBbXSwgZCA9IDA7IGQgPCBhLmxlbmd0aDsgZCsrKVxuICAgIGIoYVtkXSwgZCwgYSkgJiYgYy5wdXNoKGFbZF0pOyByZXR1cm4gYzsgfVxudmFyIFhjID0gIHRydWUgPyBmdW5jdGlvbiAoYSwgYiwgYykgeyByZXR1cm4gYS5zdWJzdHIoYiwgYyk7IH0gOiAwLCAkYyA9IHUoZnVuY3Rpb24gKGEsIGIpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGIsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiAhMCB9KTsgYSA9IFwiZnVuY3Rpb25cIiA9PT0gdHlwZW9mIHNldEltbWVkaWF0ZSA/IHNldEltbWVkaWF0ZS5iaW5kKGwpIDogc2V0VGltZW91dC5iaW5kKGwpOyBiLmRlZmF1bHQgPSBhOyB9KTtcbnQoJGMpO1xudmFyIEwgPSB1KGZ1bmN0aW9uIChhLCBiKSB7IGZ1bmN0aW9uIGMoKSB7IHZhciBhID0gQ2IgfHwge307IGEuZ2V0dWlkIHx8IChhLmdldHVpZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIDA7IH0pOyBhLmdldGdpZCB8fCAoYS5nZXRnaWQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAwOyB9KTsgYS5jd2QgfHwgKGEuY3dkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gXCIvXCI7IH0pOyBhLm5leHRUaWNrIHx8IChhLm5leHRUaWNrID0gJGMuZGVmYXVsdCk7IGEuZW1pdFdhcm5pbmcgfHwgKGEuZW1pdFdhcm5pbmcgPSBmdW5jdGlvbiAoYSwgYikgeyBjb25zb2xlLndhcm4oXCJcIiArIGIgKyAoYiA/IFwiOiBcIiA6IFwiXCIpICsgYSk7IH0pOyBhLmVudiB8fCAoYS5lbnYgPSB7fSk7IHJldHVybiBhOyB9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShiLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogITAgfSk7IGIuY3JlYXRlUHJvY2VzcyA9IGM7IGIuZGVmYXVsdCA9IGMoKTsgfSk7XG50KEwpO1xuZnVuY3Rpb24gYWQoKSB7IH1cbmFkLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG5mdW5jdGlvbiBPKCkgeyBPLmluaXQuY2FsbCh0aGlzKTsgfVxuTy5FdmVudEVtaXR0ZXIgPSBPO1xuTy51c2luZ0RvbWFpbnMgPSAhMTtcbk8ucHJvdG90eXBlLmRvbWFpbiA9IHZvaWQgMDtcbk8ucHJvdG90eXBlLl9ldmVudHMgPSB2b2lkIDA7XG5PLnByb3RvdHlwZS5fbWF4TGlzdGVuZXJzID0gdm9pZCAwO1xuTy5kZWZhdWx0TWF4TGlzdGVuZXJzID0gMTA7XG5PLmluaXQgPSBmdW5jdGlvbiAoKSB7IHRoaXMuZG9tYWluID0gbnVsbDsgdGhpcy5fZXZlbnRzICYmIHRoaXMuX2V2ZW50cyAhPT0gT2JqZWN0LmdldFByb3RvdHlwZU9mKHRoaXMpLl9ldmVudHMgfHwgKHRoaXMuX2V2ZW50cyA9IG5ldyBhZCwgdGhpcy5fZXZlbnRzQ291bnQgPSAwKTsgdGhpcy5fbWF4TGlzdGVuZXJzID0gdGhpcy5fbWF4TGlzdGVuZXJzIHx8IHZvaWQgMDsgfTtcbk8ucHJvdG90eXBlLnNldE1heExpc3RlbmVycyA9IGZ1bmN0aW9uIChhKSB7IGlmIChcIm51bWJlclwiICE9PSB0eXBlb2YgYSB8fCAwID4gYSB8fCBpc05hTihhKSlcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdcIm5cIiBhcmd1bWVudCBtdXN0IGJlIGEgcG9zaXRpdmUgbnVtYmVyJyk7IHRoaXMuX21heExpc3RlbmVycyA9IGE7IHJldHVybiB0aGlzOyB9O1xuTy5wcm90b3R5cGUuZ2V0TWF4TGlzdGVuZXJzID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdm9pZCAwID09PSB0aGlzLl9tYXhMaXN0ZW5lcnMgPyBPLmRlZmF1bHRNYXhMaXN0ZW5lcnMgOiB0aGlzLl9tYXhMaXN0ZW5lcnM7IH07XG5PLnByb3RvdHlwZS5lbWl0ID0gZnVuY3Rpb24gKGEpIHtcbiAgICB2YXIgYiwgYztcbiAgICB2YXIgZCA9IFwiZXJyb3JcIiA9PT0gYTtcbiAgICBpZiAoYiA9IHRoaXMuX2V2ZW50cylcbiAgICAgICAgZCA9IGQgJiYgbnVsbCA9PSBiLmVycm9yO1xuICAgIGVsc2UgaWYgKCFkKVxuICAgICAgICByZXR1cm4gITE7XG4gICAgdmFyIGUgPSB0aGlzLmRvbWFpbjtcbiAgICBpZiAoZCkge1xuICAgICAgICBiID0gYXJndW1lbnRzWzFdO1xuICAgICAgICBpZiAoZSlcbiAgICAgICAgICAgIGIgfHwgKGIgPSBFcnJvcignVW5jYXVnaHQsIHVuc3BlY2lmaWVkIFwiZXJyb3JcIiBldmVudCcpKSwgYi5kb21haW5FbWl0dGVyID0gdGhpcywgYi5kb21haW4gPSBlLCBiLmRvbWFpblRocm93biA9ICExLCBlLmVtaXQoXCJlcnJvclwiLCBiKTtcbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoYiBpbnN0YW5jZW9mIEVycm9yKVxuICAgICAgICAgICAgICAgIHRocm93IGI7XG4gICAgICAgICAgICBlID0gRXJyb3IoJ1VuY2F1Z2h0LCB1bnNwZWNpZmllZCBcImVycm9yXCIgZXZlbnQuICgnICsgYiArIFwiKVwiKTtcbiAgICAgICAgICAgIGUuY29udGV4dCA9IGI7XG4gICAgICAgICAgICB0aHJvdyBlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAhMTtcbiAgICB9XG4gICAgZSA9IGJbYV07XG4gICAgaWYgKCFlKVxuICAgICAgICByZXR1cm4gITE7XG4gICAgYiA9IFwiZnVuY3Rpb25cIiA9PT0gdHlwZW9mIGU7XG4gICAgdmFyIGYgPSBhcmd1bWVudHMubGVuZ3RoO1xuICAgIHN3aXRjaCAoZikge1xuICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICBpZiAoYilcbiAgICAgICAgICAgICAgICBlLmNhbGwodGhpcyk7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgZm9yIChiID0gZS5sZW5ndGgsIGUgPSBiZChlLCBiKSwgZCA9IDA7IGQgPCBiOyArK2QpXG4gICAgICAgICAgICAgICAgICAgIGVbZF0uY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICBkID0gYXJndW1lbnRzWzFdO1xuICAgICAgICAgICAgaWYgKGIpXG4gICAgICAgICAgICAgICAgZS5jYWxsKHRoaXMsIGQpO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIGZvciAoYiA9IGUubGVuZ3RoLCBlID0gYmQoZSwgYiksIGYgPSAwOyBmIDwgYjsgKytmKVxuICAgICAgICAgICAgICAgICAgICBlW2ZdLmNhbGwodGhpcywgZCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgZCA9IGFyZ3VtZW50c1sxXTtcbiAgICAgICAgICAgIGYgPSBhcmd1bWVudHNbMl07XG4gICAgICAgICAgICBpZiAoYilcbiAgICAgICAgICAgICAgICBlLmNhbGwodGhpcywgZCwgZik7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgZm9yIChiID0gZS5sZW5ndGgsIGUgPSBiZChlLCBiKSwgYyA9IDA7IGMgPCBiOyArK2MpXG4gICAgICAgICAgICAgICAgICAgIGVbY10uY2FsbCh0aGlzLCBkLCBmKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICBkID0gYXJndW1lbnRzWzFdO1xuICAgICAgICAgICAgZiA9IGFyZ3VtZW50c1syXTtcbiAgICAgICAgICAgIGMgPSBhcmd1bWVudHNbM107XG4gICAgICAgICAgICBpZiAoYilcbiAgICAgICAgICAgICAgICBlLmNhbGwodGhpcywgZCwgZiwgYyk7XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBiID0gZS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgZSA9IGJkKGUsIGIpO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGcgPSAwOyBnIDwgYjsgKytnKVxuICAgICAgICAgICAgICAgICAgICBlW2ddLmNhbGwodGhpcywgZCwgZiwgYyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIGQgPSBBcnJheShmIC0gMSk7XG4gICAgICAgICAgICBmb3IgKGMgPSAxOyBjIDwgZjsgYysrKVxuICAgICAgICAgICAgICAgIGRbYyAtIDFdID0gYXJndW1lbnRzW2NdO1xuICAgICAgICAgICAgaWYgKGIpXG4gICAgICAgICAgICAgICAgZS5hcHBseSh0aGlzLCBkKTtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBmb3IgKGIgPSBlLmxlbmd0aCwgZSA9IGJkKGUsIGIpLCBmID0gMDsgZiA8IGI7ICsrZilcbiAgICAgICAgICAgICAgICAgICAgZVtmXS5hcHBseSh0aGlzLCBkKTtcbiAgICB9XG4gICAgcmV0dXJuICEwO1xufTtcbmZ1bmN0aW9uIGNkKGEsIGIsIGMsIGQpIHtcbiAgICB2YXIgZTtcbiAgICBpZiAoXCJmdW5jdGlvblwiICE9PSB0eXBlb2YgYylcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignXCJsaXN0ZW5lclwiIGFyZ3VtZW50IG11c3QgYmUgYSBmdW5jdGlvbicpO1xuICAgIGlmIChlID0gYS5fZXZlbnRzKSB7XG4gICAgICAgIGUubmV3TGlzdGVuZXIgJiYgKGEuZW1pdChcIm5ld0xpc3RlbmVyXCIsIGIsIGMubGlzdGVuZXIgPyBjLmxpc3RlbmVyIDogYyksIGUgPSBhLl9ldmVudHMpO1xuICAgICAgICB2YXIgZiA9IGVbYl07XG4gICAgfVxuICAgIGVsc2VcbiAgICAgICAgZSA9IGEuX2V2ZW50cyA9IG5ldyBhZCwgYS5fZXZlbnRzQ291bnQgPSAwO1xuICAgIGYgPyAoXCJmdW5jdGlvblwiID09PSB0eXBlb2YgZiA/IGYgPSBlW2JdID0gZCA/IFtjLCBmXSA6IFtmLCBjXSA6IGQgPyBmLnVuc2hpZnQoYykgOiBmLnB1c2goYyksIGYud2FybmVkIHx8IChjID0gdm9pZCAwID09PSBhLl9tYXhMaXN0ZW5lcnMgPyBPLmRlZmF1bHRNYXhMaXN0ZW5lcnMgOiBhLl9tYXhMaXN0ZW5lcnMpICYmIDAgPCBjICYmIGYubGVuZ3RoID4gYyAmJiAoZi53YXJuZWQgPSAhMCwgYyA9IEVycm9yKFwiUG9zc2libGUgRXZlbnRFbWl0dGVyIG1lbW9yeSBsZWFrIGRldGVjdGVkLiBcIiArIGYubGVuZ3RoICtcbiAgICAgICAgXCIgXCIgKyBiICsgXCIgbGlzdGVuZXJzIGFkZGVkLiBVc2UgZW1pdHRlci5zZXRNYXhMaXN0ZW5lcnMoKSB0byBpbmNyZWFzZSBsaW1pdFwiKSwgYy5uYW1lID0gXCJNYXhMaXN0ZW5lcnNFeGNlZWRlZFdhcm5pbmdcIiwgYy5lbWl0dGVyID0gYSwgYy50eXBlID0gYiwgYy5jb3VudCA9IGYubGVuZ3RoLCBcImZ1bmN0aW9uXCIgPT09IHR5cGVvZiBjb25zb2xlLndhcm4gPyBjb25zb2xlLndhcm4oYykgOiBjb25zb2xlLmxvZyhjKSkpIDogKGVbYl0gPSBjLCArK2EuX2V2ZW50c0NvdW50KTtcbiAgICByZXR1cm4gYTtcbn1cbk8ucHJvdG90eXBlLmFkZExpc3RlbmVyID0gZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGNkKHRoaXMsIGEsIGIsICExKTsgfTtcbk8ucHJvdG90eXBlLm9uID0gTy5wcm90b3R5cGUuYWRkTGlzdGVuZXI7XG5PLnByb3RvdHlwZS5wcmVwZW5kTGlzdGVuZXIgPSBmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gY2QodGhpcywgYSwgYiwgITApOyB9O1xuZnVuY3Rpb24gZGQoYSwgYiwgYykgeyBmdW5jdGlvbiBkKCkgeyBhLnJlbW92ZUxpc3RlbmVyKGIsIGQpOyBlIHx8IChlID0gITAsIGMuYXBwbHkoYSwgYXJndW1lbnRzKSk7IH0gdmFyIGUgPSAhMTsgZC5saXN0ZW5lciA9IGM7IHJldHVybiBkOyB9XG5PLnByb3RvdHlwZS5vbmNlID0gZnVuY3Rpb24gKGEsIGIpIHsgaWYgKFwiZnVuY3Rpb25cIiAhPT0gdHlwZW9mIGIpXG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignXCJsaXN0ZW5lclwiIGFyZ3VtZW50IG11c3QgYmUgYSBmdW5jdGlvbicpOyB0aGlzLm9uKGEsIGRkKHRoaXMsIGEsIGIpKTsgcmV0dXJuIHRoaXM7IH07XG5PLnByb3RvdHlwZS5wcmVwZW5kT25jZUxpc3RlbmVyID0gZnVuY3Rpb24gKGEsIGIpIHsgaWYgKFwiZnVuY3Rpb25cIiAhPT0gdHlwZW9mIGIpXG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignXCJsaXN0ZW5lclwiIGFyZ3VtZW50IG11c3QgYmUgYSBmdW5jdGlvbicpOyB0aGlzLnByZXBlbmRMaXN0ZW5lcihhLCBkZCh0aGlzLCBhLCBiKSk7IHJldHVybiB0aGlzOyB9O1xuTy5wcm90b3R5cGUucmVtb3ZlTGlzdGVuZXIgPSBmdW5jdGlvbiAoYSwgYikge1xuICAgIHZhciBjO1xuICAgIGlmIChcImZ1bmN0aW9uXCIgIT09IHR5cGVvZiBiKVxuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdcImxpc3RlbmVyXCIgYXJndW1lbnQgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XG4gICAgdmFyIGQgPSB0aGlzLl9ldmVudHM7XG4gICAgaWYgKCFkKVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB2YXIgZSA9IGRbYV07XG4gICAgaWYgKCFlKVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICBpZiAoZSA9PT0gYiB8fCBlLmxpc3RlbmVyICYmIGUubGlzdGVuZXIgPT09IGIpXG4gICAgICAgIDAgPT09IC0tdGhpcy5fZXZlbnRzQ291bnQgPyB0aGlzLl9ldmVudHMgPSBuZXcgYWQgOiAoZGVsZXRlIGRbYV0sIGQucmVtb3ZlTGlzdGVuZXIgJiYgdGhpcy5lbWl0KFwicmVtb3ZlTGlzdGVuZXJcIiwgYSwgZS5saXN0ZW5lciB8fCBiKSk7XG4gICAgZWxzZSBpZiAoXCJmdW5jdGlvblwiICE9PSB0eXBlb2YgZSkge1xuICAgICAgICB2YXIgZiA9IC0xO1xuICAgICAgICBmb3IgKGMgPSBlLmxlbmd0aDsgMCA8IGMtLTspXG4gICAgICAgICAgICBpZiAoZVtjXSA9PT0gYiB8fCBlW2NdLmxpc3RlbmVyICYmIGVbY10ubGlzdGVuZXIgPT09IGIpIHtcbiAgICAgICAgICAgICAgICB2YXIgZyA9IGVbY10ubGlzdGVuZXI7XG4gICAgICAgICAgICAgICAgZiA9IGM7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIGlmICgwID5cbiAgICAgICAgICAgIGYpXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgaWYgKDEgPT09IGUubGVuZ3RoKSB7XG4gICAgICAgICAgICBlWzBdID0gdm9pZCAwO1xuICAgICAgICAgICAgaWYgKDAgPT09IC0tdGhpcy5fZXZlbnRzQ291bnQpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2V2ZW50cyA9IG5ldyBhZCwgdGhpcztcbiAgICAgICAgICAgIGRlbGV0ZSBkW2FdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgYyA9IGYgKyAxO1xuICAgICAgICAgICAgZm9yICh2YXIgaCA9IGUubGVuZ3RoOyBjIDwgaDsgZiArPSAxLCBjICs9IDEpXG4gICAgICAgICAgICAgICAgZVtmXSA9IGVbY107XG4gICAgICAgICAgICBlLnBvcCgpO1xuICAgICAgICB9XG4gICAgICAgIGQucmVtb3ZlTGlzdGVuZXIgJiYgdGhpcy5lbWl0KFwicmVtb3ZlTGlzdGVuZXJcIiwgYSwgZyB8fCBiKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuTy5wcm90b3R5cGUucmVtb3ZlQWxsTGlzdGVuZXJzID0gZnVuY3Rpb24gKGEpIHtcbiAgICB2YXIgYiA9IHRoaXMuX2V2ZW50cztcbiAgICBpZiAoIWIpXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIGlmICghYi5yZW1vdmVMaXN0ZW5lcilcbiAgICAgICAgcmV0dXJuIDAgPT09IGFyZ3VtZW50cy5sZW5ndGggPyAodGhpcy5fZXZlbnRzID0gbmV3IGFkLCB0aGlzLl9ldmVudHNDb3VudCA9IDApIDogYlthXSAmJiAoMCA9PT0gLS10aGlzLl9ldmVudHNDb3VudCA/IHRoaXMuX2V2ZW50cyA9IG5ldyBhZCA6IGRlbGV0ZSBiW2FdKSwgdGhpcztcbiAgICBpZiAoMCA9PT0gYXJndW1lbnRzLmxlbmd0aCkge1xuICAgICAgICBiID0gT2JqZWN0LmtleXMoYik7XG4gICAgICAgIGZvciAodmFyIGMgPSAwLCBkOyBjIDwgYi5sZW5ndGg7ICsrYylcbiAgICAgICAgICAgIGQgPSBiW2NdLCBcInJlbW92ZUxpc3RlbmVyXCIgIT09IGQgJiYgdGhpcy5yZW1vdmVBbGxMaXN0ZW5lcnMoZCk7XG4gICAgICAgIHRoaXMucmVtb3ZlQWxsTGlzdGVuZXJzKFwicmVtb3ZlTGlzdGVuZXJcIik7XG4gICAgICAgIHRoaXMuX2V2ZW50cyA9IG5ldyBhZDtcbiAgICAgICAgdGhpcy5fZXZlbnRzQ291bnQgPSAwO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgYiA9IGJbYV07XG4gICAgaWYgKFwiZnVuY3Rpb25cIiA9PT0gdHlwZW9mIGIpXG4gICAgICAgIHRoaXMucmVtb3ZlTGlzdGVuZXIoYSwgYik7XG4gICAgZWxzZSBpZiAoYikge1xuICAgICAgICBkb1xuICAgICAgICAgICAgdGhpcy5yZW1vdmVMaXN0ZW5lcihhLCBiW2IubGVuZ3RoIC0gMV0pO1xuICAgICAgICB3aGlsZSAoYlswXSk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xufTtcbk8ucHJvdG90eXBlLmxpc3RlbmVycyA9IGZ1bmN0aW9uIChhKSB7IHZhciBiID0gdGhpcy5fZXZlbnRzOyBpZiAoYilcbiAgICBpZiAoYSA9IGJbYV0pXG4gICAgICAgIGlmIChcImZ1bmN0aW9uXCIgPT09IHR5cGVvZiBhKVxuICAgICAgICAgICAgYSA9IFthLmxpc3RlbmVyIHx8IGFdO1xuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGIgPSBBcnJheShhLmxlbmd0aCk7XG4gICAgICAgICAgICBmb3IgKHZhciBjID0gMDsgYyA8IGIubGVuZ3RoOyArK2MpXG4gICAgICAgICAgICAgICAgYltjXSA9IGFbY10ubGlzdGVuZXIgfHwgYVtjXTtcbiAgICAgICAgICAgIGEgPSBiO1xuICAgICAgICB9XG4gICAgZWxzZVxuICAgICAgICBhID0gW107XG5lbHNlXG4gICAgYSA9IFtdOyByZXR1cm4gYTsgfTtcbk8ubGlzdGVuZXJDb3VudCA9IGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBcImZ1bmN0aW9uXCIgPT09IHR5cGVvZiBhLmxpc3RlbmVyQ291bnQgPyBhLmxpc3RlbmVyQ291bnQoYikgOiBlZC5jYWxsKGEsIGIpOyB9O1xuTy5wcm90b3R5cGUubGlzdGVuZXJDb3VudCA9IGVkO1xuZnVuY3Rpb24gZWQoYSkgeyB2YXIgYiA9IHRoaXMuX2V2ZW50czsgaWYgKGIpIHtcbiAgICBhID0gYlthXTtcbiAgICBpZiAoXCJmdW5jdGlvblwiID09PSB0eXBlb2YgYSlcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgaWYgKGEpXG4gICAgICAgIHJldHVybiBhLmxlbmd0aDtcbn0gcmV0dXJuIDA7IH1cbk8ucHJvdG90eXBlLmV2ZW50TmFtZXMgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAwIDwgdGhpcy5fZXZlbnRzQ291bnQgPyBSZWZsZWN0Lm93bktleXModGhpcy5fZXZlbnRzKSA6IFtdOyB9O1xuZnVuY3Rpb24gYmQoYSwgYikgeyBmb3IgKHZhciBjID0gQXJyYXkoYik7IGItLTspXG4gICAgY1tiXSA9IGFbYl07IHJldHVybiBjOyB9XG52YXIgZmQgPSB1KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgdmFyIGMgPSBsICYmIGwuX19leHRlbmRzIHx8IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gYShiLCBjKSB7IGEgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoYSwgYikgeyBhLl9fcHJvdG9fXyA9IGI7IH0gfHwgZnVuY3Rpb24gKGEsIGIpIHsgZm9yICh2YXIgYyBpbiBiKVxuICAgICAgICBiLmhhc093blByb3BlcnR5KGMpICYmIChhW2NdID0gYltjXSk7IH07IHJldHVybiBhKGIsIGMpOyB9IHJldHVybiBmdW5jdGlvbiAoYiwgYykgeyBmdW5jdGlvbiBkKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gYjsgfSBhKGIsIGMpOyBiLnByb3RvdHlwZSA9IG51bGwgPT09IGMgPyBPYmplY3QuY3JlYXRlKGMpIDogKGQucHJvdG90eXBlID0gYy5wcm90b3R5cGUsIG5ldyBkKTsgfTsgfSgpO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShiLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogITAgfSk7XG4gICAgdmFyIGQgPSB3LmNvbnN0YW50cy5TX0lGTVQsIGUgPSB3LmNvbnN0YW50cy5TX0lGRElSLCBmID0gdy5jb25zdGFudHMuU19JRlJFRywgZyA9IHcuY29uc3RhbnRzLlNfSUZMTkssIGggPSB3LmNvbnN0YW50cy5PX0FQUEVORDtcbiAgICBiLlNFUCA9IFwiL1wiO1xuICAgIGEgPSBmdW5jdGlvbiAoYSkge1xuICAgICAgICBmdW5jdGlvbiBiKGIsIGMpIHsgdm9pZCAwID09PSBjICYmIChjID0gNDM4KTsgdmFyIGQgPSBhLmNhbGwodGhpcykgfHwgdGhpczsgZC51aWQgPSBMLmRlZmF1bHQuZ2V0dWlkKCk7IGQuZ2lkID0gTC5kZWZhdWx0LmdldGdpZCgpOyBkLmF0aW1lID0gbmV3IERhdGU7IGQubXRpbWUgPSBuZXcgRGF0ZTsgZC5jdGltZSA9IG5ldyBEYXRlOyBkLnBlcm0gPSA0Mzg7IGQubW9kZSA9IGY7IGQubmxpbmsgPSAxOyBkLnBlcm0gPSBjOyBkLm1vZGUgfD0gYzsgZC5pbm8gPSBiOyByZXR1cm4gZDsgfVxuICAgICAgICBjKGIsIGEpO1xuICAgICAgICBiLnByb3RvdHlwZS5nZXRTdHJpbmcgPSBmdW5jdGlvbiAoYSkgeyB2b2lkIDAgPT09IGEgJiYgKGEgPSBcInV0ZjhcIik7IHJldHVybiB0aGlzLmdldEJ1ZmZlcigpLnRvU3RyaW5nKGEpOyB9O1xuICAgICAgICBiLnByb3RvdHlwZS5zZXRTdHJpbmcgPSBmdW5jdGlvbiAoYSkgeyB0aGlzLmJ1ZiA9IEYuYnVmZmVyRnJvbShhLCBcInV0ZjhcIik7IHRoaXMudG91Y2goKTsgfTtcbiAgICAgICAgYi5wcm90b3R5cGUuZ2V0QnVmZmVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5idWYgfHwgdGhpcy5zZXRCdWZmZXIoRi5idWZmZXJBbGxvY1Vuc2FmZSgwKSk7XG4gICAgICAgICAgICByZXR1cm4gRi5idWZmZXJGcm9tKHRoaXMuYnVmKTtcbiAgICAgICAgfTtcbiAgICAgICAgYi5wcm90b3R5cGUuc2V0QnVmZmVyID0gZnVuY3Rpb24gKGEpIHsgdGhpcy5idWYgPSBGLmJ1ZmZlckZyb20oYSk7IHRoaXMudG91Y2goKTsgfTtcbiAgICAgICAgYi5wcm90b3R5cGUuZ2V0U2l6ZSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuYnVmID8gdGhpcy5idWYubGVuZ3RoIDogMDsgfTtcbiAgICAgICAgYi5wcm90b3R5cGUuc2V0TW9kZVByb3BlcnR5ID0gZnVuY3Rpb24gKGEpIHsgdGhpcy5tb2RlID0gdGhpcy5tb2RlICYgfmQgfCBhOyB9O1xuICAgICAgICBiLnByb3RvdHlwZS5zZXRJc0ZpbGUgPSBmdW5jdGlvbiAoKSB7IHRoaXMuc2V0TW9kZVByb3BlcnR5KGYpOyB9O1xuICAgICAgICBiLnByb3RvdHlwZS5zZXRJc0RpcmVjdG9yeSA9IGZ1bmN0aW9uICgpIHsgdGhpcy5zZXRNb2RlUHJvcGVydHkoZSk7IH07XG4gICAgICAgIGIucHJvdG90eXBlLnNldElzU3ltbGluayA9IGZ1bmN0aW9uICgpIHsgdGhpcy5zZXRNb2RlUHJvcGVydHkoZyk7IH07XG4gICAgICAgIGIucHJvdG90eXBlLmlzRmlsZSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICh0aGlzLm1vZGUgJiBkKSA9PT0gZjsgfTtcbiAgICAgICAgYi5wcm90b3R5cGUuaXNEaXJlY3RvcnkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gKHRoaXMubW9kZSAmXG4gICAgICAgICAgICAgICAgZCkgPT09IGU7XG4gICAgICAgIH07XG4gICAgICAgIGIucHJvdG90eXBlLmlzU3ltbGluayA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICh0aGlzLm1vZGUgJiBkKSA9PT0gZzsgfTtcbiAgICAgICAgYi5wcm90b3R5cGUubWFrZVN5bWxpbmsgPSBmdW5jdGlvbiAoYSkgeyB0aGlzLnN5bWxpbmsgPSBhOyB0aGlzLnNldElzU3ltbGluaygpOyB9O1xuICAgICAgICBiLnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uIChhLCBiLCBjLCBkKSB7IHZvaWQgMCA9PT0gYiAmJiAoYiA9IDApOyB2b2lkIDAgPT09IGMgJiYgKGMgPSBhLmxlbmd0aCk7IHZvaWQgMCA9PT0gZCAmJiAoZCA9IDApOyB0aGlzLmJ1ZiB8fCAodGhpcy5idWYgPSBGLmJ1ZmZlckFsbG9jVW5zYWZlKDApKTsgaWYgKGQgKyBjID4gdGhpcy5idWYubGVuZ3RoKSB7XG4gICAgICAgICAgICB2YXIgZSA9IEYuYnVmZmVyQWxsb2NVbnNhZmUoZCArIGMpO1xuICAgICAgICAgICAgdGhpcy5idWYuY29weShlLCAwLCAwLCB0aGlzLmJ1Zi5sZW5ndGgpO1xuICAgICAgICAgICAgdGhpcy5idWYgPSBlO1xuICAgICAgICB9IGEuY29weSh0aGlzLmJ1ZiwgZCwgYiwgYiArIGMpOyB0aGlzLnRvdWNoKCk7IHJldHVybiBjOyB9O1xuICAgICAgICBiLnByb3RvdHlwZS5yZWFkID0gZnVuY3Rpb24gKGEsIGIsIGMsIGQpIHtcbiAgICAgICAgICAgIHZvaWQgMCA9PT0gYiAmJiAoYiA9IDApO1xuICAgICAgICAgICAgdm9pZCAwID09PSBjICYmIChjID0gYS5ieXRlTGVuZ3RoKTtcbiAgICAgICAgICAgIHZvaWQgMCA9PT0gZCAmJiAoZCA9IDApO1xuICAgICAgICAgICAgdGhpcy5idWYgfHwgKHRoaXMuYnVmID0gRi5idWZmZXJBbGxvY1Vuc2FmZSgwKSk7XG4gICAgICAgICAgICBjID4gYS5ieXRlTGVuZ3RoICYmIChjID0gYS5ieXRlTGVuZ3RoKTtcbiAgICAgICAgICAgIGMgKyBkID4gdGhpcy5idWYubGVuZ3RoICYmIChjID0gdGhpcy5idWYubGVuZ3RoIC0gZCk7XG4gICAgICAgICAgICB0aGlzLmJ1Zi5jb3B5KGEsIGIsIGQsIGQgKyBjKTtcbiAgICAgICAgICAgIHJldHVybiBjO1xuICAgICAgICB9O1xuICAgICAgICBiLnByb3RvdHlwZS50cnVuY2F0ZSA9IGZ1bmN0aW9uIChhKSB7IHZvaWQgMCA9PT0gYSAmJiAoYSA9IDApOyBpZiAoYSlcbiAgICAgICAgICAgIGlmICh0aGlzLmJ1ZiB8fCAodGhpcy5idWYgPSBGLmJ1ZmZlckFsbG9jVW5zYWZlKDApKSwgYSA8PSB0aGlzLmJ1Zi5sZW5ndGgpXG4gICAgICAgICAgICAgICAgdGhpcy5idWYgPSB0aGlzLmJ1Zi5zbGljZSgwLCBhKTtcbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBiID0gRi5idWZmZXJBbGxvY1Vuc2FmZSgwKTtcbiAgICAgICAgICAgICAgICB0aGlzLmJ1Zi5jb3B5KGIpO1xuICAgICAgICAgICAgICAgIGIuZmlsbCgwLCBhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgdGhpcy5idWYgPSBGLmJ1ZmZlckFsbG9jVW5zYWZlKDApOyB0aGlzLnRvdWNoKCk7IH07XG4gICAgICAgIGIucHJvdG90eXBlLmNobW9kID0gZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgIHRoaXMucGVybSA9IGE7XG4gICAgICAgICAgICB0aGlzLm1vZGUgPSB0aGlzLm1vZGUgJiAtNTEyIHxcbiAgICAgICAgICAgICAgICBhO1xuICAgICAgICAgICAgdGhpcy50b3VjaCgpO1xuICAgICAgICB9O1xuICAgICAgICBiLnByb3RvdHlwZS5jaG93biA9IGZ1bmN0aW9uIChhLCBiKSB7IHRoaXMudWlkID0gYTsgdGhpcy5naWQgPSBiOyB0aGlzLnRvdWNoKCk7IH07XG4gICAgICAgIGIucHJvdG90eXBlLnRvdWNoID0gZnVuY3Rpb24gKCkgeyB0aGlzLm10aW1lID0gbmV3IERhdGU7IHRoaXMuZW1pdChcImNoYW5nZVwiLCB0aGlzKTsgfTtcbiAgICAgICAgYi5wcm90b3R5cGUuY2FuUmVhZCA9IGZ1bmN0aW9uIChhLCBiKSB7IHZvaWQgMCA9PT0gYSAmJiAoYSA9IEwuZGVmYXVsdC5nZXR1aWQoKSk7IHZvaWQgMCA9PT0gYiAmJiAoYiA9IEwuZGVmYXVsdC5nZXRnaWQoKSk7IHJldHVybiB0aGlzLnBlcm0gJiA0IHx8IGIgPT09IHRoaXMuZ2lkICYmIHRoaXMucGVybSAmIDMyIHx8IGEgPT09IHRoaXMudWlkICYmIHRoaXMucGVybSAmIDI1NiA/ICEwIDogITE7IH07XG4gICAgICAgIGIucHJvdG90eXBlLmNhbldyaXRlID0gZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgICAgIHZvaWQgMCA9PT0gYSAmJiAoYSA9IEwuZGVmYXVsdC5nZXR1aWQoKSk7XG4gICAgICAgICAgICB2b2lkIDAgPT09IGIgJiYgKGIgPSBMLmRlZmF1bHQuZ2V0Z2lkKCkpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGVybSAmIDIgfHwgYiA9PT0gdGhpcy5naWQgJiYgdGhpcy5wZXJtICYgMTYgfHwgYSA9PT1cbiAgICAgICAgICAgICAgICB0aGlzLnVpZCAmJiB0aGlzLnBlcm0gJiAxMjggPyAhMCA6ICExO1xuICAgICAgICB9O1xuICAgICAgICBiLnByb3RvdHlwZS5kZWwgPSBmdW5jdGlvbiAoKSB7IHRoaXMuZW1pdChcImRlbGV0ZVwiLCB0aGlzKTsgfTtcbiAgICAgICAgYi5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKCkgeyByZXR1cm4geyBpbm86IHRoaXMuaW5vLCB1aWQ6IHRoaXMudWlkLCBnaWQ6IHRoaXMuZ2lkLCBhdGltZTogdGhpcy5hdGltZS5nZXRUaW1lKCksIG10aW1lOiB0aGlzLm10aW1lLmdldFRpbWUoKSwgY3RpbWU6IHRoaXMuY3RpbWUuZ2V0VGltZSgpLCBwZXJtOiB0aGlzLnBlcm0sIG1vZGU6IHRoaXMubW9kZSwgbmxpbms6IHRoaXMubmxpbmssIHN5bWxpbms6IHRoaXMuc3ltbGluaywgZGF0YTogdGhpcy5nZXRTdHJpbmcoKSB9OyB9O1xuICAgICAgICByZXR1cm4gYjtcbiAgICB9KE8uRXZlbnRFbWl0dGVyKTtcbiAgICBiLk5vZGUgPSBhO1xuICAgIGEgPSBmdW5jdGlvbiAoYSkge1xuICAgICAgICBmdW5jdGlvbiBkKGIsIGMsIGQpIHtcbiAgICAgICAgICAgIHZhciBlID0gYS5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgICAgICBlLmNoaWxkcmVuID0ge307XG4gICAgICAgICAgICBlLnN0ZXBzID0gW107XG4gICAgICAgICAgICBlLmlubyA9IDA7XG4gICAgICAgICAgICBlLmxlbmd0aCA9IDA7XG4gICAgICAgICAgICBlLnZvbCA9IGI7XG4gICAgICAgICAgICBlLnBhcmVudCA9IGM7XG4gICAgICAgICAgICBlLnN0ZXBzID0gYyA/IGMuc3RlcHMuY29uY2F0KFtkXSkgOlxuICAgICAgICAgICAgICAgIFtkXTtcbiAgICAgICAgICAgIHJldHVybiBlO1xuICAgICAgICB9XG4gICAgICAgIGMoZCwgYSk7XG4gICAgICAgIGQucHJvdG90eXBlLnNldE5vZGUgPSBmdW5jdGlvbiAoYSkgeyB0aGlzLm5vZGUgPSBhOyB0aGlzLmlubyA9IGEuaW5vOyB9O1xuICAgICAgICBkLnByb3RvdHlwZS5nZXROb2RlID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5ub2RlOyB9O1xuICAgICAgICBkLnByb3RvdHlwZS5jcmVhdGVDaGlsZCA9IGZ1bmN0aW9uIChhLCBiKSB7IHZvaWQgMCA9PT0gYiAmJiAoYiA9IHRoaXMudm9sLmNyZWF0ZU5vZGUoKSk7IHZhciBjID0gbmV3IGQodGhpcy52b2wsIHRoaXMsIGEpOyBjLnNldE5vZGUoYik7IGIuaXNEaXJlY3RvcnkoKTsgdGhpcy5zZXRDaGlsZChhLCBjKTsgcmV0dXJuIGM7IH07XG4gICAgICAgIGQucHJvdG90eXBlLnNldENoaWxkID0gZnVuY3Rpb24gKGEsIGIpIHsgdm9pZCAwID09PSBiICYmIChiID0gbmV3IGQodGhpcy52b2wsIHRoaXMsIGEpKTsgdGhpcy5jaGlsZHJlblthXSA9IGI7IGIucGFyZW50ID0gdGhpczsgdGhpcy5sZW5ndGgrKzsgdGhpcy5lbWl0KFwiY2hpbGQ6YWRkXCIsIGIsIHRoaXMpOyByZXR1cm4gYjsgfTtcbiAgICAgICAgZC5wcm90b3R5cGUuZGVsZXRlQ2hpbGQgPSBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMuY2hpbGRyZW5bYS5nZXROYW1lKCldO1xuICAgICAgICAgICAgdGhpcy5sZW5ndGgtLTtcbiAgICAgICAgICAgIHRoaXMuZW1pdChcImNoaWxkOmRlbGV0ZVwiLCBhLCB0aGlzKTtcbiAgICAgICAgfTtcbiAgICAgICAgZC5wcm90b3R5cGUuZ2V0Q2hpbGQgPSBmdW5jdGlvbiAoYSkgeyBpZiAoT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwodGhpcy5jaGlsZHJlbiwgYSkpXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jaGlsZHJlblthXTsgfTtcbiAgICAgICAgZC5wcm90b3R5cGUuZ2V0UGF0aCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuc3RlcHMuam9pbihiLlNFUCk7IH07XG4gICAgICAgIGQucHJvdG90eXBlLmdldE5hbWUgPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLnN0ZXBzW3RoaXMuc3RlcHMubGVuZ3RoIC0gMV07IH07XG4gICAgICAgIGQucHJvdG90eXBlLndhbGsgPSBmdW5jdGlvbiAoYSwgYiwgYykgeyB2b2lkIDAgPT09IGIgJiYgKGIgPSBhLmxlbmd0aCk7IHZvaWQgMCA9PT0gYyAmJiAoYyA9IDApOyBpZiAoYyA+PSBhLmxlbmd0aCB8fCBjID49IGIpXG4gICAgICAgICAgICByZXR1cm4gdGhpczsgdmFyIGQgPSB0aGlzLmdldENoaWxkKGFbY10pOyByZXR1cm4gZCA/IGQud2FsayhhLCBiLCBjICsgMSkgOiBudWxsOyB9O1xuICAgICAgICBkLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4geyBzdGVwczogdGhpcy5zdGVwcyxcbiAgICAgICAgICAgICAgICBpbm86IHRoaXMuaW5vLCBjaGlsZHJlbjogT2JqZWN0LmtleXModGhpcy5jaGlsZHJlbikgfTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIGQ7XG4gICAgfShPLkV2ZW50RW1pdHRlcik7XG4gICAgYi5MaW5rID0gYTtcbiAgICBhID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBhKGEsIGIsIGMsIGQpIHsgdGhpcy5wb3NpdGlvbiA9IDA7IHRoaXMubGluayA9IGE7IHRoaXMubm9kZSA9IGI7IHRoaXMuZmxhZ3MgPSBjOyB0aGlzLmZkID0gZDsgfVxuICAgICAgICBhLnByb3RvdHlwZS5nZXRTdHJpbmcgPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLm5vZGUuZ2V0U3RyaW5nKCk7IH07XG4gICAgICAgIGEucHJvdG90eXBlLnNldFN0cmluZyA9IGZ1bmN0aW9uIChhKSB7IHRoaXMubm9kZS5zZXRTdHJpbmcoYSk7IH07XG4gICAgICAgIGEucHJvdG90eXBlLmdldEJ1ZmZlciA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMubm9kZS5nZXRCdWZmZXIoKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuc2V0QnVmZmVyID0gZnVuY3Rpb24gKGEpIHsgdGhpcy5ub2RlLnNldEJ1ZmZlcihhKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuZ2V0U2l6ZSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMubm9kZS5nZXRTaXplKCk7IH07XG4gICAgICAgIGEucHJvdG90eXBlLnRydW5jYXRlID1cbiAgICAgICAgICAgIGZ1bmN0aW9uIChhKSB7IHRoaXMubm9kZS50cnVuY2F0ZShhKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuc2Vla1RvID0gZnVuY3Rpb24gKGEpIHsgdGhpcy5wb3NpdGlvbiA9IGE7IH07XG4gICAgICAgIGEucHJvdG90eXBlLnN0YXRzID0gZnVuY3Rpb24gKCkgeyByZXR1cm4ga2EuZGVmYXVsdC5idWlsZCh0aGlzLm5vZGUpOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uIChhLCBiLCBjLCBkKSB7IHZvaWQgMCA9PT0gYiAmJiAoYiA9IDApOyB2b2lkIDAgPT09IGMgJiYgKGMgPSBhLmxlbmd0aCk7IFwibnVtYmVyXCIgIT09IHR5cGVvZiBkICYmIChkID0gdGhpcy5wb3NpdGlvbik7IHRoaXMuZmxhZ3MgJiBoICYmIChkID0gdGhpcy5nZXRTaXplKCkpOyBhID0gdGhpcy5ub2RlLndyaXRlKGEsIGIsIGMsIGQpOyB0aGlzLnBvc2l0aW9uID0gZCArIGE7IHJldHVybiBhOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5yZWFkID0gZnVuY3Rpb24gKGEsIGIsIGMsIGQpIHtcbiAgICAgICAgICAgIHZvaWQgMCA9PT0gYiAmJiAoYiA9IDApO1xuICAgICAgICAgICAgdm9pZCAwID09PSBjICYmIChjID0gYS5ieXRlTGVuZ3RoKTtcbiAgICAgICAgICAgIFwibnVtYmVyXCIgIT09IHR5cGVvZiBkICYmIChkID0gdGhpcy5wb3NpdGlvbik7XG4gICAgICAgICAgICBhID0gdGhpcy5ub2RlLnJlYWQoYSwgYiwgYywgZCk7XG4gICAgICAgICAgICB0aGlzLnBvc2l0aW9uID0gZCArIGE7XG4gICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuY2htb2QgPSBmdW5jdGlvbiAoYSkgeyB0aGlzLm5vZGUuY2htb2QoYSk7IH07XG4gICAgICAgIGEucHJvdG90eXBlLmNob3duID0gZnVuY3Rpb24gKGEsIGIpIHsgdGhpcy5ub2RlLmNob3duKGEsIGIpOyB9O1xuICAgICAgICByZXR1cm4gYTtcbiAgICB9KCk7XG4gICAgYi5GaWxlID0gYTtcbn0pO1xudChmZCk7XG52YXIgZ2QgPSBmZC5Ob2RlLCBoZCA9IHUoZnVuY3Rpb24gKGEsIGIpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGIsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiAhMCB9KTsgYi5kZWZhdWx0ID0gZnVuY3Rpb24gKGEsIGIsIGUpIHsgdmFyIGMgPSBzZXRUaW1lb3V0LmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7IGMgJiYgXCJvYmplY3RcIiA9PT0gdHlwZW9mIGMgJiYgXCJmdW5jdGlvblwiID09PSB0eXBlb2YgYy51bnJlZiAmJiBjLnVucmVmKCk7IHJldHVybiBjOyB9OyB9KTtcbnQoaGQpO1xuZnVuY3Rpb24gaWQoKSB7IHRoaXMudGFpbCA9IHRoaXMuaGVhZCA9IG51bGw7IHRoaXMubGVuZ3RoID0gMDsgfVxuaWQucHJvdG90eXBlLnB1c2ggPSBmdW5jdGlvbiAoYSkgeyBhID0geyBkYXRhOiBhLCBuZXh0OiBudWxsIH07IDAgPCB0aGlzLmxlbmd0aCA/IHRoaXMudGFpbC5uZXh0ID0gYSA6IHRoaXMuaGVhZCA9IGE7IHRoaXMudGFpbCA9IGE7ICsrdGhpcy5sZW5ndGg7IH07XG5pZC5wcm90b3R5cGUudW5zaGlmdCA9IGZ1bmN0aW9uIChhKSB7IGEgPSB7IGRhdGE6IGEsIG5leHQ6IHRoaXMuaGVhZCB9OyAwID09PSB0aGlzLmxlbmd0aCAmJiAodGhpcy50YWlsID0gYSk7IHRoaXMuaGVhZCA9IGE7ICsrdGhpcy5sZW5ndGg7IH07XG5pZC5wcm90b3R5cGUuc2hpZnQgPSBmdW5jdGlvbiAoKSB7IGlmICgwICE9PSB0aGlzLmxlbmd0aCkge1xuICAgIHZhciBhID0gdGhpcy5oZWFkLmRhdGE7XG4gICAgdGhpcy5oZWFkID0gMSA9PT0gdGhpcy5sZW5ndGggPyB0aGlzLnRhaWwgPSBudWxsIDogdGhpcy5oZWFkLm5leHQ7XG4gICAgLS10aGlzLmxlbmd0aDtcbiAgICByZXR1cm4gYTtcbn0gfTtcbmlkLnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHsgdGhpcy5oZWFkID0gdGhpcy50YWlsID0gbnVsbDsgdGhpcy5sZW5ndGggPSAwOyB9O1xuaWQucHJvdG90eXBlLmpvaW4gPSBmdW5jdGlvbiAoYSkgeyBpZiAoMCA9PT0gdGhpcy5sZW5ndGgpXG4gICAgcmV0dXJuIFwiXCI7IGZvciAodmFyIGIgPSB0aGlzLmhlYWQsIGMgPSBcIlwiICsgYi5kYXRhOyBiID0gYi5uZXh0OylcbiAgICBjICs9IGEgKyBiLmRhdGE7IHJldHVybiBjOyB9O1xuaWQucHJvdG90eXBlLmNvbmNhdCA9IGZ1bmN0aW9uIChhKSB7IGlmICgwID09PSB0aGlzLmxlbmd0aClcbiAgICByZXR1cm4gei5hbGxvYygwKTsgaWYgKDEgPT09IHRoaXMubGVuZ3RoKVxuICAgIHJldHVybiB0aGlzLmhlYWQuZGF0YTsgYSA9IHouYWxsb2NVbnNhZmUoYSA+Pj4gMCk7IGZvciAodmFyIGIgPSB0aGlzLmhlYWQsIGMgPSAwOyBiOylcbiAgICBiLmRhdGEuY29weShhLCBjKSwgYyArPSBiLmRhdGEubGVuZ3RoLCBiID0gYi5uZXh0OyByZXR1cm4gYTsgfTtcbnZhciBqZCA9IHouaXNFbmNvZGluZyB8fCBmdW5jdGlvbiAoYSkgeyBzd2l0Y2ggKGEgJiYgYS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgY2FzZSBcImhleFwiOlxuICAgIGNhc2UgXCJ1dGY4XCI6XG4gICAgY2FzZSBcInV0Zi04XCI6XG4gICAgY2FzZSBcImFzY2lpXCI6XG4gICAgY2FzZSBcImJpbmFyeVwiOlxuICAgIGNhc2UgXCJiYXNlNjRcIjpcbiAgICBjYXNlIFwidWNzMlwiOlxuICAgIGNhc2UgXCJ1Y3MtMlwiOlxuICAgIGNhc2UgXCJ1dGYxNmxlXCI6XG4gICAgY2FzZSBcInV0Zi0xNmxlXCI6XG4gICAgY2FzZSBcInJhd1wiOiByZXR1cm4gITA7XG4gICAgZGVmYXVsdDogcmV0dXJuICExO1xufSB9O1xuZnVuY3Rpb24ga2QoYSkgeyB0aGlzLmVuY29kaW5nID0gKGEgfHwgXCJ1dGY4XCIpLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvWy1fXS8sIFwiXCIpOyBpZiAoYSAmJiAhamQoYSkpXG4gICAgdGhyb3cgRXJyb3IoXCJVbmtub3duIGVuY29kaW5nOiBcIiArIGEpOyBzd2l0Y2ggKHRoaXMuZW5jb2RpbmcpIHtcbiAgICBjYXNlIFwidXRmOFwiOlxuICAgICAgICB0aGlzLnN1cnJvZ2F0ZVNpemUgPSAzO1xuICAgICAgICBicmVhaztcbiAgICBjYXNlIFwidWNzMlwiOlxuICAgIGNhc2UgXCJ1dGYxNmxlXCI6XG4gICAgICAgIHRoaXMuc3Vycm9nYXRlU2l6ZSA9IDI7XG4gICAgICAgIHRoaXMuZGV0ZWN0SW5jb21wbGV0ZUNoYXIgPSBsZDtcbiAgICAgICAgYnJlYWs7XG4gICAgY2FzZSBcImJhc2U2NFwiOlxuICAgICAgICB0aGlzLnN1cnJvZ2F0ZVNpemUgPSAzO1xuICAgICAgICB0aGlzLmRldGVjdEluY29tcGxldGVDaGFyID0gbWQ7XG4gICAgICAgIGJyZWFrO1xuICAgIGRlZmF1bHQ6XG4gICAgICAgIHRoaXMud3JpdGUgPSBuZDtcbiAgICAgICAgcmV0dXJuO1xufSB0aGlzLmNoYXJCdWZmZXIgPSBuZXcgeig2KTsgdGhpcy5jaGFyTGVuZ3RoID0gdGhpcy5jaGFyUmVjZWl2ZWQgPSAwOyB9XG5rZC5wcm90b3R5cGUud3JpdGUgPSBmdW5jdGlvbiAoYSkge1xuICAgIGZvciAodmFyIGIgPSBcIlwiOyB0aGlzLmNoYXJMZW5ndGg7KSB7XG4gICAgICAgIGIgPSBhLmxlbmd0aCA+PSB0aGlzLmNoYXJMZW5ndGggLSB0aGlzLmNoYXJSZWNlaXZlZCA/IHRoaXMuY2hhckxlbmd0aCAtIHRoaXMuY2hhclJlY2VpdmVkIDogYS5sZW5ndGg7XG4gICAgICAgIGEuY29weSh0aGlzLmNoYXJCdWZmZXIsIHRoaXMuY2hhclJlY2VpdmVkLCAwLCBiKTtcbiAgICAgICAgdGhpcy5jaGFyUmVjZWl2ZWQgKz0gYjtcbiAgICAgICAgaWYgKHRoaXMuY2hhclJlY2VpdmVkIDwgdGhpcy5jaGFyTGVuZ3RoKVxuICAgICAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgICAgIGEgPSBhLnNsaWNlKGIsIGEubGVuZ3RoKTtcbiAgICAgICAgYiA9IHRoaXMuY2hhckJ1ZmZlci5zbGljZSgwLCB0aGlzLmNoYXJMZW5ndGgpLnRvU3RyaW5nKHRoaXMuZW5jb2RpbmcpO1xuICAgICAgICB2YXIgYyA9IGIuY2hhckNvZGVBdChiLmxlbmd0aCAtIDEpO1xuICAgICAgICBpZiAoNTUyOTYgPD0gYyAmJiA1NjMxOSA+PSBjKVxuICAgICAgICAgICAgdGhpcy5jaGFyTGVuZ3RoICs9IHRoaXMuc3Vycm9nYXRlU2l6ZSwgYiA9IFwiXCI7XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5jaGFyUmVjZWl2ZWQgPSB0aGlzLmNoYXJMZW5ndGggPSAwO1xuICAgICAgICAgICAgaWYgKDAgPT09IGEubGVuZ3RoKVxuICAgICAgICAgICAgICAgIHJldHVybiBiO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdGhpcy5kZXRlY3RJbmNvbXBsZXRlQ2hhcihhKTtcbiAgICB2YXIgZCA9IGEubGVuZ3RoO1xuICAgIHRoaXMuY2hhckxlbmd0aCAmJiAoYS5jb3B5KHRoaXMuY2hhckJ1ZmZlciwgMCwgYS5sZW5ndGggLSB0aGlzLmNoYXJSZWNlaXZlZCwgZCksIGQgLT0gdGhpcy5jaGFyUmVjZWl2ZWQpO1xuICAgIGIgKz0gYS50b1N0cmluZyh0aGlzLmVuY29kaW5nLCAwLCBkKTtcbiAgICBkID0gYi5sZW5ndGggLSAxO1xuICAgIGMgPSBiLmNoYXJDb2RlQXQoZCk7XG4gICAgcmV0dXJuIDU1Mjk2IDw9IGMgJiYgNTYzMTkgPj0gYyA/IChjID0gdGhpcy5zdXJyb2dhdGVTaXplLCB0aGlzLmNoYXJMZW5ndGggKz0gYywgdGhpcy5jaGFyUmVjZWl2ZWQgKz0gYywgdGhpcy5jaGFyQnVmZmVyLmNvcHkodGhpcy5jaGFyQnVmZmVyLCBjLCAwLCBjKSwgYS5jb3B5KHRoaXMuY2hhckJ1ZmZlciwgMCwgMCwgYyksIGIuc3Vic3RyaW5nKDAsIGQpKSA6IGI7XG59O1xua2QucHJvdG90eXBlLmRldGVjdEluY29tcGxldGVDaGFyID0gZnVuY3Rpb24gKGEpIHsgZm9yICh2YXIgYiA9IDMgPD0gYS5sZW5ndGggPyAzIDogYS5sZW5ndGg7IDAgPCBiOyBiLS0pIHtcbiAgICB2YXIgYyA9IGFbYS5sZW5ndGggLSBiXTtcbiAgICBpZiAoMSA9PSBiICYmIDYgPT0gYyA+PiA1KSB7XG4gICAgICAgIHRoaXMuY2hhckxlbmd0aCA9IDI7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBpZiAoMiA+PSBiICYmIDE0ID09IGMgPj4gNCkge1xuICAgICAgICB0aGlzLmNoYXJMZW5ndGggPSAzO1xuICAgICAgICBicmVhaztcbiAgICB9XG4gICAgaWYgKDMgPj0gYiAmJiAzMCA9PSBjID4+IDMpIHtcbiAgICAgICAgdGhpcy5jaGFyTGVuZ3RoID0gNDtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxufSB0aGlzLmNoYXJSZWNlaXZlZCA9IGI7IH07XG5rZC5wcm90b3R5cGUuZW5kID0gZnVuY3Rpb24gKGEpIHsgdmFyIGIgPSBcIlwiOyBhICYmIGEubGVuZ3RoICYmIChiID0gdGhpcy53cml0ZShhKSk7IHRoaXMuY2hhclJlY2VpdmVkICYmIChhID0gdGhpcy5lbmNvZGluZywgYiArPSB0aGlzLmNoYXJCdWZmZXIuc2xpY2UoMCwgdGhpcy5jaGFyUmVjZWl2ZWQpLnRvU3RyaW5nKGEpKTsgcmV0dXJuIGI7IH07XG5mdW5jdGlvbiBuZChhKSB7IHJldHVybiBhLnRvU3RyaW5nKHRoaXMuZW5jb2RpbmcpOyB9XG5mdW5jdGlvbiBsZChhKSB7IHRoaXMuY2hhckxlbmd0aCA9ICh0aGlzLmNoYXJSZWNlaXZlZCA9IGEubGVuZ3RoICUgMikgPyAyIDogMDsgfVxuZnVuY3Rpb24gbWQoYSkgeyB0aGlzLmNoYXJMZW5ndGggPSAodGhpcy5jaGFyUmVjZWl2ZWQgPSBhLmxlbmd0aCAlIDMpID8gMyA6IDA7IH1cblAuUmVhZGFibGVTdGF0ZSA9IG9kO1xudmFyIFEgPSBNYihcInN0cmVhbVwiKTtcbkRiKFAsIE8pO1xuZnVuY3Rpb24gcGQoYSwgYiwgYykgeyBpZiAoXCJmdW5jdGlvblwiID09PSB0eXBlb2YgYS5wcmVwZW5kTGlzdGVuZXIpXG4gICAgcmV0dXJuIGEucHJlcGVuZExpc3RlbmVyKGIsIGMpOyBpZiAoYS5fZXZlbnRzICYmIGEuX2V2ZW50c1tiXSlcbiAgICBBcnJheS5pc0FycmF5KGEuX2V2ZW50c1tiXSkgPyBhLl9ldmVudHNbYl0udW5zaGlmdChjKSA6IGEuX2V2ZW50c1tiXSA9IFtjLCBhLl9ldmVudHNbYl1dO1xuZWxzZVxuICAgIGEub24oYiwgYyk7IH1cbmZ1bmN0aW9uIG9kKGEsIGIpIHtcbiAgICBhID0gYSB8fCB7fTtcbiAgICB0aGlzLm9iamVjdE1vZGUgPSAhIWEub2JqZWN0TW9kZTtcbiAgICBiIGluc3RhbmNlb2YgViAmJiAodGhpcy5vYmplY3RNb2RlID0gdGhpcy5vYmplY3RNb2RlIHx8ICEhYS5yZWFkYWJsZU9iamVjdE1vZGUpO1xuICAgIGIgPSBhLmhpZ2hXYXRlck1hcms7XG4gICAgdmFyIGMgPSB0aGlzLm9iamVjdE1vZGUgPyAxNiA6IDE2Mzg0O1xuICAgIHRoaXMuaGlnaFdhdGVyTWFyayA9IGIgfHwgMCA9PT0gYiA/IGIgOiBjO1xuICAgIHRoaXMuaGlnaFdhdGVyTWFyayA9IH5+dGhpcy5oaWdoV2F0ZXJNYXJrO1xuICAgIHRoaXMuYnVmZmVyID0gbmV3IGlkO1xuICAgIHRoaXMubGVuZ3RoID0gMDtcbiAgICB0aGlzLnBpcGVzID0gbnVsbDtcbiAgICB0aGlzLnBpcGVzQ291bnQgPSAwO1xuICAgIHRoaXMuZmxvd2luZyA9IG51bGw7XG4gICAgdGhpcy5yZWFkaW5nID0gdGhpcy5lbmRFbWl0dGVkID0gdGhpcy5lbmRlZCA9ICExO1xuICAgIHRoaXMuc3luYyA9ICEwO1xuICAgIHRoaXMucmVzdW1lU2NoZWR1bGVkID0gdGhpcy5yZWFkYWJsZUxpc3RlbmluZyA9IHRoaXMuZW1pdHRlZFJlYWRhYmxlID0gdGhpcy5uZWVkUmVhZGFibGUgPSAhMTtcbiAgICB0aGlzLmRlZmF1bHRFbmNvZGluZyA9IGEuZGVmYXVsdEVuY29kaW5nIHx8XG4gICAgICAgIFwidXRmOFwiO1xuICAgIHRoaXMucmFuT3V0ID0gITE7XG4gICAgdGhpcy5hd2FpdERyYWluID0gMDtcbiAgICB0aGlzLnJlYWRpbmdNb3JlID0gITE7XG4gICAgdGhpcy5lbmNvZGluZyA9IHRoaXMuZGVjb2RlciA9IG51bGw7XG4gICAgYS5lbmNvZGluZyAmJiAodGhpcy5kZWNvZGVyID0gbmV3IGtkKGEuZW5jb2RpbmcpLCB0aGlzLmVuY29kaW5nID0gYS5lbmNvZGluZyk7XG59XG5mdW5jdGlvbiBQKGEpIHsgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFApKVxuICAgIHJldHVybiBuZXcgUChhKTsgdGhpcy5fcmVhZGFibGVTdGF0ZSA9IG5ldyBvZChhLCB0aGlzKTsgdGhpcy5yZWFkYWJsZSA9ICEwOyBhICYmIFwiZnVuY3Rpb25cIiA9PT0gdHlwZW9mIGEucmVhZCAmJiAodGhpcy5fcmVhZCA9IGEucmVhZCk7IE8uY2FsbCh0aGlzKTsgfVxuUC5wcm90b3R5cGUucHVzaCA9IGZ1bmN0aW9uIChhLCBiKSB7IHZhciBjID0gdGhpcy5fcmVhZGFibGVTdGF0ZTsgYy5vYmplY3RNb2RlIHx8IFwic3RyaW5nXCIgIT09IHR5cGVvZiBhIHx8IChiID0gYiB8fCBjLmRlZmF1bHRFbmNvZGluZywgYiAhPT0gYy5lbmNvZGluZyAmJiAoYSA9IHouZnJvbShhLCBiKSwgYiA9IFwiXCIpKTsgcmV0dXJuIHFkKHRoaXMsIGMsIGEsIGIsICExKTsgfTtcblAucHJvdG90eXBlLnVuc2hpZnQgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gcWQodGhpcywgdGhpcy5fcmVhZGFibGVTdGF0ZSwgYSwgXCJcIiwgITApOyB9O1xuUC5wcm90b3R5cGUuaXNQYXVzZWQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAhMSA9PT0gdGhpcy5fcmVhZGFibGVTdGF0ZS5mbG93aW5nOyB9O1xuZnVuY3Rpb24gcWQoYSwgYiwgYywgZCwgZSkge1xuICAgIHZhciBmID0gYztcbiAgICB2YXIgZyA9IG51bGw7XG4gICAgTmEoZikgfHwgXCJzdHJpbmdcIiA9PT0gdHlwZW9mIGYgfHwgbnVsbCA9PT0gZiB8fCB2b2lkIDAgPT09IGYgfHwgYi5vYmplY3RNb2RlIHx8IChnID0gbmV3IFR5cGVFcnJvcihcIkludmFsaWQgbm9uLXN0cmluZy9idWZmZXIgY2h1bmtcIikpO1xuICAgIGlmIChmID0gZylcbiAgICAgICAgYS5lbWl0KFwiZXJyb3JcIiwgZik7XG4gICAgZWxzZSBpZiAobnVsbCA9PT0gYylcbiAgICAgICAgYi5yZWFkaW5nID0gITEsIGIuZW5kZWQgfHwgKGIuZGVjb2RlciAmJiAoYyA9IGIuZGVjb2Rlci5lbmQoKSkgJiYgYy5sZW5ndGggJiYgKGIuYnVmZmVyLnB1c2goYyksIGIubGVuZ3RoICs9IGIub2JqZWN0TW9kZSA/IDEgOiBjLmxlbmd0aCksIGIuZW5kZWQgPSAhMCwgcmQoYSkpO1xuICAgIGVsc2UgaWYgKGIub2JqZWN0TW9kZSB8fCBjICYmIDAgPCBjLmxlbmd0aClcbiAgICAgICAgaWYgKGIuZW5kZWQgJiYgIWUpXG4gICAgICAgICAgICBhLmVtaXQoXCJlcnJvclwiLCBFcnJvcihcInN0cmVhbS5wdXNoKCkgYWZ0ZXIgRU9GXCIpKTtcbiAgICAgICAgZWxzZSBpZiAoYi5lbmRFbWl0dGVkICYmIGUpXG4gICAgICAgICAgICBhLmVtaXQoXCJlcnJvclwiLCBFcnJvcihcInN0cmVhbS51bnNoaWZ0KCkgYWZ0ZXIgZW5kIGV2ZW50XCIpKTtcbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoYi5kZWNvZGVyICYmICFlICYmICFkKSB7XG4gICAgICAgICAgICAgICAgYyA9IGIuZGVjb2Rlci53cml0ZShjKTtcbiAgICAgICAgICAgICAgICB2YXIgaCA9ICFiLm9iamVjdE1vZGUgJiYgMCA9PT0gYy5sZW5ndGg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlIHx8IChiLnJlYWRpbmcgPSAhMSk7XG4gICAgICAgICAgICBoIHx8IChiLmZsb3dpbmcgJiYgMCA9PT0gYi5sZW5ndGggJiYgIWIuc3luYyA/IChhLmVtaXQoXCJkYXRhXCIsIGMpLCBhLnJlYWQoMCkpIDogKGIubGVuZ3RoICs9IGIub2JqZWN0TW9kZSA/IDEgOiBjLmxlbmd0aCwgZSA/IGIuYnVmZmVyLnVuc2hpZnQoYykgOiBiLmJ1ZmZlci5wdXNoKGMpLCBiLm5lZWRSZWFkYWJsZSAmJiByZChhKSkpO1xuICAgICAgICAgICAgYi5yZWFkaW5nTW9yZSB8fCAoYi5yZWFkaW5nTW9yZSA9ICEwLCBHKHNkLCBhLCBiKSk7XG4gICAgICAgIH1cbiAgICBlbHNlXG4gICAgICAgIGUgfHwgKGIucmVhZGluZyA9ICExKTtcbiAgICByZXR1cm4gIWIuZW5kZWQgJiYgKGIubmVlZFJlYWRhYmxlIHx8IGIubGVuZ3RoIDwgYi5oaWdoV2F0ZXJNYXJrIHx8IDAgPT09IGIubGVuZ3RoKTtcbn1cblAucHJvdG90eXBlLnNldEVuY29kaW5nID0gZnVuY3Rpb24gKGEpIHsgdGhpcy5fcmVhZGFibGVTdGF0ZS5kZWNvZGVyID0gbmV3IGtkKGEpOyB0aGlzLl9yZWFkYWJsZVN0YXRlLmVuY29kaW5nID0gYTsgcmV0dXJuIHRoaXM7IH07XG5mdW5jdGlvbiB0ZChhLCBiKSB7IGlmICgwID49IGEgfHwgMCA9PT0gYi5sZW5ndGggJiYgYi5lbmRlZClcbiAgICByZXR1cm4gMDsgaWYgKGIub2JqZWN0TW9kZSlcbiAgICByZXR1cm4gMTsgaWYgKGEgIT09IGEpXG4gICAgcmV0dXJuIGIuZmxvd2luZyAmJiBiLmxlbmd0aCA/IGIuYnVmZmVyLmhlYWQuZGF0YS5sZW5ndGggOiBiLmxlbmd0aDsgaWYgKGEgPiBiLmhpZ2hXYXRlck1hcmspIHtcbiAgICB2YXIgYyA9IGE7XG4gICAgODM4ODYwOCA8PSBjID8gYyA9IDgzODg2MDggOiAoYy0tLCBjIHw9IGMgPj4+IDEsIGMgfD0gYyA+Pj4gMiwgYyB8PSBjID4+PiA0LCBjIHw9IGMgPj4+IDgsIGMgfD0gYyA+Pj4gMTYsIGMrKyk7XG4gICAgYi5oaWdoV2F0ZXJNYXJrID0gYztcbn0gcmV0dXJuIGEgPD0gYi5sZW5ndGggPyBhIDogYi5lbmRlZCA/IGIubGVuZ3RoIDogKGIubmVlZFJlYWRhYmxlID0gITAsIDApOyB9XG5QLnByb3RvdHlwZS5yZWFkID0gZnVuY3Rpb24gKGEpIHtcbiAgICBRKFwicmVhZFwiLCBhKTtcbiAgICBhID0gcGFyc2VJbnQoYSwgMTApO1xuICAgIHZhciBiID0gdGhpcy5fcmVhZGFibGVTdGF0ZSwgYyA9IGE7XG4gICAgMCAhPT0gYSAmJiAoYi5lbWl0dGVkUmVhZGFibGUgPSAhMSk7XG4gICAgaWYgKDAgPT09IGEgJiYgYi5uZWVkUmVhZGFibGUgJiYgKGIubGVuZ3RoID49IGIuaGlnaFdhdGVyTWFyayB8fCBiLmVuZGVkKSlcbiAgICAgICAgcmV0dXJuIFEoXCJyZWFkOiBlbWl0UmVhZGFibGVcIiwgYi5sZW5ndGgsIGIuZW5kZWQpLCAwID09PSBiLmxlbmd0aCAmJiBiLmVuZGVkID8gSmQodGhpcykgOiByZCh0aGlzKSwgbnVsbDtcbiAgICBhID0gdGQoYSwgYik7XG4gICAgaWYgKDAgPT09IGEgJiYgYi5lbmRlZClcbiAgICAgICAgcmV0dXJuIDAgPT09IGIubGVuZ3RoICYmIEpkKHRoaXMpLCBudWxsO1xuICAgIHZhciBkID0gYi5uZWVkUmVhZGFibGU7XG4gICAgUShcIm5lZWQgcmVhZGFibGVcIiwgZCk7XG4gICAgaWYgKDAgPT09IGIubGVuZ3RoIHx8IGIubGVuZ3RoIC0gYSA8IGIuaGlnaFdhdGVyTWFyaylcbiAgICAgICAgZCA9ICEwLCBRKFwibGVuZ3RoIGxlc3MgdGhhbiB3YXRlcm1hcmtcIiwgZCk7XG4gICAgYi5lbmRlZCB8fCBiLnJlYWRpbmcgPyBRKFwicmVhZGluZyBvciBlbmRlZFwiLCAhMSkgOiBkICYmIChRKFwiZG8gcmVhZFwiKSwgYi5yZWFkaW5nID0gITAsIGIuc3luYyA9ICEwLCAwID09PSBiLmxlbmd0aCAmJiAoYi5uZWVkUmVhZGFibGUgPSAhMCksIHRoaXMuX3JlYWQoYi5oaWdoV2F0ZXJNYXJrKSwgYi5zeW5jID0gITEsIGIucmVhZGluZyB8fCAoYSA9IHRkKGMsIGIpKSk7XG4gICAgZCA9IDAgPCBhID8gS2QoYSwgYikgOiBudWxsO1xuICAgIG51bGwgPT09IGQgPyAoYi5uZWVkUmVhZGFibGUgPSAhMCwgYSA9IDApIDogYi5sZW5ndGggLT0gYTtcbiAgICAwID09PSBiLmxlbmd0aCAmJiAoYi5lbmRlZCB8fCAoYi5uZWVkUmVhZGFibGUgPSAhMCksIGMgIT09IGEgJiYgYi5lbmRlZCAmJiBKZCh0aGlzKSk7XG4gICAgbnVsbCAhPT0gZCAmJiB0aGlzLmVtaXQoXCJkYXRhXCIsIGQpO1xuICAgIHJldHVybiBkO1xufTtcbmZ1bmN0aW9uIHJkKGEpIHsgdmFyIGIgPSBhLl9yZWFkYWJsZVN0YXRlOyBiLm5lZWRSZWFkYWJsZSA9ICExOyBiLmVtaXR0ZWRSZWFkYWJsZSB8fCAoUShcImVtaXRSZWFkYWJsZVwiLCBiLmZsb3dpbmcpLCBiLmVtaXR0ZWRSZWFkYWJsZSA9ICEwLCBiLnN5bmMgPyBHKExkLCBhKSA6IExkKGEpKTsgfVxuZnVuY3Rpb24gTGQoYSkgeyBRKFwiZW1pdCByZWFkYWJsZVwiKTsgYS5lbWl0KFwicmVhZGFibGVcIik7IE1kKGEpOyB9XG5mdW5jdGlvbiBzZChhLCBiKSB7IGZvciAodmFyIGMgPSBiLmxlbmd0aDsgIWIucmVhZGluZyAmJiAhYi5mbG93aW5nICYmICFiLmVuZGVkICYmIGIubGVuZ3RoIDwgYi5oaWdoV2F0ZXJNYXJrICYmIChRKFwibWF5YmVSZWFkTW9yZSByZWFkIDBcIiksIGEucmVhZCgwKSwgYyAhPT0gYi5sZW5ndGgpOylcbiAgICBjID0gYi5sZW5ndGg7IGIucmVhZGluZ01vcmUgPSAhMTsgfVxuUC5wcm90b3R5cGUuX3JlYWQgPSBmdW5jdGlvbiAoKSB7IHRoaXMuZW1pdChcImVycm9yXCIsIEVycm9yKFwibm90IGltcGxlbWVudGVkXCIpKTsgfTtcblAucHJvdG90eXBlLnBpcGUgPSBmdW5jdGlvbiAoYSwgYikge1xuICAgIGZ1bmN0aW9uIGMoYSkgeyBRKFwib251bnBpcGVcIik7IGEgPT09IG4gJiYgZSgpOyB9XG4gICAgZnVuY3Rpb24gZCgpIHsgUShcIm9uZW5kXCIpOyBhLmVuZCgpOyB9XG4gICAgZnVuY3Rpb24gZSgpIHsgUShcImNsZWFudXBcIik7IGEucmVtb3ZlTGlzdGVuZXIoXCJjbG9zZVwiLCBoKTsgYS5yZW1vdmVMaXN0ZW5lcihcImZpbmlzaFwiLCBrKTsgYS5yZW1vdmVMaXN0ZW5lcihcImRyYWluXCIsIEIpOyBhLnJlbW92ZUxpc3RlbmVyKFwiZXJyb3JcIiwgZyk7IGEucmVtb3ZlTGlzdGVuZXIoXCJ1bnBpcGVcIiwgYyk7IG4ucmVtb3ZlTGlzdGVuZXIoXCJlbmRcIiwgZCk7IG4ucmVtb3ZlTGlzdGVuZXIoXCJlbmRcIiwgZSk7IG4ucmVtb3ZlTGlzdGVuZXIoXCJkYXRhXCIsIGYpOyBtID0gITA7ICFxLmF3YWl0RHJhaW4gfHwgYS5fd3JpdGFibGVTdGF0ZSAmJiAhYS5fd3JpdGFibGVTdGF0ZS5uZWVkRHJhaW4gfHwgQigpOyB9XG4gICAgZnVuY3Rpb24gZihiKSB7XG4gICAgICAgIFEoXCJvbmRhdGFcIik7XG4gICAgICAgIHYgPSAhMTtcbiAgICAgICAgITEgIT09IGEud3JpdGUoYikgfHwgdiB8fCAoKDEgPT09IHEucGlwZXNDb3VudCAmJiBxLnBpcGVzID09PVxuICAgICAgICAgICAgYSB8fCAxIDwgcS5waXBlc0NvdW50ICYmIC0xICE9PSBOZChxLnBpcGVzLCBhKSkgJiYgIW0gJiYgKFEoXCJmYWxzZSB3cml0ZSByZXNwb25zZSwgcGF1c2VcIiwgbi5fcmVhZGFibGVTdGF0ZS5hd2FpdERyYWluKSwgbi5fcmVhZGFibGVTdGF0ZS5hd2FpdERyYWluKyssIHYgPSAhMCksIG4ucGF1c2UoKSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGcoYikgeyBRKFwib25lcnJvclwiLCBiKTsgcCgpOyBhLnJlbW92ZUxpc3RlbmVyKFwiZXJyb3JcIiwgZyk7IDAgPT09IGEubGlzdGVuZXJzKFwiZXJyb3JcIikubGVuZ3RoICYmIGEuZW1pdChcImVycm9yXCIsIGIpOyB9XG4gICAgZnVuY3Rpb24gaCgpIHsgYS5yZW1vdmVMaXN0ZW5lcihcImZpbmlzaFwiLCBrKTsgcCgpOyB9XG4gICAgZnVuY3Rpb24gaygpIHsgUShcIm9uZmluaXNoXCIpOyBhLnJlbW92ZUxpc3RlbmVyKFwiY2xvc2VcIiwgaCk7IHAoKTsgfVxuICAgIGZ1bmN0aW9uIHAoKSB7IFEoXCJ1bnBpcGVcIik7IG4udW5waXBlKGEpOyB9XG4gICAgdmFyIG4gPSB0aGlzLCBxID0gdGhpcy5fcmVhZGFibGVTdGF0ZTtcbiAgICBzd2l0Y2ggKHEucGlwZXNDb3VudCkge1xuICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICBxLnBpcGVzID0gYTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICBxLnBpcGVzID0gW3EucGlwZXMsXG4gICAgICAgICAgICAgICAgYV07XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDogcS5waXBlcy5wdXNoKGEpO1xuICAgIH1cbiAgICBxLnBpcGVzQ291bnQgKz0gMTtcbiAgICBRKFwicGlwZSBjb3VudD0lZCBvcHRzPSVqXCIsIHEucGlwZXNDb3VudCwgYik7XG4gICAgYiA9IGIgJiYgITEgPT09IGIuZW5kID8gZSA6IGQ7XG4gICAgaWYgKHEuZW5kRW1pdHRlZClcbiAgICAgICAgRyhiKTtcbiAgICBlbHNlXG4gICAgICAgIG4ub25jZShcImVuZFwiLCBiKTtcbiAgICBhLm9uKFwidW5waXBlXCIsIGMpO1xuICAgIHZhciBCID0gT2Qobik7XG4gICAgYS5vbihcImRyYWluXCIsIEIpO1xuICAgIHZhciBtID0gITEsIHYgPSAhMTtcbiAgICBuLm9uKFwiZGF0YVwiLCBmKTtcbiAgICBwZChhLCBcImVycm9yXCIsIGcpO1xuICAgIGEub25jZShcImNsb3NlXCIsIGgpO1xuICAgIGEub25jZShcImZpbmlzaFwiLCBrKTtcbiAgICBhLmVtaXQoXCJwaXBlXCIsIG4pO1xuICAgIHEuZmxvd2luZyB8fCAoUShcInBpcGUgcmVzdW1lXCIpLCBuLnJlc3VtZSgpKTtcbiAgICByZXR1cm4gYTtcbn07XG5mdW5jdGlvbiBPZChhKSB7IHJldHVybiBmdW5jdGlvbiAoKSB7IHZhciBiID0gYS5fcmVhZGFibGVTdGF0ZTsgUShcInBpcGVPbkRyYWluXCIsIGIuYXdhaXREcmFpbik7IGIuYXdhaXREcmFpbiAmJiBiLmF3YWl0RHJhaW4tLTsgMCA9PT0gYi5hd2FpdERyYWluICYmIGEubGlzdGVuZXJzKFwiZGF0YVwiKS5sZW5ndGggJiYgKGIuZmxvd2luZyA9ICEwLCBNZChhKSk7IH07IH1cblAucHJvdG90eXBlLnVucGlwZSA9IGZ1bmN0aW9uIChhKSB7IHZhciBiID0gdGhpcy5fcmVhZGFibGVTdGF0ZTsgaWYgKDAgPT09IGIucGlwZXNDb3VudClcbiAgICByZXR1cm4gdGhpczsgaWYgKDEgPT09IGIucGlwZXNDb3VudCkge1xuICAgIGlmIChhICYmIGEgIT09IGIucGlwZXMpXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIGEgfHwgKGEgPSBiLnBpcGVzKTtcbiAgICBiLnBpcGVzID0gbnVsbDtcbiAgICBiLnBpcGVzQ291bnQgPSAwO1xuICAgIGIuZmxvd2luZyA9ICExO1xuICAgIGEgJiYgYS5lbWl0KFwidW5waXBlXCIsIHRoaXMpO1xuICAgIHJldHVybiB0aGlzO1xufSBpZiAoIWEpIHtcbiAgICBhID0gYi5waXBlcztcbiAgICB2YXIgYyA9IGIucGlwZXNDb3VudDtcbiAgICBiLnBpcGVzID0gbnVsbDtcbiAgICBiLnBpcGVzQ291bnQgPSAwO1xuICAgIGIuZmxvd2luZyA9ICExO1xuICAgIGZvciAoYiA9IDA7IGIgPCBjOyBiKyspXG4gICAgICAgIGFbYl0uZW1pdChcInVucGlwZVwiLCB0aGlzKTtcbiAgICByZXR1cm4gdGhpcztcbn0gYyA9IE5kKGIucGlwZXMsIGEpOyBpZiAoLTEgPT09IGMpXG4gICAgcmV0dXJuIHRoaXM7IGIucGlwZXMuc3BsaWNlKGMsIDEpOyAtLWIucGlwZXNDb3VudDsgMSA9PT0gYi5waXBlc0NvdW50ICYmIChiLnBpcGVzID0gYi5waXBlc1swXSk7IGEuZW1pdChcInVucGlwZVwiLCB0aGlzKTsgcmV0dXJuIHRoaXM7IH07XG5QLnByb3RvdHlwZS5vbiA9IGZ1bmN0aW9uIChhLCBiKSB7IGIgPSBPLnByb3RvdHlwZS5vbi5jYWxsKHRoaXMsIGEsIGIpOyBcImRhdGFcIiA9PT0gYSA/ICExICE9PSB0aGlzLl9yZWFkYWJsZVN0YXRlLmZsb3dpbmcgJiYgdGhpcy5yZXN1bWUoKSA6IFwicmVhZGFibGVcIiA9PT0gYSAmJiAoYSA9IHRoaXMuX3JlYWRhYmxlU3RhdGUsIGEuZW5kRW1pdHRlZCB8fCBhLnJlYWRhYmxlTGlzdGVuaW5nIHx8IChhLnJlYWRhYmxlTGlzdGVuaW5nID0gYS5uZWVkUmVhZGFibGUgPSAhMCwgYS5lbWl0dGVkUmVhZGFibGUgPSAhMSwgYS5yZWFkaW5nID8gYS5sZW5ndGggJiYgcmQodGhpcykgOiBHKFBkLCB0aGlzKSkpOyByZXR1cm4gYjsgfTtcblAucHJvdG90eXBlLmFkZExpc3RlbmVyID0gUC5wcm90b3R5cGUub247XG5mdW5jdGlvbiBQZChhKSB7IFEoXCJyZWFkYWJsZSBuZXh0dGljayByZWFkIDBcIik7IGEucmVhZCgwKTsgfVxuUC5wcm90b3R5cGUucmVzdW1lID0gZnVuY3Rpb24gKCkgeyB2YXIgYSA9IHRoaXMuX3JlYWRhYmxlU3RhdGU7IGEuZmxvd2luZyB8fCAoUShcInJlc3VtZVwiKSwgYS5mbG93aW5nID0gITAsIGEucmVzdW1lU2NoZWR1bGVkIHx8IChhLnJlc3VtZVNjaGVkdWxlZCA9ICEwLCBHKFFkLCB0aGlzLCBhKSkpOyByZXR1cm4gdGhpczsgfTtcbmZ1bmN0aW9uIFFkKGEsIGIpIHsgYi5yZWFkaW5nIHx8IChRKFwicmVzdW1lIHJlYWQgMFwiKSwgYS5yZWFkKDApKTsgYi5yZXN1bWVTY2hlZHVsZWQgPSAhMTsgYi5hd2FpdERyYWluID0gMDsgYS5lbWl0KFwicmVzdW1lXCIpOyBNZChhKTsgYi5mbG93aW5nICYmICFiLnJlYWRpbmcgJiYgYS5yZWFkKDApOyB9XG5QLnByb3RvdHlwZS5wYXVzZSA9IGZ1bmN0aW9uICgpIHsgUShcImNhbGwgcGF1c2UgZmxvd2luZz0lalwiLCB0aGlzLl9yZWFkYWJsZVN0YXRlLmZsb3dpbmcpOyAhMSAhPT0gdGhpcy5fcmVhZGFibGVTdGF0ZS5mbG93aW5nICYmIChRKFwicGF1c2VcIiksIHRoaXMuX3JlYWRhYmxlU3RhdGUuZmxvd2luZyA9ICExLCB0aGlzLmVtaXQoXCJwYXVzZVwiKSk7IHJldHVybiB0aGlzOyB9O1xuZnVuY3Rpb24gTWQoYSkgeyB2YXIgYiA9IGEuX3JlYWRhYmxlU3RhdGU7IGZvciAoUShcImZsb3dcIiwgYi5mbG93aW5nKTsgYi5mbG93aW5nICYmIG51bGwgIT09IGEucmVhZCgpOylcbiAgICA7IH1cblAucHJvdG90eXBlLndyYXAgPSBmdW5jdGlvbiAoYSkge1xuICAgIHZhciBiID0gdGhpcy5fcmVhZGFibGVTdGF0ZSwgYyA9ICExLCBkID0gdGhpcztcbiAgICBhLm9uKFwiZW5kXCIsIGZ1bmN0aW9uICgpIHsgUShcIndyYXBwZWQgZW5kXCIpOyBpZiAoYi5kZWNvZGVyICYmICFiLmVuZGVkKSB7XG4gICAgICAgIHZhciBhID0gYi5kZWNvZGVyLmVuZCgpO1xuICAgICAgICBhICYmIGEubGVuZ3RoICYmIGQucHVzaChhKTtcbiAgICB9IGQucHVzaChudWxsKTsgfSk7XG4gICAgYS5vbihcImRhdGFcIiwgZnVuY3Rpb24gKGUpIHsgUShcIndyYXBwZWQgZGF0YVwiKTsgYi5kZWNvZGVyICYmIChlID0gYi5kZWNvZGVyLndyaXRlKGUpKTsgYi5vYmplY3RNb2RlICYmIChudWxsID09PSBlIHx8IHZvaWQgMCA9PT0gZSkgfHwgIShiLm9iamVjdE1vZGUgfHwgZSAmJiBlLmxlbmd0aCkgfHwgZC5wdXNoKGUpIHx8IChjID0gITAsIGEucGF1c2UoKSk7IH0pO1xuICAgIGZvciAodmFyIGUgaW4gYSlcbiAgICAgICAgdm9pZCAwID09PSB0aGlzW2VdICYmIFwiZnVuY3Rpb25cIiA9PT0gdHlwZW9mIGFbZV0gJiYgKHRoaXNbZV0gPSBmdW5jdGlvbiAoYikgeyByZXR1cm4gZnVuY3Rpb24gKCkgeyByZXR1cm4gYVtiXS5hcHBseShhLCBhcmd1bWVudHMpOyB9OyB9KGUpKTtcbiAgICBSZChbXCJlcnJvclwiLFxuICAgICAgICBcImNsb3NlXCIsIFwiZGVzdHJveVwiLCBcInBhdXNlXCIsIFwicmVzdW1lXCJdLCBmdW5jdGlvbiAoYikgeyBhLm9uKGIsIGQuZW1pdC5iaW5kKGQsIGIpKTsgfSk7XG4gICAgZC5fcmVhZCA9IGZ1bmN0aW9uIChiKSB7IFEoXCJ3cmFwcGVkIF9yZWFkXCIsIGIpOyBjICYmIChjID0gITEsIGEucmVzdW1lKCkpOyB9O1xuICAgIHJldHVybiBkO1xufTtcblAuX2Zyb21MaXN0ID0gS2Q7XG5mdW5jdGlvbiBLZChhLCBiKSB7XG4gICAgaWYgKDAgPT09IGIubGVuZ3RoKVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICBpZiAoYi5vYmplY3RNb2RlKVxuICAgICAgICB2YXIgYyA9IGIuYnVmZmVyLnNoaWZ0KCk7XG4gICAgZWxzZSBpZiAoIWEgfHwgYSA+PSBiLmxlbmd0aClcbiAgICAgICAgYyA9IGIuZGVjb2RlciA/IGIuYnVmZmVyLmpvaW4oXCJcIikgOiAxID09PSBiLmJ1ZmZlci5sZW5ndGggPyBiLmJ1ZmZlci5oZWFkLmRhdGEgOiBiLmJ1ZmZlci5jb25jYXQoYi5sZW5ndGgpLCBiLmJ1ZmZlci5jbGVhcigpO1xuICAgIGVsc2Uge1xuICAgICAgICBjID0gYi5idWZmZXI7XG4gICAgICAgIGIgPSBiLmRlY29kZXI7XG4gICAgICAgIGlmIChhIDwgYy5oZWFkLmRhdGEubGVuZ3RoKVxuICAgICAgICAgICAgYiA9IGMuaGVhZC5kYXRhLnNsaWNlKDAsIGEpLCBjLmhlYWQuZGF0YSA9IGMuaGVhZC5kYXRhLnNsaWNlKGEpO1xuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChhID09PSBjLmhlYWQuZGF0YS5sZW5ndGgpXG4gICAgICAgICAgICAgICAgYyA9IGMuc2hpZnQoKTtcbiAgICAgICAgICAgIGVsc2UgaWYgKGIpIHtcbiAgICAgICAgICAgICAgICBiID0gYy5oZWFkO1xuICAgICAgICAgICAgICAgIHZhciBkID0gMSwgZSA9IGIuZGF0YTtcbiAgICAgICAgICAgICAgICBmb3IgKGEgLT0gZS5sZW5ndGg7IGIgPSBiLm5leHQ7KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmID0gYi5kYXRhLCBnID0gYSA+IGYubGVuZ3RoID8gZi5sZW5ndGggOiBhO1xuICAgICAgICAgICAgICAgICAgICBlID0gZyA9PT0gZi5sZW5ndGggPyBlICsgZiA6IGUgKyBmLnNsaWNlKDAsIGEpO1xuICAgICAgICAgICAgICAgICAgICBhIC09IGc7XG4gICAgICAgICAgICAgICAgICAgIGlmICgwID09PSBhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBnID09PSBmLmxlbmd0aCA/ICgrK2QsIGMuaGVhZCA9IGIubmV4dCA/IGIubmV4dCA6IGMudGFpbCA9IG51bGwpIDogKGMuaGVhZCA9IGIsIGIuZGF0YSA9IGYuc2xpY2UoZykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgKytkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjLmxlbmd0aCAtPSBkO1xuICAgICAgICAgICAgICAgIGMgPSBlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgYiA9IHouYWxsb2NVbnNhZmUoYSk7XG4gICAgICAgICAgICAgICAgZCA9IGMuaGVhZDtcbiAgICAgICAgICAgICAgICBlID0gMTtcbiAgICAgICAgICAgICAgICBkLmRhdGEuY29weShiKTtcbiAgICAgICAgICAgICAgICBmb3IgKGEgLT0gZC5kYXRhLmxlbmd0aDsgZCA9IGQubmV4dDspIHtcbiAgICAgICAgICAgICAgICAgICAgZiA9IGQuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgZyA9IGEgPiBmLmxlbmd0aCA/IGYubGVuZ3RoIDogYTtcbiAgICAgICAgICAgICAgICAgICAgZi5jb3B5KGIsIGIubGVuZ3RoIC0gYSwgMCwgZyk7XG4gICAgICAgICAgICAgICAgICAgIGEgLT0gZztcbiAgICAgICAgICAgICAgICAgICAgaWYgKDAgPT09IGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGcgPT09IGYubGVuZ3RoID8gKCsrZSwgYy5oZWFkID0gZC5uZXh0ID8gZC5uZXh0IDogYy50YWlsID0gbnVsbCkgOiAoYy5oZWFkID0gZCwgZC5kYXRhID0gZi5zbGljZShnKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICArK2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGMubGVuZ3RoIC09IGU7XG4gICAgICAgICAgICAgICAgYyA9IGI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBiID0gYztcbiAgICAgICAgfVxuICAgICAgICBjID0gYjtcbiAgICB9XG4gICAgcmV0dXJuIGM7XG59XG5mdW5jdGlvbiBKZChhKSB7IHZhciBiID0gYS5fcmVhZGFibGVTdGF0ZTsgaWYgKDAgPCBiLmxlbmd0aClcbiAgICB0aHJvdyBFcnJvcignXCJlbmRSZWFkYWJsZSgpXCIgY2FsbGVkIG9uIG5vbi1lbXB0eSBzdHJlYW0nKTsgYi5lbmRFbWl0dGVkIHx8IChiLmVuZGVkID0gITAsIEcoU2QsIGIsIGEpKTsgfVxuZnVuY3Rpb24gU2QoYSwgYikgeyBhLmVuZEVtaXR0ZWQgfHwgMCAhPT0gYS5sZW5ndGggfHwgKGEuZW5kRW1pdHRlZCA9ICEwLCBiLnJlYWRhYmxlID0gITEsIGIuZW1pdChcImVuZFwiKSk7IH1cbmZ1bmN0aW9uIFJkKGEsIGIpIHsgZm9yICh2YXIgYyA9IDAsIGQgPSBhLmxlbmd0aDsgYyA8IGQ7IGMrKylcbiAgICBiKGFbY10sIGMpOyB9XG5mdW5jdGlvbiBOZChhLCBiKSB7IGZvciAodmFyIGMgPSAwLCBkID0gYS5sZW5ndGg7IGMgPCBkOyBjKyspXG4gICAgaWYgKGFbY10gPT09IGIpXG4gICAgICAgIHJldHVybiBjOyByZXR1cm4gLTE7IH1cblcuV3JpdGFibGVTdGF0ZSA9IFRkO1xuRGIoVywgTyk7XG5mdW5jdGlvbiBVZCgpIHsgfVxuZnVuY3Rpb24gVmQoYSwgYiwgYykgeyB0aGlzLmNodW5rID0gYTsgdGhpcy5lbmNvZGluZyA9IGI7IHRoaXMuY2FsbGJhY2sgPSBjOyB0aGlzLm5leHQgPSBudWxsOyB9XG5mdW5jdGlvbiBUZChhLCBiKSB7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiYnVmZmVyXCIsIHsgZ2V0OiBJYihmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLmdldEJ1ZmZlcigpOyB9LCBcIl93cml0YWJsZVN0YXRlLmJ1ZmZlciBpcyBkZXByZWNhdGVkLiBVc2UgX3dyaXRhYmxlU3RhdGUuZ2V0QnVmZmVyIGluc3RlYWQuXCIpIH0pO1xuICAgIGEgPSBhIHx8IHt9O1xuICAgIHRoaXMub2JqZWN0TW9kZSA9ICEhYS5vYmplY3RNb2RlO1xuICAgIGIgaW5zdGFuY2VvZiBWICYmICh0aGlzLm9iamVjdE1vZGUgPSB0aGlzLm9iamVjdE1vZGUgfHwgISFhLndyaXRhYmxlT2JqZWN0TW9kZSk7XG4gICAgdmFyIGMgPSBhLmhpZ2hXYXRlck1hcmssIGQgPSB0aGlzLm9iamVjdE1vZGUgPyAxNiA6IDE2Mzg0O1xuICAgIHRoaXMuaGlnaFdhdGVyTWFyayA9IGMgfHwgMCA9PT0gYyA/IGMgOiBkO1xuICAgIHRoaXMuaGlnaFdhdGVyTWFyayA9IH5+dGhpcy5oaWdoV2F0ZXJNYXJrO1xuICAgIHRoaXMuZmluaXNoZWQgPSB0aGlzLmVuZGVkID0gdGhpcy5lbmRpbmcgPSB0aGlzLm5lZWREcmFpbiA9ICExO1xuICAgIHRoaXMuZGVjb2RlU3RyaW5ncyA9ICExICE9PSBhLmRlY29kZVN0cmluZ3M7XG4gICAgdGhpcy5kZWZhdWx0RW5jb2RpbmcgPSBhLmRlZmF1bHRFbmNvZGluZyB8fCBcInV0ZjhcIjtcbiAgICB0aGlzLmxlbmd0aCA9IDA7XG4gICAgdGhpcy53cml0aW5nID0gITE7XG4gICAgdGhpcy5jb3JrZWQgPSAwO1xuICAgIHRoaXMuc3luYyA9ICEwO1xuICAgIHRoaXMuYnVmZmVyUHJvY2Vzc2luZyA9ICExO1xuICAgIHRoaXMub253cml0ZSA9IGZ1bmN0aW9uIChhKSB7IHZhciBjID0gYi5fd3JpdGFibGVTdGF0ZSwgZCA9IGMuc3luYywgZSA9IGMud3JpdGVjYjsgYy53cml0aW5nID0gITE7IGMud3JpdGVjYiA9IG51bGw7IGMubGVuZ3RoIC09IGMud3JpdGVsZW47IGMud3JpdGVsZW4gPSAwOyBhID8gKC0tYy5wZW5kaW5nY2IsIGQgPyBHKGUsIGEpIDogZShhKSwgYi5fd3JpdGFibGVTdGF0ZS5lcnJvckVtaXR0ZWQgPSAhMCwgYi5lbWl0KFwiZXJyb3JcIiwgYSkpIDogKChhID0gV2QoYykpIHx8IGMuY29ya2VkIHx8IGMuYnVmZmVyUHJvY2Vzc2luZyB8fCAhYy5idWZmZXJlZFJlcXVlc3QgfHwgWGQoYiwgYyksIGQgPyBHKFlkLCBiLCBjLCBhLCBlKSA6IFlkKGIsIGMsIGEsIGUpKTsgfTtcbiAgICB0aGlzLndyaXRlY2IgPSBudWxsO1xuICAgIHRoaXMud3JpdGVsZW4gPSAwO1xuICAgIHRoaXMubGFzdEJ1ZmZlcmVkUmVxdWVzdCA9XG4gICAgICAgIHRoaXMuYnVmZmVyZWRSZXF1ZXN0ID0gbnVsbDtcbiAgICB0aGlzLnBlbmRpbmdjYiA9IDA7XG4gICAgdGhpcy5lcnJvckVtaXR0ZWQgPSB0aGlzLnByZWZpbmlzaGVkID0gITE7XG4gICAgdGhpcy5idWZmZXJlZFJlcXVlc3RDb3VudCA9IDA7XG4gICAgdGhpcy5jb3JrZWRSZXF1ZXN0c0ZyZWUgPSBuZXcgWmQodGhpcyk7XG59XG5UZC5wcm90b3R5cGUuZ2V0QnVmZmVyID0gZnVuY3Rpb24gKCkgeyBmb3IgKHZhciBhID0gdGhpcy5idWZmZXJlZFJlcXVlc3QsIGIgPSBbXTsgYTspXG4gICAgYi5wdXNoKGEpLCBhID0gYS5uZXh0OyByZXR1cm4gYjsgfTtcbmZ1bmN0aW9uIFcoYSkgeyBpZiAoISh0aGlzIGluc3RhbmNlb2YgVyB8fCB0aGlzIGluc3RhbmNlb2YgVikpXG4gICAgcmV0dXJuIG5ldyBXKGEpOyB0aGlzLl93cml0YWJsZVN0YXRlID0gbmV3IFRkKGEsIHRoaXMpOyB0aGlzLndyaXRhYmxlID0gITA7IGEgJiYgKFwiZnVuY3Rpb25cIiA9PT0gdHlwZW9mIGEud3JpdGUgJiYgKHRoaXMuX3dyaXRlID0gYS53cml0ZSksIFwiZnVuY3Rpb25cIiA9PT0gdHlwZW9mIGEud3JpdGV2ICYmICh0aGlzLl93cml0ZXYgPSBhLndyaXRldikpOyBPLmNhbGwodGhpcyk7IH1cblcucHJvdG90eXBlLnBpcGUgPSBmdW5jdGlvbiAoKSB7IHRoaXMuZW1pdChcImVycm9yXCIsIEVycm9yKFwiQ2Fubm90IHBpcGUsIG5vdCByZWFkYWJsZVwiKSk7IH07XG5XLnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7XG4gICAgdmFyIGQgPSB0aGlzLl93cml0YWJsZVN0YXRlLCBlID0gITE7XG4gICAgXCJmdW5jdGlvblwiID09PSB0eXBlb2YgYiAmJiAoYyA9IGIsIGIgPSBudWxsKTtcbiAgICB6LmlzQnVmZmVyKGEpID8gYiA9IFwiYnVmZmVyXCIgOiBiIHx8IChiID0gZC5kZWZhdWx0RW5jb2RpbmcpO1xuICAgIFwiZnVuY3Rpb25cIiAhPT0gdHlwZW9mIGMgJiYgKGMgPSBVZCk7XG4gICAgaWYgKGQuZW5kZWQpXG4gICAgICAgIGQgPSBjLCBhID0gRXJyb3IoXCJ3cml0ZSBhZnRlciBlbmRcIiksIHRoaXMuZW1pdChcImVycm9yXCIsIGEpLCBHKGQsIGEpO1xuICAgIGVsc2Uge1xuICAgICAgICB2YXIgZiA9IGMsIGcgPSAhMCwgaCA9ICExO1xuICAgICAgICBudWxsID09PSBhID8gaCA9IG5ldyBUeXBlRXJyb3IoXCJNYXkgbm90IHdyaXRlIG51bGwgdmFsdWVzIHRvIHN0cmVhbVwiKSA6IHouaXNCdWZmZXIoYSkgfHwgXCJzdHJpbmdcIiA9PT0gdHlwZW9mIGEgfHwgdm9pZCAwID09PSBhIHx8IGQub2JqZWN0TW9kZSB8fCAoaCA9IG5ldyBUeXBlRXJyb3IoXCJJbnZhbGlkIG5vbi1zdHJpbmcvYnVmZmVyIGNodW5rXCIpKTtcbiAgICAgICAgaCAmJiAodGhpcy5lbWl0KFwiZXJyb3JcIiwgaCksIEcoZiwgaCksIGcgPSAhMSk7XG4gICAgICAgIGcgJiYgKGQucGVuZGluZ2NiKyssXG4gICAgICAgICAgICBlID0gYiwgZC5vYmplY3RNb2RlIHx8ICExID09PSBkLmRlY29kZVN0cmluZ3MgfHwgXCJzdHJpbmdcIiAhPT0gdHlwZW9mIGEgfHwgKGEgPSB6LmZyb20oYSwgZSkpLCB6LmlzQnVmZmVyKGEpICYmIChlID0gXCJidWZmZXJcIiksIGYgPSBkLm9iamVjdE1vZGUgPyAxIDogYS5sZW5ndGgsIGQubGVuZ3RoICs9IGYsIGIgPSBkLmxlbmd0aCA8IGQuaGlnaFdhdGVyTWFyaywgYiB8fCAoZC5uZWVkRHJhaW4gPSAhMCksIGQud3JpdGluZyB8fCBkLmNvcmtlZCA/IChmID0gZC5sYXN0QnVmZmVyZWRSZXF1ZXN0LCBkLmxhc3RCdWZmZXJlZFJlcXVlc3QgPSBuZXcgVmQoYSwgZSwgYyksIGYgPyBmLm5leHQgPSBkLmxhc3RCdWZmZXJlZFJlcXVlc3QgOiBkLmJ1ZmZlcmVkUmVxdWVzdCA9IGQubGFzdEJ1ZmZlcmVkUmVxdWVzdCwgZC5idWZmZXJlZFJlcXVlc3RDb3VudCArPSAxKSA6ICRkKHRoaXMsIGQsICExLCBmLCBhLCBlLCBjKSwgZSA9IGIpO1xuICAgIH1cbiAgICByZXR1cm4gZTtcbn07XG5XLnByb3RvdHlwZS5jb3JrID0gZnVuY3Rpb24gKCkgeyB0aGlzLl93cml0YWJsZVN0YXRlLmNvcmtlZCsrOyB9O1xuVy5wcm90b3R5cGUudW5jb3JrID0gZnVuY3Rpb24gKCkgeyB2YXIgYSA9IHRoaXMuX3dyaXRhYmxlU3RhdGU7IGEuY29ya2VkICYmIChhLmNvcmtlZC0tLCBhLndyaXRpbmcgfHwgYS5jb3JrZWQgfHwgYS5maW5pc2hlZCB8fCBhLmJ1ZmZlclByb2Nlc3NpbmcgfHwgIWEuYnVmZmVyZWRSZXF1ZXN0IHx8IFhkKHRoaXMsIGEpKTsgfTtcblcucHJvdG90eXBlLnNldERlZmF1bHRFbmNvZGluZyA9IGZ1bmN0aW9uIChhKSB7IFwic3RyaW5nXCIgPT09IHR5cGVvZiBhICYmIChhID0gYS50b0xvd2VyQ2FzZSgpKTsgaWYgKCEoLTEgPCBcImhleCB1dGY4IHV0Zi04IGFzY2lpIGJpbmFyeSBiYXNlNjQgdWNzMiB1Y3MtMiB1dGYxNmxlIHV0Zi0xNmxlIHJhd1wiLnNwbGl0KFwiIFwiKS5pbmRleE9mKChhICsgXCJcIikudG9Mb3dlckNhc2UoKSkpKVxuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJVbmtub3duIGVuY29kaW5nOiBcIiArIGEpOyB0aGlzLl93cml0YWJsZVN0YXRlLmRlZmF1bHRFbmNvZGluZyA9IGE7IHJldHVybiB0aGlzOyB9O1xuZnVuY3Rpb24gJGQoYSwgYiwgYywgZCwgZSwgZiwgZykgeyBiLndyaXRlbGVuID0gZDsgYi53cml0ZWNiID0gZzsgYi53cml0aW5nID0gITA7IGIuc3luYyA9ICEwOyBjID8gYS5fd3JpdGV2KGUsIGIub253cml0ZSkgOiBhLl93cml0ZShlLCBmLCBiLm9ud3JpdGUpOyBiLnN5bmMgPSAhMTsgfVxuZnVuY3Rpb24gWWQoYSwgYiwgYywgZCkgeyAhYyAmJiAwID09PSBiLmxlbmd0aCAmJiBiLm5lZWREcmFpbiAmJiAoYi5uZWVkRHJhaW4gPSAhMSwgYS5lbWl0KFwiZHJhaW5cIikpOyBiLnBlbmRpbmdjYi0tOyBkKCk7IGFlKGEsIGIpOyB9XG5mdW5jdGlvbiBYZChhLCBiKSB7XG4gICAgYi5idWZmZXJQcm9jZXNzaW5nID0gITA7XG4gICAgdmFyIGMgPSBiLmJ1ZmZlcmVkUmVxdWVzdDtcbiAgICBpZiAoYS5fd3JpdGV2ICYmIGMgJiYgYy5uZXh0KSB7XG4gICAgICAgIHZhciBkID0gQXJyYXkoYi5idWZmZXJlZFJlcXVlc3RDb3VudCksIGUgPSBiLmNvcmtlZFJlcXVlc3RzRnJlZTtcbiAgICAgICAgZS5lbnRyeSA9IGM7XG4gICAgICAgIGZvciAodmFyIGYgPSAwOyBjOylcbiAgICAgICAgICAgIGRbZl0gPSBjLCBjID0gYy5uZXh0LCBmICs9IDE7XG4gICAgICAgICRkKGEsIGIsICEwLCBiLmxlbmd0aCwgZCwgXCJcIiwgZS5maW5pc2gpO1xuICAgICAgICBiLnBlbmRpbmdjYisrO1xuICAgICAgICBiLmxhc3RCdWZmZXJlZFJlcXVlc3QgPSBudWxsO1xuICAgICAgICBlLm5leHQgPyAoYi5jb3JrZWRSZXF1ZXN0c0ZyZWUgPSBlLm5leHQsIGUubmV4dCA9IG51bGwpIDogYi5jb3JrZWRSZXF1ZXN0c0ZyZWUgPSBuZXcgWmQoYik7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBmb3IgKDsgYyAmJiAoZCA9IGMuY2h1bmssICRkKGEsIGIsICExLCBiLm9iamVjdE1vZGUgPyAxIDogZC5sZW5ndGgsIGQsIGMuZW5jb2RpbmcsIGMuY2FsbGJhY2spLCBjID0gYy5uZXh0LCAhYi53cml0aW5nKTspXG4gICAgICAgICAgICA7XG4gICAgICAgIG51bGwgPT09IGMgJiYgKGIubGFzdEJ1ZmZlcmVkUmVxdWVzdCA9IG51bGwpO1xuICAgIH1cbiAgICBiLmJ1ZmZlcmVkUmVxdWVzdENvdW50ID1cbiAgICAgICAgMDtcbiAgICBiLmJ1ZmZlcmVkUmVxdWVzdCA9IGM7XG4gICAgYi5idWZmZXJQcm9jZXNzaW5nID0gITE7XG59XG5XLnByb3RvdHlwZS5fd3JpdGUgPSBmdW5jdGlvbiAoYSwgYiwgYykgeyBjKEVycm9yKFwibm90IGltcGxlbWVudGVkXCIpKTsgfTtcblcucHJvdG90eXBlLl93cml0ZXYgPSBudWxsO1xuVy5wcm90b3R5cGUuZW5kID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgdmFyIGQgPSB0aGlzLl93cml0YWJsZVN0YXRlOyBcImZ1bmN0aW9uXCIgPT09IHR5cGVvZiBhID8gKGMgPSBhLCBiID0gYSA9IG51bGwpIDogXCJmdW5jdGlvblwiID09PSB0eXBlb2YgYiAmJiAoYyA9IGIsIGIgPSBudWxsKTsgbnVsbCAhPT0gYSAmJiB2b2lkIDAgIT09IGEgJiYgdGhpcy53cml0ZShhLCBiKTsgZC5jb3JrZWQgJiYgKGQuY29ya2VkID0gMSwgdGhpcy51bmNvcmsoKSk7IGlmICghZC5lbmRpbmcgJiYgIWQuZmluaXNoZWQpIHtcbiAgICBhID0gYztcbiAgICBkLmVuZGluZyA9ICEwO1xuICAgIGFlKHRoaXMsIGQpO1xuICAgIGlmIChhKVxuICAgICAgICBpZiAoZC5maW5pc2hlZClcbiAgICAgICAgICAgIEcoYSk7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHRoaXMub25jZShcImZpbmlzaFwiLCBhKTtcbiAgICBkLmVuZGVkID0gITA7XG4gICAgdGhpcy53cml0YWJsZSA9ICExO1xufSB9O1xuZnVuY3Rpb24gV2QoYSkgeyByZXR1cm4gYS5lbmRpbmcgJiYgMCA9PT0gYS5sZW5ndGggJiYgbnVsbCA9PT0gYS5idWZmZXJlZFJlcXVlc3QgJiYgIWEuZmluaXNoZWQgJiYgIWEud3JpdGluZzsgfVxuZnVuY3Rpb24gYWUoYSwgYikgeyB2YXIgYyA9IFdkKGIpOyBjICYmICgwID09PSBiLnBlbmRpbmdjYiA/IChiLnByZWZpbmlzaGVkIHx8IChiLnByZWZpbmlzaGVkID0gITAsIGEuZW1pdChcInByZWZpbmlzaFwiKSksIGIuZmluaXNoZWQgPSAhMCwgYS5lbWl0KFwiZmluaXNoXCIpKSA6IGIucHJlZmluaXNoZWQgfHwgKGIucHJlZmluaXNoZWQgPSAhMCwgYS5lbWl0KFwicHJlZmluaXNoXCIpKSk7IHJldHVybiBjOyB9XG5mdW5jdGlvbiBaZChhKSB7IHZhciBiID0gdGhpczsgdGhpcy5lbnRyeSA9IHRoaXMubmV4dCA9IG51bGw7IHRoaXMuZmluaXNoID0gZnVuY3Rpb24gKGMpIHsgdmFyIGQgPSBiLmVudHJ5OyBmb3IgKGIuZW50cnkgPSBudWxsOyBkOykge1xuICAgIHZhciBlID0gZC5jYWxsYmFjaztcbiAgICBhLnBlbmRpbmdjYi0tO1xuICAgIGUoYyk7XG4gICAgZCA9IGQubmV4dDtcbn0gYS5jb3JrZWRSZXF1ZXN0c0ZyZWUgPyBhLmNvcmtlZFJlcXVlc3RzRnJlZS5uZXh0ID0gYiA6IGEuY29ya2VkUmVxdWVzdHNGcmVlID0gYjsgfTsgfVxuRGIoViwgUCk7XG5mb3IgKHZhciBiZSA9IE9iamVjdC5rZXlzKFcucHJvdG90eXBlKSwgY2UgPSAwOyBjZSA8IGJlLmxlbmd0aDsgY2UrKykge1xuICAgIHZhciBkZSA9IGJlW2NlXTtcbiAgICBWLnByb3RvdHlwZVtkZV0gfHwgKFYucHJvdG90eXBlW2RlXSA9IFcucHJvdG90eXBlW2RlXSk7XG59XG5mdW5jdGlvbiBWKGEpIHsgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFYpKVxuICAgIHJldHVybiBuZXcgVihhKTsgUC5jYWxsKHRoaXMsIGEpOyBXLmNhbGwodGhpcywgYSk7IGEgJiYgITEgPT09IGEucmVhZGFibGUgJiYgKHRoaXMucmVhZGFibGUgPSAhMSk7IGEgJiYgITEgPT09IGEud3JpdGFibGUgJiYgKHRoaXMud3JpdGFibGUgPSAhMSk7IHRoaXMuYWxsb3dIYWxmT3BlbiA9ICEwOyBhICYmICExID09PSBhLmFsbG93SGFsZk9wZW4gJiYgKHRoaXMuYWxsb3dIYWxmT3BlbiA9ICExKTsgdGhpcy5vbmNlKFwiZW5kXCIsIGVlKTsgfVxuZnVuY3Rpb24gZWUoKSB7IHRoaXMuYWxsb3dIYWxmT3BlbiB8fCB0aGlzLl93cml0YWJsZVN0YXRlLmVuZGVkIHx8IEcoZmUsIHRoaXMpOyB9XG5mdW5jdGlvbiBmZShhKSB7IGEuZW5kKCk7IH1cbkRiKFgsIFYpO1xuZnVuY3Rpb24gZ2UoYSkgeyB0aGlzLmFmdGVyVHJhbnNmb3JtID0gZnVuY3Rpb24gKGIsIGMpIHsgdmFyIGQgPSBhLl90cmFuc2Zvcm1TdGF0ZTsgZC50cmFuc2Zvcm1pbmcgPSAhMTsgdmFyIGUgPSBkLndyaXRlY2I7IGUgPyAoZC53cml0ZWNodW5rID0gbnVsbCwgZC53cml0ZWNiID0gbnVsbCwgbnVsbCAhPT0gYyAmJiB2b2lkIDAgIT09IGMgJiYgYS5wdXNoKGMpLCBlKGIpLCBiID0gYS5fcmVhZGFibGVTdGF0ZSwgYi5yZWFkaW5nID0gITEsIChiLm5lZWRSZWFkYWJsZSB8fCBiLmxlbmd0aCA8IGIuaGlnaFdhdGVyTWFyaykgJiYgYS5fcmVhZChiLmhpZ2hXYXRlck1hcmspLCBiID0gdm9pZCAwKSA6IGIgPSBhLmVtaXQoXCJlcnJvclwiLCBFcnJvcihcIm5vIHdyaXRlY2IgaW4gVHJhbnNmb3JtIGNsYXNzXCIpKTsgcmV0dXJuIGI7IH07IHRoaXMudHJhbnNmb3JtaW5nID0gdGhpcy5uZWVkVHJhbnNmb3JtID0gITE7IHRoaXMud3JpdGVlbmNvZGluZyA9IHRoaXMud3JpdGVjaHVuayA9IHRoaXMud3JpdGVjYiA9IG51bGw7IH1cbmZ1bmN0aW9uIFgoYSkgeyBpZiAoISh0aGlzIGluc3RhbmNlb2YgWCkpXG4gICAgcmV0dXJuIG5ldyBYKGEpOyBWLmNhbGwodGhpcywgYSk7IHRoaXMuX3RyYW5zZm9ybVN0YXRlID0gbmV3IGdlKHRoaXMpOyB2YXIgYiA9IHRoaXM7IHRoaXMuX3JlYWRhYmxlU3RhdGUubmVlZFJlYWRhYmxlID0gITA7IHRoaXMuX3JlYWRhYmxlU3RhdGUuc3luYyA9ICExOyBhICYmIChcImZ1bmN0aW9uXCIgPT09IHR5cGVvZiBhLnRyYW5zZm9ybSAmJiAodGhpcy5fdHJhbnNmb3JtID0gYS50cmFuc2Zvcm0pLCBcImZ1bmN0aW9uXCIgPT09IHR5cGVvZiBhLmZsdXNoICYmICh0aGlzLl9mbHVzaCA9IGEuZmx1c2gpKTsgdGhpcy5vbmNlKFwicHJlZmluaXNoXCIsIGZ1bmN0aW9uICgpIHsgXCJmdW5jdGlvblwiID09PSB0eXBlb2YgdGhpcy5fZmx1c2ggPyB0aGlzLl9mbHVzaChmdW5jdGlvbiAoYSkgeyBoZShiLCBhKTsgfSkgOiBoZShiKTsgfSk7IH1cblgucHJvdG90eXBlLnB1c2ggPSBmdW5jdGlvbiAoYSwgYikgeyB0aGlzLl90cmFuc2Zvcm1TdGF0ZS5uZWVkVHJhbnNmb3JtID0gITE7IHJldHVybiBWLnByb3RvdHlwZS5wdXNoLmNhbGwodGhpcywgYSwgYik7IH07XG5YLnByb3RvdHlwZS5fdHJhbnNmb3JtID0gZnVuY3Rpb24gKCkgeyB0aHJvdyBFcnJvcihcIk5vdCBpbXBsZW1lbnRlZFwiKTsgfTtcblgucHJvdG90eXBlLl93cml0ZSA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7IHZhciBkID0gdGhpcy5fdHJhbnNmb3JtU3RhdGU7IGQud3JpdGVjYiA9IGM7IGQud3JpdGVjaHVuayA9IGE7IGQud3JpdGVlbmNvZGluZyA9IGI7IGQudHJhbnNmb3JtaW5nIHx8IChhID0gdGhpcy5fcmVhZGFibGVTdGF0ZSwgKGQubmVlZFRyYW5zZm9ybSB8fCBhLm5lZWRSZWFkYWJsZSB8fCBhLmxlbmd0aCA8IGEuaGlnaFdhdGVyTWFyaykgJiYgdGhpcy5fcmVhZChhLmhpZ2hXYXRlck1hcmspKTsgfTtcblgucHJvdG90eXBlLl9yZWFkID0gZnVuY3Rpb24gKCkgeyB2YXIgYSA9IHRoaXMuX3RyYW5zZm9ybVN0YXRlOyBudWxsICE9PSBhLndyaXRlY2h1bmsgJiYgYS53cml0ZWNiICYmICFhLnRyYW5zZm9ybWluZyA/IChhLnRyYW5zZm9ybWluZyA9ICEwLCB0aGlzLl90cmFuc2Zvcm0oYS53cml0ZWNodW5rLCBhLndyaXRlZW5jb2RpbmcsIGEuYWZ0ZXJUcmFuc2Zvcm0pKSA6IGEubmVlZFRyYW5zZm9ybSA9ICEwOyB9O1xuZnVuY3Rpb24gaGUoYSwgYikgeyBpZiAoYilcbiAgICByZXR1cm4gYS5lbWl0KFwiZXJyb3JcIiwgYik7IGIgPSBhLl90cmFuc2Zvcm1TdGF0ZTsgaWYgKGEuX3dyaXRhYmxlU3RhdGUubGVuZ3RoKVxuICAgIHRocm93IEVycm9yKFwiQ2FsbGluZyB0cmFuc2Zvcm0gZG9uZSB3aGVuIHdzLmxlbmd0aCAhPSAwXCIpOyBpZiAoYi50cmFuc2Zvcm1pbmcpXG4gICAgdGhyb3cgRXJyb3IoXCJDYWxsaW5nIHRyYW5zZm9ybSBkb25lIHdoZW4gc3RpbGwgdHJhbnNmb3JtaW5nXCIpOyByZXR1cm4gYS5wdXNoKG51bGwpOyB9XG5EYihpZSwgWCk7XG5mdW5jdGlvbiBpZShhKSB7IGlmICghKHRoaXMgaW5zdGFuY2VvZiBpZSkpXG4gICAgcmV0dXJuIG5ldyBpZShhKTsgWC5jYWxsKHRoaXMsIGEpOyB9XG5pZS5wcm90b3R5cGUuX3RyYW5zZm9ybSA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7IGMobnVsbCwgYSk7IH07XG5EYihZLCBPKTtcblkuUmVhZGFibGUgPSBQO1xuWS5Xcml0YWJsZSA9IFc7XG5ZLkR1cGxleCA9IFY7XG5ZLlRyYW5zZm9ybSA9IFg7XG5ZLlBhc3NUaHJvdWdoID0gaWU7XG5ZLlN0cmVhbSA9IFk7XG5mdW5jdGlvbiBZKCkgeyBPLmNhbGwodGhpcyk7IH1cblkucHJvdG90eXBlLnBpcGUgPSBmdW5jdGlvbiAoYSwgYikge1xuICAgIGZ1bmN0aW9uIGMoYikgeyBhLndyaXRhYmxlICYmICExID09PSBhLndyaXRlKGIpICYmIGsucGF1c2UgJiYgay5wYXVzZSgpOyB9XG4gICAgZnVuY3Rpb24gZCgpIHsgay5yZWFkYWJsZSAmJiBrLnJlc3VtZSAmJiBrLnJlc3VtZSgpOyB9XG4gICAgZnVuY3Rpb24gZSgpIHsgcCB8fCAocCA9ICEwLCBhLmVuZCgpKTsgfVxuICAgIGZ1bmN0aW9uIGYoKSB7IHAgfHwgKHAgPSAhMCwgXCJmdW5jdGlvblwiID09PSB0eXBlb2YgYS5kZXN0cm95ICYmIGEuZGVzdHJveSgpKTsgfVxuICAgIGZ1bmN0aW9uIGcoYSkgeyBoKCk7IGlmICgwID09PSBPLmxpc3RlbmVyQ291bnQodGhpcywgXCJlcnJvclwiKSlcbiAgICAgICAgdGhyb3cgYTsgfVxuICAgIGZ1bmN0aW9uIGgoKSB7XG4gICAgICAgIGsucmVtb3ZlTGlzdGVuZXIoXCJkYXRhXCIsIGMpO1xuICAgICAgICBhLnJlbW92ZUxpc3RlbmVyKFwiZHJhaW5cIiwgZCk7XG4gICAgICAgIGsucmVtb3ZlTGlzdGVuZXIoXCJlbmRcIiwgZSk7XG4gICAgICAgIGsucmVtb3ZlTGlzdGVuZXIoXCJjbG9zZVwiLCBmKTtcbiAgICAgICAgay5yZW1vdmVMaXN0ZW5lcihcImVycm9yXCIsIGcpO1xuICAgICAgICBhLnJlbW92ZUxpc3RlbmVyKFwiZXJyb3JcIiwgZyk7XG4gICAgICAgIGsucmVtb3ZlTGlzdGVuZXIoXCJlbmRcIiwgaCk7XG4gICAgICAgIGsucmVtb3ZlTGlzdGVuZXIoXCJjbG9zZVwiLCBoKTtcbiAgICAgICAgYS5yZW1vdmVMaXN0ZW5lcihcImNsb3NlXCIsIGgpO1xuICAgIH1cbiAgICB2YXIgayA9IHRoaXM7XG4gICAgay5vbihcImRhdGFcIiwgYyk7XG4gICAgYS5vbihcImRyYWluXCIsIGQpO1xuICAgIGEuX2lzU3RkaW8gfHwgYiAmJiAhMSA9PT0gYi5lbmQgfHwgKGsub24oXCJlbmRcIiwgZSksIGsub24oXCJjbG9zZVwiLCBmKSk7XG4gICAgdmFyIHAgPSAhMTtcbiAgICBrLm9uKFwiZXJyb3JcIiwgZyk7XG4gICAgYS5vbihcImVycm9yXCIsIGcpO1xuICAgIGsub24oXCJlbmRcIiwgaCk7XG4gICAgay5vbihcImNsb3NlXCIsIGgpO1xuICAgIGEub24oXCJjbG9zZVwiLCBoKTtcbiAgICBhLmVtaXQoXCJwaXBlXCIsIGspO1xuICAgIHJldHVybiBhO1xufTtcbnZhciBqZSA9IEFycmF5LnByb3RvdHlwZS5zbGljZSwgbGUgPSB7IGV4dGVuZDogZnVuY3Rpb24ga2UoYSwgYikgeyBmb3IgKHZhciBkIGluIGIpXG4gICAgICAgIGFbZF0gPSBiW2RdOyByZXR1cm4gMyA+IGFyZ3VtZW50cy5sZW5ndGggPyBhIDoga2UuYXBwbHkobnVsbCwgW2FdLmNvbmNhdChqZS5jYWxsKGFyZ3VtZW50cywgMikpKTsgfSB9LCBtZSA9IHUoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICBmdW5jdGlvbiBjKGEsIGIsIGMpIHsgdm9pZCAwID09PSBjICYmIChjID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGE7IH0pOyByZXR1cm4gZnVuY3Rpb24gKCkgeyBmb3IgKHZhciBlID0gW10sIGYgPSAwOyBmIDwgYXJndW1lbnRzLmxlbmd0aDsgZisrKVxuICAgICAgICBlW2ZdID0gYXJndW1lbnRzW2ZdOyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKGYsIGcpIHsgYVtiXS5iaW5kKGEpLmFwcGx5KHZvaWQgMCwgZChlLCBbZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGEgPyBnKGEpIDogZihjKGIpKTsgfV0pKTsgfSk7IH07IH1cbiAgICB2YXIgZCA9IGwgJiYgbC5fX3NwcmVhZEFycmF5cyB8fCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZvciAodmFyIGEgPSAwLCBiID0gMCwgYyA9IGFyZ3VtZW50cy5sZW5ndGg7IGIgPCBjOyBiKyspXG4gICAgICAgICAgICBhICs9XG4gICAgICAgICAgICAgICAgYXJndW1lbnRzW2JdLmxlbmd0aDtcbiAgICAgICAgYSA9IEFycmF5KGEpO1xuICAgICAgICB2YXIgZCA9IDA7XG4gICAgICAgIGZvciAoYiA9IDA7IGIgPCBjOyBiKyspXG4gICAgICAgICAgICBmb3IgKHZhciBlID0gYXJndW1lbnRzW2JdLCBuID0gMCwgcSA9IGUubGVuZ3RoOyBuIDwgcTsgbisrLCBkKyspXG4gICAgICAgICAgICAgICAgYVtkXSA9IGVbbl07XG4gICAgICAgIHJldHVybiBhO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGIsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiAhMCB9KTtcbiAgICB2YXIgZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gYShhLCBiKSB7IHRoaXMudm9sID0gYTsgdGhpcy5mZCA9IGI7IH1cbiAgICAgICAgYS5wcm90b3R5cGUuYXBwZW5kRmlsZSA9IGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBjKHRoaXMudm9sLCBcImFwcGVuZEZpbGVcIikodGhpcy5mZCwgYSwgYik7IH07XG4gICAgICAgIGEucHJvdG90eXBlLmNobW9kID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGModGhpcy52b2wsIFwiZmNobW9kXCIpKHRoaXMuZmQsIGEpOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5jaG93biA9IGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBjKHRoaXMudm9sLCBcImZjaG93blwiKSh0aGlzLmZkLCBhLCBiKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gYyh0aGlzLnZvbCwgXCJjbG9zZVwiKSh0aGlzLmZkKTtcbiAgICAgICAgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuZGF0YXN5bmMgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBjKHRoaXMudm9sLCBcImZkYXRhc3luY1wiKSh0aGlzLmZkKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUucmVhZCA9IGZ1bmN0aW9uIChhLCBiLCBkLCBlKSB7IHJldHVybiBjKHRoaXMudm9sLCBcInJlYWRcIiwgZnVuY3Rpb24gKGIpIHsgcmV0dXJuIHsgYnl0ZXNSZWFkOiBiLCBidWZmZXI6IGEgfTsgfSkodGhpcy5mZCwgYSwgYiwgZCwgZSk7IH07XG4gICAgICAgIGEucHJvdG90eXBlLnJlYWRGaWxlID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGModGhpcy52b2wsIFwicmVhZEZpbGVcIikodGhpcy5mZCwgYSk7IH07XG4gICAgICAgIGEucHJvdG90eXBlLnN0YXQgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gYyh0aGlzLnZvbCwgXCJmc3RhdFwiKSh0aGlzLmZkLCBhKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuc3luYyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGModGhpcy52b2wsIFwiZnN5bmNcIikodGhpcy5mZCk7IH07XG4gICAgICAgIGEucHJvdG90eXBlLnRydW5jYXRlID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGModGhpcy52b2wsIFwiZnRydW5jYXRlXCIpKHRoaXMuZmQsIGEpOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS51dGltZXMgPVxuICAgICAgICAgICAgZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGModGhpcy52b2wsIFwiZnV0aW1lc1wiKSh0aGlzLmZkLCBhLCBiKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUud3JpdGUgPSBmdW5jdGlvbiAoYSwgYiwgZCwgZSkgeyByZXR1cm4gYyh0aGlzLnZvbCwgXCJ3cml0ZVwiLCBmdW5jdGlvbiAoYikgeyByZXR1cm4geyBieXRlc1dyaXR0ZW46IGIsIGJ1ZmZlcjogYSB9OyB9KSh0aGlzLmZkLCBhLCBiLCBkLCBlKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUud3JpdGVGaWxlID0gZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGModGhpcy52b2wsIFwid3JpdGVGaWxlXCIpKHRoaXMuZmQsIGEsIGIpOyB9O1xuICAgICAgICByZXR1cm4gYTtcbiAgICB9KCk7XG4gICAgYi5GaWxlSGFuZGxlID0gZTtcbiAgICBiLmRlZmF1bHQgPSBmdW5jdGlvbiAoYSkge1xuICAgICAgICByZXR1cm4gXCJ1bmRlZmluZWRcIiA9PT0gdHlwZW9mIFByb21pc2UgPyBudWxsIDogeyBGaWxlSGFuZGxlOiBlLCBhY2Nlc3M6IGZ1bmN0aW9uIChiLCBkKSB7IHJldHVybiBjKGEsIFwiYWNjZXNzXCIpKGIsIGQpOyB9LCBhcHBlbmRGaWxlOiBmdW5jdGlvbiAoYiwgZCwgZikgeyByZXR1cm4gYyhhLCBcImFwcGVuZEZpbGVcIikoYiBpbnN0YW5jZW9mIGUgPyBiLmZkIDogYiwgZCwgZik7IH0sIGNobW9kOiBmdW5jdGlvbiAoYiwgZCkgeyByZXR1cm4gYyhhLCBcImNobW9kXCIpKGIsIGQpOyB9LCBjaG93bjogZnVuY3Rpb24gKGIsIGQsIGUpIHsgcmV0dXJuIGMoYSwgXCJjaG93blwiKShiLCBkLCBlKTsgfSwgY29weUZpbGU6IGZ1bmN0aW9uIChiLCBkLCBlKSB7IHJldHVybiBjKGEsIFwiY29weUZpbGVcIikoYiwgZCwgZSk7IH0sIGxjaG1vZDogZnVuY3Rpb24gKGIsIGQpIHsgcmV0dXJuIGMoYSwgXCJsY2htb2RcIikoYiwgZCk7IH0sIGxjaG93bjogZnVuY3Rpb24gKGIsIGQsIGUpIHsgcmV0dXJuIGMoYSwgXCJsY2hvd25cIikoYiwgZCwgZSk7IH0sIGxpbms6IGZ1bmN0aW9uIChiLCBkKSB7IHJldHVybiBjKGEsIFwibGlua1wiKShiLCBkKTsgfSwgbHN0YXQ6IGZ1bmN0aW9uIChiLCBkKSB7IHJldHVybiBjKGEsIFwibHN0YXRcIikoYiwgZCk7IH0sIG1rZGlyOiBmdW5jdGlvbiAoYiwgZCkgeyByZXR1cm4gYyhhLCBcIm1rZGlyXCIpKGIsIGQpOyB9LCBta2R0ZW1wOiBmdW5jdGlvbiAoYiwgZCkgeyByZXR1cm4gYyhhLCBcIm1rZHRlbXBcIikoYiwgZCk7IH0sIG9wZW46IGZ1bmN0aW9uIChiLCBkLCBmKSB7IHJldHVybiBjKGEsIFwib3BlblwiLCBmdW5jdGlvbiAoYikgeyByZXR1cm4gbmV3IGUoYSwgYik7IH0pKGIsIGQsIGYpOyB9LCByZWFkZGlyOiBmdW5jdGlvbiAoYiwgZCkgeyByZXR1cm4gYyhhLCBcInJlYWRkaXJcIikoYiwgZCk7IH0sIHJlYWRGaWxlOiBmdW5jdGlvbiAoYiwgZCkgeyByZXR1cm4gYyhhLCBcInJlYWRGaWxlXCIpKGIgaW5zdGFuY2VvZiBlID8gYi5mZCA6IGIsIGQpOyB9LCByZWFkbGluazogZnVuY3Rpb24gKGIsIGQpIHsgcmV0dXJuIGMoYSwgXCJyZWFkbGlua1wiKShiLCBkKTsgfSwgcmVhbHBhdGg6IGZ1bmN0aW9uIChiLCBkKSB7IHJldHVybiBjKGEsIFwicmVhbHBhdGhcIikoYiwgZCk7IH0sIHJlbmFtZTogZnVuY3Rpb24gKGIsIGQpIHsgcmV0dXJuIGMoYSwgXCJyZW5hbWVcIikoYiwgZCk7IH0sIHJtZGlyOiBmdW5jdGlvbiAoYikgeyByZXR1cm4gYyhhLCBcInJtZGlyXCIpKGIpOyB9LCBzdGF0OiBmdW5jdGlvbiAoYiwgZCkgeyByZXR1cm4gYyhhLCBcInN0YXRcIikoYiwgZCk7IH0sIHN5bWxpbms6IGZ1bmN0aW9uIChiLCBkLCBlKSB7IHJldHVybiBjKGEsIFwic3ltbGlua1wiKShiLCBkLCBlKTsgfSwgdHJ1bmNhdGU6IGZ1bmN0aW9uIChiLCBkKSB7IHJldHVybiBjKGEsIFwidHJ1bmNhdGVcIikoYiwgZCk7IH0sIHVubGluazogZnVuY3Rpb24gKGIpIHsgcmV0dXJuIGMoYSwgXCJ1bmxpbmtcIikoYik7IH0sIHV0aW1lczogZnVuY3Rpb24gKGIsIGQsIGUpIHsgcmV0dXJuIGMoYSwgXCJ1dGltZXNcIikoYiwgZCwgZSk7IH0sIHdyaXRlRmlsZTogZnVuY3Rpb24gKGIsIGQsIGYpIHsgcmV0dXJuIGMoYSwgXCJ3cml0ZUZpbGVcIikoYiBpbnN0YW5jZW9mIGUgPyBiLmZkIDogYiwgZCwgZik7IH0gfTtcbiAgICB9O1xufSk7XG50KG1lKTtcbnZhciBuZSA9IC9bXlxceDIwLVxceDdFXS8sIG9lID0gL1tcXHgyRVxcdTMwMDJcXHVGRjBFXFx1RkY2MV0vZywgcGUgPSB7IG92ZXJmbG93OiBcIk92ZXJmbG93OiBpbnB1dCBuZWVkcyB3aWRlciBpbnRlZ2VycyB0byBwcm9jZXNzXCIsIFwibm90LWJhc2ljXCI6IFwiSWxsZWdhbCBpbnB1dCA+PSAweDgwIChub3QgYSBiYXNpYyBjb2RlIHBvaW50KVwiLCBcImludmFsaWQtaW5wdXRcIjogXCJJbnZhbGlkIGlucHV0XCIgfSwgcWUgPSBNYXRoLmZsb29yLCByZSA9IFN0cmluZy5mcm9tQ2hhckNvZGU7XG5mdW5jdGlvbiBzZShhLCBiKSB7IHZhciBjID0gYS5zcGxpdChcIkBcIiksIGQgPSBcIlwiOyAxIDwgYy5sZW5ndGggJiYgKGQgPSBjWzBdICsgXCJAXCIsIGEgPSBjWzFdKTsgYSA9IGEucmVwbGFjZShvZSwgXCIuXCIpOyBhID0gYS5zcGxpdChcIi5cIik7IGMgPSBhLmxlbmd0aDsgZm9yICh2YXIgZSA9IFtdOyBjLS07KVxuICAgIGVbY10gPSBiKGFbY10pOyBiID0gZS5qb2luKFwiLlwiKTsgcmV0dXJuIGQgKyBiOyB9XG5mdW5jdGlvbiB0ZShhLCBiKSB7IHJldHVybiBhICsgMjIgKyA3NSAqICgyNiA+IGEpIC0gKCgwICE9IGIpIDw8IDUpOyB9XG5mdW5jdGlvbiB1ZShhKSB7XG4gICAgcmV0dXJuIHNlKGEsIGZ1bmN0aW9uIChhKSB7XG4gICAgICAgIGlmIChuZS50ZXN0KGEpKSB7XG4gICAgICAgICAgICB2YXIgYjtcbiAgICAgICAgICAgIHZhciBkID0gW107XG4gICAgICAgICAgICB2YXIgZSA9IFtdO1xuICAgICAgICAgICAgdmFyIGYgPSAwO1xuICAgICAgICAgICAgZm9yIChiID0gYS5sZW5ndGg7IGYgPCBiOykge1xuICAgICAgICAgICAgICAgIHZhciBnID0gYS5jaGFyQ29kZUF0KGYrKyk7XG4gICAgICAgICAgICAgICAgaWYgKDU1Mjk2IDw9IGcgJiYgNTYzMTkgPj0gZyAmJiBmIDwgYikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaCA9IGEuY2hhckNvZGVBdChmKyspO1xuICAgICAgICAgICAgICAgICAgICA1NjMyMCA9PSAoaCAmIDY0NTEyKSA/IGUucHVzaCgoKGcgJiAxMDIzKSA8PCAxMCkgKyAoaCAmIDEwMjMpICsgNjU1MzYpIDogKGUucHVzaChnKSwgZi0tKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICBlLnB1c2goZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhID0gZTtcbiAgICAgICAgICAgIGggPSBhLmxlbmd0aDtcbiAgICAgICAgICAgIGUgPSAxMjg7XG4gICAgICAgICAgICB2YXIgayA9IDA7XG4gICAgICAgICAgICB2YXIgcCA9IDcyO1xuICAgICAgICAgICAgZm9yIChnID0gMDsgZyA8IGg7ICsrZykge1xuICAgICAgICAgICAgICAgIHZhciBuID0gYVtnXTtcbiAgICAgICAgICAgICAgICAxMjggPiBuICYmIGQucHVzaChyZShuKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKChmID0gYiA9IGQubGVuZ3RoKSAmJiBkLnB1c2goXCItXCIpOyBmIDwgaDspIHtcbiAgICAgICAgICAgICAgICB2YXIgcSA9IDIxNDc0ODM2NDc7XG4gICAgICAgICAgICAgICAgZm9yIChnID0gMDsgZyA8IGg7ICsrZylcbiAgICAgICAgICAgICAgICAgICAgbiA9IGFbZ10sIG4gPj0gZSAmJiBuIDwgcSAmJiAocSA9IG4pO1xuICAgICAgICAgICAgICAgIHZhciBCID0gZiArIDE7XG4gICAgICAgICAgICAgICAgaWYgKHEgLSBlID4gcWUoKDIxNDc0ODM2NDcgLSBrKSAvIEIpKVxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcihwZS5vdmVyZmxvdyk7XG4gICAgICAgICAgICAgICAgayArPSAocSAtIGUpICogQjtcbiAgICAgICAgICAgICAgICBlID0gcTtcbiAgICAgICAgICAgICAgICBmb3IgKGcgPSAwOyBnIDwgaDsgKytnKSB7XG4gICAgICAgICAgICAgICAgICAgIG4gPSBhW2ddO1xuICAgICAgICAgICAgICAgICAgICBpZiAobiA8IGUgJiYgMjE0NzQ4MzY0NyA8ICsraylcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKHBlLm92ZXJmbG93KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG4gPT0gZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG0gPSBrO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChxID0gMzY7OyBxICs9IDM2KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbiA9IHEgPD0gcCA/IDEgOiBxID49IHAgKyAyNiA/IDI2IDogcSAtIHA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG0gPCBuKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdiA9IG0gLSBuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0gPSAzNiAtIG47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5wdXNoKHJlKHRlKG4gKyB2ICUgbSwgMCkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtID0gcWUodiAvIG0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZC5wdXNoKHJlKHRlKG0sIDApKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwID0gQjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHEgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgayA9IGYgPT0gYiA/IHFlKGsgLyA3MDApIDogayA+PiAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChrICs9IHFlKGsgLyBwKTsgNDU1IDwgazsgcSArPSAzNilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrID0gcWUoayAvIDM1KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHAgPSBxZShxICsgMzYgKiBrIC8gKGsgKyAzOCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgayA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICArK2Y7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKytrO1xuICAgICAgICAgICAgICAgICsrZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGQgPSBcInhuLS1cIiArIGQuam9pbihcIlwiKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgICAgICBkID0gYTtcbiAgICAgICAgcmV0dXJuIGQ7XG4gICAgfSk7XG59XG52YXIgdmUgPSBBcnJheS5pc0FycmF5IHx8IGZ1bmN0aW9uIChhKSB7IHJldHVybiBcIltvYmplY3QgQXJyYXldXCIgPT09IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChhKTsgfTtcbmZ1bmN0aW9uIHdlKGEpIHsgc3dpdGNoICh0eXBlb2YgYSkge1xuICAgIGNhc2UgXCJzdHJpbmdcIjogcmV0dXJuIGE7XG4gICAgY2FzZSBcImJvb2xlYW5cIjogcmV0dXJuIGEgPyBcInRydWVcIiA6IFwiZmFsc2VcIjtcbiAgICBjYXNlIFwibnVtYmVyXCI6IHJldHVybiBpc0Zpbml0ZShhKSA/IGEgOiBcIlwiO1xuICAgIGRlZmF1bHQ6IHJldHVybiBcIlwiO1xufSB9XG5mdW5jdGlvbiB4ZShhLCBiLCBjLCBkKSB7IGIgPSBiIHx8IFwiJlwiOyBjID0gYyB8fCBcIj1cIjsgbnVsbCA9PT0gYSAmJiAoYSA9IHZvaWQgMCk7IHJldHVybiBcIm9iamVjdFwiID09PSB0eXBlb2YgYSA/IHllKHplKGEpLCBmdW5jdGlvbiAoZCkgeyB2YXIgZSA9IGVuY29kZVVSSUNvbXBvbmVudCh3ZShkKSkgKyBjOyByZXR1cm4gdmUoYVtkXSkgPyB5ZShhW2RdLCBmdW5jdGlvbiAoYSkgeyByZXR1cm4gZSArIGVuY29kZVVSSUNvbXBvbmVudCh3ZShhKSk7IH0pLmpvaW4oYikgOiBlICsgZW5jb2RlVVJJQ29tcG9uZW50KHdlKGFbZF0pKTsgfSkuam9pbihiKSA6IGQgPyBlbmNvZGVVUklDb21wb25lbnQod2UoZCkpICsgYyArIGVuY29kZVVSSUNvbXBvbmVudCh3ZShhKSkgOiBcIlwiOyB9XG5mdW5jdGlvbiB5ZShhLCBiKSB7IGlmIChhLm1hcClcbiAgICByZXR1cm4gYS5tYXAoYik7IGZvciAodmFyIGMgPSBbXSwgZCA9IDA7IGQgPCBhLmxlbmd0aDsgZCsrKVxuICAgIGMucHVzaChiKGFbZF0sIGQpKTsgcmV0dXJuIGM7IH1cbnZhciB6ZSA9IE9iamVjdC5rZXlzIHx8IGZ1bmN0aW9uIChhKSB7IHZhciBiID0gW10sIGM7IGZvciAoYyBpbiBhKVxuICAgIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChhLCBjKSAmJiBiLnB1c2goYyk7IHJldHVybiBiOyB9O1xuZnVuY3Rpb24gQWUoYSwgYiwgYywgZCkgeyBjID0gYyB8fCBcIj1cIjsgdmFyIGUgPSB7fTsgaWYgKFwic3RyaW5nXCIgIT09IHR5cGVvZiBhIHx8IDAgPT09IGEubGVuZ3RoKVxuICAgIHJldHVybiBlOyB2YXIgZiA9IC9cXCsvZzsgYSA9IGEuc3BsaXQoYiB8fCBcIiZcIik7IGIgPSAxRTM7IGQgJiYgXCJudW1iZXJcIiA9PT0gdHlwZW9mIGQubWF4S2V5cyAmJiAoYiA9IGQubWF4S2V5cyk7IGQgPSBhLmxlbmd0aDsgMCA8IGIgJiYgZCA+IGIgJiYgKGQgPSBiKTsgZm9yIChiID0gMDsgYiA8IGQ7ICsrYikge1xuICAgIHZhciBnID0gYVtiXS5yZXBsYWNlKGYsIFwiJTIwXCIpLCBoID0gZy5pbmRleE9mKGMpO1xuICAgIGlmICgwIDw9IGgpIHtcbiAgICAgICAgdmFyIGsgPSBnLnN1YnN0cigwLCBoKTtcbiAgICAgICAgZyA9IGcuc3Vic3RyKGggKyAxKTtcbiAgICB9XG4gICAgZWxzZVxuICAgICAgICBrID0gZywgZyA9IFwiXCI7XG4gICAgayA9IGRlY29kZVVSSUNvbXBvbmVudChrKTtcbiAgICBnID0gZGVjb2RlVVJJQ29tcG9uZW50KGcpO1xuICAgIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLCBrKSA/IHZlKGVba10pID8gZVtrXS5wdXNoKGcpIDogZVtrXSA9IFtlW2tdLCBnXSA6IGVba10gPSBnO1xufSByZXR1cm4gZTsgfVxudmFyIEZlID0geyBwYXJzZTogQmUsIHJlc29sdmU6IENlLCByZXNvbHZlT2JqZWN0OiBEZSwgZm9ybWF0OiBFZSwgVXJsOiBaIH07XG5mdW5jdGlvbiBaKCkgeyB0aGlzLmhyZWYgPSB0aGlzLnBhdGggPSB0aGlzLnBhdGhuYW1lID0gdGhpcy5xdWVyeSA9IHRoaXMuc2VhcmNoID0gdGhpcy5oYXNoID0gdGhpcy5ob3N0bmFtZSA9IHRoaXMucG9ydCA9IHRoaXMuaG9zdCA9IHRoaXMuYXV0aCA9IHRoaXMuc2xhc2hlcyA9IHRoaXMucHJvdG9jb2wgPSBudWxsOyB9XG52YXIgR2UgPSAvXihbYS16MC05ListXSs6KS9pLCBIZSA9IC86WzAtOV0qJC8sIEllID0gL14oXFwvXFwvPyg/IVxcLylbXlxcP1xcc10qKShcXD9bXlxcc10qKT8kLywgSmUgPSBcInt9fFxcXFxeYFwiLnNwbGl0KFwiXCIpLmNvbmNhdCgnPD5cImAgXFxyXFxuXFx0Jy5zcGxpdChcIlwiKSksIEtlID0gW1wiJ1wiXS5jb25jYXQoSmUpLCBMZSA9IFtcIiVcIiwgXCIvXCIsIFwiP1wiLCBcIjtcIiwgXCIjXCJdLmNvbmNhdChLZSksIE1lID0gW1wiL1wiLCBcIj9cIiwgXCIjXCJdLCBOZSA9IDI1NSwgT2UgPSAvXlsrYS16MC05QS1aXy1dezAsNjN9JC8sIFBlID0gL14oWythLXowLTlBLVpfLV17MCw2M30pKC4qKSQvLCBRZSA9IHsgamF2YXNjcmlwdDogITAsIFwiamF2YXNjcmlwdDpcIjogITAgfSwgUmUgPSB7IGphdmFzY3JpcHQ6ICEwLCBcImphdmFzY3JpcHQ6XCI6ICEwIH0sIFNlID0geyBodHRwOiAhMCwgaHR0cHM6ICEwLCBmdHA6ICEwLCBnb3BoZXI6ICEwLCBmaWxlOiAhMCwgXCJodHRwOlwiOiAhMCwgXCJodHRwczpcIjogITAsIFwiZnRwOlwiOiAhMCwgXCJnb3BoZXI6XCI6ICEwLCBcImZpbGU6XCI6ICEwIH07XG5mdW5jdGlvbiBCZShhLCBiLCBjKSB7IGlmIChhICYmIEhiKGEpICYmIGEgaW5zdGFuY2VvZiBaKVxuICAgIHJldHVybiBhOyB2YXIgZCA9IG5ldyBaOyBkLnBhcnNlKGEsIGIsIGMpOyByZXR1cm4gZDsgfVxuWi5wcm90b3R5cGUucGFyc2UgPSBmdW5jdGlvbiAoYSwgYiwgYykgeyByZXR1cm4gVGUodGhpcywgYSwgYiwgYyk7IH07XG5mdW5jdGlvbiBUZShhLCBiLCBjLCBkKSB7XG4gICAgaWYgKCFHYihiKSlcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlBhcmFtZXRlciAndXJsJyBtdXN0IGJlIGEgc3RyaW5nLCBub3QgXCIgKyB0eXBlb2YgYik7XG4gICAgdmFyIGUgPSBiLmluZGV4T2YoXCI/XCIpO1xuICAgIGUgPSAtMSAhPT0gZSAmJiBlIDwgYi5pbmRleE9mKFwiI1wiKSA/IFwiP1wiIDogXCIjXCI7XG4gICAgYiA9IGIuc3BsaXQoZSk7XG4gICAgYlswXSA9IGJbMF0ucmVwbGFjZSgvXFxcXC9nLCBcIi9cIik7XG4gICAgYiA9IGIuam9pbihlKTtcbiAgICBlID0gYi50cmltKCk7XG4gICAgaWYgKCFkICYmIDEgPT09IGIuc3BsaXQoXCIjXCIpLmxlbmd0aCAmJiAoYiA9IEllLmV4ZWMoZSkpKVxuICAgICAgICByZXR1cm4gYS5wYXRoID0gZSwgYS5ocmVmID0gZSwgYS5wYXRobmFtZSA9IGJbMV0sIGJbMl0gPyAoYS5zZWFyY2ggPSBiWzJdLCBhLnF1ZXJ5ID0gYyA/IEFlKGEuc2VhcmNoLnN1YnN0cigxKSkgOiBhLnNlYXJjaC5zdWJzdHIoMSkpIDogYyAmJiAoYS5zZWFyY2ggPSBcIlwiLCBhLnF1ZXJ5ID0ge30pLCBhO1xuICAgIGlmIChiID0gR2UuZXhlYyhlKSkge1xuICAgICAgICBiID0gYlswXTtcbiAgICAgICAgdmFyIGYgPSBiLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIGEucHJvdG9jb2wgPSBmO1xuICAgICAgICBlID0gZS5zdWJzdHIoYi5sZW5ndGgpO1xuICAgIH1cbiAgICBpZiAoZCB8fCBiIHx8XG4gICAgICAgIGUubWF0Y2goL15cXC9cXC9bXkBcXC9dK0BbXkBcXC9dKy8pKSB7XG4gICAgICAgIHZhciBnID0gXCIvL1wiID09PSBlLnN1YnN0cigwLCAyKTtcbiAgICAgICAgIWcgfHwgYiAmJiBSZVtiXSB8fCAoZSA9IGUuc3Vic3RyKDIpLCBhLnNsYXNoZXMgPSAhMCk7XG4gICAgfVxuICAgIGlmICghUmVbYl0gJiYgKGcgfHwgYiAmJiAhU2VbYl0pKSB7XG4gICAgICAgIGIgPSAtMTtcbiAgICAgICAgZm9yIChkID0gMDsgZCA8IE1lLmxlbmd0aDsgZCsrKVxuICAgICAgICAgICAgZyA9IGUuaW5kZXhPZihNZVtkXSksIC0xICE9PSBnICYmICgtMSA9PT0gYiB8fCBnIDwgYikgJiYgKGIgPSBnKTtcbiAgICAgICAgZyA9IC0xID09PSBiID8gZS5sYXN0SW5kZXhPZihcIkBcIikgOiBlLmxhc3RJbmRleE9mKFwiQFwiLCBiKTtcbiAgICAgICAgLTEgIT09IGcgJiYgKGQgPSBlLnNsaWNlKDAsIGcpLCBlID0gZS5zbGljZShnICsgMSksIGEuYXV0aCA9IGRlY29kZVVSSUNvbXBvbmVudChkKSk7XG4gICAgICAgIGIgPSAtMTtcbiAgICAgICAgZm9yIChkID0gMDsgZCA8IExlLmxlbmd0aDsgZCsrKVxuICAgICAgICAgICAgZyA9IGUuaW5kZXhPZihMZVtkXSksIC0xICE9PSBnICYmICgtMSA9PT0gYiB8fCBnIDwgYikgJiYgKGIgPSBnKTtcbiAgICAgICAgLTEgPT09IGIgJiYgKGIgPSBlLmxlbmd0aCk7XG4gICAgICAgIGEuaG9zdCA9IGUuc2xpY2UoMCwgYik7XG4gICAgICAgIGUgPSBlLnNsaWNlKGIpO1xuICAgICAgICBVZShhKTtcbiAgICAgICAgYS5ob3N0bmFtZSA9IGEuaG9zdG5hbWUgfHwgXCJcIjtcbiAgICAgICAgZyA9IFwiW1wiID09PSBhLmhvc3RuYW1lWzBdICYmXG4gICAgICAgICAgICBcIl1cIiA9PT0gYS5ob3N0bmFtZVthLmhvc3RuYW1lLmxlbmd0aCAtIDFdO1xuICAgICAgICBpZiAoIWcpIHtcbiAgICAgICAgICAgIHZhciBoID0gYS5ob3N0bmFtZS5zcGxpdCgvXFwuLyk7XG4gICAgICAgICAgICBkID0gMDtcbiAgICAgICAgICAgIGZvciAoYiA9IGgubGVuZ3RoOyBkIDwgYjsgZCsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGsgPSBoW2RdO1xuICAgICAgICAgICAgICAgIGlmIChrICYmICFrLm1hdGNoKE9lKSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBwID0gXCJcIiwgbiA9IDAsIHEgPSBrLmxlbmd0aDsgbiA8IHE7IG4rKylcbiAgICAgICAgICAgICAgICAgICAgICAgIHAgPSAxMjcgPCBrLmNoYXJDb2RlQXQobikgPyBwICsgXCJ4XCIgOiBwICsga1tuXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFwLm1hdGNoKE9lKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYiA9IGguc2xpY2UoMCwgZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkID0gaC5zbGljZShkICsgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoayA9IGsubWF0Y2goUGUpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIucHVzaChrWzFdKSwgZC51bnNoaWZ0KGtbMl0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5sZW5ndGggJiYgKGUgPSBcIi9cIiArIGQuam9pbihcIi5cIikgKyBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGEuaG9zdG5hbWUgPSBiLmpvaW4oXCIuXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYS5ob3N0bmFtZSA9IGEuaG9zdG5hbWUubGVuZ3RoID4gTmUgPyBcIlwiIDogYS5ob3N0bmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBnIHx8IChhLmhvc3RuYW1lID0gdWUoYS5ob3N0bmFtZSkpO1xuICAgICAgICBkID0gYS5wb3J0ID8gXCI6XCIgKyBhLnBvcnQgOiBcIlwiO1xuICAgICAgICBhLmhvc3QgPSAoYS5ob3N0bmFtZSB8fCBcIlwiKSArIGQ7XG4gICAgICAgIGEuaHJlZiArPSBhLmhvc3Q7XG4gICAgICAgIGcgJiYgKGEuaG9zdG5hbWUgPSBhLmhvc3RuYW1lLnN1YnN0cigxLCBhLmhvc3RuYW1lLmxlbmd0aCAtIDIpLCBcIi9cIiAhPT0gZVswXSAmJiAoZSA9IFwiL1wiICsgZSkpO1xuICAgIH1cbiAgICBpZiAoIVFlW2ZdKVxuICAgICAgICBmb3IgKGQgPSAwLCBiID0gS2UubGVuZ3RoOyBkIDwgYjsgZCsrKVxuICAgICAgICAgICAgZyA9IEtlW2RdLCAtMSAhPT0gZS5pbmRleE9mKGcpICYmIChrID0gZW5jb2RlVVJJQ29tcG9uZW50KGcpLCBrID09PSBnICYmIChrID0gZXNjYXBlKGcpKSwgZSA9IGUuc3BsaXQoZykuam9pbihrKSk7XG4gICAgZCA9IGUuaW5kZXhPZihcIiNcIik7XG4gICAgLTEgIT09IGQgJiYgKGEuaGFzaCA9IGUuc3Vic3RyKGQpLCBlID0gZS5zbGljZSgwLCBkKSk7XG4gICAgZCA9IGUuaW5kZXhPZihcIj9cIik7XG4gICAgLTEgIT09IGQgPyAoYS5zZWFyY2ggPSBlLnN1YnN0cihkKSwgYS5xdWVyeSA9IGUuc3Vic3RyKGQgKyAxKSwgYyAmJiAoYS5xdWVyeSA9IEFlKGEucXVlcnkpKSwgZSA9IGUuc2xpY2UoMCwgZCkpIDogYyAmJiAoYS5zZWFyY2ggPSBcIlwiLCBhLnF1ZXJ5ID0ge30pO1xuICAgIGUgJiYgKGEucGF0aG5hbWUgPSBlKTtcbiAgICBTZVtmXSAmJiBhLmhvc3RuYW1lICYmICFhLnBhdGhuYW1lICYmIChhLnBhdGhuYW1lID0gXCIvXCIpO1xuICAgIGlmIChhLnBhdGhuYW1lIHx8XG4gICAgICAgIGEuc2VhcmNoKVxuICAgICAgICBkID0gYS5wYXRobmFtZSB8fCBcIlwiLCBhLnBhdGggPSBkICsgKGEuc2VhcmNoIHx8IFwiXCIpO1xuICAgIGEuaHJlZiA9IFZlKGEpO1xuICAgIHJldHVybiBhO1xufVxuZnVuY3Rpb24gRWUoYSkgeyBHYihhKSAmJiAoYSA9IFRlKHt9LCBhKSk7IHJldHVybiBWZShhKTsgfVxuZnVuY3Rpb24gVmUoYSkge1xuICAgIHZhciBiID0gYS5hdXRoIHx8IFwiXCI7XG4gICAgYiAmJiAoYiA9IGVuY29kZVVSSUNvbXBvbmVudChiKSwgYiA9IGIucmVwbGFjZSgvJTNBL2ksIFwiOlwiKSwgYiArPSBcIkBcIik7XG4gICAgdmFyIGMgPSBhLnByb3RvY29sIHx8IFwiXCIsIGQgPSBhLnBhdGhuYW1lIHx8IFwiXCIsIGUgPSBhLmhhc2ggfHwgXCJcIiwgZiA9ICExLCBnID0gXCJcIjtcbiAgICBhLmhvc3QgPyBmID0gYiArIGEuaG9zdCA6IGEuaG9zdG5hbWUgJiYgKGYgPSBiICsgKC0xID09PSBhLmhvc3RuYW1lLmluZGV4T2YoXCI6XCIpID8gYS5ob3N0bmFtZSA6IFwiW1wiICsgdGhpcy5ob3N0bmFtZSArIFwiXVwiKSwgYS5wb3J0ICYmIChmICs9IFwiOlwiICsgYS5wb3J0KSk7XG4gICAgYS5xdWVyeSAmJiBIYihhLnF1ZXJ5KSAmJiBPYmplY3Qua2V5cyhhLnF1ZXJ5KS5sZW5ndGggJiYgKGcgPSB4ZShhLnF1ZXJ5KSk7XG4gICAgYiA9IGEuc2VhcmNoIHx8IGcgJiYgXCI/XCIgKyBnIHx8IFwiXCI7XG4gICAgYyAmJiBcIjpcIiAhPT0gYy5zdWJzdHIoLTEpICYmIChjICs9IFwiOlwiKTtcbiAgICBhLnNsYXNoZXMgfHwgKCFjIHx8IFNlW2NdKSAmJiAhMSAhPT0gZiA/IChmID0gXCIvL1wiICsgKGYgfHwgXCJcIiksIGQgJiYgXCIvXCIgIT09IGQuY2hhckF0KDApICYmIChkID0gXCIvXCIgKyBkKSkgOiBmIHx8IChmID0gXCJcIik7XG4gICAgZSAmJiBcIiNcIiAhPT0gZS5jaGFyQXQoMCkgJiZcbiAgICAgICAgKGUgPSBcIiNcIiArIGUpO1xuICAgIGIgJiYgXCI/XCIgIT09IGIuY2hhckF0KDApICYmIChiID0gXCI/XCIgKyBiKTtcbiAgICBkID0gZC5yZXBsYWNlKC9bPyNdL2csIGZ1bmN0aW9uIChhKSB7IHJldHVybiBlbmNvZGVVUklDb21wb25lbnQoYSk7IH0pO1xuICAgIGIgPSBiLnJlcGxhY2UoXCIjXCIsIFwiJTIzXCIpO1xuICAgIHJldHVybiBjICsgZiArIGQgKyBiICsgZTtcbn1cbloucHJvdG90eXBlLmZvcm1hdCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIFZlKHRoaXMpOyB9O1xuZnVuY3Rpb24gQ2UoYSwgYikgeyByZXR1cm4gQmUoYSwgITEsICEwKS5yZXNvbHZlKGIpOyB9XG5aLnByb3RvdHlwZS5yZXNvbHZlID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIHRoaXMucmVzb2x2ZU9iamVjdChCZShhLCAhMSwgITApKS5mb3JtYXQoKTsgfTtcbmZ1bmN0aW9uIERlKGEsIGIpIHsgcmV0dXJuIGEgPyBCZShhLCAhMSwgITApLnJlc29sdmVPYmplY3QoYikgOiBiOyB9XG5aLnByb3RvdHlwZS5yZXNvbHZlT2JqZWN0ID0gZnVuY3Rpb24gKGEpIHtcbiAgICBpZiAoR2IoYSkpIHtcbiAgICAgICAgdmFyIGIgPSBuZXcgWjtcbiAgICAgICAgYi5wYXJzZShhLCAhMSwgITApO1xuICAgICAgICBhID0gYjtcbiAgICB9XG4gICAgYiA9IG5ldyBaO1xuICAgIGZvciAodmFyIGMgPSBPYmplY3Qua2V5cyh0aGlzKSwgZCA9IDA7IGQgPCBjLmxlbmd0aDsgZCsrKSB7XG4gICAgICAgIHZhciBlID0gY1tkXTtcbiAgICAgICAgYltlXSA9IHRoaXNbZV07XG4gICAgfVxuICAgIGIuaGFzaCA9IGEuaGFzaDtcbiAgICBpZiAoXCJcIiA9PT0gYS5ocmVmKVxuICAgICAgICByZXR1cm4gYi5ocmVmID0gYi5mb3JtYXQoKSwgYjtcbiAgICBpZiAoYS5zbGFzaGVzICYmICFhLnByb3RvY29sKSB7XG4gICAgICAgIGMgPSBPYmplY3Qua2V5cyhhKTtcbiAgICAgICAgZm9yIChkID0gMDsgZCA8IGMubGVuZ3RoOyBkKyspXG4gICAgICAgICAgICBlID0gY1tkXSwgXCJwcm90b2NvbFwiICE9PSBlICYmIChiW2VdID0gYVtlXSk7XG4gICAgICAgIFNlW2IucHJvdG9jb2xdICYmIGIuaG9zdG5hbWUgJiYgIWIucGF0aG5hbWUgJiYgKGIucGF0aCA9IGIucGF0aG5hbWUgPSBcIi9cIik7XG4gICAgICAgIGIuaHJlZiA9IGIuZm9ybWF0KCk7XG4gICAgICAgIHJldHVybiBiO1xuICAgIH1cbiAgICB2YXIgZjtcbiAgICBpZiAoYS5wcm90b2NvbCAmJiBhLnByb3RvY29sICE9PSBiLnByb3RvY29sKSB7XG4gICAgICAgIGlmICghU2VbYS5wcm90b2NvbF0pIHtcbiAgICAgICAgICAgIGMgPSBPYmplY3Qua2V5cyhhKTtcbiAgICAgICAgICAgIGZvciAoZCA9IDA7IGQgPFxuICAgICAgICAgICAgICAgIGMubGVuZ3RoOyBkKyspXG4gICAgICAgICAgICAgICAgZSA9IGNbZF0sIGJbZV0gPSBhW2VdO1xuICAgICAgICAgICAgYi5ocmVmID0gYi5mb3JtYXQoKTtcbiAgICAgICAgICAgIHJldHVybiBiO1xuICAgICAgICB9XG4gICAgICAgIGIucHJvdG9jb2wgPSBhLnByb3RvY29sO1xuICAgICAgICBpZiAoYS5ob3N0IHx8IFJlW2EucHJvdG9jb2xdKVxuICAgICAgICAgICAgYi5wYXRobmFtZSA9IGEucGF0aG5hbWU7XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZm9yIChmID0gKGEucGF0aG5hbWUgfHwgXCJcIikuc3BsaXQoXCIvXCIpOyBmLmxlbmd0aCAmJiAhKGEuaG9zdCA9IGYuc2hpZnQoKSk7KVxuICAgICAgICAgICAgICAgIDtcbiAgICAgICAgICAgIGEuaG9zdCB8fCAoYS5ob3N0ID0gXCJcIik7XG4gICAgICAgICAgICBhLmhvc3RuYW1lIHx8IChhLmhvc3RuYW1lID0gXCJcIik7XG4gICAgICAgICAgICBcIlwiICE9PSBmWzBdICYmIGYudW5zaGlmdChcIlwiKTtcbiAgICAgICAgICAgIDIgPiBmLmxlbmd0aCAmJiBmLnVuc2hpZnQoXCJcIik7XG4gICAgICAgICAgICBiLnBhdGhuYW1lID0gZi5qb2luKFwiL1wiKTtcbiAgICAgICAgfVxuICAgICAgICBiLnNlYXJjaCA9IGEuc2VhcmNoO1xuICAgICAgICBiLnF1ZXJ5ID0gYS5xdWVyeTtcbiAgICAgICAgYi5ob3N0ID0gYS5ob3N0IHx8IFwiXCI7XG4gICAgICAgIGIuYXV0aCA9IGEuYXV0aDtcbiAgICAgICAgYi5ob3N0bmFtZSA9IGEuaG9zdG5hbWUgfHwgYS5ob3N0O1xuICAgICAgICBiLnBvcnQgPSBhLnBvcnQ7XG4gICAgICAgIGlmIChiLnBhdGhuYW1lIHx8IGIuc2VhcmNoKVxuICAgICAgICAgICAgYi5wYXRoID0gKGIucGF0aG5hbWUgfHwgXCJcIikgKyAoYi5zZWFyY2ggfHwgXCJcIik7XG4gICAgICAgIGIuc2xhc2hlcyA9XG4gICAgICAgICAgICBiLnNsYXNoZXMgfHwgYS5zbGFzaGVzO1xuICAgICAgICBiLmhyZWYgPSBiLmZvcm1hdCgpO1xuICAgICAgICByZXR1cm4gYjtcbiAgICB9XG4gICAgYyA9IGIucGF0aG5hbWUgJiYgXCIvXCIgPT09IGIucGF0aG5hbWUuY2hhckF0KDApO1xuICAgIHZhciBnID0gYS5ob3N0IHx8IGEucGF0aG5hbWUgJiYgXCIvXCIgPT09IGEucGF0aG5hbWUuY2hhckF0KDApLCBoID0gYyA9IGcgfHwgYyB8fCBiLmhvc3QgJiYgYS5wYXRobmFtZTtcbiAgICBkID0gYi5wYXRobmFtZSAmJiBiLnBhdGhuYW1lLnNwbGl0KFwiL1wiKSB8fCBbXTtcbiAgICBlID0gYi5wcm90b2NvbCAmJiAhU2VbYi5wcm90b2NvbF07XG4gICAgZiA9IGEucGF0aG5hbWUgJiYgYS5wYXRobmFtZS5zcGxpdChcIi9cIikgfHwgW107XG4gICAgZSAmJiAoYi5ob3N0bmFtZSA9IFwiXCIsIGIucG9ydCA9IG51bGwsIGIuaG9zdCAmJiAoXCJcIiA9PT0gZFswXSA/IGRbMF0gPSBiLmhvc3QgOiBkLnVuc2hpZnQoYi5ob3N0KSksIGIuaG9zdCA9IFwiXCIsIGEucHJvdG9jb2wgJiYgKGEuaG9zdG5hbWUgPSBudWxsLCBhLnBvcnQgPSBudWxsLCBhLmhvc3QgJiYgKFwiXCIgPT09IGZbMF0gPyBmWzBdID0gYS5ob3N0IDogZi51bnNoaWZ0KGEuaG9zdCkpLCBhLmhvc3QgPSBudWxsKSwgYyA9IGMgJiYgKFwiXCIgPT09IGZbMF0gfHwgXCJcIiA9PT0gZFswXSkpO1xuICAgIGlmIChnKVxuICAgICAgICBiLmhvc3QgPSBhLmhvc3QgfHwgXCJcIiA9PT0gYS5ob3N0ID8gYS5ob3N0IDogYi5ob3N0LCBiLmhvc3RuYW1lID0gYS5ob3N0bmFtZSB8fCBcIlwiID09PSBhLmhvc3RuYW1lID8gYS5ob3N0bmFtZSA6IGIuaG9zdG5hbWUsIGIuc2VhcmNoID0gYS5zZWFyY2gsIGIucXVlcnkgPSBhLnF1ZXJ5LCBkID0gZjtcbiAgICBlbHNlIGlmIChmLmxlbmd0aClcbiAgICAgICAgZCB8fCAoZCA9IFtdKSwgZC5wb3AoKSwgZCA9IGQuY29uY2F0KGYpLCBiLnNlYXJjaCA9IGEuc2VhcmNoLCBiLnF1ZXJ5ID0gYS5xdWVyeTtcbiAgICBlbHNlIGlmIChudWxsICE9IGEuc2VhcmNoKSB7XG4gICAgICAgIGUgJiYgKGIuaG9zdG5hbWUgPSBiLmhvc3QgPSBkLnNoaWZ0KCksIGUgPSBiLmhvc3QgJiYgMCA8IGIuaG9zdC5pbmRleE9mKFwiQFwiKSA/IGIuaG9zdC5zcGxpdChcIkBcIikgOiAhMSkgJiYgKGIuYXV0aCA9IGUuc2hpZnQoKSwgYi5ob3N0ID0gYi5ob3N0bmFtZSA9IGUuc2hpZnQoKSk7XG4gICAgICAgIGIuc2VhcmNoID0gYS5zZWFyY2g7XG4gICAgICAgIGIucXVlcnkgPSBhLnF1ZXJ5O1xuICAgICAgICBpZiAobnVsbCAhPT0gYi5wYXRobmFtZSB8fCBudWxsICE9PSBiLnNlYXJjaClcbiAgICAgICAgICAgIGIucGF0aCA9IChiLnBhdGhuYW1lID8gYi5wYXRobmFtZSA6IFwiXCIpICsgKGIuc2VhcmNoID9cbiAgICAgICAgICAgICAgICBiLnNlYXJjaCA6IFwiXCIpO1xuICAgICAgICBiLmhyZWYgPSBiLmZvcm1hdCgpO1xuICAgICAgICByZXR1cm4gYjtcbiAgICB9XG4gICAgaWYgKCFkLmxlbmd0aClcbiAgICAgICAgcmV0dXJuIGIucGF0aG5hbWUgPSBudWxsLCBiLnBhdGggPSBiLnNlYXJjaCA/IFwiL1wiICsgYi5zZWFyY2ggOiBudWxsLCBiLmhyZWYgPSBiLmZvcm1hdCgpLCBiO1xuICAgIGcgPSBkLnNsaWNlKC0xKVswXTtcbiAgICBmID0gKGIuaG9zdCB8fCBhLmhvc3QgfHwgMSA8IGQubGVuZ3RoKSAmJiAoXCIuXCIgPT09IGcgfHwgXCIuLlwiID09PSBnKSB8fCBcIlwiID09PSBnO1xuICAgIGZvciAodmFyIGsgPSAwLCBwID0gZC5sZW5ndGg7IDAgPD0gcDsgcC0tKVxuICAgICAgICBnID0gZFtwXSwgXCIuXCIgPT09IGcgPyBkLnNwbGljZShwLCAxKSA6IFwiLi5cIiA9PT0gZyA/IChkLnNwbGljZShwLCAxKSwgaysrKSA6IGsgJiYgKGQuc3BsaWNlKHAsIDEpLCBrLS0pO1xuICAgIGlmICghYyAmJiAhaClcbiAgICAgICAgZm9yICg7IGstLTsgaylcbiAgICAgICAgICAgIGQudW5zaGlmdChcIi4uXCIpO1xuICAgICFjIHx8IFwiXCIgPT09IGRbMF0gfHwgZFswXSAmJiBcIi9cIiA9PT0gZFswXS5jaGFyQXQoMCkgfHwgZC51bnNoaWZ0KFwiXCIpO1xuICAgIGYgJiYgXCIvXCIgIT09IGQuam9pbihcIi9cIikuc3Vic3RyKC0xKSAmJiBkLnB1c2goXCJcIik7XG4gICAgaCA9IFwiXCIgPT09IGRbMF0gfHwgZFswXSAmJiBcIi9cIiA9PT0gZFswXS5jaGFyQXQoMCk7XG4gICAgZSAmJlxuICAgICAgICAoYi5ob3N0bmFtZSA9IGIuaG9zdCA9IGggPyBcIlwiIDogZC5sZW5ndGggPyBkLnNoaWZ0KCkgOiBcIlwiLCBlID0gYi5ob3N0ICYmIDAgPCBiLmhvc3QuaW5kZXhPZihcIkBcIikgPyBiLmhvc3Quc3BsaXQoXCJAXCIpIDogITEpICYmIChiLmF1dGggPSBlLnNoaWZ0KCksIGIuaG9zdCA9IGIuaG9zdG5hbWUgPSBlLnNoaWZ0KCkpO1xuICAgIChjID0gYyB8fCBiLmhvc3QgJiYgZC5sZW5ndGgpICYmICFoICYmIGQudW5zaGlmdChcIlwiKTtcbiAgICBkLmxlbmd0aCA/IGIucGF0aG5hbWUgPSBkLmpvaW4oXCIvXCIpIDogKGIucGF0aG5hbWUgPSBudWxsLCBiLnBhdGggPSBudWxsKTtcbiAgICBpZiAobnVsbCAhPT0gYi5wYXRobmFtZSB8fCBudWxsICE9PSBiLnNlYXJjaClcbiAgICAgICAgYi5wYXRoID0gKGIucGF0aG5hbWUgPyBiLnBhdGhuYW1lIDogXCJcIikgKyAoYi5zZWFyY2ggPyBiLnNlYXJjaCA6IFwiXCIpO1xuICAgIGIuYXV0aCA9IGEuYXV0aCB8fCBiLmF1dGg7XG4gICAgYi5zbGFzaGVzID0gYi5zbGFzaGVzIHx8IGEuc2xhc2hlcztcbiAgICBiLmhyZWYgPSBiLmZvcm1hdCgpO1xuICAgIHJldHVybiBiO1xufTtcbloucHJvdG90eXBlLnBhcnNlSG9zdCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIFVlKHRoaXMpOyB9O1xuZnVuY3Rpb24gVWUoYSkgeyB2YXIgYiA9IGEuaG9zdCwgYyA9IEhlLmV4ZWMoYik7IGMgJiYgKGMgPSBjWzBdLCBcIjpcIiAhPT0gYyAmJiAoYS5wb3J0ID0gYy5zdWJzdHIoMSkpLCBiID0gYi5zdWJzdHIoMCwgYi5sZW5ndGggLSBjLmxlbmd0aCkpOyBiICYmIChhLmhvc3RuYW1lID0gYik7IH1cbnZhciBXZSA9IHUoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICBmdW5jdGlvbiBjKGEsIGIpIHsgYSA9IGFbYl07IHJldHVybiAwIDwgYiAmJiAoXCIvXCIgPT09IGEgfHwgZSAmJiBcIlxcXFxcIiA9PT0gYSk7IH1cbiAgICBmdW5jdGlvbiBkKGEpIHsgdmFyIGIgPSAxIDwgYXJndW1lbnRzLmxlbmd0aCAmJiB2b2lkIDAgIT09IGFyZ3VtZW50c1sxXSA/IGFyZ3VtZW50c1sxXSA6ICEwOyBpZiAoZSkge1xuICAgICAgICB2YXIgZCA9IGE7XG4gICAgICAgIGlmIChcInN0cmluZ1wiICE9PSB0eXBlb2YgZClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJleHBlY3RlZCBhIHN0cmluZ1wiKTtcbiAgICAgICAgZCA9IGQucmVwbGFjZSgvW1xcXFxcXC9dKy9nLCBcIi9cIik7XG4gICAgICAgIGlmICghMSAhPT0gYilcbiAgICAgICAgICAgIGlmIChiID0gZCwgZCA9IGIubGVuZ3RoIC0gMSwgMiA+IGQpXG4gICAgICAgICAgICAgICAgZCA9IGI7XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBmb3IgKDsgYyhiLCBkKTspXG4gICAgICAgICAgICAgICAgICAgIGQtLTtcbiAgICAgICAgICAgICAgICBkID0gYi5zdWJzdHIoMCwgZCArIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICByZXR1cm4gZC5yZXBsYWNlKC9eKFthLXpBLVpdKzp8XFwuXFwvKS8sIFwiXCIpO1xuICAgIH0gcmV0dXJuIGE7IH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoYiwgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6ICEwIH0pO1xuICAgIGIudW5peGlmeSA9IGQ7XG4gICAgYi5jb3JyZWN0UGF0aCA9IGZ1bmN0aW9uIChhKSB7XG4gICAgICAgIHJldHVybiBkKGEucmVwbGFjZSgvXlxcXFxcXFxcXFw/XFxcXC46XFxcXC8sIFwiXFxcXFwiKSk7XG4gICAgfTtcbiAgICB2YXIgZSA9IFwid2luMzJcIiA9PT0gQ2IucGxhdGZvcm07XG59KTtcbnQoV2UpO1xudmFyIFhlID0gdShmdW5jdGlvbiAoYSwgYikge1xuICAgIGZ1bmN0aW9uIGMoYSwgYikgeyB2b2lkIDAgPT09IGIgJiYgKGIgPSBMLmRlZmF1bHQuY3dkKCkpOyByZXR1cm4gY2YoYiwgYSk7IH1cbiAgICBmdW5jdGlvbiBkKGEsIGIpIHsgcmV0dXJuIFwiZnVuY3Rpb25cIiA9PT0gdHlwZW9mIGEgPyBbZSgpLCBhXSA6IFtlKGEpLCBxKGIpXTsgfVxuICAgIGZ1bmN0aW9uIGUoYSkgeyB2b2lkIDAgPT09IGEgJiYgKGEgPSB7fSk7IHJldHVybiBhYSh7fSwgZGYsIGEpOyB9XG4gICAgZnVuY3Rpb24gZihhKSB7IHJldHVybiBcIm51bWJlclwiID09PSB0eXBlb2YgYSA/IGFhKHt9LCB1ZCwgeyBtb2RlOiBhIH0pIDogYWEoe30sIHVkLCBhKTsgfVxuICAgIGZ1bmN0aW9uIGcoYSwgYiwgYywgZCkge1xuICAgICAgICB2b2lkIDAgPT09IGIgJiYgKGIgPSBcIlwiKTtcbiAgICAgICAgdm9pZCAwID09PSBjICYmIChjID0gXCJcIik7XG4gICAgICAgIHZvaWQgMCA9PT0gZCAmJiAoZCA9IFwiXCIpO1xuICAgICAgICB2YXIgZSA9IFwiXCI7XG4gICAgICAgIGMgJiYgKGUgPSBcIiAnXCIgKyBjICsgXCInXCIpO1xuICAgICAgICBkICYmIChlICs9IFwiIC0+ICdcIiArIGQgKyBcIidcIik7XG4gICAgICAgIHN3aXRjaCAoYSkge1xuICAgICAgICAgICAgY2FzZSBcIkVOT0VOVFwiOiByZXR1cm4gXCJFTk9FTlQ6IG5vIHN1Y2ggZmlsZSBvciBkaXJlY3RvcnksIFwiICsgYiArIGU7XG4gICAgICAgICAgICBjYXNlIFwiRUJBREZcIjogcmV0dXJuIFwiRUJBREY6IGJhZCBmaWxlIGRlc2NyaXB0b3IsIFwiICtcbiAgICAgICAgICAgICAgICBiICsgZTtcbiAgICAgICAgICAgIGNhc2UgXCJFSU5WQUxcIjogcmV0dXJuIFwiRUlOVkFMOiBpbnZhbGlkIGFyZ3VtZW50LCBcIiArIGIgKyBlO1xuICAgICAgICAgICAgY2FzZSBcIkVQRVJNXCI6IHJldHVybiBcIkVQRVJNOiBvcGVyYXRpb24gbm90IHBlcm1pdHRlZCwgXCIgKyBiICsgZTtcbiAgICAgICAgICAgIGNhc2UgXCJFUFJPVE9cIjogcmV0dXJuIFwiRVBST1RPOiBwcm90b2NvbCBlcnJvciwgXCIgKyBiICsgZTtcbiAgICAgICAgICAgIGNhc2UgXCJFRVhJU1RcIjogcmV0dXJuIFwiRUVYSVNUOiBmaWxlIGFscmVhZHkgZXhpc3RzLCBcIiArIGIgKyBlO1xuICAgICAgICAgICAgY2FzZSBcIkVOT1RESVJcIjogcmV0dXJuIFwiRU5PVERJUjogbm90IGEgZGlyZWN0b3J5LCBcIiArIGIgKyBlO1xuICAgICAgICAgICAgY2FzZSBcIkVJU0RJUlwiOiByZXR1cm4gXCJFSVNESVI6IGlsbGVnYWwgb3BlcmF0aW9uIG9uIGEgZGlyZWN0b3J5LCBcIiArIGIgKyBlO1xuICAgICAgICAgICAgY2FzZSBcIkVBQ0NFU1wiOiByZXR1cm4gXCJFQUNDRVM6IHBlcm1pc3Npb24gZGVuaWVkLCBcIiArIGIgKyBlO1xuICAgICAgICAgICAgY2FzZSBcIkVOT1RFTVBUWVwiOiByZXR1cm4gXCJFTk9URU1QVFk6IGRpcmVjdG9yeSBub3QgZW1wdHksIFwiICsgYiArIGU7XG4gICAgICAgICAgICBjYXNlIFwiRU1GSUxFXCI6IHJldHVybiBcIkVNRklMRTogdG9vIG1hbnkgb3BlbiBmaWxlcywgXCIgK1xuICAgICAgICAgICAgICAgIGIgKyBlO1xuICAgICAgICAgICAgY2FzZSBcIkVOT1NZU1wiOiByZXR1cm4gXCJFTk9TWVM6IGZ1bmN0aW9uIG5vdCBpbXBsZW1lbnRlZCwgXCIgKyBiICsgZTtcbiAgICAgICAgICAgIGRlZmF1bHQ6IHJldHVybiBhICsgXCI6IGVycm9yIG9jY3VycmVkLCBcIiArIGIgKyBlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIGgoYSwgYiwgYywgZCwgZSkgeyB2b2lkIDAgPT09IGIgJiYgKGIgPSBcIlwiKTsgdm9pZCAwID09PSBjICYmIChjID0gXCJcIik7IHZvaWQgMCA9PT0gZCAmJiAoZCA9IFwiXCIpOyB2b2lkIDAgPT09IGUgJiYgKGUgPSBFcnJvcik7IGIgPSBuZXcgZShnKGEsIGIsIGMsIGQpKTsgYi5jb2RlID0gYTsgcmV0dXJuIGI7IH1cbiAgICBmdW5jdGlvbiBrKGEpIHsgaWYgKFwibnVtYmVyXCIgPT09IHR5cGVvZiBhKVxuICAgICAgICByZXR1cm4gYTsgaWYgKFwic3RyaW5nXCIgPT09IHR5cGVvZiBhKSB7XG4gICAgICAgIHZhciBiID0gdWFbYV07XG4gICAgICAgIGlmIChcInVuZGVmaW5lZFwiICE9PSB0eXBlb2YgYilcbiAgICAgICAgICAgIHJldHVybiBiO1xuICAgIH0gdGhyb3cgbmV3IFBjLlR5cGVFcnJvcihcIkVSUl9JTlZBTElEX09QVF9WQUxVRVwiLCBcImZsYWdzXCIsIGEpOyB9XG4gICAgZnVuY3Rpb24gcChhLCBiKSB7XG4gICAgICAgIGlmIChiKSB7XG4gICAgICAgICAgICB2YXIgYyA9IHR5cGVvZiBiO1xuICAgICAgICAgICAgc3dpdGNoIChjKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBcInN0cmluZ1wiOlxuICAgICAgICAgICAgICAgICAgICBhID0gYWEoe30sIGEsIHsgZW5jb2Rpbmc6IGIgfSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJvYmplY3RcIjpcbiAgICAgICAgICAgICAgICAgICAgYSA9IGFhKHt9LCBhLCBiKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDogdGhyb3cgVHlwZUVycm9yKFwiRXhwZWN0ZWQgb3B0aW9ucyB0byBiZSBlaXRoZXIgYW4gb2JqZWN0IG9yIGEgc3RyaW5nLCBidXQgZ290IFwiICsgYyArIFwiIGluc3RlYWRcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgIFwiYnVmZmVyXCIgIT09IGEuZW5jb2RpbmcgJiYgSy5hc3NlcnRFbmNvZGluZyhhLmVuY29kaW5nKTtcbiAgICAgICAgcmV0dXJuIGE7XG4gICAgfVxuICAgIGZ1bmN0aW9uIG4oYSkgeyByZXR1cm4gZnVuY3Rpb24gKGIpIHsgcmV0dXJuIHAoYSwgYik7IH07IH1cbiAgICBmdW5jdGlvbiBxKGEpIHsgaWYgKFwiZnVuY3Rpb25cIiAhPT0gdHlwZW9mIGEpXG4gICAgICAgIHRocm93IFR5cGVFcnJvcihmYS5DQik7IHJldHVybiBhOyB9XG4gICAgZnVuY3Rpb24gQihhKSB7IHJldHVybiBmdW5jdGlvbiAoYiwgYykgeyByZXR1cm4gXCJmdW5jdGlvblwiID09PSB0eXBlb2YgYiA/IFthKCksIGJdIDogW2EoYiksIHEoYyldOyB9OyB9XG4gICAgZnVuY3Rpb24gbShhKSB7XG4gICAgICAgIGlmIChcInN0cmluZ1wiICE9PSB0eXBlb2YgYSAmJiAhRi5CdWZmZXIuaXNCdWZmZXIoYSkpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgaWYgKCEoYSBpbnN0YW5jZW9mXG4gICAgICAgICAgICAgICAgICAgIEZlLlVSTCkpXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoZmEuUEFUSF9TVFIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKFhhKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihmYS5QQVRIX1NUUik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoXCJcIiAhPT0gYS5ob3N0bmFtZSlcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUGMuVHlwZUVycm9yKFwiRVJSX0lOVkFMSURfRklMRV9VUkxfSE9TVFwiLCBMLmRlZmF1bHQucGxhdGZvcm0pO1xuICAgICAgICAgICAgYSA9IGEucGF0aG5hbWU7XG4gICAgICAgICAgICBmb3IgKHZhciBiID0gMDsgYiA8IGEubGVuZ3RoOyBiKyspXG4gICAgICAgICAgICAgICAgaWYgKFwiJVwiID09PSBhW2JdKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjID0gYS5jb2RlUG9pbnRBdChiICsgMikgfCAzMjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKFwiMlwiID09PSBhW2IgKyAxXSAmJiAxMDIgPT09IGMpXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUGMuVHlwZUVycm9yKFwiRVJSX0lOVkFMSURfRklMRV9VUkxfUEFUSFwiLCBcIm11c3Qgbm90IGluY2x1ZGUgZW5jb2RlZCAvIGNoYXJhY3RlcnNcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgYSA9IGRlY29kZVVSSUNvbXBvbmVudChhKTtcbiAgICAgICAgfVxuICAgICAgICBhID0gU3RyaW5nKGEpO1xuICAgICAgICBxYihhKTtcbiAgICAgICAgcmV0dXJuIGE7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHYoYSwgYikgeyByZXR1cm4gKGEgPSBjKGEsIGIpLnN1YnN0cigxKSkgPyBhLnNwbGl0KFMpIDogW107IH1cbiAgICBmdW5jdGlvbiB4YShhKSB7IHJldHVybiB2KG0oYSkpOyB9XG4gICAgZnVuY3Rpb24gTGEoYSwgYikgeyB2b2lkIDAgPT09IGIgJiYgKGIgPSBLLkVOQ09ESU5HX1VURjgpOyByZXR1cm4gRi5CdWZmZXIuaXNCdWZmZXIoYSkgPyBhIDogYSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkgPyBGLmJ1ZmZlckZyb20oYSkgOiBGLmJ1ZmZlckZyb20oU3RyaW5nKGEpLCBiKTsgfVxuICAgIGZ1bmN0aW9uICRiKGEsIGIpIHsgcmV0dXJuIGIgJiYgXCJidWZmZXJcIiAhPT0gYiA/IGEudG9TdHJpbmcoYikgOiBhOyB9XG4gICAgZnVuY3Rpb24gcWIoYSwgYikgeyBpZiAoLTEgIT09IChcIlwiICsgYSkuaW5kZXhPZihcIlxceDAwXCIpKSB7XG4gICAgICAgIGEgPSBFcnJvcihcIlBhdGggbXVzdCBiZSBhIHN0cmluZyB3aXRob3V0IG51bGwgYnl0ZXNcIik7XG4gICAgICAgIGEuY29kZSA9IFwiRU5PRU5UXCI7XG4gICAgICAgIGlmIChcImZ1bmN0aW9uXCIgIT09IHR5cGVvZiBiKVxuICAgICAgICAgICAgdGhyb3cgYTtcbiAgICAgICAgTC5kZWZhdWx0Lm5leHRUaWNrKGIsIGEpO1xuICAgICAgICByZXR1cm4gITE7XG4gICAgfSByZXR1cm4gITA7IH1cbiAgICBmdW5jdGlvbiBNKGEsIGIpIHtcbiAgICAgICAgYSA9IFwibnVtYmVyXCIgPT09IHR5cGVvZiBhID8gYSA6IFwic3RyaW5nXCIgPT09IHR5cGVvZiBhID8gcGFyc2VJbnQoYSwgOCkgOiBiID8gTShiKSA6IHZvaWQgMDtcbiAgICAgICAgaWYgKFwibnVtYmVyXCIgIT09IHR5cGVvZiBhIHx8XG4gICAgICAgICAgICBpc05hTihhKSlcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoZmEuTU9ERV9JTlQpO1xuICAgICAgICByZXR1cm4gYTtcbiAgICB9XG4gICAgZnVuY3Rpb24gWWEoYSkgeyBpZiAoYSA+Pj4gMCAhPT0gYSlcbiAgICAgICAgdGhyb3cgVHlwZUVycm9yKGZhLkZEKTsgfVxuICAgIGZ1bmN0aW9uIGhhKGEpIHsgaWYgKFwic3RyaW5nXCIgPT09IHR5cGVvZiBhICYmICthID09IGEpXG4gICAgICAgIHJldHVybiArYTsgaWYgKGEgaW5zdGFuY2VvZiBEYXRlKVxuICAgICAgICByZXR1cm4gYS5nZXRUaW1lKCkgLyAxRTM7IGlmIChpc0Zpbml0ZShhKSlcbiAgICAgICAgcmV0dXJuIDAgPiBhID8gRGF0ZS5ub3coKSAvIDFFMyA6IGE7IHRocm93IEVycm9yKFwiQ2Fubm90IHBhcnNlIHRpbWU6IFwiICsgYSk7IH1cbiAgICBmdW5jdGlvbiBIYShhKSB7IGlmIChcIm51bWJlclwiICE9PSB0eXBlb2YgYSlcbiAgICAgICAgdGhyb3cgVHlwZUVycm9yKGZhLlVJRCk7IH1cbiAgICBmdW5jdGlvbiBJYShhKSB7IGlmIChcIm51bWJlclwiICE9PSB0eXBlb2YgYSlcbiAgICAgICAgdGhyb3cgVHlwZUVycm9yKGZhLkdJRCk7IH1cbiAgICBmdW5jdGlvbiBlZihhKSB7IGEuZW1pdChcInN0b3BcIik7IH1cbiAgICBmdW5jdGlvbiBUKGEsIGIsIGMpIHtcbiAgICAgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFQpKVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBUKGEsIGIsIGMpO1xuICAgICAgICB0aGlzLl92b2wgPVxuICAgICAgICAgICAgYTtcbiAgICAgICAgYyA9IGFhKHt9LCBwKGMsIHt9KSk7XG4gICAgICAgIHZvaWQgMCA9PT0gYy5oaWdoV2F0ZXJNYXJrICYmIChjLmhpZ2hXYXRlck1hcmsgPSA2NTUzNik7XG4gICAgICAgIFkuUmVhZGFibGUuY2FsbCh0aGlzLCBjKTtcbiAgICAgICAgdGhpcy5wYXRoID0gbShiKTtcbiAgICAgICAgdGhpcy5mZCA9IHZvaWQgMCA9PT0gYy5mZCA/IG51bGwgOiBjLmZkO1xuICAgICAgICB0aGlzLmZsYWdzID0gdm9pZCAwID09PSBjLmZsYWdzID8gXCJyXCIgOiBjLmZsYWdzO1xuICAgICAgICB0aGlzLm1vZGUgPSB2b2lkIDAgPT09IGMubW9kZSA/IDQzOCA6IGMubW9kZTtcbiAgICAgICAgdGhpcy5zdGFydCA9IGMuc3RhcnQ7XG4gICAgICAgIHRoaXMuZW5kID0gYy5lbmQ7XG4gICAgICAgIHRoaXMuYXV0b0Nsb3NlID0gdm9pZCAwID09PSBjLmF1dG9DbG9zZSA/ICEwIDogYy5hdXRvQ2xvc2U7XG4gICAgICAgIHRoaXMucG9zID0gdm9pZCAwO1xuICAgICAgICB0aGlzLmJ5dGVzUmVhZCA9IDA7XG4gICAgICAgIGlmICh2b2lkIDAgIT09IHRoaXMuc3RhcnQpIHtcbiAgICAgICAgICAgIGlmIChcIm51bWJlclwiICE9PSB0eXBlb2YgdGhpcy5zdGFydClcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdcInN0YXJ0XCIgb3B0aW9uIG11c3QgYmUgYSBOdW1iZXInKTtcbiAgICAgICAgICAgIGlmICh2b2lkIDAgPT09IHRoaXMuZW5kKVxuICAgICAgICAgICAgICAgIHRoaXMuZW5kID0gSW5maW5pdHk7XG4gICAgICAgICAgICBlbHNlIGlmIChcIm51bWJlclwiICE9PVxuICAgICAgICAgICAgICAgIHR5cGVvZiB0aGlzLmVuZClcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdcImVuZFwiIG9wdGlvbiBtdXN0IGJlIGEgTnVtYmVyJyk7XG4gICAgICAgICAgICBpZiAodGhpcy5zdGFydCA+IHRoaXMuZW5kKVxuICAgICAgICAgICAgICAgIHRocm93IEVycm9yKCdcInN0YXJ0XCIgb3B0aW9uIG11c3QgYmUgPD0gXCJlbmRcIiBvcHRpb24nKTtcbiAgICAgICAgICAgIHRoaXMucG9zID0gdGhpcy5zdGFydDtcbiAgICAgICAgfVxuICAgICAgICBcIm51bWJlclwiICE9PSB0eXBlb2YgdGhpcy5mZCAmJiB0aGlzLm9wZW4oKTtcbiAgICAgICAgdGhpcy5vbihcImVuZFwiLCBmdW5jdGlvbiAoKSB7IHRoaXMuYXV0b0Nsb3NlICYmIHRoaXMuZGVzdHJveSAmJiB0aGlzLmRlc3Ryb3koKTsgfSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGZmKCkgeyB0aGlzLmNsb3NlKCk7IH1cbiAgICBmdW5jdGlvbiBSKGEsIGIsIGMpIHtcbiAgICAgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFIpKVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBSKGEsIGIsIGMpO1xuICAgICAgICB0aGlzLl92b2wgPSBhO1xuICAgICAgICBjID0gYWEoe30sIHAoYywge30pKTtcbiAgICAgICAgWS5Xcml0YWJsZS5jYWxsKHRoaXMsIGMpO1xuICAgICAgICB0aGlzLnBhdGggPSBtKGIpO1xuICAgICAgICB0aGlzLmZkID0gdm9pZCAwID09PSBjLmZkID8gbnVsbCA6IGMuZmQ7XG4gICAgICAgIHRoaXMuZmxhZ3MgPSB2b2lkIDAgPT09IGMuZmxhZ3MgPyBcIndcIiA6IGMuZmxhZ3M7XG4gICAgICAgIHRoaXMubW9kZSA9IHZvaWQgMCA9PT0gYy5tb2RlID8gNDM4IDogYy5tb2RlO1xuICAgICAgICB0aGlzLnN0YXJ0ID0gYy5zdGFydDtcbiAgICAgICAgdGhpcy5hdXRvQ2xvc2UgPSB2b2lkIDAgPT09IGMuYXV0b0Nsb3NlID8gITAgOiAhIWMuYXV0b0Nsb3NlO1xuICAgICAgICB0aGlzLnBvcyA9IHZvaWQgMDtcbiAgICAgICAgdGhpcy5ieXRlc1dyaXR0ZW4gPSAwO1xuICAgICAgICBpZiAodm9pZCAwICE9PSB0aGlzLnN0YXJ0KSB7XG4gICAgICAgICAgICBpZiAoXCJudW1iZXJcIiAhPT0gdHlwZW9mIHRoaXMuc3RhcnQpXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignXCJzdGFydFwiIG9wdGlvbiBtdXN0IGJlIGEgTnVtYmVyJyk7XG4gICAgICAgICAgICBpZiAoMCA+IHRoaXMuc3RhcnQpXG4gICAgICAgICAgICAgICAgdGhyb3cgRXJyb3IoJ1wic3RhcnRcIiBtdXN0IGJlID49IHplcm8nKTtcbiAgICAgICAgICAgIHRoaXMucG9zID0gdGhpcy5zdGFydDtcbiAgICAgICAgfVxuICAgICAgICBjLmVuY29kaW5nICYmIHRoaXMuc2V0RGVmYXVsdEVuY29kaW5nKGMuZW5jb2RpbmcpO1xuICAgICAgICBcIm51bWJlclwiICE9PSB0eXBlb2YgdGhpcy5mZCAmJiB0aGlzLm9wZW4oKTtcbiAgICAgICAgdGhpcy5vbmNlKFwiZmluaXNoXCIsIGZ1bmN0aW9uICgpIHsgdGhpcy5hdXRvQ2xvc2UgJiYgdGhpcy5jbG9zZSgpOyB9KTtcbiAgICB9XG4gICAgdmFyIEphID0gbCAmJiBsLl9fZXh0ZW5kcyB8fFxuICAgICAgICBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGEoYiwgYykgeyBhID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGEsIGIpIHsgYS5fX3Byb3RvX18gPSBiOyB9IHx8IGZ1bmN0aW9uIChhLCBiKSB7IGZvciAodmFyIGMgaW4gYilcbiAgICAgICAgICAgIGIuaGFzT3duUHJvcGVydHkoYykgJiYgKGFbY10gPSBiW2NdKTsgfTsgcmV0dXJuIGEoYiwgYyk7IH0gcmV0dXJuIGZ1bmN0aW9uIChiLCBjKSB7IGZ1bmN0aW9uIGQoKSB7IHRoaXMuY29uc3RydWN0b3IgPSBiOyB9IGEoYiwgYyk7IGIucHJvdG90eXBlID0gbnVsbCA9PT0gYyA/IE9iamVjdC5jcmVhdGUoYykgOiAoZC5wcm90b3R5cGUgPSBjLnByb3RvdHlwZSwgbmV3IGQpOyB9OyB9KCksIFhiID0gbCAmJiBsLl9fc3ByZWFkQXJyYXlzIHx8IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZm9yICh2YXIgYSA9IDAsIGIgPSAwLCBjID0gYXJndW1lbnRzLmxlbmd0aDsgYiA8IGM7IGIrKylcbiAgICAgICAgICAgIGEgKz0gYXJndW1lbnRzW2JdLmxlbmd0aDtcbiAgICAgICAgYSA9IEFycmF5KGEpO1xuICAgICAgICB2YXIgZCA9IDA7XG4gICAgICAgIGZvciAoYiA9IDA7IGIgPCBjOyBiKyspXG4gICAgICAgICAgICBmb3IgKHZhciBlID0gYXJndW1lbnRzW2JdLCBmID0gMCwgZyA9IGUubGVuZ3RoOyBmIDxcbiAgICAgICAgICAgICAgICBnOyBmKyssIGQrKylcbiAgICAgICAgICAgICAgICBhW2RdID0gZVtmXTtcbiAgICAgICAgcmV0dXJuIGE7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoYiwgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6ICEwIH0pO1xuICAgIHZhciBhYSA9IGxlLmV4dGVuZCwgY2YgPSBaYy5yZXNvbHZlLCBtYiA9IHcuY29uc3RhbnRzLk9fUkRPTkxZLCBLYSA9IHcuY29uc3RhbnRzLk9fV1JPTkxZLCBuYSA9IHcuY29uc3RhbnRzLk9fUkRXUiwgVSA9IHcuY29uc3RhbnRzLk9fQ1JFQVQsIG5iID0gdy5jb25zdGFudHMuT19FWENMLCBaYSA9IHcuY29uc3RhbnRzLk9fVFJVTkMsICRhID0gdy5jb25zdGFudHMuT19BUFBFTkQsIHZkID0gdy5jb25zdGFudHMuT19TWU5DLCBnZiA9IHcuY29uc3RhbnRzLk9fRElSRUNUT1JZLCB3ZCA9IHcuY29uc3RhbnRzLkZfT0ssIGhmID0gdy5jb25zdGFudHMuQ09QWUZJTEVfRVhDTCwgamYgPSB3LmNvbnN0YW50cy5DT1BZRklMRV9GSUNMT05FX0ZPUkNFO1xuICAgIHZhciBTID0gWmMuc2VwO1xuICAgIHZhciB4ZCA9IFpjLnJlbGF0aXZlO1xuICAgIHZhciBZYiA9IFwid2luMzJcIiA9PT0gTC5kZWZhdWx0LnBsYXRmb3JtLCBmYSA9IHsgUEFUSF9TVFI6IFwicGF0aCBtdXN0IGJlIGEgc3RyaW5nIG9yIEJ1ZmZlclwiLFxuICAgICAgICBGRDogXCJmZCBtdXN0IGJlIGEgZmlsZSBkZXNjcmlwdG9yXCIsIE1PREVfSU5UOiBcIm1vZGUgbXVzdCBiZSBhbiBpbnRcIiwgQ0I6IFwiY2FsbGJhY2sgbXVzdCBiZSBhIGZ1bmN0aW9uXCIsIFVJRDogXCJ1aWQgbXVzdCBiZSBhbiB1bnNpZ25lZCBpbnRcIiwgR0lEOiBcImdpZCBtdXN0IGJlIGFuIHVuc2lnbmVkIGludFwiLCBMRU46IFwibGVuIG11c3QgYmUgYW4gaW50ZWdlclwiLCBBVElNRTogXCJhdGltZSBtdXN0IGJlIGFuIGludGVnZXJcIiwgTVRJTUU6IFwibXRpbWUgbXVzdCBiZSBhbiBpbnRlZ2VyXCIsIFBSRUZJWDogXCJmaWxlbmFtZSBwcmVmaXggaXMgcmVxdWlyZWRcIiwgQlVGRkVSOiBcImJ1ZmZlciBtdXN0IGJlIGFuIGluc3RhbmNlIG9mIEJ1ZmZlciBvciBTdGF0aWNCdWZmZXJcIiwgT0ZGU0VUOiBcIm9mZnNldCBtdXN0IGJlIGFuIGludGVnZXJcIiwgTEVOR1RIOiBcImxlbmd0aCBtdXN0IGJlIGFuIGludGVnZXJcIiwgUE9TSVRJT046IFwicG9zaXRpb24gbXVzdCBiZSBhbiBpbnRlZ2VyXCIgfSwgdWE7XG4gICAgKGZ1bmN0aW9uIChhKSB7XG4gICAgICAgIGFbYS5yID0gbWJdID0gXCJyXCI7XG4gICAgICAgIGFbYVtcInIrXCJdID1cbiAgICAgICAgICAgIG5hXSA9IFwicitcIjtcbiAgICAgICAgYVthLnJzID0gbWIgfCB2ZF0gPSBcInJzXCI7XG4gICAgICAgIGFbYS5zciA9IGEucnNdID0gXCJzclwiO1xuICAgICAgICBhW2FbXCJycytcIl0gPSBuYSB8IHZkXSA9IFwicnMrXCI7XG4gICAgICAgIGFbYVtcInNyK1wiXSA9IGFbXCJycytcIl1dID0gXCJzcitcIjtcbiAgICAgICAgYVthLncgPSBLYSB8IFUgfCBaYV0gPSBcIndcIjtcbiAgICAgICAgYVthLnd4ID0gS2EgfCBVIHwgWmEgfCBuYl0gPSBcInd4XCI7XG4gICAgICAgIGFbYS54dyA9IGEud3hdID0gXCJ4d1wiO1xuICAgICAgICBhW2FbXCJ3K1wiXSA9IG5hIHwgVSB8IFphXSA9IFwidytcIjtcbiAgICAgICAgYVthW1wid3grXCJdID0gbmEgfCBVIHwgWmEgfCBuYl0gPSBcInd4K1wiO1xuICAgICAgICBhW2FbXCJ4dytcIl0gPSBhW1wid3grXCJdXSA9IFwieHcrXCI7XG4gICAgICAgIGFbYS5hID0gS2EgfCAkYSB8IFVdID0gXCJhXCI7XG4gICAgICAgIGFbYS5heCA9IEthIHwgJGEgfCBVIHwgbmJdID0gXCJheFwiO1xuICAgICAgICBhW2EueGEgPSBhLmF4XSA9IFwieGFcIjtcbiAgICAgICAgYVthW1wiYStcIl0gPSBuYSB8ICRhIHwgVV0gPSBcImErXCI7XG4gICAgICAgIGFbYVtcImF4K1wiXSA9IG5hIHwgJGEgfCBVIHwgbmJdID0gXCJheCtcIjtcbiAgICAgICAgYVthW1wieGErXCJdID0gYVtcImF4K1wiXV0gPSBcInhhK1wiO1xuICAgIH0pKHVhID0gYi5GTEFHUyB8fCAoYi5GTEFHUyA9IHt9KSk7XG4gICAgYi5mbGFnc1RvTnVtYmVyID0gaztcbiAgICBhID0geyBlbmNvZGluZzogXCJ1dGY4XCIgfTtcbiAgICB2YXIgb2IgPSBuKGEpLCB5ZCA9IEIob2IpLCB6ZCA9IG4oeyBmbGFnOiBcInJcIiB9KSwgQWQgPSB7IGVuY29kaW5nOiBcInV0ZjhcIixcbiAgICAgICAgbW9kZTogNDM4LCBmbGFnOiB1YVt1YS53XSB9LCBCZCA9IG4oQWQpLCBDZCA9IHsgZW5jb2Rpbmc6IFwidXRmOFwiLCBtb2RlOiA0MzgsIGZsYWc6IHVhW3VhLmFdIH0sIERkID0gbihDZCksIGtmID0gQihEZCksIEVkID0gbihhKSwgbGYgPSBCKEVkKSwgdWQgPSB7IG1vZGU6IDUxMSwgcmVjdXJzaXZlOiAhMSB9LCBGZCA9IHsgcmVjdXJzaXZlOiAhMSB9LCBHZCA9IG4oeyBlbmNvZGluZzogXCJ1dGY4XCIsIHdpdGhGaWxlVHlwZXM6ICExIH0pLCBtZiA9IEIoR2QpLCBkZiA9IHsgYmlnaW50OiAhMSB9O1xuICAgIGIucGF0aFRvRmlsZW5hbWUgPSBtO1xuICAgIGlmIChZYikge1xuICAgICAgICB2YXIgbmYgPSBjLCBvZiA9IFdlLnVuaXhpZnk7XG4gICAgICAgIGMgPSBmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gb2YobmYoYSwgYikpOyB9O1xuICAgIH1cbiAgICBiLmZpbGVuYW1lVG9TdGVwcyA9IHY7XG4gICAgYi5wYXRoVG9TdGVwcyA9IHhhO1xuICAgIGIuZGF0YVRvU3RyID0gZnVuY3Rpb24gKGEsIGIpIHsgdm9pZCAwID09PSBiICYmIChiID0gSy5FTkNPRElOR19VVEY4KTsgcmV0dXJuIEYuQnVmZmVyLmlzQnVmZmVyKGEpID8gYS50b1N0cmluZyhiKSA6IGEgaW5zdGFuY2VvZiBVaW50OEFycmF5ID8gRi5idWZmZXJGcm9tKGEpLnRvU3RyaW5nKGIpIDogU3RyaW5nKGEpOyB9O1xuICAgIGIuZGF0YVRvQnVmZmVyID0gTGE7XG4gICAgYi5idWZmZXJUb0VuY29kaW5nID0gJGI7XG4gICAgYi50b1VuaXhUaW1lc3RhbXAgPSBoYTtcbiAgICBhID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBhKGEpIHtcbiAgICAgICAgICAgIHZvaWQgMCA9PT0gYSAmJiAoYSA9IHt9KTtcbiAgICAgICAgICAgIHRoaXMuaW5vID0gMDtcbiAgICAgICAgICAgIHRoaXMuaW5vZGVzID0ge307XG4gICAgICAgICAgICB0aGlzLnJlbGVhc2VkSW5vcyA9IFtdO1xuICAgICAgICAgICAgdGhpcy5mZHMgPSB7fTtcbiAgICAgICAgICAgIHRoaXMucmVsZWFzZWRGZHMgPSBbXTtcbiAgICAgICAgICAgIHRoaXMubWF4RmlsZXMgPSAxRTQ7XG4gICAgICAgICAgICB0aGlzLm9wZW5GaWxlcyA9IDA7XG4gICAgICAgICAgICB0aGlzLnByb21pc2VzQXBpID0gbWUuZGVmYXVsdCh0aGlzKTtcbiAgICAgICAgICAgIHRoaXMuc3RhdFdhdGNoZXJzID0ge307XG4gICAgICAgICAgICB0aGlzLnByb3BzID0gYWEoeyBOb2RlOiBmZC5Ob2RlLCBMaW5rOiBmZC5MaW5rLCBGaWxlOiBmZC5GaWxlIH0sIGEpO1xuICAgICAgICAgICAgYSA9IHRoaXMuY3JlYXRlTGluaygpO1xuICAgICAgICAgICAgYS5zZXROb2RlKHRoaXMuY3JlYXRlTm9kZSghMCkpO1xuICAgICAgICAgICAgdmFyIGIgPSB0aGlzO1xuICAgICAgICAgICAgdGhpcy5TdGF0V2F0Y2hlciA9IGZ1bmN0aW9uIChhKSB7IGZ1bmN0aW9uIGMoKSB7IHJldHVybiBhLmNhbGwodGhpcywgYikgfHwgdGhpczsgfSBKYShjLCBhKTsgcmV0dXJuIGM7IH0oSGQpO1xuICAgICAgICAgICAgdGhpcy5SZWFkU3RyZWFtID1cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiAoYSkgeyBmdW5jdGlvbiBjKCkgeyBmb3IgKHZhciBjID0gW10sIGQgPSAwOyBkIDwgYXJndW1lbnRzLmxlbmd0aDsgZCsrKVxuICAgICAgICAgICAgICAgICAgICBjW2RdID0gYXJndW1lbnRzW2RdOyByZXR1cm4gYS5hcHBseSh0aGlzLCBYYihbYl0sIGMpKSB8fCB0aGlzOyB9IEphKGMsIGEpOyByZXR1cm4gYzsgfShUKTtcbiAgICAgICAgICAgIHRoaXMuV3JpdGVTdHJlYW0gPSBmdW5jdGlvbiAoYSkgeyBmdW5jdGlvbiBjKCkgeyBmb3IgKHZhciBjID0gW10sIGQgPSAwOyBkIDwgYXJndW1lbnRzLmxlbmd0aDsgZCsrKVxuICAgICAgICAgICAgICAgIGNbZF0gPSBhcmd1bWVudHNbZF07IHJldHVybiBhLmFwcGx5KHRoaXMsIFhiKFtiXSwgYykpIHx8IHRoaXM7IH0gSmEoYywgYSk7IHJldHVybiBjOyB9KFIpO1xuICAgICAgICAgICAgdGhpcy5GU1dhdGNoZXIgPSBmdW5jdGlvbiAoYSkgeyBmdW5jdGlvbiBjKCkgeyByZXR1cm4gYS5jYWxsKHRoaXMsIGIpIHx8IHRoaXM7IH0gSmEoYywgYSk7IHJldHVybiBjOyB9KElkKTtcbiAgICAgICAgICAgIHRoaXMucm9vdCA9IGE7XG4gICAgICAgIH1cbiAgICAgICAgYS5mcm9tSlNPTiA9IGZ1bmN0aW9uIChiLCBjKSB7IHZhciBkID0gbmV3IGE7IGQuZnJvbUpTT04oYiwgYyk7IHJldHVybiBkOyB9O1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoYS5wcm90b3R5cGUsIFwicHJvbWlzZXNcIiwgeyBnZXQ6IGZ1bmN0aW9uICgpIHsgaWYgKG51bGwgPT09IHRoaXMucHJvbWlzZXNBcGkpXG4gICAgICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJQcm9taXNlIGlzIG5vdCBzdXBwb3J0ZWQgaW4gdGhpcyBlbnZpcm9ubWVudC5cIik7IHJldHVybiB0aGlzLnByb21pc2VzQXBpOyB9LCBlbnVtZXJhYmxlOiAhMCwgY29uZmlndXJhYmxlOiAhMCB9KTtcbiAgICAgICAgYS5wcm90b3R5cGUuY3JlYXRlTGluayA9IGZ1bmN0aW9uIChhLCBiLCBjLCBkKSB7IHZvaWQgMCA9PT0gYyAmJiAoYyA9ICExKTsgaWYgKCFhKVxuICAgICAgICAgICAgcmV0dXJuIG5ldyB0aGlzLnByb3BzLkxpbmsodGhpcywgbnVsbCwgXCJcIik7IGlmICghYilcbiAgICAgICAgICAgIHRocm93IEVycm9yKFwiY3JlYXRlTGluazogbmFtZSBjYW5ub3QgYmUgZW1wdHlcIik7IHJldHVybiBhLmNyZWF0ZUNoaWxkKGIsIHRoaXMuY3JlYXRlTm9kZShjLCBkKSk7IH07XG4gICAgICAgIGEucHJvdG90eXBlLmRlbGV0ZUxpbmsgPSBmdW5jdGlvbiAoYSkgeyB2YXIgYiA9IGEucGFyZW50OyByZXR1cm4gYiA/IChiLmRlbGV0ZUNoaWxkKGEpLCAhMCkgOiAhMTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUubmV3SW5vTnVtYmVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGEgPSB0aGlzLnJlbGVhc2VkSW5vcy5wb3AoKTtcbiAgICAgICAgICAgIHJldHVybiBhID8gYSA6IHRoaXMuaW5vID0gKHRoaXMuaW5vICsgMSkgJSA0Mjk0OTY3Mjk1O1xuICAgICAgICB9O1xuICAgICAgICBhLnByb3RvdHlwZS5uZXdGZE51bWJlciA9IGZ1bmN0aW9uICgpIHsgdmFyIGIgPSB0aGlzLnJlbGVhc2VkRmRzLnBvcCgpOyByZXR1cm4gXCJudW1iZXJcIiA9PT0gdHlwZW9mIGIgPyBiIDogYS5mZC0tOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5jcmVhdGVOb2RlID0gZnVuY3Rpb24gKGEsIGIpIHsgdm9pZCAwID09PSBhICYmIChhID0gITEpOyBiID0gbmV3IHRoaXMucHJvcHMuTm9kZSh0aGlzLm5ld0lub051bWJlcigpLCBiKTsgYSAmJiBiLnNldElzRGlyZWN0b3J5KCk7IHJldHVybiB0aGlzLmlub2Rlc1tiLmlub10gPSBiOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5nZXROb2RlID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIHRoaXMuaW5vZGVzW2FdOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5kZWxldGVOb2RlID0gZnVuY3Rpb24gKGEpIHsgYS5kZWwoKTsgZGVsZXRlIHRoaXMuaW5vZGVzW2EuaW5vXTsgdGhpcy5yZWxlYXNlZElub3MucHVzaChhLmlubyk7IH07XG4gICAgICAgIGEucHJvdG90eXBlLmdlblJuZFN0ciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBhID0gKE1hdGgucmFuZG9tKCkgK1xuICAgICAgICAgICAgICAgIDEpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgNik7XG4gICAgICAgICAgICByZXR1cm4gNiA9PT0gYS5sZW5ndGggPyBhIDogdGhpcy5nZW5SbmRTdHIoKTtcbiAgICAgICAgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuZ2V0TGluayA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiB0aGlzLnJvb3Qud2FsayhhKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuZ2V0TGlua09yVGhyb3cgPSBmdW5jdGlvbiAoYSwgYikgeyB2YXIgYyA9IHYoYSk7IGMgPSB0aGlzLmdldExpbmsoYyk7IGlmICghYylcbiAgICAgICAgICAgIHRocm93IGgoXCJFTk9FTlRcIiwgYiwgYSk7IHJldHVybiBjOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5nZXRSZXNvbHZlZExpbmsgPSBmdW5jdGlvbiAoYSkgeyBhID0gXCJzdHJpbmdcIiA9PT0gdHlwZW9mIGEgPyB2KGEpIDogYTsgZm9yICh2YXIgYiA9IHRoaXMucm9vdCwgYyA9IDA7IGMgPCBhLmxlbmd0aDspIHtcbiAgICAgICAgICAgIGIgPSBiLmdldENoaWxkKGFbY10pO1xuICAgICAgICAgICAgaWYgKCFiKVxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgdmFyIGQgPSBiLmdldE5vZGUoKTtcbiAgICAgICAgICAgIGQuaXNTeW1saW5rKCkgPyAoYSA9IGQuc3ltbGluay5jb25jYXQoYS5zbGljZShjICsgMSkpLCBiID0gdGhpcy5yb290LCBjID0gMCkgOiBjKys7XG4gICAgICAgIH0gcmV0dXJuIGI7IH07XG4gICAgICAgIGEucHJvdG90eXBlLmdldFJlc29sdmVkTGlua09yVGhyb3cgPVxuICAgICAgICAgICAgZnVuY3Rpb24gKGEsIGIpIHsgdmFyIGMgPSB0aGlzLmdldFJlc29sdmVkTGluayhhKTsgaWYgKCFjKVxuICAgICAgICAgICAgICAgIHRocm93IGgoXCJFTk9FTlRcIiwgYiwgYSk7IHJldHVybiBjOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5yZXNvbHZlU3ltbGlua3MgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gdGhpcy5nZXRSZXNvbHZlZExpbmsoYS5zdGVwcy5zbGljZSgxKSk7IH07XG4gICAgICAgIGEucHJvdG90eXBlLmdldExpbmtBc0Rpck9yVGhyb3cgPSBmdW5jdGlvbiAoYSwgYikgeyB2YXIgYyA9IHRoaXMuZ2V0TGlua09yVGhyb3coYSwgYik7IGlmICghYy5nZXROb2RlKCkuaXNEaXJlY3RvcnkoKSlcbiAgICAgICAgICAgIHRocm93IGgoXCJFTk9URElSXCIsIGIsIGEpOyByZXR1cm4gYzsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuZ2V0TGlua1BhcmVudCA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiB0aGlzLnJvb3Qud2FsayhhLCBhLmxlbmd0aCAtIDEpOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5nZXRMaW5rUGFyZW50QXNEaXJPclRocm93ID0gZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgICAgIGEgPSBhIGluc3RhbmNlb2YgQXJyYXkgPyBhIDogdihhKTtcbiAgICAgICAgICAgIHZhciBjID0gdGhpcy5nZXRMaW5rUGFyZW50KGEpO1xuICAgICAgICAgICAgaWYgKCFjKVxuICAgICAgICAgICAgICAgIHRocm93IGgoXCJFTk9FTlRcIiwgYiwgUyArIGEuam9pbihTKSk7XG4gICAgICAgICAgICBpZiAoIWMuZ2V0Tm9kZSgpLmlzRGlyZWN0b3J5KCkpXG4gICAgICAgICAgICAgICAgdGhyb3cgaChcIkVOT1RESVJcIiwgYiwgUyArIGEuam9pbihTKSk7XG4gICAgICAgICAgICByZXR1cm4gYztcbiAgICAgICAgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuZ2V0RmlsZUJ5RmQgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gdGhpcy5mZHNbU3RyaW5nKGEpXTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuZ2V0RmlsZUJ5RmRPclRocm93ID0gZnVuY3Rpb24gKGEsIGIpIHsgaWYgKGEgPj4+IDAgIT09IGEpXG4gICAgICAgICAgICB0aHJvdyBUeXBlRXJyb3IoZmEuRkQpOyBhID0gdGhpcy5nZXRGaWxlQnlGZChhKTsgaWYgKCFhKVxuICAgICAgICAgICAgdGhyb3cgaChcIkVCQURGXCIsIGIpOyByZXR1cm4gYTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuZ2V0Tm9kZUJ5SWRPckNyZWF0ZSA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7XG4gICAgICAgICAgICBpZiAoXCJudW1iZXJcIiA9PT0gdHlwZW9mIGEpIHtcbiAgICAgICAgICAgICAgICBhID0gdGhpcy5nZXRGaWxlQnlGZChhKTtcbiAgICAgICAgICAgICAgICBpZiAoIWEpXG4gICAgICAgICAgICAgICAgICAgIHRocm93IEVycm9yKFwiRmlsZSBudG8gZm91bmRcIik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGEubm9kZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBkID0geGEoYSksIGUgPSB0aGlzLmdldExpbmsoZCk7XG4gICAgICAgICAgICBpZiAoZSlcbiAgICAgICAgICAgICAgICByZXR1cm4gZS5nZXROb2RlKCk7XG4gICAgICAgICAgICBpZiAoYiAmIFUgJiYgKGIgPSB0aGlzLmdldExpbmtQYXJlbnQoZCkpKVxuICAgICAgICAgICAgICAgIHJldHVybiBlID1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVMaW5rKGIsIGRbZC5sZW5ndGggLSAxXSwgITEsIGMpLCBlLmdldE5vZGUoKTtcbiAgICAgICAgICAgIHRocm93IGgoXCJFTk9FTlRcIiwgXCJnZXROb2RlQnlJZE9yQ3JlYXRlXCIsIG0oYSkpO1xuICAgICAgICB9O1xuICAgICAgICBhLnByb3RvdHlwZS53cmFwQXN5bmMgPSBmdW5jdGlvbiAoYSwgYiwgYykgeyB2YXIgZCA9IHRoaXM7IHEoYyk7ICRjLmRlZmF1bHQoZnVuY3Rpb24gKCkgeyB0cnkge1xuICAgICAgICAgICAgYyhudWxsLCBhLmFwcGx5KGQsIGIpKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAodmEpIHtcbiAgICAgICAgICAgIGModmEpO1xuICAgICAgICB9IH0pOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5fdG9KU09OID0gZnVuY3Rpb24gKGEsIGIsIGMpIHtcbiAgICAgICAgICAgIHZhciBkO1xuICAgICAgICAgICAgdm9pZCAwID09PSBhICYmIChhID0gdGhpcy5yb290KTtcbiAgICAgICAgICAgIHZvaWQgMCA9PT0gYiAmJiAoYiA9IHt9KTtcbiAgICAgICAgICAgIHZhciBlID0gITAsIHIgPSBhLmNoaWxkcmVuO1xuICAgICAgICAgICAgYS5nZXROb2RlKCkuaXNGaWxlKCkgJiYgKHIgPSAoZCA9IHt9LCBkW2EuZ2V0TmFtZSgpXSA9IGEucGFyZW50LmdldENoaWxkKGEuZ2V0TmFtZSgpKSwgZCksIGEgPSBhLnBhcmVudCk7XG4gICAgICAgICAgICBmb3IgKHZhciBEIGluIHIpIHtcbiAgICAgICAgICAgICAgICBlID0gITE7XG4gICAgICAgICAgICAgICAgciA9IGEuZ2V0Q2hpbGQoRCk7XG4gICAgICAgICAgICAgICAgaWYgKCFyKVxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBFcnJvcihcIl90b0pTT046IHVuZXhwZWN0ZWQgdW5kZWZpbmVkXCIpO1xuICAgICAgICAgICAgICAgIGQgPSByLmdldE5vZGUoKTtcbiAgICAgICAgICAgICAgICBkLmlzRmlsZSgpID8gKHIgPSByLmdldFBhdGgoKSwgYyAmJiAociA9IHhkKGMsIHIpKSwgYltyXSA9IGQuZ2V0U3RyaW5nKCkpIDogZC5pc0RpcmVjdG9yeSgpICYmIHRoaXMuX3RvSlNPTihyLCBiLCBjKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGEgPSBhLmdldFBhdGgoKTtcbiAgICAgICAgICAgIGMgJiYgKGEgPSB4ZChjLCBhKSk7XG4gICAgICAgICAgICBhICYmIGUgJiYgKGJbYV0gPSBudWxsKTtcbiAgICAgICAgICAgIHJldHVybiBiO1xuICAgICAgICB9O1xuICAgICAgICBhLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiAoYSwgYiwgYykgeyB2b2lkIDAgPT09IGIgJiYgKGIgPSB7fSk7IHZvaWQgMCA9PT0gYyAmJiAoYyA9ICExKTsgdmFyIGQgPSBbXTsgaWYgKGEpIHtcbiAgICAgICAgICAgIGEgaW5zdGFuY2VvZiBBcnJheSB8fCAoYSA9IFthXSk7XG4gICAgICAgICAgICBmb3IgKHZhciBlID0gMDsgZSA8IGEubGVuZ3RoOyBlKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgciA9IG0oYVtlXSk7XG4gICAgICAgICAgICAgICAgKHIgPSB0aGlzLmdldFJlc29sdmVkTGluayhyKSkgJiYgZC5wdXNoKHIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIGQucHVzaCh0aGlzLnJvb3QpOyBpZiAoIWQubGVuZ3RoKVxuICAgICAgICAgICAgcmV0dXJuIGI7IGZvciAoZSA9IDA7IGUgPCBkLmxlbmd0aDsgZSsrKVxuICAgICAgICAgICAgciA9IGRbZV0sIHRoaXMuX3RvSlNPTihyLCBiLCBjID8gci5nZXRQYXRoKCkgOiBcIlwiKTsgcmV0dXJuIGI7IH07XG4gICAgICAgIGEucHJvdG90eXBlLmZyb21KU09OID1cbiAgICAgICAgICAgIGZ1bmN0aW9uIChhLCBiKSB7IHZvaWQgMCA9PT0gYiAmJiAoYiA9IEwuZGVmYXVsdC5jd2QoKSk7IGZvciAodmFyIGQgaW4gYSkge1xuICAgICAgICAgICAgICAgIHZhciBlID0gYVtkXTtcbiAgICAgICAgICAgICAgICBpZiAoXCJzdHJpbmdcIiA9PT0gdHlwZW9mIGUpIHtcbiAgICAgICAgICAgICAgICAgICAgZCA9IGMoZCwgYik7XG4gICAgICAgICAgICAgICAgICAgIHZhciByID0gdihkKTtcbiAgICAgICAgICAgICAgICAgICAgMSA8IHIubGVuZ3RoICYmIChyID0gUyArIHIuc2xpY2UoMCwgci5sZW5ndGggLSAxKS5qb2luKFMpLCB0aGlzLm1rZGlycEJhc2UociwgNTExKSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMud3JpdGVGaWxlU3luYyhkLCBlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICB0aGlzLm1rZGlycEJhc2UoZCwgNTExKTtcbiAgICAgICAgICAgIH0gfTtcbiAgICAgICAgYS5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbiAoKSB7IHRoaXMuaW5vID0gMDsgdGhpcy5pbm9kZXMgPSB7fTsgdGhpcy5yZWxlYXNlZElub3MgPSBbXTsgdGhpcy5mZHMgPSB7fTsgdGhpcy5yZWxlYXNlZEZkcyA9IFtdOyB0aGlzLm9wZW5GaWxlcyA9IDA7IHRoaXMucm9vdCA9IHRoaXMuY3JlYXRlTGluaygpOyB0aGlzLnJvb3Quc2V0Tm9kZSh0aGlzLmNyZWF0ZU5vZGUoITApKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUubW91bnRTeW5jID0gZnVuY3Rpb24gKGEsIGIpIHsgdGhpcy5mcm9tSlNPTihiLCBhKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUub3BlbkxpbmsgPVxuICAgICAgICAgICAgZnVuY3Rpb24gKGEsIGIsIGMpIHsgdm9pZCAwID09PSBjICYmIChjID0gITApOyBpZiAodGhpcy5vcGVuRmlsZXMgPj0gdGhpcy5tYXhGaWxlcylcbiAgICAgICAgICAgICAgICB0aHJvdyBoKFwiRU1GSUxFXCIsIFwib3BlblwiLCBhLmdldFBhdGgoKSk7IHZhciBkID0gYTsgYyAmJiAoZCA9IHRoaXMucmVzb2x2ZVN5bWxpbmtzKGEpKTsgaWYgKCFkKVxuICAgICAgICAgICAgICAgIHRocm93IGgoXCJFTk9FTlRcIiwgXCJvcGVuXCIsIGEuZ2V0UGF0aCgpKTsgYyA9IGQuZ2V0Tm9kZSgpOyBpZiAoYy5pc0RpcmVjdG9yeSgpKSB7XG4gICAgICAgICAgICAgICAgaWYgKChiICYgKG1iIHwgbmEgfCBLYSkpICE9PSBtYilcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgaChcIkVJU0RJUlwiLCBcIm9wZW5cIiwgYS5nZXRQYXRoKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoYiAmIGdmKVxuICAgICAgICAgICAgICAgIHRocm93IGgoXCJFTk9URElSXCIsIFwib3BlblwiLCBhLmdldFBhdGgoKSk7IGlmICghKGIgJiBLYSB8fCBjLmNhblJlYWQoKSkpXG4gICAgICAgICAgICAgICAgdGhyb3cgaChcIkVBQ0NFU1wiLCBcIm9wZW5cIiwgYS5nZXRQYXRoKCkpOyBhID0gbmV3IHRoaXMucHJvcHMuRmlsZShhLCBjLCBiLCB0aGlzLm5ld0ZkTnVtYmVyKCkpOyB0aGlzLmZkc1thLmZkXSA9IGE7IHRoaXMub3BlbkZpbGVzKys7IGIgJiBaYSAmJiBhLnRydW5jYXRlKCk7IHJldHVybiBhOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5vcGVuRmlsZSA9IGZ1bmN0aW9uIChhLCBiLCBjLCBkKSB7IHZvaWQgMCA9PT0gZCAmJiAoZCA9ICEwKTsgdmFyIGUgPSB2KGEpLCByID0gZCA/IHRoaXMuZ2V0UmVzb2x2ZWRMaW5rKGUpIDogdGhpcy5nZXRMaW5rKGUpOyBpZiAoIXIgJiYgYiAmIFUpIHtcbiAgICAgICAgICAgIHZhciBEID0gdGhpcy5nZXRSZXNvbHZlZExpbmsoZS5zbGljZSgwLCBlLmxlbmd0aCAtIDEpKTtcbiAgICAgICAgICAgIGlmICghRClcbiAgICAgICAgICAgICAgICB0aHJvdyBoKFwiRU5PRU5UXCIsIFwib3BlblwiLCBTICsgZS5qb2luKFMpKTtcbiAgICAgICAgICAgIGIgJiBVICYmIFwibnVtYmVyXCIgPT09IHR5cGVvZiBjICYmIChyID0gdGhpcy5jcmVhdGVMaW5rKEQsIGVbZS5sZW5ndGggLSAxXSwgITEsIGMpKTtcbiAgICAgICAgfSBpZiAocilcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm9wZW5MaW5rKHIsIGIsIGQpOyB0aHJvdyBoKFwiRU5PRU5UXCIsIFwib3BlblwiLCBhKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUub3BlbkJhc2UgPSBmdW5jdGlvbiAoYSwgYiwgYywgZCkgeyB2b2lkIDAgPT09IGQgJiYgKGQgPSAhMCk7IGIgPSB0aGlzLm9wZW5GaWxlKGEsIGIsIGMsIGQpOyBpZiAoIWIpXG4gICAgICAgICAgICB0aHJvdyBoKFwiRU5PRU5UXCIsIFwib3BlblwiLCBhKTsgcmV0dXJuIGIuZmQ7IH07XG4gICAgICAgIGEucHJvdG90eXBlLm9wZW5TeW5jID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgdm9pZCAwID09PSBjICYmIChjID0gNDM4KTsgYyA9IE0oYyk7IGEgPSBtKGEpOyBiID0gayhiKTsgcmV0dXJuIHRoaXMub3BlbkJhc2UoYSwgYiwgYyk7IH07XG4gICAgICAgIGEucHJvdG90eXBlLm9wZW4gPSBmdW5jdGlvbiAoYSwgYiwgYywgZCkgeyB2YXIgZSA9IGM7IFwiZnVuY3Rpb25cIiA9PT0gdHlwZW9mIGMgJiYgKGUgPSA0MzgsIGQgPSBjKTsgYyA9IE0oZSB8fCA0MzgpOyBhID0gbShhKTsgYiA9IGsoYik7IHRoaXMud3JhcEFzeW5jKHRoaXMub3BlbkJhc2UsIFthLCBiLCBjXSwgZCk7IH07XG4gICAgICAgIGEucHJvdG90eXBlLmNsb3NlRmlsZSA9IGZ1bmN0aW9uIChhKSB7IHRoaXMuZmRzW2EuZmRdICYmICh0aGlzLm9wZW5GaWxlcy0tLCBkZWxldGUgdGhpcy5mZHNbYS5mZF0sIHRoaXMucmVsZWFzZWRGZHMucHVzaChhLmZkKSk7IH07XG4gICAgICAgIGEucHJvdG90eXBlLmNsb3NlU3luYyA9IGZ1bmN0aW9uIChhKSB7IFlhKGEpOyBhID0gdGhpcy5nZXRGaWxlQnlGZE9yVGhyb3coYSwgXCJjbG9zZVwiKTsgdGhpcy5jbG9zZUZpbGUoYSk7IH07XG4gICAgICAgIGEucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgICAgIFlhKGEpO1xuICAgICAgICAgICAgdGhpcy53cmFwQXN5bmModGhpcy5jbG9zZVN5bmMsIFthXSwgYik7XG4gICAgICAgIH07XG4gICAgICAgIGEucHJvdG90eXBlLm9wZW5GaWxlT3JHZXRCeUlkID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgaWYgKFwibnVtYmVyXCIgPT09IHR5cGVvZiBhKSB7XG4gICAgICAgICAgICBhID0gdGhpcy5mZHNbYV07XG4gICAgICAgICAgICBpZiAoIWEpXG4gICAgICAgICAgICAgICAgdGhyb3cgaChcIkVOT0VOVFwiKTtcbiAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICB9IHJldHVybiB0aGlzLm9wZW5GaWxlKG0oYSksIGIsIGMpOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5yZWFkQmFzZSA9IGZ1bmN0aW9uIChhLCBiLCBjLCBkLCBlKSB7IHJldHVybiB0aGlzLmdldEZpbGVCeUZkT3JUaHJvdyhhKS5yZWFkKGIsIE51bWJlcihjKSwgTnVtYmVyKGQpLCBlKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUucmVhZFN5bmMgPSBmdW5jdGlvbiAoYSwgYiwgYywgZCwgZSkgeyBZYShhKTsgcmV0dXJuIHRoaXMucmVhZEJhc2UoYSwgYiwgYywgZCwgZSk7IH07XG4gICAgICAgIGEucHJvdG90eXBlLnJlYWQgPSBmdW5jdGlvbiAoYSwgYiwgYywgZCwgZSwgZikge1xuICAgICAgICAgICAgdmFyIHIgPSB0aGlzO1xuICAgICAgICAgICAgcShmKTtcbiAgICAgICAgICAgIGlmICgwID09PSBkKVxuICAgICAgICAgICAgICAgIHJldHVybiBMLmRlZmF1bHQubmV4dFRpY2soZnVuY3Rpb24gKCkgeyBmICYmIGYobnVsbCwgMCwgYik7IH0pO1xuICAgICAgICAgICAgJGMuZGVmYXVsdChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIEQgPSByLnJlYWRCYXNlKGEsIGIsIGMsIGQsIGUpO1xuICAgICAgICAgICAgICAgICAgICBmKG51bGwsIEQsIGIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAocGYpIHtcbiAgICAgICAgICAgICAgICAgICAgZihwZik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIGEucHJvdG90eXBlLnJlYWRGaWxlQmFzZSA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7IHZhciBkID0gXCJudW1iZXJcIiA9PT0gdHlwZW9mIGEgJiYgYSA+Pj4gMCA9PT0gYTsgaWYgKCFkKSB7XG4gICAgICAgICAgICB2YXIgZSA9IG0oYSk7XG4gICAgICAgICAgICBlID0gdihlKTtcbiAgICAgICAgICAgIGlmICgoZSA9IHRoaXMuZ2V0UmVzb2x2ZWRMaW5rKGUpKSAmJiBlLmdldE5vZGUoKS5pc0RpcmVjdG9yeSgpKVxuICAgICAgICAgICAgICAgIHRocm93IGgoXCJFSVNESVJcIiwgXCJvcGVuXCIsIGUuZ2V0UGF0aCgpKTtcbiAgICAgICAgICAgIGEgPSB0aGlzLm9wZW5TeW5jKGEsIGIpO1xuICAgICAgICB9IHRyeSB7XG4gICAgICAgICAgICB2YXIgciA9ICRiKHRoaXMuZ2V0RmlsZUJ5RmRPclRocm93KGEpLmdldEJ1ZmZlcigpLCBjKTtcbiAgICAgICAgfVxuICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgIGQgfHwgdGhpcy5jbG9zZVN5bmMoYSk7XG4gICAgICAgIH0gcmV0dXJuIHI7IH07XG4gICAgICAgIGEucHJvdG90eXBlLnJlYWRGaWxlU3luYyA9IGZ1bmN0aW9uIChhLCBiKSB7IGIgPSB6ZChiKTsgdmFyIGMgPSBrKGIuZmxhZyk7IHJldHVybiB0aGlzLnJlYWRGaWxlQmFzZShhLCBjLCBiLmVuY29kaW5nKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUucmVhZEZpbGUgPSBmdW5jdGlvbiAoYSwgYiwgYykge1xuICAgICAgICAgICAgYyA9IEIoemQpKGIsIGMpO1xuICAgICAgICAgICAgYiA9IGNbMF07XG4gICAgICAgICAgICBjID0gY1sxXTtcbiAgICAgICAgICAgIHZhciBkID0gayhiLmZsYWcpO1xuICAgICAgICAgICAgdGhpcy53cmFwQXN5bmModGhpcy5yZWFkRmlsZUJhc2UsIFthLCBkLCBiLmVuY29kaW5nXSwgYyk7XG4gICAgICAgIH07XG4gICAgICAgIGEucHJvdG90eXBlLndyaXRlQmFzZSA9IGZ1bmN0aW9uIChhLCBiLCBjLCBkLCBlKSB7IHJldHVybiB0aGlzLmdldEZpbGVCeUZkT3JUaHJvdyhhLCBcIndyaXRlXCIpLndyaXRlKGIsIGMsIGQsIGUpOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS53cml0ZVN5bmMgPSBmdW5jdGlvbiAoYSwgYiwgYywgZCwgZSkgeyBZYShhKTsgdmFyIHIgPSBcInN0cmluZ1wiICE9PSB0eXBlb2YgYjsgaWYgKHIpIHtcbiAgICAgICAgICAgIHZhciBEID0gKGMgfHwgMCkgfCAwO1xuICAgICAgICAgICAgdmFyIGYgPSBkO1xuICAgICAgICAgICAgYyA9IGU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgdmFyIFhhID0gZDsgYiA9IExhKGIsIFhhKTsgciA/IFwidW5kZWZpbmVkXCIgPT09IHR5cGVvZiBmICYmIChmID0gYi5sZW5ndGgpIDogKEQgPSAwLCBmID0gYi5sZW5ndGgpOyByZXR1cm4gdGhpcy53cml0ZUJhc2UoYSwgYiwgRCwgZiwgYyk7IH07XG4gICAgICAgIGEucHJvdG90eXBlLndyaXRlID0gZnVuY3Rpb24gKGEsIGIsIGMsIGQsIGUsIGYpIHtcbiAgICAgICAgICAgIHZhciByID0gdGhpcztcbiAgICAgICAgICAgIFlhKGEpO1xuICAgICAgICAgICAgdmFyIEQgPSB0eXBlb2YgYiwgWGEgPSB0eXBlb2YgYywgZyA9IHR5cGVvZiBkLCBoID0gdHlwZW9mIGU7XG4gICAgICAgICAgICBpZiAoXCJzdHJpbmdcIiAhPT0gRClcbiAgICAgICAgICAgICAgICBpZiAoXCJmdW5jdGlvblwiID09PSBYYSlcbiAgICAgICAgICAgICAgICAgICAgdmFyIGsgPSBjO1xuICAgICAgICAgICAgICAgIGVsc2UgaWYgKFwiZnVuY3Rpb25cIiA9PT0gZykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGIgPSBjIHwgMDtcbiAgICAgICAgICAgICAgICAgICAgayA9IGQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKFwiZnVuY3Rpb25cIiA9PT0gaCkge1xuICAgICAgICAgICAgICAgICAgICBsYiA9IGMgfCAwO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbSA9IGQ7XG4gICAgICAgICAgICAgICAgICAgIGsgPSBlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbGIgPSBjIHwgMDtcbiAgICAgICAgICAgICAgICAgICAgbSA9IGQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuID0gZTtcbiAgICAgICAgICAgICAgICAgICAgayA9IGY7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoXCJmdW5jdGlvblwiID09PSBYYSlcbiAgICAgICAgICAgICAgICBrID0gYztcbiAgICAgICAgICAgIGVsc2UgaWYgKFwiZnVuY3Rpb25cIiA9PT0gZylcbiAgICAgICAgICAgICAgICBuID0gYywgayA9IGQ7XG4gICAgICAgICAgICBlbHNlIGlmIChcImZ1bmN0aW9uXCIgPT09IGgpIHtcbiAgICAgICAgICAgICAgICBuID0gYztcbiAgICAgICAgICAgICAgICB2YXIgdmEgPSBkO1xuICAgICAgICAgICAgICAgIGsgPSBlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHAgPSBMYShiLCB2YSk7XG4gICAgICAgICAgICBcInN0cmluZ1wiICE9PSBEID8gXCJ1bmRlZmluZWRcIiA9PT0gdHlwZW9mIG0gJiYgKG0gPSBwLmxlbmd0aCkgOiAobGIgPSAwLCBtID0gcC5sZW5ndGgpO1xuICAgICAgICAgICAgdmFyIHYgPSBxKGspO1xuICAgICAgICAgICAgJGMuZGVmYXVsdChmdW5jdGlvbiAoKSB7IHRyeSB7XG4gICAgICAgICAgICAgICAgdmFyIGMgPSByLndyaXRlQmFzZShhLCBwLCBsYiwgbSwgbik7XG4gICAgICAgICAgICAgICAgXCJzdHJpbmdcIiAhPT0gRCA/IHYobnVsbCwgYywgcCkgOiB2KG51bGwsIGMsIGIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKHFmKSB7XG4gICAgICAgICAgICAgICAgdihxZik7XG4gICAgICAgICAgICB9IH0pO1xuICAgICAgICB9O1xuICAgICAgICBhLnByb3RvdHlwZS53cml0ZUZpbGVCYXNlID0gZnVuY3Rpb24gKGEsIGIsIGMsIGQpIHsgdmFyIGUgPSBcIm51bWJlclwiID09PSB0eXBlb2YgYTsgYSA9IGUgPyBhIDogdGhpcy5vcGVuQmFzZShtKGEpLCBjLCBkKTsgZCA9IDA7IHZhciByID0gYi5sZW5ndGg7IGMgPSBjICYgJGEgPyB2b2lkIDAgOiAwOyB0cnkge1xuICAgICAgICAgICAgZm9yICg7IDAgPCByOykge1xuICAgICAgICAgICAgICAgIHZhciBEID0gdGhpcy53cml0ZVN5bmMoYSwgYiwgZCwgciwgYyk7XG4gICAgICAgICAgICAgICAgZCArPSBEO1xuICAgICAgICAgICAgICAgIHIgLT0gRDtcbiAgICAgICAgICAgICAgICB2b2lkIDAgIT09IGMgJiYgKGMgKz0gRCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICBlIHx8IHRoaXMuY2xvc2VTeW5jKGEpO1xuICAgICAgICB9IH07XG4gICAgICAgIGEucHJvdG90eXBlLndyaXRlRmlsZVN5bmMgPSBmdW5jdGlvbiAoYSwgYiwgYykgeyB2YXIgZCA9IEJkKGMpOyBjID0gayhkLmZsYWcpOyB2YXIgZSA9IE0oZC5tb2RlKTsgYiA9IExhKGIsIGQuZW5jb2RpbmcpOyB0aGlzLndyaXRlRmlsZUJhc2UoYSwgYiwgYywgZSk7IH07XG4gICAgICAgIGEucHJvdG90eXBlLndyaXRlRmlsZSA9IGZ1bmN0aW9uIChhLCBiLCBjLCBkKSB7XG4gICAgICAgICAgICB2YXIgZSA9IGM7XG4gICAgICAgICAgICBcImZ1bmN0aW9uXCIgPT09IHR5cGVvZiBjICYmIChlID0gQWQsIGQgPSBjKTtcbiAgICAgICAgICAgIGMgPSBxKGQpO1xuICAgICAgICAgICAgdmFyIHIgPSBCZChlKTtcbiAgICAgICAgICAgIGUgPSBrKHIuZmxhZyk7XG4gICAgICAgICAgICBkID0gTShyLm1vZGUpO1xuICAgICAgICAgICAgYiA9IExhKGIsIHIuZW5jb2RpbmcpO1xuICAgICAgICAgICAgdGhpcy53cmFwQXN5bmModGhpcy53cml0ZUZpbGVCYXNlLCBbYSwgYiwgZSwgZF0sIGMpO1xuICAgICAgICB9O1xuICAgICAgICBhLnByb3RvdHlwZS5saW5rQmFzZSA9IGZ1bmN0aW9uIChhLCBiKSB7IHZhciBjID0gdihhKSwgZCA9IHRoaXMuZ2V0TGluayhjKTsgaWYgKCFkKVxuICAgICAgICAgICAgdGhyb3cgaChcIkVOT0VOVFwiLCBcImxpbmtcIiwgYSwgYik7IHZhciBlID0gdihiKTsgYyA9IHRoaXMuZ2V0TGlua1BhcmVudChlKTsgaWYgKCFjKVxuICAgICAgICAgICAgdGhyb3cgaChcIkVOT0VOVFwiLCBcImxpbmtcIiwgYSwgYik7IGUgPSBlW2UubGVuZ3RoIC0gMV07IGlmIChjLmdldENoaWxkKGUpKVxuICAgICAgICAgICAgdGhyb3cgaChcIkVFWElTVFwiLCBcImxpbmtcIiwgYSwgYik7IGEgPSBkLmdldE5vZGUoKTsgYS5ubGluaysrOyBjLmNyZWF0ZUNoaWxkKGUsIGEpOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5jb3B5RmlsZUJhc2UgPSBmdW5jdGlvbiAoYSwgYiwgYykgeyB2YXIgZCA9IHRoaXMucmVhZEZpbGVTeW5jKGEpOyBpZiAoYyAmIGhmICYmIHRoaXMuZXhpc3RzU3luYyhiKSlcbiAgICAgICAgICAgIHRocm93IGgoXCJFRVhJU1RcIiwgXCJjb3B5RmlsZVwiLCBhLCBiKTsgaWYgKGMgJiBqZilcbiAgICAgICAgICAgIHRocm93IGgoXCJFTk9TWVNcIiwgXCJjb3B5RmlsZVwiLCBhLCBiKTsgdGhpcy53cml0ZUZpbGVCYXNlKGIsIGQsIHVhLncsIDQzOCk7IH07XG4gICAgICAgIGEucHJvdG90eXBlLmNvcHlGaWxlU3luYyA9XG4gICAgICAgICAgICBmdW5jdGlvbiAoYSwgYiwgYykgeyBhID0gbShhKTsgYiA9IG0oYik7IHJldHVybiB0aGlzLmNvcHlGaWxlQmFzZShhLCBiLCAoYyB8fCAwKSB8IDApOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5jb3B5RmlsZSA9IGZ1bmN0aW9uIChhLCBiLCBjLCBkKSB7IGEgPSBtKGEpOyBiID0gbShiKTsgaWYgKFwiZnVuY3Rpb25cIiA9PT0gdHlwZW9mIGMpXG4gICAgICAgICAgICB2YXIgZSA9IDA7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIGUgPSBjLCBjID0gZDsgcShjKTsgdGhpcy53cmFwQXN5bmModGhpcy5jb3B5RmlsZUJhc2UsIFthLCBiLCBlXSwgYyk7IH07XG4gICAgICAgIGEucHJvdG90eXBlLmxpbmtTeW5jID0gZnVuY3Rpb24gKGEsIGIpIHsgYSA9IG0oYSk7IGIgPSBtKGIpOyB0aGlzLmxpbmtCYXNlKGEsIGIpOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5saW5rID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgYSA9IG0oYSk7IGIgPSBtKGIpOyB0aGlzLndyYXBBc3luYyh0aGlzLmxpbmtCYXNlLCBbYSwgYl0sIGMpOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS51bmxpbmtCYXNlID0gZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgIHZhciBiID0gdihhKTtcbiAgICAgICAgICAgIGIgPSB0aGlzLmdldExpbmsoYik7XG4gICAgICAgICAgICBpZiAoIWIpXG4gICAgICAgICAgICAgICAgdGhyb3cgaChcIkVOT0VOVFwiLCBcInVubGlua1wiLCBhKTtcbiAgICAgICAgICAgIGlmIChiLmxlbmd0aClcbiAgICAgICAgICAgICAgICB0aHJvdyBFcnJvcihcIkRpciBub3QgZW1wdHkuLi5cIik7XG4gICAgICAgICAgICB0aGlzLmRlbGV0ZUxpbmsoYik7XG4gICAgICAgICAgICBhID0gYi5nZXROb2RlKCk7XG4gICAgICAgICAgICBhLm5saW5rLS07XG4gICAgICAgICAgICAwID49IGEubmxpbmsgJiYgdGhpcy5kZWxldGVOb2RlKGEpO1xuICAgICAgICB9O1xuICAgICAgICBhLnByb3RvdHlwZS51bmxpbmtTeW5jID0gZnVuY3Rpb24gKGEpIHsgYSA9IG0oYSk7IHRoaXMudW5saW5rQmFzZShhKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUudW5saW5rID0gZnVuY3Rpb24gKGEsIGIpIHsgYSA9IG0oYSk7IHRoaXMud3JhcEFzeW5jKHRoaXMudW5saW5rQmFzZSwgW2FdLCBiKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuc3ltbGlua0Jhc2UgPSBmdW5jdGlvbiAoYSwgYikgeyB2YXIgYyA9IHYoYiksIGQgPSB0aGlzLmdldExpbmtQYXJlbnQoYyk7IGlmICghZClcbiAgICAgICAgICAgIHRocm93IGgoXCJFTk9FTlRcIiwgXCJzeW1saW5rXCIsIGEsIGIpOyBjID0gY1tjLmxlbmd0aCAtIDFdOyBpZiAoZC5nZXRDaGlsZChjKSlcbiAgICAgICAgICAgIHRocm93IGgoXCJFRVhJU1RcIiwgXCJzeW1saW5rXCIsIGEsIGIpOyBiID0gZC5jcmVhdGVDaGlsZChjKTsgYi5nZXROb2RlKCkubWFrZVN5bWxpbmsodihhKSk7IHJldHVybiBiOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5zeW1saW5rU3luYyA9IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICBhID0gbShhKTtcbiAgICAgICAgICAgIGIgPSBtKGIpO1xuICAgICAgICAgICAgdGhpcy5zeW1saW5rQmFzZShhLCBiKTtcbiAgICAgICAgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuc3ltbGluayA9IGZ1bmN0aW9uIChhLCBiLCBjLCBkKSB7IGMgPSBxKFwiZnVuY3Rpb25cIiA9PT0gdHlwZW9mIGMgPyBjIDogZCk7IGEgPSBtKGEpOyBiID0gbShiKTsgdGhpcy53cmFwQXN5bmModGhpcy5zeW1saW5rQmFzZSwgW2EsIGJdLCBjKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUucmVhbHBhdGhCYXNlID0gZnVuY3Rpb24gKGEsIGIpIHsgdmFyIGMgPSB2KGEpOyBjID0gdGhpcy5nZXRSZXNvbHZlZExpbmsoYyk7IGlmICghYylcbiAgICAgICAgICAgIHRocm93IGgoXCJFTk9FTlRcIiwgXCJyZWFscGF0aFwiLCBhKTsgcmV0dXJuIEsuc3RyVG9FbmNvZGluZyhjLmdldFBhdGgoKSwgYik7IH07XG4gICAgICAgIGEucHJvdG90eXBlLnJlYWxwYXRoU3luYyA9IGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiB0aGlzLnJlYWxwYXRoQmFzZShtKGEpLCBFZChiKS5lbmNvZGluZyk7IH07XG4gICAgICAgIGEucHJvdG90eXBlLnJlYWxwYXRoID0gZnVuY3Rpb24gKGEsIGIsIGMpIHtcbiAgICAgICAgICAgIGMgPSBsZihiLCBjKTtcbiAgICAgICAgICAgIGIgPSBjWzBdO1xuICAgICAgICAgICAgYyA9IGNbMV07XG4gICAgICAgICAgICBhID0gbShhKTtcbiAgICAgICAgICAgIHRoaXMud3JhcEFzeW5jKHRoaXMucmVhbHBhdGhCYXNlLCBbYSwgYi5lbmNvZGluZ10sIGMpO1xuICAgICAgICB9O1xuICAgICAgICBhLnByb3RvdHlwZS5sc3RhdEJhc2UgPSBmdW5jdGlvbiAoYSwgYikgeyB2b2lkIDAgPT09IGIgJiYgKGIgPSAhMSk7IHZhciBjID0gdGhpcy5nZXRMaW5rKHYoYSkpOyBpZiAoIWMpXG4gICAgICAgICAgICB0aHJvdyBoKFwiRU5PRU5UXCIsIFwibHN0YXRcIiwgYSk7IHJldHVybiBrYS5kZWZhdWx0LmJ1aWxkKGMuZ2V0Tm9kZSgpLCBiKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUubHN0YXRTeW5jID0gZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIHRoaXMubHN0YXRCYXNlKG0oYSksIGUoYikuYmlnaW50KTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUubHN0YXQgPSBmdW5jdGlvbiAoYSwgYiwgYykgeyBjID0gZChiLCBjKTsgYiA9IGNbMF07IGMgPSBjWzFdOyB0aGlzLndyYXBBc3luYyh0aGlzLmxzdGF0QmFzZSwgW20oYSksIGIuYmlnaW50XSwgYyk7IH07XG4gICAgICAgIGEucHJvdG90eXBlLnN0YXRCYXNlID0gZnVuY3Rpb24gKGEsIGIpIHsgdm9pZCAwID09PSBiICYmIChiID0gITEpOyB2YXIgYyA9IHRoaXMuZ2V0UmVzb2x2ZWRMaW5rKHYoYSkpOyBpZiAoIWMpXG4gICAgICAgICAgICB0aHJvdyBoKFwiRU5PRU5UXCIsIFwic3RhdFwiLCBhKTsgcmV0dXJuIGthLmRlZmF1bHQuYnVpbGQoYy5nZXROb2RlKCksIGIpOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5zdGF0U3luYyA9IGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiB0aGlzLnN0YXRCYXNlKG0oYSksIGUoYikuYmlnaW50KTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuc3RhdCA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7IGMgPSBkKGIsIGMpOyBiID0gY1swXTsgYyA9IGNbMV07IHRoaXMud3JhcEFzeW5jKHRoaXMuc3RhdEJhc2UsIFttKGEpLCBiLmJpZ2ludF0sIGMpOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5mc3RhdEJhc2UgPSBmdW5jdGlvbiAoYSwgYikgeyB2b2lkIDAgPT09IGIgJiYgKGIgPSAhMSk7IGEgPSB0aGlzLmdldEZpbGVCeUZkKGEpOyBpZiAoIWEpXG4gICAgICAgICAgICB0aHJvdyBoKFwiRUJBREZcIiwgXCJmc3RhdFwiKTsgcmV0dXJuIGthLmRlZmF1bHQuYnVpbGQoYS5ub2RlLCBiKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuZnN0YXRTeW5jID0gZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIHRoaXMuZnN0YXRCYXNlKGEsIGUoYikuYmlnaW50KTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuZnN0YXQgPSBmdW5jdGlvbiAoYSwgYiwgYykgeyBiID0gZChiLCBjKTsgdGhpcy53cmFwQXN5bmModGhpcy5mc3RhdEJhc2UsIFthLCBiWzBdLmJpZ2ludF0sIGJbMV0pOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5yZW5hbWVCYXNlID1cbiAgICAgICAgICAgIGZ1bmN0aW9uIChhLCBiKSB7IHZhciBjID0gdGhpcy5nZXRMaW5rKHYoYSkpOyBpZiAoIWMpXG4gICAgICAgICAgICAgICAgdGhyb3cgaChcIkVOT0VOVFwiLCBcInJlbmFtZVwiLCBhLCBiKTsgdmFyIGQgPSB2KGIpLCBlID0gdGhpcy5nZXRMaW5rUGFyZW50KGQpOyBpZiAoIWUpXG4gICAgICAgICAgICAgICAgdGhyb3cgaChcIkVOT0VOVFwiLCBcInJlbmFtZVwiLCBhLCBiKTsgKGEgPSBjLnBhcmVudCkgJiYgYS5kZWxldGVDaGlsZChjKTsgYy5zdGVwcyA9IFhiKGUuc3RlcHMsIFtkW2QubGVuZ3RoIC0gMV1dKTsgZS5zZXRDaGlsZChjLmdldE5hbWUoKSwgYyk7IH07XG4gICAgICAgIGEucHJvdG90eXBlLnJlbmFtZVN5bmMgPSBmdW5jdGlvbiAoYSwgYikgeyBhID0gbShhKTsgYiA9IG0oYik7IHRoaXMucmVuYW1lQmFzZShhLCBiKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUucmVuYW1lID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgYSA9IG0oYSk7IGIgPSBtKGIpOyB0aGlzLndyYXBBc3luYyh0aGlzLnJlbmFtZUJhc2UsIFthLCBiXSwgYyk7IH07XG4gICAgICAgIGEucHJvdG90eXBlLmV4aXN0c0Jhc2UgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gISF0aGlzLnN0YXRCYXNlKGEpOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5leGlzdHNTeW5jID0gZnVuY3Rpb24gKGEpIHsgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmV4aXN0c0Jhc2UobShhKSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKEQpIHtcbiAgICAgICAgICAgIHJldHVybiAhMTtcbiAgICAgICAgfSB9O1xuICAgICAgICBhLnByb3RvdHlwZS5leGlzdHMgPSBmdW5jdGlvbiAoYSwgYikgeyB2YXIgYyA9IHRoaXMsIGQgPSBtKGEpOyBpZiAoXCJmdW5jdGlvblwiICE9PSB0eXBlb2YgYilcbiAgICAgICAgICAgIHRocm93IEVycm9yKGZhLkNCKTsgJGMuZGVmYXVsdChmdW5jdGlvbiAoKSB7IHRyeSB7XG4gICAgICAgICAgICBiKGMuZXhpc3RzQmFzZShkKSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKHZhKSB7XG4gICAgICAgICAgICBiKCExKTtcbiAgICAgICAgfSB9KTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuYWNjZXNzQmFzZSA9IGZ1bmN0aW9uIChhKSB7IHRoaXMuZ2V0TGlua09yVGhyb3coYSwgXCJhY2Nlc3NcIik7IH07XG4gICAgICAgIGEucHJvdG90eXBlLmFjY2Vzc1N5bmMgPSBmdW5jdGlvbiAoYSwgYikgeyB2b2lkIDAgPT09IGIgJiYgKGIgPSB3ZCk7IGEgPSBtKGEpOyB0aGlzLmFjY2Vzc0Jhc2UoYSwgYiB8IDApOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5hY2Nlc3MgPSBmdW5jdGlvbiAoYSwgYiwgYykgeyB2YXIgZCA9IHdkOyBcImZ1bmN0aW9uXCIgIT09IHR5cGVvZiBiICYmIChkID0gYiB8IDAsIGIgPSBxKGMpKTsgYSA9IG0oYSk7IHRoaXMud3JhcEFzeW5jKHRoaXMuYWNjZXNzQmFzZSwgW2EsIGRdLCBiKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuYXBwZW5kRmlsZVN5bmMgPSBmdW5jdGlvbiAoYSwgYiwgYykge1xuICAgICAgICAgICAgdm9pZCAwID09PSBjICYmIChjID1cbiAgICAgICAgICAgICAgICBDZCk7XG4gICAgICAgICAgICBjID0gRGQoYyk7XG4gICAgICAgICAgICBjLmZsYWcgJiYgYSA+Pj4gMCAhPT0gYSB8fCAoYy5mbGFnID0gXCJhXCIpO1xuICAgICAgICAgICAgdGhpcy53cml0ZUZpbGVTeW5jKGEsIGIsIGMpO1xuICAgICAgICB9O1xuICAgICAgICBhLnByb3RvdHlwZS5hcHBlbmRGaWxlID0gZnVuY3Rpb24gKGEsIGIsIGMsIGQpIHsgZCA9IGtmKGMsIGQpOyBjID0gZFswXTsgZCA9IGRbMV07IGMuZmxhZyAmJiBhID4+PiAwICE9PSBhIHx8IChjLmZsYWcgPSBcImFcIik7IHRoaXMud3JpdGVGaWxlKGEsIGIsIGMsIGQpOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5yZWFkZGlyQmFzZSA9IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICB2YXIgYyA9IHYoYSk7XG4gICAgICAgICAgICBjID0gdGhpcy5nZXRSZXNvbHZlZExpbmsoYyk7XG4gICAgICAgICAgICBpZiAoIWMpXG4gICAgICAgICAgICAgICAgdGhyb3cgaChcIkVOT0VOVFwiLCBcInJlYWRkaXJcIiwgYSk7XG4gICAgICAgICAgICBpZiAoIWMuZ2V0Tm9kZSgpLmlzRGlyZWN0b3J5KCkpXG4gICAgICAgICAgICAgICAgdGhyb3cgaChcIkVOT1RESVJcIiwgXCJzY2FuZGlyXCIsIGEpO1xuICAgICAgICAgICAgaWYgKGIud2l0aEZpbGVUeXBlcykge1xuICAgICAgICAgICAgICAgIHZhciBkID0gW107XG4gICAgICAgICAgICAgICAgZm9yIChlIGluIGMuY2hpbGRyZW4pXG4gICAgICAgICAgICAgICAgICAgIChhID0gYy5nZXRDaGlsZChlKSkgJiYgZC5wdXNoKFFjLmRlZmF1bHQuYnVpbGQoYSwgYi5lbmNvZGluZykpO1xuICAgICAgICAgICAgICAgIFliIHx8IFwiYnVmZmVyXCIgPT09IGIuZW5jb2RpbmcgfHwgZC5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBhLm5hbWUgPCBiLm5hbWUgPyAtMSA6IGEubmFtZSA+IGIubmFtZSA/IDEgOiAwOyB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBlID0gW107XG4gICAgICAgICAgICBmb3IgKGQgaW4gYy5jaGlsZHJlbilcbiAgICAgICAgICAgICAgICBlLnB1c2goSy5zdHJUb0VuY29kaW5nKGQsIGIuZW5jb2RpbmcpKTtcbiAgICAgICAgICAgIFliIHx8IFwiYnVmZmVyXCIgPT09IGIuZW5jb2RpbmcgfHwgZS5zb3J0KCk7XG4gICAgICAgICAgICByZXR1cm4gZTtcbiAgICAgICAgfTtcbiAgICAgICAgYS5wcm90b3R5cGUucmVhZGRpclN5bmMgPSBmdW5jdGlvbiAoYSwgYikgeyBiID0gR2QoYik7IGEgPSBtKGEpOyByZXR1cm4gdGhpcy5yZWFkZGlyQmFzZShhLCBiKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUucmVhZGRpciA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7IGMgPSBtZihiLCBjKTsgYiA9IGNbMF07IGMgPSBjWzFdOyBhID0gbShhKTsgdGhpcy53cmFwQXN5bmModGhpcy5yZWFkZGlyQmFzZSwgW2EsIGJdLCBjKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUucmVhZGxpbmtCYXNlID0gZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgICAgIHZhciBjID0gdGhpcy5nZXRMaW5rT3JUaHJvdyhhLCBcInJlYWRsaW5rXCIpLmdldE5vZGUoKTtcbiAgICAgICAgICAgIGlmICghYy5pc1N5bWxpbmsoKSlcbiAgICAgICAgICAgICAgICB0aHJvdyBoKFwiRUlOVkFMXCIsIFwicmVhZGxpbmtcIiwgYSk7XG4gICAgICAgICAgICBhID1cbiAgICAgICAgICAgICAgICBTICsgYy5zeW1saW5rLmpvaW4oUyk7XG4gICAgICAgICAgICByZXR1cm4gSy5zdHJUb0VuY29kaW5nKGEsIGIpO1xuICAgICAgICB9O1xuICAgICAgICBhLnByb3RvdHlwZS5yZWFkbGlua1N5bmMgPSBmdW5jdGlvbiAoYSwgYikgeyBiID0gb2IoYik7IGEgPSBtKGEpOyByZXR1cm4gdGhpcy5yZWFkbGlua0Jhc2UoYSwgYi5lbmNvZGluZyk7IH07XG4gICAgICAgIGEucHJvdG90eXBlLnJlYWRsaW5rID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgYyA9IHlkKGIsIGMpOyBiID0gY1swXTsgYyA9IGNbMV07IGEgPSBtKGEpOyB0aGlzLndyYXBBc3luYyh0aGlzLnJlYWRsaW5rQmFzZSwgW2EsIGIuZW5jb2RpbmddLCBjKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuZnN5bmNCYXNlID0gZnVuY3Rpb24gKGEpIHsgdGhpcy5nZXRGaWxlQnlGZE9yVGhyb3coYSwgXCJmc3luY1wiKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuZnN5bmNTeW5jID0gZnVuY3Rpb24gKGEpIHsgdGhpcy5mc3luY0Jhc2UoYSk7IH07XG4gICAgICAgIGEucHJvdG90eXBlLmZzeW5jID0gZnVuY3Rpb24gKGEsIGIpIHsgdGhpcy53cmFwQXN5bmModGhpcy5mc3luY0Jhc2UsIFthXSwgYik7IH07XG4gICAgICAgIGEucHJvdG90eXBlLmZkYXRhc3luY0Jhc2UgPSBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgdGhpcy5nZXRGaWxlQnlGZE9yVGhyb3coYSwgXCJmZGF0YXN5bmNcIik7XG4gICAgICAgIH07XG4gICAgICAgIGEucHJvdG90eXBlLmZkYXRhc3luY1N5bmMgPSBmdW5jdGlvbiAoYSkgeyB0aGlzLmZkYXRhc3luY0Jhc2UoYSk7IH07XG4gICAgICAgIGEucHJvdG90eXBlLmZkYXRhc3luYyA9IGZ1bmN0aW9uIChhLCBiKSB7IHRoaXMud3JhcEFzeW5jKHRoaXMuZmRhdGFzeW5jQmFzZSwgW2FdLCBiKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuZnRydW5jYXRlQmFzZSA9IGZ1bmN0aW9uIChhLCBiKSB7IHRoaXMuZ2V0RmlsZUJ5RmRPclRocm93KGEsIFwiZnRydW5jYXRlXCIpLnRydW5jYXRlKGIpOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5mdHJ1bmNhdGVTeW5jID0gZnVuY3Rpb24gKGEsIGIpIHsgdGhpcy5mdHJ1bmNhdGVCYXNlKGEsIGIpOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5mdHJ1bmNhdGUgPSBmdW5jdGlvbiAoYSwgYiwgYykgeyB2YXIgZCA9IFwibnVtYmVyXCIgPT09IHR5cGVvZiBiID8gYiA6IDA7IGIgPSBxKFwibnVtYmVyXCIgPT09IHR5cGVvZiBiID8gYyA6IGIpOyB0aGlzLndyYXBBc3luYyh0aGlzLmZ0cnVuY2F0ZUJhc2UsIFthLCBkXSwgYik7IH07XG4gICAgICAgIGEucHJvdG90eXBlLnRydW5jYXRlQmFzZSA9IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICBhID0gdGhpcy5vcGVuU3luYyhhLCBcInIrXCIpO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0aGlzLmZ0cnVuY2F0ZVN5bmMoYSwgYik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlU3luYyhhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgYS5wcm90b3R5cGUudHJ1bmNhdGVTeW5jID0gZnVuY3Rpb24gKGEsIGIpIHsgaWYgKGEgPj4+IDAgPT09IGEpXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5mdHJ1bmNhdGVTeW5jKGEsIGIpOyB0aGlzLnRydW5jYXRlQmFzZShhLCBiKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUudHJ1bmNhdGUgPSBmdW5jdGlvbiAoYSwgYiwgYykgeyB2YXIgZCA9IFwibnVtYmVyXCIgPT09IHR5cGVvZiBiID8gYiA6IDA7IGIgPSBxKFwibnVtYmVyXCIgPT09IHR5cGVvZiBiID8gYyA6IGIpOyBpZiAoYSA+Pj4gMCA9PT0gYSlcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZ0cnVuY2F0ZShhLCBkLCBiKTsgdGhpcy53cmFwQXN5bmModGhpcy50cnVuY2F0ZUJhc2UsIFthLCBkXSwgYik7IH07XG4gICAgICAgIGEucHJvdG90eXBlLmZ1dGltZXNCYXNlID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgYSA9IHRoaXMuZ2V0RmlsZUJ5RmRPclRocm93KGEsIFwiZnV0aW1lc1wiKS5ub2RlOyBhLmF0aW1lID0gbmV3IERhdGUoMUUzICogYik7IGEubXRpbWUgPSBuZXcgRGF0ZSgxRTMgKiBjKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuZnV0aW1lc1N5bmMgPVxuICAgICAgICAgICAgZnVuY3Rpb24gKGEsIGIsIGMpIHsgdGhpcy5mdXRpbWVzQmFzZShhLCBoYShiKSwgaGEoYykpOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5mdXRpbWVzID0gZnVuY3Rpb24gKGEsIGIsIGMsIGQpIHsgdGhpcy53cmFwQXN5bmModGhpcy5mdXRpbWVzQmFzZSwgW2EsIGhhKGIpLCBoYShjKV0sIGQpOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS51dGltZXNCYXNlID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgYSA9IHRoaXMub3BlblN5bmMoYSwgXCJyK1wiKTsgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMuZnV0aW1lc0Jhc2UoYSwgYiwgYyk7XG4gICAgICAgIH1cbiAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlU3luYyhhKTtcbiAgICAgICAgfSB9O1xuICAgICAgICBhLnByb3RvdHlwZS51dGltZXNTeW5jID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgdGhpcy51dGltZXNCYXNlKG0oYSksIGhhKGIpLCBoYShjKSk7IH07XG4gICAgICAgIGEucHJvdG90eXBlLnV0aW1lcyA9IGZ1bmN0aW9uIChhLCBiLCBjLCBkKSB7IHRoaXMud3JhcEFzeW5jKHRoaXMudXRpbWVzQmFzZSwgW20oYSksIGhhKGIpLCBoYShjKV0sIGQpOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5ta2RpckJhc2UgPSBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICAgICAgdmFyIGMgPSB2KGEpO1xuICAgICAgICAgICAgaWYgKCFjLmxlbmd0aClcbiAgICAgICAgICAgICAgICB0aHJvdyBoKFwiRUlTRElSXCIsIFwibWtkaXJcIiwgYSk7XG4gICAgICAgICAgICB2YXIgZCA9IHRoaXMuZ2V0TGlua1BhcmVudEFzRGlyT3JUaHJvdyhhLCBcIm1rZGlyXCIpO1xuICAgICAgICAgICAgYyA9IGNbYy5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgIGlmIChkLmdldENoaWxkKGMpKVxuICAgICAgICAgICAgICAgIHRocm93IGgoXCJFRVhJU1RcIiwgXCJta2RpclwiLCBhKTtcbiAgICAgICAgICAgIGQuY3JlYXRlQ2hpbGQoYywgdGhpcy5jcmVhdGVOb2RlKCEwLCBiKSk7XG4gICAgICAgIH07XG4gICAgICAgIGEucHJvdG90eXBlLm1rZGlycEJhc2UgPSBmdW5jdGlvbiAoYSwgYikgeyBhID0gdihhKTsgZm9yICh2YXIgYyA9IHRoaXMucm9vdCwgZCA9IDA7IGQgPCBhLmxlbmd0aDsgZCsrKSB7XG4gICAgICAgICAgICB2YXIgZSA9IGFbZF07XG4gICAgICAgICAgICBpZiAoIWMuZ2V0Tm9kZSgpLmlzRGlyZWN0b3J5KCkpXG4gICAgICAgICAgICAgICAgdGhyb3cgaChcIkVOT1RESVJcIiwgXCJta2RpclwiLCBjLmdldFBhdGgoKSk7XG4gICAgICAgICAgICB2YXIgZiA9IGMuZ2V0Q2hpbGQoZSk7XG4gICAgICAgICAgICBpZiAoZilcbiAgICAgICAgICAgICAgICBpZiAoZi5nZXROb2RlKCkuaXNEaXJlY3RvcnkoKSlcbiAgICAgICAgICAgICAgICAgICAgYyA9IGY7XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBoKFwiRU5PVERJUlwiLCBcIm1rZGlyXCIsIGYuZ2V0UGF0aCgpKTtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBjID0gYy5jcmVhdGVDaGlsZChlLCB0aGlzLmNyZWF0ZU5vZGUoITAsIGIpKTtcbiAgICAgICAgfSB9O1xuICAgICAgICBhLnByb3RvdHlwZS5ta2RpclN5bmMgPSBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICAgICAgYiA9XG4gICAgICAgICAgICAgICAgZihiKTtcbiAgICAgICAgICAgIHZhciBjID0gTShiLm1vZGUsIDUxMSk7XG4gICAgICAgICAgICBhID0gbShhKTtcbiAgICAgICAgICAgIGIucmVjdXJzaXZlID8gdGhpcy5ta2RpcnBCYXNlKGEsIGMpIDogdGhpcy5ta2RpckJhc2UoYSwgYyk7XG4gICAgICAgIH07XG4gICAgICAgIGEucHJvdG90eXBlLm1rZGlyID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgdmFyIGQgPSBmKGIpOyBiID0gcShcImZ1bmN0aW9uXCIgPT09IHR5cGVvZiBiID8gYiA6IGMpOyBjID0gTShkLm1vZGUsIDUxMSk7IGEgPSBtKGEpOyBkLnJlY3Vyc2l2ZSA/IHRoaXMud3JhcEFzeW5jKHRoaXMubWtkaXJwQmFzZSwgW2EsIGNdLCBiKSA6IHRoaXMud3JhcEFzeW5jKHRoaXMubWtkaXJCYXNlLCBbYSwgY10sIGIpOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5ta2RpcnBTeW5jID0gZnVuY3Rpb24gKGEsIGIpIHsgdGhpcy5ta2RpclN5bmMoYSwgeyBtb2RlOiBiLCByZWN1cnNpdmU6ICEwIH0pOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5ta2RpcnAgPSBmdW5jdGlvbiAoYSwgYiwgYykgeyB2YXIgZCA9IFwiZnVuY3Rpb25cIiA9PT0gdHlwZW9mIGIgPyB2b2lkIDAgOiBiOyBiID0gcShcImZ1bmN0aW9uXCIgPT09IHR5cGVvZiBiID8gYiA6IGMpOyB0aGlzLm1rZGlyKGEsIHsgbW9kZTogZCwgcmVjdXJzaXZlOiAhMCB9LCBiKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUubWtkdGVtcEJhc2UgPVxuICAgICAgICAgICAgZnVuY3Rpb24gKGEsIGIsIGMpIHsgdm9pZCAwID09PSBjICYmIChjID0gNSk7IHZhciBkID0gYSArIHRoaXMuZ2VuUm5kU3RyKCk7IHRyeSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubWtkaXJCYXNlKGQsIDUxMSksIEsuc3RyVG9FbmNvZGluZyhkLCBiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoICh2YSkge1xuICAgICAgICAgICAgICAgIGlmIChcIkVFWElTVFwiID09PSB2YS5jb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgxIDwgYylcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm1rZHRlbXBCYXNlKGEsIGIsIGMgLSAxKTtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJDb3VsZCBub3QgY3JlYXRlIHRlbXAgZGlyLlwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhyb3cgdmE7XG4gICAgICAgICAgICB9IH07XG4gICAgICAgIGEucHJvdG90eXBlLm1rZHRlbXBTeW5jID0gZnVuY3Rpb24gKGEsIGIpIHsgYiA9IG9iKGIpLmVuY29kaW5nOyBpZiAoIWEgfHwgXCJzdHJpbmdcIiAhPT0gdHlwZW9mIGEpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiZmlsZW5hbWUgcHJlZml4IGlzIHJlcXVpcmVkXCIpOyBxYihhKTsgcmV0dXJuIHRoaXMubWtkdGVtcEJhc2UoYSwgYik7IH07XG4gICAgICAgIGEucHJvdG90eXBlLm1rZHRlbXAgPSBmdW5jdGlvbiAoYSwgYiwgYykge1xuICAgICAgICAgICAgYyA9IHlkKGIsIGMpO1xuICAgICAgICAgICAgYiA9IGNbMF0uZW5jb2Rpbmc7XG4gICAgICAgICAgICBjID0gY1sxXTtcbiAgICAgICAgICAgIGlmICghYSB8fCBcInN0cmluZ1wiICE9PSB0eXBlb2YgYSlcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiZmlsZW5hbWUgcHJlZml4IGlzIHJlcXVpcmVkXCIpO1xuICAgICAgICAgICAgcWIoYSkgJiYgdGhpcy53cmFwQXN5bmModGhpcy5ta2R0ZW1wQmFzZSwgW2EsIGJdLCBjKTtcbiAgICAgICAgfTtcbiAgICAgICAgYS5wcm90b3R5cGUucm1kaXJCYXNlID0gZnVuY3Rpb24gKGEsIGIpIHsgYiA9IGFhKHt9LCBGZCwgYik7IHZhciBjID0gdGhpcy5nZXRMaW5rQXNEaXJPclRocm93KGEsIFwicm1kaXJcIik7IGlmIChjLmxlbmd0aCAmJiAhYi5yZWN1cnNpdmUpXG4gICAgICAgICAgICB0aHJvdyBoKFwiRU5PVEVNUFRZXCIsIFwicm1kaXJcIiwgYSk7IHRoaXMuZGVsZXRlTGluayhjKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUucm1kaXJTeW5jID0gZnVuY3Rpb24gKGEsIGIpIHsgdGhpcy5ybWRpckJhc2UobShhKSwgYik7IH07XG4gICAgICAgIGEucHJvdG90eXBlLnJtZGlyID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgdmFyIGQgPSBhYSh7fSwgRmQsIGIpOyBiID0gcShcImZ1bmN0aW9uXCIgPT09IHR5cGVvZiBiID8gYiA6IGMpOyB0aGlzLndyYXBBc3luYyh0aGlzLnJtZGlyQmFzZSwgW20oYSksIGRdLCBiKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuZmNobW9kQmFzZSA9IGZ1bmN0aW9uIChhLCBiKSB7IHRoaXMuZ2V0RmlsZUJ5RmRPclRocm93KGEsIFwiZmNobW9kXCIpLmNobW9kKGIpOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5mY2htb2RTeW5jID1cbiAgICAgICAgICAgIGZ1bmN0aW9uIChhLCBiKSB7IHRoaXMuZmNobW9kQmFzZShhLCBNKGIpKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuZmNobW9kID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgdGhpcy53cmFwQXN5bmModGhpcy5mY2htb2RCYXNlLCBbYSwgTShiKV0sIGMpOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5jaG1vZEJhc2UgPSBmdW5jdGlvbiAoYSwgYikgeyBhID0gdGhpcy5vcGVuU3luYyhhLCBcInIrXCIpOyB0cnkge1xuICAgICAgICAgICAgdGhpcy5mY2htb2RCYXNlKGEsIGIpO1xuICAgICAgICB9XG4gICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgdGhpcy5jbG9zZVN5bmMoYSk7XG4gICAgICAgIH0gfTtcbiAgICAgICAgYS5wcm90b3R5cGUuY2htb2RTeW5jID0gZnVuY3Rpb24gKGEsIGIpIHsgYiA9IE0oYik7IGEgPSBtKGEpOyB0aGlzLmNobW9kQmFzZShhLCBiKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuY2htb2QgPSBmdW5jdGlvbiAoYSwgYiwgYykgeyBiID0gTShiKTsgYSA9IG0oYSk7IHRoaXMud3JhcEFzeW5jKHRoaXMuY2htb2RCYXNlLCBbYSwgYl0sIGMpOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5sY2htb2RCYXNlID0gZnVuY3Rpb24gKGEsIGIpIHsgYSA9IHRoaXMub3BlbkJhc2UoYSwgbmEsIDAsICExKTsgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMuZmNobW9kQmFzZShhLCBiKTtcbiAgICAgICAgfVxuICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2VTeW5jKGEpO1xuICAgICAgICB9IH07XG4gICAgICAgIGEucHJvdG90eXBlLmxjaG1vZFN5bmMgPSBmdW5jdGlvbiAoYSwgYikgeyBiID0gTShiKTsgYSA9IG0oYSk7IHRoaXMubGNobW9kQmFzZShhLCBiKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUubGNobW9kID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgYiA9IE0oYik7IGEgPSBtKGEpOyB0aGlzLndyYXBBc3luYyh0aGlzLmxjaG1vZEJhc2UsIFthLCBiXSwgYyk7IH07XG4gICAgICAgIGEucHJvdG90eXBlLmZjaG93bkJhc2UgPSBmdW5jdGlvbiAoYSwgYiwgYykgeyB0aGlzLmdldEZpbGVCeUZkT3JUaHJvdyhhLCBcImZjaG93blwiKS5jaG93bihiLCBjKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuZmNob3duU3luYyA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7IEhhKGIpOyBJYShjKTsgdGhpcy5mY2hvd25CYXNlKGEsIGIsIGMpOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5mY2hvd24gPSBmdW5jdGlvbiAoYSwgYiwgYywgZCkgeyBIYShiKTsgSWEoYyk7IHRoaXMud3JhcEFzeW5jKHRoaXMuZmNob3duQmFzZSwgW2EsIGIsIGNdLCBkKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuY2hvd25CYXNlID0gZnVuY3Rpb24gKGEsIGIsIGMpIHtcbiAgICAgICAgICAgIHRoaXMuZ2V0UmVzb2x2ZWRMaW5rT3JUaHJvdyhhLCBcImNob3duXCIpLmdldE5vZGUoKS5jaG93bihiLCBjKTtcbiAgICAgICAgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuY2hvd25TeW5jID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgSGEoYik7IElhKGMpOyB0aGlzLmNob3duQmFzZShtKGEpLCBiLCBjKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuY2hvd24gPSBmdW5jdGlvbiAoYSwgYiwgYywgZCkgeyBIYShiKTsgSWEoYyk7IHRoaXMud3JhcEFzeW5jKHRoaXMuY2hvd25CYXNlLCBbbShhKSwgYiwgY10sIGQpOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5sY2hvd25CYXNlID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgdGhpcy5nZXRMaW5rT3JUaHJvdyhhLCBcImxjaG93blwiKS5nZXROb2RlKCkuY2hvd24oYiwgYyk7IH07XG4gICAgICAgIGEucHJvdG90eXBlLmxjaG93blN5bmMgPSBmdW5jdGlvbiAoYSwgYiwgYykgeyBIYShiKTsgSWEoYyk7IHRoaXMubGNob3duQmFzZShtKGEpLCBiLCBjKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUubGNob3duID0gZnVuY3Rpb24gKGEsIGIsIGMsIGQpIHsgSGEoYik7IElhKGMpOyB0aGlzLndyYXBBc3luYyh0aGlzLmxjaG93bkJhc2UsIFttKGEpLCBiLCBjXSwgZCk7IH07XG4gICAgICAgIGEucHJvdG90eXBlLndhdGNoRmlsZSA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7XG4gICAgICAgICAgICBhID0gbShhKTtcbiAgICAgICAgICAgIHZhciBkID0gYjtcbiAgICAgICAgICAgIFwiZnVuY3Rpb25cIiA9PT1cbiAgICAgICAgICAgICAgICB0eXBlb2YgZCAmJiAoYyA9IGIsIGQgPSBudWxsKTtcbiAgICAgICAgICAgIGlmIChcImZ1bmN0aW9uXCIgIT09IHR5cGVvZiBjKVxuICAgICAgICAgICAgICAgIHRocm93IEVycm9yKCdcIndhdGNoRmlsZSgpXCIgcmVxdWlyZXMgYSBsaXN0ZW5lciBmdW5jdGlvbicpO1xuICAgICAgICAgICAgYiA9IDUwMDc7XG4gICAgICAgICAgICB2YXIgZSA9ICEwO1xuICAgICAgICAgICAgZCAmJiBcIm9iamVjdFwiID09PSB0eXBlb2YgZCAmJiAoXCJudW1iZXJcIiA9PT0gdHlwZW9mIGQuaW50ZXJ2YWwgJiYgKGIgPSBkLmludGVydmFsKSwgXCJib29sZWFuXCIgPT09IHR5cGVvZiBkLnBlcnNpc3RlbnQgJiYgKGUgPSBkLnBlcnNpc3RlbnQpKTtcbiAgICAgICAgICAgIGQgPSB0aGlzLnN0YXRXYXRjaGVyc1thXTtcbiAgICAgICAgICAgIGQgfHwgKGQgPSBuZXcgdGhpcy5TdGF0V2F0Y2hlciwgZC5zdGFydChhLCBlLCBiKSwgdGhpcy5zdGF0V2F0Y2hlcnNbYV0gPSBkKTtcbiAgICAgICAgICAgIGQuYWRkTGlzdGVuZXIoXCJjaGFuZ2VcIiwgYyk7XG4gICAgICAgICAgICByZXR1cm4gZDtcbiAgICAgICAgfTtcbiAgICAgICAgYS5wcm90b3R5cGUudW53YXRjaEZpbGUgPSBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICAgICAgYSA9IG0oYSk7XG4gICAgICAgICAgICB2YXIgYyA9IHRoaXMuc3RhdFdhdGNoZXJzW2FdO1xuICAgICAgICAgICAgYyAmJiAoXCJmdW5jdGlvblwiID09PSB0eXBlb2YgYiA/IGMucmVtb3ZlTGlzdGVuZXIoXCJjaGFuZ2VcIiwgYikgOiBjLnJlbW92ZUFsbExpc3RlbmVycyhcImNoYW5nZVwiKSxcbiAgICAgICAgICAgICAgICAwID09PSBjLmxpc3RlbmVyQ291bnQoXCJjaGFuZ2VcIikgJiYgKGMuc3RvcCgpLCBkZWxldGUgdGhpcy5zdGF0V2F0Y2hlcnNbYV0pKTtcbiAgICAgICAgfTtcbiAgICAgICAgYS5wcm90b3R5cGUuY3JlYXRlUmVhZFN0cmVhbSA9IGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBuZXcgdGhpcy5SZWFkU3RyZWFtKGEsIGIpOyB9O1xuICAgICAgICBhLnByb3RvdHlwZS5jcmVhdGVXcml0ZVN0cmVhbSA9IGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBuZXcgdGhpcy5Xcml0ZVN0cmVhbShhLCBiKTsgfTtcbiAgICAgICAgYS5wcm90b3R5cGUud2F0Y2ggPSBmdW5jdGlvbiAoYSwgYiwgYykgeyBhID0gbShhKTsgdmFyIGQgPSBiOyBcImZ1bmN0aW9uXCIgPT09IHR5cGVvZiBiICYmIChjID0gYiwgZCA9IG51bGwpOyB2YXIgZSA9IG9iKGQpOyBiID0gZS5wZXJzaXN0ZW50OyBkID0gZS5yZWN1cnNpdmU7IGUgPSBlLmVuY29kaW5nOyB2b2lkIDAgPT09IGIgJiYgKGIgPSAhMCk7IHZvaWQgMCA9PT0gZCAmJiAoZCA9ICExKTsgdmFyIGYgPSBuZXcgdGhpcy5GU1dhdGNoZXI7IGYuc3RhcnQoYSwgYiwgZCwgZSk7IGMgJiYgZi5hZGRMaXN0ZW5lcihcImNoYW5nZVwiLCBjKTsgcmV0dXJuIGY7IH07XG4gICAgICAgIGEuZmQgPSAyMTQ3NDgzNjQ3O1xuICAgICAgICByZXR1cm4gYTtcbiAgICB9KCk7XG4gICAgYi5Wb2x1bWUgPSBhO1xuICAgIHZhciBIZCA9IGZ1bmN0aW9uIChhKSB7XG4gICAgICAgIGZ1bmN0aW9uIGIoYikgeyB2YXIgYyA9IGEuY2FsbCh0aGlzKSB8fCB0aGlzOyBjLm9uSW50ZXJ2YWwgPSBmdW5jdGlvbiAoKSB7IHRyeSB7XG4gICAgICAgICAgICB2YXIgYSA9IGMudm9sLnN0YXRTeW5jKGMuZmlsZW5hbWUpO1xuICAgICAgICAgICAgYy5oYXNDaGFuZ2VkKGEpICYmIChjLmVtaXQoXCJjaGFuZ2VcIiwgYSwgYy5wcmV2KSwgYy5wcmV2ID0gYSk7XG4gICAgICAgIH1cbiAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICBjLmxvb3AoKTtcbiAgICAgICAgfSB9OyBjLnZvbCA9IGI7IHJldHVybiBjOyB9XG4gICAgICAgIEphKGIsIGEpO1xuICAgICAgICBiLnByb3RvdHlwZS5sb29wID0gZnVuY3Rpb24gKCkgeyB0aGlzLnRpbWVvdXRSZWYgPSB0aGlzLnNldFRpbWVvdXQodGhpcy5vbkludGVydmFsLCB0aGlzLmludGVydmFsKTsgfTtcbiAgICAgICAgYi5wcm90b3R5cGUuaGFzQ2hhbmdlZCA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiBhLm10aW1lTXMgPiB0aGlzLnByZXYubXRpbWVNcyB8fCBhLm5saW5rICE9PSB0aGlzLnByZXYubmxpbmsgPyAhMCA6ICExOyB9O1xuICAgICAgICBiLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7XG4gICAgICAgICAgICB2b2lkIDAgPT09IGIgJiYgKGIgPSAhMCk7XG4gICAgICAgICAgICB2b2lkIDAgPT09IGMgJiYgKGMgPSA1MDA3KTtcbiAgICAgICAgICAgIHRoaXMuZmlsZW5hbWUgPVxuICAgICAgICAgICAgICAgIG0oYSk7XG4gICAgICAgICAgICB0aGlzLnNldFRpbWVvdXQgPSBiID8gc2V0VGltZW91dCA6IGhkLmRlZmF1bHQ7XG4gICAgICAgICAgICB0aGlzLmludGVydmFsID0gYztcbiAgICAgICAgICAgIHRoaXMucHJldiA9IHRoaXMudm9sLnN0YXRTeW5jKHRoaXMuZmlsZW5hbWUpO1xuICAgICAgICAgICAgdGhpcy5sb29wKCk7XG4gICAgICAgIH07XG4gICAgICAgIGIucHJvdG90eXBlLnN0b3AgPSBmdW5jdGlvbiAoKSB7IGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXRSZWYpOyBMLmRlZmF1bHQubmV4dFRpY2soZWYsIHRoaXMpOyB9O1xuICAgICAgICByZXR1cm4gYjtcbiAgICB9KE8uRXZlbnRFbWl0dGVyKTtcbiAgICBiLlN0YXRXYXRjaGVyID0gSGQ7XG4gICAgdmFyIE47XG4gICAgbGMuaW5oZXJpdHMoVCwgWS5SZWFkYWJsZSk7XG4gICAgYi5SZWFkU3RyZWFtID0gVDtcbiAgICBULnByb3RvdHlwZS5vcGVuID0gZnVuY3Rpb24gKCkgeyB2YXIgYSA9IHRoaXM7IHRoaXMuX3ZvbC5vcGVuKHRoaXMucGF0aCwgdGhpcy5mbGFncywgdGhpcy5tb2RlLCBmdW5jdGlvbiAoYiwgYykgeyBiID8gKGEuYXV0b0Nsb3NlICYmIGEuZGVzdHJveSAmJiBhLmRlc3Ryb3koKSwgYS5lbWl0KFwiZXJyb3JcIiwgYikpIDogKGEuZmQgPSBjLCBhLmVtaXQoXCJvcGVuXCIsIGMpLCBhLnJlYWQoKSk7IH0pOyB9O1xuICAgIFQucHJvdG90eXBlLl9yZWFkID1cbiAgICAgICAgZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgIGlmIChcIm51bWJlclwiICE9PSB0eXBlb2YgdGhpcy5mZClcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5vbmNlKFwib3BlblwiLCBmdW5jdGlvbiAoKSB7IHRoaXMuX3JlYWQoYSk7IH0pO1xuICAgICAgICAgICAgaWYgKCF0aGlzLmRlc3Ryb3llZCkge1xuICAgICAgICAgICAgICAgIGlmICghTiB8fCAxMjggPiBOLmxlbmd0aCAtIE4udXNlZClcbiAgICAgICAgICAgICAgICAgICAgTiA9IEYuYnVmZmVyQWxsb2NVbnNhZmUodGhpcy5fcmVhZGFibGVTdGF0ZS5oaWdoV2F0ZXJNYXJrKSwgTi51c2VkID0gMDtcbiAgICAgICAgICAgICAgICB2YXIgYiA9IE4sIGMgPSBNYXRoLm1pbihOLmxlbmd0aCAtIE4udXNlZCwgYSksIGQgPSBOLnVzZWQ7XG4gICAgICAgICAgICAgICAgdm9pZCAwICE9PSB0aGlzLnBvcyAmJiAoYyA9IE1hdGgubWluKHRoaXMuZW5kIC0gdGhpcy5wb3MgKyAxLCBjKSk7XG4gICAgICAgICAgICAgICAgaWYgKDAgPj0gYylcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucHVzaChudWxsKTtcbiAgICAgICAgICAgICAgICB2YXIgZSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpcy5fdm9sLnJlYWQodGhpcy5mZCwgTiwgTi51c2VkLCBjLCB0aGlzLnBvcywgZnVuY3Rpb24gKGEsIGMpIHtcbiAgICAgICAgICAgICAgICAgICAgYSA/IChlLmF1dG9DbG9zZSAmJiBlLmRlc3Ryb3kgJiYgZS5kZXN0cm95KCksIGUuZW1pdChcImVycm9yXCIsIGEpKSA6IChhID0gbnVsbCwgMCA8IGMgJiYgKGUuYnl0ZXNSZWFkICs9IGMsIGEgPSBiLnNsaWNlKGQsIGQgKyBjKSksIGUucHVzaChhKSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdm9pZCAwICE9PSB0aGlzLnBvcyAmJiAodGhpcy5wb3MgKz0gYyk7XG4gICAgICAgICAgICAgICAgTi51c2VkICs9IGM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgVC5wcm90b3R5cGUuX2Rlc3Ryb3kgPSBmdW5jdGlvbiAoYSwgYikgeyB0aGlzLmNsb3NlKGZ1bmN0aW9uIChjKSB7IGIoYSB8fCBjKTsgfSk7IH07XG4gICAgVC5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiAoYSkgeyB2YXIgYiA9IHRoaXM7IGlmIChhKVxuICAgICAgICB0aGlzLm9uY2UoXCJjbG9zZVwiLCBhKTsgaWYgKHRoaXMuY2xvc2VkIHx8IFwibnVtYmVyXCIgIT09IHR5cGVvZiB0aGlzLmZkKSB7XG4gICAgICAgIGlmIChcIm51bWJlclwiICE9PSB0eXBlb2YgdGhpcy5mZCkge1xuICAgICAgICAgICAgdGhpcy5vbmNlKFwib3BlblwiLCBmZik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIEwuZGVmYXVsdC5uZXh0VGljayhmdW5jdGlvbiAoKSB7IHJldHVybiBiLmVtaXQoXCJjbG9zZVwiKTsgfSk7XG4gICAgfSB0aGlzLmNsb3NlZCA9ICEwOyB0aGlzLl92b2wuY2xvc2UodGhpcy5mZCwgZnVuY3Rpb24gKGEpIHsgYSA/IGIuZW1pdChcImVycm9yXCIsIGEpIDogYi5lbWl0KFwiY2xvc2VcIik7IH0pOyB0aGlzLmZkID0gbnVsbDsgfTtcbiAgICBsYy5pbmhlcml0cyhSLCBZLldyaXRhYmxlKTtcbiAgICBiLldyaXRlU3RyZWFtID1cbiAgICAgICAgUjtcbiAgICBSLnByb3RvdHlwZS5vcGVuID0gZnVuY3Rpb24gKCkgeyB0aGlzLl92b2wub3Blbih0aGlzLnBhdGgsIHRoaXMuZmxhZ3MsIHRoaXMubW9kZSwgZnVuY3Rpb24gKGEsIGIpIHsgYSA/ICh0aGlzLmF1dG9DbG9zZSAmJiB0aGlzLmRlc3Ryb3kgJiYgdGhpcy5kZXN0cm95KCksIHRoaXMuZW1pdChcImVycm9yXCIsIGEpKSA6ICh0aGlzLmZkID0gYiwgdGhpcy5lbWl0KFwib3BlblwiLCBiKSk7IH0uYmluZCh0aGlzKSk7IH07XG4gICAgUi5wcm90b3R5cGUuX3dyaXRlID0gZnVuY3Rpb24gKGEsIGIsIGMpIHtcbiAgICAgICAgaWYgKCEoYSBpbnN0YW5jZW9mIEYuQnVmZmVyKSlcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmVtaXQoXCJlcnJvclwiLCBFcnJvcihcIkludmFsaWQgZGF0YVwiKSk7XG4gICAgICAgIGlmIChcIm51bWJlclwiICE9PSB0eXBlb2YgdGhpcy5mZClcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm9uY2UoXCJvcGVuXCIsIGZ1bmN0aW9uICgpIHsgdGhpcy5fd3JpdGUoYSwgYiwgYyk7IH0pO1xuICAgICAgICB2YXIgZCA9IHRoaXM7XG4gICAgICAgIHRoaXMuX3ZvbC53cml0ZSh0aGlzLmZkLCBhLCAwLCBhLmxlbmd0aCwgdGhpcy5wb3MsIGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICBpZiAoYSlcbiAgICAgICAgICAgICAgICByZXR1cm4gZC5hdXRvQ2xvc2UgJiYgZC5kZXN0cm95ICYmXG4gICAgICAgICAgICAgICAgICAgIGQuZGVzdHJveSgpLCBjKGEpO1xuICAgICAgICAgICAgZC5ieXRlc1dyaXR0ZW4gKz0gYjtcbiAgICAgICAgICAgIGMoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHZvaWQgMCAhPT0gdGhpcy5wb3MgJiYgKHRoaXMucG9zICs9IGEubGVuZ3RoKTtcbiAgICB9O1xuICAgIFIucHJvdG90eXBlLl93cml0ZXYgPSBmdW5jdGlvbiAoYSwgYikgeyBpZiAoXCJudW1iZXJcIiAhPT0gdHlwZW9mIHRoaXMuZmQpXG4gICAgICAgIHJldHVybiB0aGlzLm9uY2UoXCJvcGVuXCIsIGZ1bmN0aW9uICgpIHsgdGhpcy5fd3JpdGV2KGEsIGIpOyB9KTsgZm9yICh2YXIgYyA9IHRoaXMsIGQgPSBhLmxlbmd0aCwgZSA9IEFycmF5KGQpLCBmID0gMCwgZyA9IDA7IGcgPCBkOyBnKyspIHtcbiAgICAgICAgdmFyIGggPSBhW2ddLmNodW5rO1xuICAgICAgICBlW2ddID0gaDtcbiAgICAgICAgZiArPSBoLmxlbmd0aDtcbiAgICB9IGQgPSBGLkJ1ZmZlci5jb25jYXQoZSk7IHRoaXMuX3ZvbC53cml0ZSh0aGlzLmZkLCBkLCAwLCBkLmxlbmd0aCwgdGhpcy5wb3MsIGZ1bmN0aW9uIChhLCBkKSB7IGlmIChhKVxuICAgICAgICByZXR1cm4gYy5kZXN0cm95ICYmIGMuZGVzdHJveSgpLCBiKGEpOyBjLmJ5dGVzV3JpdHRlbiArPSBkOyBiKCk7IH0pOyB2b2lkIDAgIT09IHRoaXMucG9zICYmICh0aGlzLnBvcyArPSBmKTsgfTtcbiAgICBSLnByb3RvdHlwZS5fZGVzdHJveSA9IFQucHJvdG90eXBlLl9kZXN0cm95O1xuICAgIFIucHJvdG90eXBlLmNsb3NlID0gVC5wcm90b3R5cGUuY2xvc2U7XG4gICAgUi5wcm90b3R5cGUuZGVzdHJveVNvb24gPSBSLnByb3RvdHlwZS5lbmQ7XG4gICAgdmFyIElkID0gZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgZnVuY3Rpb24gYihiKSB7IHZhciBjID0gYS5jYWxsKHRoaXMpIHx8IHRoaXM7IGMuX2ZpbGVuYW1lID0gXCJcIjsgYy5fZmlsZW5hbWVFbmNvZGVkID0gXCJcIjsgYy5fcmVjdXJzaXZlID0gITE7IGMuX2VuY29kaW5nID0gSy5FTkNPRElOR19VVEY4OyBjLl9vbk5vZGVDaGFuZ2UgPSBmdW5jdGlvbiAoKSB7IGMuX2VtaXQoXCJjaGFuZ2VcIik7IH07IGMuX29uUGFyZW50Q2hpbGQgPSBmdW5jdGlvbiAoYSkgeyBhLmdldE5hbWUoKSA9PT0gYy5fZ2V0TmFtZSgpICYmIGMuX2VtaXQoXCJyZW5hbWVcIik7IH07IGMuX2VtaXQgPSBmdW5jdGlvbiAoYSkgeyBjLmVtaXQoXCJjaGFuZ2VcIiwgYSwgYy5fZmlsZW5hbWVFbmNvZGVkKTsgfTsgYy5fcGVyc2lzdCA9IGZ1bmN0aW9uICgpIHsgYy5fdGltZXIgPSBzZXRUaW1lb3V0KGMuX3BlcnNpc3QsIDFFNik7IH07IGMuX3ZvbCA9IGI7IHJldHVybiBjOyB9XG4gICAgICAgIEphKGIsIGEpO1xuICAgICAgICBiLnByb3RvdHlwZS5fZ2V0TmFtZSA9XG4gICAgICAgICAgICBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLl9zdGVwc1t0aGlzLl9zdGVwcy5sZW5ndGggLSAxXTsgfTtcbiAgICAgICAgYi5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbiAoYSwgYiwgYywgZCkge1xuICAgICAgICAgICAgdm9pZCAwID09PSBiICYmIChiID0gITApO1xuICAgICAgICAgICAgdm9pZCAwID09PSBjICYmIChjID0gITEpO1xuICAgICAgICAgICAgdm9pZCAwID09PSBkICYmIChkID0gSy5FTkNPRElOR19VVEY4KTtcbiAgICAgICAgICAgIHRoaXMuX2ZpbGVuYW1lID0gbShhKTtcbiAgICAgICAgICAgIHRoaXMuX3N0ZXBzID0gdih0aGlzLl9maWxlbmFtZSk7XG4gICAgICAgICAgICB0aGlzLl9maWxlbmFtZUVuY29kZWQgPSBLLnN0clRvRW5jb2RpbmcodGhpcy5fZmlsZW5hbWUpO1xuICAgICAgICAgICAgdGhpcy5fcmVjdXJzaXZlID0gYztcbiAgICAgICAgICAgIHRoaXMuX2VuY29kaW5nID0gZDtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbGluayA9IHRoaXMuX3ZvbC5nZXRMaW5rT3JUaHJvdyh0aGlzLl9maWxlbmFtZSwgXCJGU1dhdGNoZXJcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoV2IpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBiID0gRXJyb3IoXCJ3YXRjaCBcIiArIHRoaXMuX2ZpbGVuYW1lICsgXCIgXCIgKyBXYi5jb2RlKSwgYi5jb2RlID0gV2IuY29kZSwgYi5lcnJubyA9IFdiLmNvZGUsIGI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9saW5rLmdldE5vZGUoKS5vbihcImNoYW5nZVwiLCB0aGlzLl9vbk5vZGVDaGFuZ2UpO1xuICAgICAgICAgICAgdGhpcy5fbGluay5vbihcImNoaWxkOmFkZFwiLCB0aGlzLl9vbk5vZGVDaGFuZ2UpO1xuICAgICAgICAgICAgdGhpcy5fbGluay5vbihcImNoaWxkOmRlbGV0ZVwiLCB0aGlzLl9vbk5vZGVDaGFuZ2UpO1xuICAgICAgICAgICAgaWYgKGEgPSB0aGlzLl9saW5rLnBhcmVudClcbiAgICAgICAgICAgICAgICBhLnNldE1heExpc3RlbmVycyhhLmdldE1heExpc3RlbmVycygpICsgMSksIGEub24oXCJjaGlsZDpkZWxldGVcIiwgdGhpcy5fb25QYXJlbnRDaGlsZCk7XG4gICAgICAgICAgICBiICYmIHRoaXMuX3BlcnNpc3QoKTtcbiAgICAgICAgfTtcbiAgICAgICAgYi5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiAoKSB7IGNsZWFyVGltZW91dCh0aGlzLl90aW1lcik7IHRoaXMuX2xpbmsuZ2V0Tm9kZSgpLnJlbW92ZUxpc3RlbmVyKFwiY2hhbmdlXCIsIHRoaXMuX29uTm9kZUNoYW5nZSk7IHZhciBhID0gdGhpcy5fbGluay5wYXJlbnQ7IGEgJiYgYS5yZW1vdmVMaXN0ZW5lcihcImNoaWxkOmRlbGV0ZVwiLCB0aGlzLl9vblBhcmVudENoaWxkKTsgfTtcbiAgICAgICAgcmV0dXJuIGI7XG4gICAgfShPLkV2ZW50RW1pdHRlcik7XG4gICAgYi5GU1dhdGNoZXIgPSBJZDtcbn0pO1xudChYZSk7XG52YXIgWWUgPSBYZS5wYXRoVG9GaWxlbmFtZSwgWmUgPSBYZS5maWxlbmFtZVRvU3RlcHMsICRlID0gWGUuVm9sdW1lLCBhZiA9IHUoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoYiwgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6ICEwIH0pO1xuICAgIGIuZnNQcm9wcyA9IFwiY29uc3RhbnRzIEZfT0sgUl9PSyBXX09LIFhfT0sgU3RhdHNcIi5zcGxpdChcIiBcIik7XG4gICAgYi5mc1N5bmNNZXRob2RzID0gXCJyZW5hbWVTeW5jIGZ0cnVuY2F0ZVN5bmMgdHJ1bmNhdGVTeW5jIGNob3duU3luYyBmY2hvd25TeW5jIGxjaG93blN5bmMgY2htb2RTeW5jIGZjaG1vZFN5bmMgbGNobW9kU3luYyBzdGF0U3luYyBsc3RhdFN5bmMgZnN0YXRTeW5jIGxpbmtTeW5jIHN5bWxpbmtTeW5jIHJlYWRsaW5rU3luYyByZWFscGF0aFN5bmMgdW5saW5rU3luYyBybWRpclN5bmMgbWtkaXJTeW5jIG1rZGlycFN5bmMgcmVhZGRpclN5bmMgY2xvc2VTeW5jIG9wZW5TeW5jIHV0aW1lc1N5bmMgZnV0aW1lc1N5bmMgZnN5bmNTeW5jIHdyaXRlU3luYyByZWFkU3luYyByZWFkRmlsZVN5bmMgd3JpdGVGaWxlU3luYyBhcHBlbmRGaWxlU3luYyBleGlzdHNTeW5jIGFjY2Vzc1N5bmMgZmRhdGFzeW5jU3luYyBta2R0ZW1wU3luYyBjb3B5RmlsZVN5bmMgY3JlYXRlUmVhZFN0cmVhbSBjcmVhdGVXcml0ZVN0cmVhbVwiLnNwbGl0KFwiIFwiKTtcbiAgICBiLmZzQXN5bmNNZXRob2RzID0gXCJyZW5hbWUgZnRydW5jYXRlIHRydW5jYXRlIGNob3duIGZjaG93biBsY2hvd24gY2htb2QgZmNobW9kIGxjaG1vZCBzdGF0IGxzdGF0IGZzdGF0IGxpbmsgc3ltbGluayByZWFkbGluayByZWFscGF0aCB1bmxpbmsgcm1kaXIgbWtkaXIgbWtkaXJwIHJlYWRkaXIgY2xvc2Ugb3BlbiB1dGltZXMgZnV0aW1lcyBmc3luYyB3cml0ZSByZWFkIHJlYWRGaWxlIHdyaXRlRmlsZSBhcHBlbmRGaWxlIGV4aXN0cyBhY2Nlc3MgZmRhdGFzeW5jIG1rZHRlbXAgY29weUZpbGUgd2F0Y2hGaWxlIHVud2F0Y2hGaWxlIHdhdGNoXCIuc3BsaXQoXCIgXCIpO1xufSk7XG50KGFmKTtcbnZhciBiZiA9IHUoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICBmdW5jdGlvbiBjKGEpIHsgZm9yICh2YXIgYiA9IHsgRl9PSzogZywgUl9PSzogaCwgV19PSzogaywgWF9PSzogcCwgY29uc3RhbnRzOiB3LmNvbnN0YW50cywgU3RhdHM6IGthLmRlZmF1bHQsIERpcmVudDogUWMuZGVmYXVsdCB9LCBjID0gMCwgZCA9IGU7IGMgPCBkLmxlbmd0aDsgYysrKSB7XG4gICAgICAgIHZhciBuID0gZFtjXTtcbiAgICAgICAgXCJmdW5jdGlvblwiID09PSB0eXBlb2YgYVtuXSAmJiAoYltuXSA9IGFbbl0uYmluZChhKSk7XG4gICAgfSBjID0gMDsgZm9yIChkID0gZjsgYyA8IGQubGVuZ3RoOyBjKyspXG4gICAgICAgIG4gPSBkW2NdLCBcImZ1bmN0aW9uXCIgPT09IHR5cGVvZiBhW25dICYmIChiW25dID0gYVtuXS5iaW5kKGEpKTsgYi5TdGF0V2F0Y2hlciA9IGEuU3RhdFdhdGNoZXI7IGIuRlNXYXRjaGVyID0gYS5GU1dhdGNoZXI7IGIuV3JpdGVTdHJlYW0gPSBhLldyaXRlU3RyZWFtOyBiLlJlYWRTdHJlYW0gPSBhLlJlYWRTdHJlYW07IGIucHJvbWlzZXMgPSBhLnByb21pc2VzOyBiLl90b1VuaXhUaW1lc3RhbXAgPSBYZS50b1VuaXhUaW1lc3RhbXA7IHJldHVybiBiOyB9XG4gICAgdmFyIGQgPSBsICYmIGwuX19hc3NpZ24gfHwgZnVuY3Rpb24gKCkge1xuICAgICAgICBkID1cbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gKGEpIHsgZm9yICh2YXIgYiwgYyA9IDEsIGQgPSBhcmd1bWVudHMubGVuZ3RoOyBjIDwgZDsgYysrKSB7XG4gICAgICAgICAgICAgICAgYiA9IGFyZ3VtZW50c1tjXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBlIGluIGIpXG4gICAgICAgICAgICAgICAgICAgIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBlKSAmJiAoYVtlXSA9IGJbZV0pO1xuICAgICAgICAgICAgfSByZXR1cm4gYTsgfTtcbiAgICAgICAgcmV0dXJuIGQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShiLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogITAgfSk7XG4gICAgdmFyIGUgPSBhZi5mc1N5bmNNZXRob2RzLCBmID0gYWYuZnNBc3luY01ldGhvZHMsIGcgPSB3LmNvbnN0YW50cy5GX09LLCBoID0gdy5jb25zdGFudHMuUl9PSywgayA9IHcuY29uc3RhbnRzLldfT0ssIHAgPSB3LmNvbnN0YW50cy5YX09LO1xuICAgIGIuVm9sdW1lID0gWGUuVm9sdW1lO1xuICAgIGIudm9sID0gbmV3IFhlLlZvbHVtZTtcbiAgICBiLmNyZWF0ZUZzRnJvbVZvbHVtZSA9IGM7XG4gICAgYi5mcyA9IGMoYi52b2wpO1xuICAgIGEuZXhwb3J0cyA9IGQoZCh7fSwgYS5leHBvcnRzKSwgYi5mcyk7XG4gICAgYS5leHBvcnRzLnNlbWFudGljID0gITA7XG59KTtcbnQoYmYpO1xudmFyIHJmID0gYmYuY3JlYXRlRnNGcm9tVm9sdW1lO1xuZ2QucHJvdG90eXBlLmVtaXQgPSBmdW5jdGlvbiAoYSkgeyBmb3IgKHZhciBiLCBjLCBkID0gW10sIGUgPSAxOyBlIDwgYXJndW1lbnRzLmxlbmd0aDsgZSsrKVxuICAgIGRbZSAtIDFdID0gYXJndW1lbnRzW2VdOyBlID0gdGhpcy5saXN0ZW5lcnMoYSk7IHRyeSB7XG4gICAgZm9yICh2YXIgZiA9IGRhKGUpLCBnID0gZi5uZXh0KCk7ICFnLmRvbmU7IGcgPSBmLm5leHQoKSkge1xuICAgICAgICB2YXIgaCA9IGcudmFsdWU7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBoLmFwcGx5KHZvaWQgMCwgaWEoZCkpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChrKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGspO1xuICAgICAgICB9XG4gICAgfVxufVxuY2F0Y2ggKGspIHtcbiAgICBiID0geyBlcnJvcjogayB9O1xufVxuZmluYWxseSB7XG4gICAgdHJ5IHtcbiAgICAgICAgZyAmJiAhZy5kb25lICYmIChjID0gZi5yZXR1cm4pICYmIGMuY2FsbChmKTtcbiAgICB9XG4gICAgZmluYWxseSB7XG4gICAgICAgIGlmIChiKVxuICAgICAgICAgICAgdGhyb3cgYi5lcnJvcjtcbiAgICB9XG59IHJldHVybiAwIDwgZS5sZW5ndGg7IH07XG52YXIgc2YgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gYSgpIHsgdGhpcy52b2x1bWUgPSBuZXcgJGU7IHRoaXMuZnMgPSByZih0aGlzLnZvbHVtZSk7IHRoaXMuZnJvbUpTT04oeyBcIi9kZXYvc3RkaW5cIjogXCJcIiwgXCIvZGV2L3N0ZG91dFwiOiBcIlwiLCBcIi9kZXYvc3RkZXJyXCI6IFwiXCIgfSk7IH1cbiAgICBhLnByb3RvdHlwZS5fdG9KU09OID0gZnVuY3Rpb24gKGEsIGMsIGQpIHsgdm9pZCAwID09PSBjICYmIChjID0ge30pOyB2YXIgYiA9ICEwLCBmOyBmb3IgKGYgaW4gYS5jaGlsZHJlbikge1xuICAgICAgICBiID0gITE7XG4gICAgICAgIHZhciBnID0gYS5nZXRDaGlsZChmKTtcbiAgICAgICAgaWYgKGcpIHtcbiAgICAgICAgICAgIHZhciBoID0gZy5nZXROb2RlKCk7XG4gICAgICAgICAgICBoICYmIGguaXNGaWxlKCkgPyAoZyA9IGcuZ2V0UGF0aCgpLCBkICYmIChnID0gWWMoZCwgZykpLCBjW2ddID0gaC5nZXRCdWZmZXIoKSkgOiBoICYmIGguaXNEaXJlY3RvcnkoKSAmJiB0aGlzLl90b0pTT04oZywgYywgZCk7XG4gICAgICAgIH1cbiAgICB9IGEgPSBhLmdldFBhdGgoKTsgZCAmJiAoYSA9IFljKGQsIGEpKTsgYSAmJiBiICYmIChjW2FdID0gbnVsbCk7IHJldHVybiBjOyB9O1xuICAgIGEucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uIChhLCBjLCBkKSB7XG4gICAgICAgIHZhciBiLCBmO1xuICAgICAgICB2b2lkIDAgPT09IGMgJiYgKGMgPSB7fSk7XG4gICAgICAgIHZvaWQgMCA9PT0gZCAmJiAoZCA9ICExKTtcbiAgICAgICAgdmFyIGcgPSBbXTtcbiAgICAgICAgaWYgKGEpIHtcbiAgICAgICAgICAgIGEgaW5zdGFuY2VvZiBBcnJheSB8fCAoYSA9IFthXSk7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGggPSBkYShhKSwgayA9IGgubmV4dCgpOyAhay5kb25lOyBrID0gaC5uZXh0KCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHAgPSBZZShrLnZhbHVlKSwgbiA9IHRoaXMudm9sdW1lLmdldFJlc29sdmVkTGluayhwKTtcbiAgICAgICAgICAgICAgICAgICAgbiAmJiBnLnB1c2gobik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKHhhKSB7XG4gICAgICAgICAgICAgICAgdmFyIHEgPSB7IGVycm9yOiB4YSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgayAmJiAhay5kb25lICYmIChiID0gaC5yZXR1cm4pICYmIGIuY2FsbChoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChxKVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgcS5lcnJvcjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgZy5wdXNoKHRoaXMudm9sdW1lLnJvb3QpO1xuICAgICAgICBpZiAoIWcubGVuZ3RoKVxuICAgICAgICAgICAgcmV0dXJuIGM7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBmb3IgKHZhciBCID0gZGEoZyksIG0gPSBCLm5leHQoKTsgIW0uZG9uZTsgbSA9IEIubmV4dCgpKVxuICAgICAgICAgICAgICAgIG4gPSBtLnZhbHVlLCB0aGlzLl90b0pTT04obiwgYywgZCA/IG4uZ2V0UGF0aCgpIDogXCJcIik7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKHhhKSB7XG4gICAgICAgICAgICB2YXIgdiA9IHsgZXJyb3I6IHhhIH07XG4gICAgICAgIH1cbiAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIG0gJiYgIW0uZG9uZSAmJiAoZiA9IEIucmV0dXJuKSAmJiBmLmNhbGwoQik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICBpZiAodilcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgdi5lcnJvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYztcbiAgICB9O1xuICAgIGEucHJvdG90eXBlLmZyb21KU09ORml4ZWQgPSBmdW5jdGlvbiAoYSwgYykgeyBmb3IgKHZhciBiIGluIGMpIHtcbiAgICAgICAgdmFyIGUgPSBjW2JdO1xuICAgICAgICBpZiAoZSA/IG51bGwgIT09IE9iamVjdC5nZXRQcm90b3R5cGVPZihlKSA6IG51bGwgIT09IGUpIHtcbiAgICAgICAgICAgIHZhciBmID0gWmUoYik7XG4gICAgICAgICAgICAxIDwgZi5sZW5ndGggJiYgKGYgPSBcIi9cIiArIGYuc2xpY2UoMCwgZi5sZW5ndGggLSAxKS5qb2luKFwiL1wiKSwgYS5ta2RpcnBCYXNlKGYsIDUxMSkpO1xuICAgICAgICAgICAgYS53cml0ZUZpbGVTeW5jKGIsIGUgfHwgXCJcIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgYS5ta2RpcnBCYXNlKGIsIDUxMSk7XG4gICAgfSB9O1xuICAgIGEucHJvdG90eXBlLmZyb21KU09OID0gZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgdGhpcy52b2x1bWUgPSBuZXcgJGU7XG4gICAgICAgIHRoaXMuZnJvbUpTT05GaXhlZCh0aGlzLnZvbHVtZSwgYSk7XG4gICAgICAgIHRoaXMuZnMgPSByZih0aGlzLnZvbHVtZSk7XG4gICAgICAgIHRoaXMudm9sdW1lLnJlbGVhc2VkRmRzID0gWzAsIDEsIDJdO1xuICAgICAgICBhID0gdGhpcy52b2x1bWUub3BlblN5bmMoXCIvZGV2L3N0ZGVyclwiLCBcIndcIik7XG4gICAgICAgIHZhciBiID0gdGhpcy52b2x1bWUub3BlblN5bmMoXCIvZGV2L3N0ZG91dFwiLCBcIndcIiksIGQgPSB0aGlzLnZvbHVtZS5vcGVuU3luYyhcIi9kZXYvc3RkaW5cIiwgXCJyXCIpO1xuICAgICAgICBpZiAoMiAhPT0gYSlcbiAgICAgICAgICAgIHRocm93IEVycm9yKFwiaW52YWxpZCBoYW5kbGUgZm9yIHN0ZGVycjogXCIgKyBhKTtcbiAgICAgICAgaWYgKDEgIT09IGIpXG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcImludmFsaWQgaGFuZGxlIGZvciBzdGRvdXQ6IFwiICsgYik7XG4gICAgICAgIGlmICgwICE9PSBkKVxuICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJpbnZhbGlkIGhhbmRsZSBmb3Igc3RkaW46IFwiICsgZCk7XG4gICAgfTtcbiAgICBhLnByb3RvdHlwZS5nZXRTdGRPdXQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBiYSh0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkgeyB2YXIgYSwgYyA9IHRoaXM7IHJldHVybiBjYSh0aGlzLCBmdW5jdGlvbiAoKSB7IGEgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAoYSkgeyBhKGMuZnMucmVhZEZpbGVTeW5jKFwiL2Rldi9zdGRvdXRcIiwgXCJ1dGY4XCIpKTsgfSk7IHJldHVybiBbMiwgYV07IH0pOyB9KTsgfTtcbiAgICByZXR1cm4gYTtcbn0oKTtcbmV4cG9ydHMuV2FzbUZzID0gc2Y7XG5leHBvcnRzW1wiZGVmYXVsdFwiXSA9IHNmO1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL0BmbHVlbmNlbGFicy9tYXJpbmUud29ya2VyLXNjcmlwdC8uLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQHdhc21lcit3YXNtZnNAMC4xMi4wL25vZGVfbW9kdWxlcy9Ad2FzbWVyL3dhc21mcy9saWIvaW5kZXguZXNtLmpzPyIpOwoKLyoqKi8gfSksCgovKioqLyAiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL2Jhc2U2NC1qc0AxLjUuMS9ub2RlX21vZHVsZXMvYmFzZTY0LWpzL2luZGV4LmpzIjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAhKioqIC4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9iYXNlNjQtanNAMS41LjEvbm9kZV9tb2R1bGVzL2Jhc2U2NC1qcy9pbmRleC5qcyAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSA9PiB7CgpldmFsKCJcbmV4cG9ydHMuYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGg7XG5leHBvcnRzLnRvQnl0ZUFycmF5ID0gdG9CeXRlQXJyYXk7XG5leHBvcnRzLmZyb21CeXRlQXJyYXkgPSBmcm9tQnl0ZUFycmF5O1xudmFyIGxvb2t1cCA9IFtdO1xudmFyIHJldkxvb2t1cCA9IFtdO1xudmFyIEFyciA9IHR5cGVvZiBVaW50OEFycmF5ICE9PSAndW5kZWZpbmVkJyA/IFVpbnQ4QXJyYXkgOiBBcnJheTtcbnZhciBjb2RlID0gJ0FCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky8nO1xuZm9yICh2YXIgaSA9IDAsIGxlbiA9IGNvZGUubGVuZ3RoOyBpIDwgbGVuOyArK2kpIHtcbiAgICBsb29rdXBbaV0gPSBjb2RlW2ldO1xuICAgIHJldkxvb2t1cFtjb2RlLmNoYXJDb2RlQXQoaSldID0gaTtcbn1cbi8vIFN1cHBvcnQgZGVjb2RpbmcgVVJMLXNhZmUgYmFzZTY0IHN0cmluZ3MsIGFzIE5vZGUuanMgZG9lcy5cbi8vIFNlZTogaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQmFzZTY0I1VSTF9hcHBsaWNhdGlvbnNcbnJldkxvb2t1cFsnLScuY2hhckNvZGVBdCgwKV0gPSA2MjtcbnJldkxvb2t1cFsnXycuY2hhckNvZGVBdCgwKV0gPSA2MztcbmZ1bmN0aW9uIGdldExlbnMoYjY0KSB7XG4gICAgdmFyIGxlbiA9IGI2NC5sZW5ndGg7XG4gICAgaWYgKGxlbiAlIDQgPiAwKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBzdHJpbmcuIExlbmd0aCBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgNCcpO1xuICAgIH1cbiAgICAvLyBUcmltIG9mZiBleHRyYSBieXRlcyBhZnRlciBwbGFjZWhvbGRlciBieXRlcyBhcmUgZm91bmRcbiAgICAvLyBTZWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9iZWF0Z2FtbWl0L2Jhc2U2NC1qcy9pc3N1ZXMvNDJcbiAgICB2YXIgdmFsaWRMZW4gPSBiNjQuaW5kZXhPZignPScpO1xuICAgIGlmICh2YWxpZExlbiA9PT0gLTEpXG4gICAgICAgIHZhbGlkTGVuID0gbGVuO1xuICAgIHZhciBwbGFjZUhvbGRlcnNMZW4gPSB2YWxpZExlbiA9PT0gbGVuXG4gICAgICAgID8gMFxuICAgICAgICA6IDQgLSAodmFsaWRMZW4gJSA0KTtcbiAgICByZXR1cm4gW3ZhbGlkTGVuLCBwbGFjZUhvbGRlcnNMZW5dO1xufVxuLy8gYmFzZTY0IGlzIDQvMyArIHVwIHRvIHR3byBjaGFyYWN0ZXJzIG9mIHRoZSBvcmlnaW5hbCBkYXRhXG5mdW5jdGlvbiBieXRlTGVuZ3RoKGI2NCkge1xuICAgIHZhciBsZW5zID0gZ2V0TGVucyhiNjQpO1xuICAgIHZhciB2YWxpZExlbiA9IGxlbnNbMF07XG4gICAgdmFyIHBsYWNlSG9sZGVyc0xlbiA9IGxlbnNbMV07XG4gICAgcmV0dXJuICgodmFsaWRMZW4gKyBwbGFjZUhvbGRlcnNMZW4pICogMyAvIDQpIC0gcGxhY2VIb2xkZXJzTGVuO1xufVxuZnVuY3Rpb24gX2J5dGVMZW5ndGgoYjY0LCB2YWxpZExlbiwgcGxhY2VIb2xkZXJzTGVuKSB7XG4gICAgcmV0dXJuICgodmFsaWRMZW4gKyBwbGFjZUhvbGRlcnNMZW4pICogMyAvIDQpIC0gcGxhY2VIb2xkZXJzTGVuO1xufVxuZnVuY3Rpb24gdG9CeXRlQXJyYXkoYjY0KSB7XG4gICAgdmFyIHRtcDtcbiAgICB2YXIgbGVucyA9IGdldExlbnMoYjY0KTtcbiAgICB2YXIgdmFsaWRMZW4gPSBsZW5zWzBdO1xuICAgIHZhciBwbGFjZUhvbGRlcnNMZW4gPSBsZW5zWzFdO1xuICAgIHZhciBhcnIgPSBuZXcgQXJyKF9ieXRlTGVuZ3RoKGI2NCwgdmFsaWRMZW4sIHBsYWNlSG9sZGVyc0xlbikpO1xuICAgIHZhciBjdXJCeXRlID0gMDtcbiAgICAvLyBpZiB0aGVyZSBhcmUgcGxhY2Vob2xkZXJzLCBvbmx5IGdldCB1cCB0byB0aGUgbGFzdCBjb21wbGV0ZSA0IGNoYXJzXG4gICAgdmFyIGxlbiA9IHBsYWNlSG9sZGVyc0xlbiA+IDBcbiAgICAgICAgPyB2YWxpZExlbiAtIDRcbiAgICAgICAgOiB2YWxpZExlbjtcbiAgICB2YXIgaTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpICs9IDQpIHtcbiAgICAgICAgdG1wID1cbiAgICAgICAgICAgIChyZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSldIDw8IDE4KSB8XG4gICAgICAgICAgICAgICAgKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMSldIDw8IDEyKSB8XG4gICAgICAgICAgICAgICAgKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMildIDw8IDYpIHxcbiAgICAgICAgICAgICAgICByZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSArIDMpXTtcbiAgICAgICAgYXJyW2N1ckJ5dGUrK10gPSAodG1wID4+IDE2KSAmIDB4RkY7XG4gICAgICAgIGFycltjdXJCeXRlKytdID0gKHRtcCA+PiA4KSAmIDB4RkY7XG4gICAgICAgIGFycltjdXJCeXRlKytdID0gdG1wICYgMHhGRjtcbiAgICB9XG4gICAgaWYgKHBsYWNlSG9sZGVyc0xlbiA9PT0gMikge1xuICAgICAgICB0bXAgPVxuICAgICAgICAgICAgKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpKV0gPDwgMikgfFxuICAgICAgICAgICAgICAgIChyZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSArIDEpXSA+PiA0KTtcbiAgICAgICAgYXJyW2N1ckJ5dGUrK10gPSB0bXAgJiAweEZGO1xuICAgIH1cbiAgICBpZiAocGxhY2VIb2xkZXJzTGVuID09PSAxKSB7XG4gICAgICAgIHRtcCA9XG4gICAgICAgICAgICAocmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkpXSA8PCAxMCkgfFxuICAgICAgICAgICAgICAgIChyZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSArIDEpXSA8PCA0KSB8XG4gICAgICAgICAgICAgICAgKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMildID4+IDIpO1xuICAgICAgICBhcnJbY3VyQnl0ZSsrXSA9ICh0bXAgPj4gOCkgJiAweEZGO1xuICAgICAgICBhcnJbY3VyQnl0ZSsrXSA9IHRtcCAmIDB4RkY7XG4gICAgfVxuICAgIHJldHVybiBhcnI7XG59XG5mdW5jdGlvbiB0cmlwbGV0VG9CYXNlNjQobnVtKSB7XG4gICAgcmV0dXJuIGxvb2t1cFtudW0gPj4gMTggJiAweDNGXSArXG4gICAgICAgIGxvb2t1cFtudW0gPj4gMTIgJiAweDNGXSArXG4gICAgICAgIGxvb2t1cFtudW0gPj4gNiAmIDB4M0ZdICtcbiAgICAgICAgbG9va3VwW251bSAmIDB4M0ZdO1xufVxuZnVuY3Rpb24gZW5jb2RlQ2h1bmsodWludDgsIHN0YXJ0LCBlbmQpIHtcbiAgICB2YXIgdG1wO1xuICAgIHZhciBvdXRwdXQgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gc3RhcnQ7IGkgPCBlbmQ7IGkgKz0gMykge1xuICAgICAgICB0bXAgPVxuICAgICAgICAgICAgKCh1aW50OFtpXSA8PCAxNikgJiAweEZGMDAwMCkgK1xuICAgICAgICAgICAgICAgICgodWludDhbaSArIDFdIDw8IDgpICYgMHhGRjAwKSArXG4gICAgICAgICAgICAgICAgKHVpbnQ4W2kgKyAyXSAmIDB4RkYpO1xuICAgICAgICBvdXRwdXQucHVzaCh0cmlwbGV0VG9CYXNlNjQodG1wKSk7XG4gICAgfVxuICAgIHJldHVybiBvdXRwdXQuam9pbignJyk7XG59XG5mdW5jdGlvbiBmcm9tQnl0ZUFycmF5KHVpbnQ4KSB7XG4gICAgdmFyIHRtcDtcbiAgICB2YXIgbGVuID0gdWludDgubGVuZ3RoO1xuICAgIHZhciBleHRyYUJ5dGVzID0gbGVuICUgMzsgLy8gaWYgd2UgaGF2ZSAxIGJ5dGUgbGVmdCwgcGFkIDIgYnl0ZXNcbiAgICB2YXIgcGFydHMgPSBbXTtcbiAgICB2YXIgbWF4Q2h1bmtMZW5ndGggPSAxNjM4MzsgLy8gbXVzdCBiZSBtdWx0aXBsZSBvZiAzXG4gICAgLy8gZ28gdGhyb3VnaCB0aGUgYXJyYXkgZXZlcnkgdGhyZWUgYnl0ZXMsIHdlJ2xsIGRlYWwgd2l0aCB0cmFpbGluZyBzdHVmZiBsYXRlclxuICAgIGZvciAodmFyIGkgPSAwLCBsZW4yID0gbGVuIC0gZXh0cmFCeXRlczsgaSA8IGxlbjI7IGkgKz0gbWF4Q2h1bmtMZW5ndGgpIHtcbiAgICAgICAgcGFydHMucHVzaChlbmNvZGVDaHVuayh1aW50OCwgaSwgKGkgKyBtYXhDaHVua0xlbmd0aCkgPiBsZW4yID8gbGVuMiA6IChpICsgbWF4Q2h1bmtMZW5ndGgpKSk7XG4gICAgfVxuICAgIC8vIHBhZCB0aGUgZW5kIHdpdGggemVyb3MsIGJ1dCBtYWtlIHN1cmUgdG8gbm90IGZvcmdldCB0aGUgZXh0cmEgYnl0ZXNcbiAgICBpZiAoZXh0cmFCeXRlcyA9PT0gMSkge1xuICAgICAgICB0bXAgPSB1aW50OFtsZW4gLSAxXTtcbiAgICAgICAgcGFydHMucHVzaChsb29rdXBbdG1wID4+IDJdICtcbiAgICAgICAgICAgIGxvb2t1cFsodG1wIDw8IDQpICYgMHgzRl0gK1xuICAgICAgICAgICAgJz09Jyk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGV4dHJhQnl0ZXMgPT09IDIpIHtcbiAgICAgICAgdG1wID0gKHVpbnQ4W2xlbiAtIDJdIDw8IDgpICsgdWludDhbbGVuIC0gMV07XG4gICAgICAgIHBhcnRzLnB1c2gobG9va3VwW3RtcCA+PiAxMF0gK1xuICAgICAgICAgICAgbG9va3VwWyh0bXAgPj4gNCkgJiAweDNGXSArXG4gICAgICAgICAgICBsb29rdXBbKHRtcCA8PCAyKSAmIDB4M0ZdICtcbiAgICAgICAgICAgICc9Jyk7XG4gICAgfVxuICAgIHJldHVybiBwYXJ0cy5qb2luKCcnKTtcbn1cblxuXG4vLyMgc291cmNlVVJMPXdlYnBhY2s6Ly9AZmx1ZW5jZWxhYnMvbWFyaW5lLndvcmtlci1zY3JpcHQvLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL2Jhc2U2NC1qc0AxLjUuMS9ub2RlX21vZHVsZXMvYmFzZTY0LWpzL2luZGV4LmpzPyIpOwoKLyoqKi8gfSksCgovKioqLyAiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL2J1ZmZlckA2LjAuMy9ub2RlX21vZHVsZXMvYnVmZmVyL2luZGV4LmpzIjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAhKioqIC4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9idWZmZXJANi4wLjMvbm9kZV9tb2R1bGVzL2J1ZmZlci9pbmRleC5qcyAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoZnVuY3Rpb24oX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCmV2YWwoIi8qIVxuICogVGhlIGJ1ZmZlciBtb2R1bGUgZnJvbSBub2RlLmpzLCBmb3IgdGhlIGJyb3dzZXIuXG4gKlxuICogQGF1dGhvciAgIEZlcm9zcyBBYm91a2hhZGlqZWggPGh0dHBzOi8vZmVyb3NzLm9yZz5cbiAqIEBsaWNlbnNlICBNSVRcbiAqL1xuLyogZXNsaW50LWRpc2FibGUgbm8tcHJvdG8gKi9cblxudmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcbnZhciBiYXNlNjQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBiYXNlNjQtanMgKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vYmFzZTY0LWpzQDEuNS4xL25vZGVfbW9kdWxlcy9iYXNlNjQtanMvaW5kZXguanNcIik7XG52YXIgaWVlZTc1NCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIGllZWU3NTQgKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vaWVlZTc1NEAxLjIuMS9ub2RlX21vZHVsZXMvaWVlZTc1NC9pbmRleC5qc1wiKTtcbnZhciBjdXN0b21JbnNwZWN0U3ltYm9sID0gKHR5cGVvZiBTeW1ib2wgPT09ICdmdW5jdGlvbicgJiYgdHlwZW9mIFN5bWJvbFsnZm9yJ10gPT09ICdmdW5jdGlvbicpIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgZG90LW5vdGF0aW9uXG4gICAgPyBTeW1ib2xbJ2ZvciddKCdub2RlanMudXRpbC5pbnNwZWN0LmN1c3RvbScpIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgZG90LW5vdGF0aW9uXG4gICAgOiBudWxsO1xuZXhwb3J0cy5CdWZmZXIgPSBCdWZmZXI7XG5leHBvcnRzLlNsb3dCdWZmZXIgPSBTbG93QnVmZmVyO1xuZXhwb3J0cy5JTlNQRUNUX01BWF9CWVRFUyA9IDUwO1xudmFyIEtfTUFYX0xFTkdUSCA9IDB4N2ZmZmZmZmY7XG5leHBvcnRzLmtNYXhMZW5ndGggPSBLX01BWF9MRU5HVEg7XG4vKipcbiAqIElmIGBCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVGA6XG4gKiAgID09PSB0cnVlICAgIFVzZSBVaW50OEFycmF5IGltcGxlbWVudGF0aW9uIChmYXN0ZXN0KVxuICogICA9PT0gZmFsc2UgICBQcmludCB3YXJuaW5nIGFuZCByZWNvbW1lbmQgdXNpbmcgYGJ1ZmZlcmAgdjQueCB3aGljaCBoYXMgYW4gT2JqZWN0XG4gKiAgICAgICAgICAgICAgIGltcGxlbWVudGF0aW9uIChtb3N0IGNvbXBhdGlibGUsIGV2ZW4gSUU2KVxuICpcbiAqIEJyb3dzZXJzIHRoYXQgc3VwcG9ydCB0eXBlZCBhcnJheXMgYXJlIElFIDEwKywgRmlyZWZveCA0KywgQ2hyb21lIDcrLCBTYWZhcmkgNS4xKyxcbiAqIE9wZXJhIDExLjYrLCBpT1MgNC4yKy5cbiAqXG4gKiBXZSByZXBvcnQgdGhhdCB0aGUgYnJvd3NlciBkb2VzIG5vdCBzdXBwb3J0IHR5cGVkIGFycmF5cyBpZiB0aGUgYXJlIG5vdCBzdWJjbGFzc2FibGVcbiAqIHVzaW5nIF9fcHJvdG9fXy4gRmlyZWZveCA0LTI5IGxhY2tzIHN1cHBvcnQgZm9yIGFkZGluZyBuZXcgcHJvcGVydGllcyB0byBgVWludDhBcnJheWBcbiAqIChTZWU6IGh0dHBzOi8vYnVnemlsbGEubW96aWxsYS5vcmcvc2hvd19idWcuY2dpP2lkPTY5NTQzOCkuIElFIDEwIGxhY2tzIHN1cHBvcnRcbiAqIGZvciBfX3Byb3RvX18gYW5kIGhhcyBhIGJ1Z2d5IHR5cGVkIGFycmF5IGltcGxlbWVudGF0aW9uLlxuICovXG5CdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCA9IHR5cGVkQXJyYXlTdXBwb3J0KCk7XG5pZiAoIUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUICYmIHR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJyAmJlxuICAgIHR5cGVvZiBjb25zb2xlLmVycm9yID09PSAnZnVuY3Rpb24nKSB7XG4gICAgY29uc29sZS5lcnJvcignVGhpcyBicm93c2VyIGxhY2tzIHR5cGVkIGFycmF5IChVaW50OEFycmF5KSBzdXBwb3J0IHdoaWNoIGlzIHJlcXVpcmVkIGJ5ICcgK1xuICAgICAgICAnYGJ1ZmZlcmAgdjUueC4gVXNlIGBidWZmZXJgIHY0LnggaWYgeW91IHJlcXVpcmUgb2xkIGJyb3dzZXIgc3VwcG9ydC4nKTtcbn1cbmZ1bmN0aW9uIHR5cGVkQXJyYXlTdXBwb3J0KCkge1xuICAgIC8vIENhbiB0eXBlZCBhcnJheSBpbnN0YW5jZXMgY2FuIGJlIGF1Z21lbnRlZD9cbiAgICB0cnkge1xuICAgICAgICB2YXIgYXJyID0gbmV3IFVpbnQ4QXJyYXkoMSk7XG4gICAgICAgIHZhciBwcm90byA9IHsgZm9vOiBmdW5jdGlvbiAoKSB7IHJldHVybiA0MjsgfSB9O1xuICAgICAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YocHJvdG8sIFVpbnQ4QXJyYXkucHJvdG90eXBlKTtcbiAgICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKGFyciwgcHJvdG8pO1xuICAgICAgICByZXR1cm4gYXJyLmZvbygpID09PSA0MjtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShCdWZmZXIucHJvdG90eXBlLCAncGFyZW50Jywge1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghQnVmZmVyLmlzQnVmZmVyKHRoaXMpKVxuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgcmV0dXJuIHRoaXMuYnVmZmVyO1xuICAgIH1cbn0pO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KEJ1ZmZlci5wcm90b3R5cGUsICdvZmZzZXQnLCB7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCFCdWZmZXIuaXNCdWZmZXIodGhpcykpXG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICByZXR1cm4gdGhpcy5ieXRlT2Zmc2V0O1xuICAgIH1cbn0pO1xuZnVuY3Rpb24gY3JlYXRlQnVmZmVyKGxlbmd0aCkge1xuICAgIGlmIChsZW5ndGggPiBLX01BWF9MRU5HVEgpIHtcbiAgICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1RoZSB2YWx1ZSBcIicgKyBsZW5ndGggKyAnXCIgaXMgaW52YWxpZCBmb3Igb3B0aW9uIFwic2l6ZVwiJyk7XG4gICAgfVxuICAgIC8vIFJldHVybiBhbiBhdWdtZW50ZWQgYFVpbnQ4QXJyYXlgIGluc3RhbmNlXG4gICAgdmFyIGJ1ZiA9IG5ldyBVaW50OEFycmF5KGxlbmd0aCk7XG4gICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKGJ1ZiwgQnVmZmVyLnByb3RvdHlwZSk7XG4gICAgcmV0dXJuIGJ1Zjtcbn1cbi8qKlxuICogVGhlIEJ1ZmZlciBjb25zdHJ1Y3RvciByZXR1cm5zIGluc3RhbmNlcyBvZiBgVWludDhBcnJheWAgdGhhdCBoYXZlIHRoZWlyXG4gKiBwcm90b3R5cGUgY2hhbmdlZCB0byBgQnVmZmVyLnByb3RvdHlwZWAuIEZ1cnRoZXJtb3JlLCBgQnVmZmVyYCBpcyBhIHN1YmNsYXNzIG9mXG4gKiBgVWludDhBcnJheWAsIHNvIHRoZSByZXR1cm5lZCBpbnN0YW5jZXMgd2lsbCBoYXZlIGFsbCB0aGUgbm9kZSBgQnVmZmVyYCBtZXRob2RzXG4gKiBhbmQgdGhlIGBVaW50OEFycmF5YCBtZXRob2RzLiBTcXVhcmUgYnJhY2tldCBub3RhdGlvbiB3b3JrcyBhcyBleHBlY3RlZCAtLSBpdFxuICogcmV0dXJucyBhIHNpbmdsZSBvY3RldC5cbiAqXG4gKiBUaGUgYFVpbnQ4QXJyYXlgIHByb3RvdHlwZSByZW1haW5zIHVubW9kaWZpZWQuXG4gKi9cbmZ1bmN0aW9uIEJ1ZmZlcihhcmcsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aCkge1xuICAgIC8vIENvbW1vbiBjYXNlLlxuICAgIGlmICh0eXBlb2YgYXJnID09PSAnbnVtYmVyJykge1xuICAgICAgICBpZiAodHlwZW9mIGVuY29kaW5nT3JPZmZzZXQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdUaGUgXCJzdHJpbmdcIiBhcmd1bWVudCBtdXN0IGJlIG9mIHR5cGUgc3RyaW5nLiBSZWNlaXZlZCB0eXBlIG51bWJlcicpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhbGxvY1Vuc2FmZShhcmcpO1xuICAgIH1cbiAgICByZXR1cm4gZnJvbShhcmcsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aCk7XG59XG5CdWZmZXIucG9vbFNpemUgPSA4MTkyOyAvLyBub3QgdXNlZCBieSB0aGlzIGltcGxlbWVudGF0aW9uXG5mdW5jdGlvbiBmcm9tKHZhbHVlLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpIHtcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xuICAgICAgICByZXR1cm4gZnJvbVN0cmluZyh2YWx1ZSwgZW5jb2RpbmdPck9mZnNldCk7XG4gICAgfVxuICAgIGlmIChBcnJheUJ1ZmZlci5pc1ZpZXcodmFsdWUpKSB7XG4gICAgICAgIHJldHVybiBmcm9tQXJyYXlWaWV3KHZhbHVlKTtcbiAgICB9XG4gICAgaWYgKHZhbHVlID09IG51bGwpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignVGhlIGZpcnN0IGFyZ3VtZW50IG11c3QgYmUgb25lIG9mIHR5cGUgc3RyaW5nLCBCdWZmZXIsIEFycmF5QnVmZmVyLCBBcnJheSwgJyArXG4gICAgICAgICAgICAnb3IgQXJyYXktbGlrZSBPYmplY3QuIFJlY2VpdmVkIHR5cGUgJyArICh0eXBlb2YgdmFsdWUpKTtcbiAgICB9XG4gICAgaWYgKGlzSW5zdGFuY2UodmFsdWUsIEFycmF5QnVmZmVyKSB8fFxuICAgICAgICAodmFsdWUgJiYgaXNJbnN0YW5jZSh2YWx1ZS5idWZmZXIsIEFycmF5QnVmZmVyKSkpIHtcbiAgICAgICAgcmV0dXJuIGZyb21BcnJheUJ1ZmZlcih2YWx1ZSwgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBTaGFyZWRBcnJheUJ1ZmZlciAhPT0gJ3VuZGVmaW5lZCcgJiZcbiAgICAgICAgKGlzSW5zdGFuY2UodmFsdWUsIFNoYXJlZEFycmF5QnVmZmVyKSB8fFxuICAgICAgICAgICAgKHZhbHVlICYmIGlzSW5zdGFuY2UodmFsdWUuYnVmZmVyLCBTaGFyZWRBcnJheUJ1ZmZlcikpKSkge1xuICAgICAgICByZXR1cm4gZnJvbUFycmF5QnVmZmVyKHZhbHVlLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJykge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdUaGUgXCJ2YWx1ZVwiIGFyZ3VtZW50IG11c3Qgbm90IGJlIG9mIHR5cGUgbnVtYmVyLiBSZWNlaXZlZCB0eXBlIG51bWJlcicpO1xuICAgIH1cbiAgICB2YXIgdmFsdWVPZiA9IHZhbHVlLnZhbHVlT2YgJiYgdmFsdWUudmFsdWVPZigpO1xuICAgIGlmICh2YWx1ZU9mICE9IG51bGwgJiYgdmFsdWVPZiAhPT0gdmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIEJ1ZmZlci5mcm9tKHZhbHVlT2YsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aCk7XG4gICAgfVxuICAgIHZhciBiID0gZnJvbU9iamVjdCh2YWx1ZSk7XG4gICAgaWYgKGIpXG4gICAgICAgIHJldHVybiBiO1xuICAgIGlmICh0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9QcmltaXRpdmUgIT0gbnVsbCAmJlxuICAgICAgICB0eXBlb2YgdmFsdWVbU3ltYm9sLnRvUHJpbWl0aXZlXSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICByZXR1cm4gQnVmZmVyLmZyb20odmFsdWVbU3ltYm9sLnRvUHJpbWl0aXZlXSgnc3RyaW5nJyksIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aCk7XG4gICAgfVxuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1RoZSBmaXJzdCBhcmd1bWVudCBtdXN0IGJlIG9uZSBvZiB0eXBlIHN0cmluZywgQnVmZmVyLCBBcnJheUJ1ZmZlciwgQXJyYXksICcgK1xuICAgICAgICAnb3IgQXJyYXktbGlrZSBPYmplY3QuIFJlY2VpdmVkIHR5cGUgJyArICh0eXBlb2YgdmFsdWUpKTtcbn1cbi8qKlxuICogRnVuY3Rpb25hbGx5IGVxdWl2YWxlbnQgdG8gQnVmZmVyKGFyZywgZW5jb2RpbmcpIGJ1dCB0aHJvd3MgYSBUeXBlRXJyb3JcbiAqIGlmIHZhbHVlIGlzIGEgbnVtYmVyLlxuICogQnVmZmVyLmZyb20oc3RyWywgZW5jb2RpbmddKVxuICogQnVmZmVyLmZyb20oYXJyYXkpXG4gKiBCdWZmZXIuZnJvbShidWZmZXIpXG4gKiBCdWZmZXIuZnJvbShhcnJheUJ1ZmZlclssIGJ5dGVPZmZzZXRbLCBsZW5ndGhdXSlcbiAqKi9cbkJ1ZmZlci5mcm9tID0gZnVuY3Rpb24gKHZhbHVlLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpIHtcbiAgICByZXR1cm4gZnJvbSh2YWx1ZSwgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKTtcbn07XG4vLyBOb3RlOiBDaGFuZ2UgcHJvdG90eXBlICphZnRlciogQnVmZmVyLmZyb20gaXMgZGVmaW5lZCB0byB3b3JrYXJvdW5kIENocm9tZSBidWc6XG4vLyBodHRwczovL2dpdGh1Yi5jb20vZmVyb3NzL2J1ZmZlci9wdWxsLzE0OFxuT2JqZWN0LnNldFByb3RvdHlwZU9mKEJ1ZmZlci5wcm90b3R5cGUsIFVpbnQ4QXJyYXkucHJvdG90eXBlKTtcbk9iamVjdC5zZXRQcm90b3R5cGVPZihCdWZmZXIsIFVpbnQ4QXJyYXkpO1xuZnVuY3Rpb24gYXNzZXJ0U2l6ZShzaXplKSB7XG4gICAgaWYgKHR5cGVvZiBzaXplICE9PSAnbnVtYmVyJykge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdcInNpemVcIiBhcmd1bWVudCBtdXN0IGJlIG9mIHR5cGUgbnVtYmVyJyk7XG4gICAgfVxuICAgIGVsc2UgaWYgKHNpemUgPCAwKSB7XG4gICAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdUaGUgdmFsdWUgXCInICsgc2l6ZSArICdcIiBpcyBpbnZhbGlkIGZvciBvcHRpb24gXCJzaXplXCInKTtcbiAgICB9XG59XG5mdW5jdGlvbiBhbGxvYyhzaXplLCBmaWxsLCBlbmNvZGluZykge1xuICAgIGFzc2VydFNpemUoc2l6ZSk7XG4gICAgaWYgKHNpemUgPD0gMCkge1xuICAgICAgICByZXR1cm4gY3JlYXRlQnVmZmVyKHNpemUpO1xuICAgIH1cbiAgICBpZiAoZmlsbCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIC8vIE9ubHkgcGF5IGF0dGVudGlvbiB0byBlbmNvZGluZyBpZiBpdCdzIGEgc3RyaW5nLiBUaGlzXG4gICAgICAgIC8vIHByZXZlbnRzIGFjY2lkZW50YWxseSBzZW5kaW5nIGluIGEgbnVtYmVyIHRoYXQgd291bGRcbiAgICAgICAgLy8gYmUgaW50ZXJwcmV0ZWQgYXMgYSBzdGFydCBvZmZzZXQuXG4gICAgICAgIHJldHVybiB0eXBlb2YgZW5jb2RpbmcgPT09ICdzdHJpbmcnXG4gICAgICAgICAgICA/IGNyZWF0ZUJ1ZmZlcihzaXplKS5maWxsKGZpbGwsIGVuY29kaW5nKVxuICAgICAgICAgICAgOiBjcmVhdGVCdWZmZXIoc2l6ZSkuZmlsbChmaWxsKTtcbiAgICB9XG4gICAgcmV0dXJuIGNyZWF0ZUJ1ZmZlcihzaXplKTtcbn1cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyBmaWxsZWQgQnVmZmVyIGluc3RhbmNlLlxuICogYWxsb2Moc2l6ZVssIGZpbGxbLCBlbmNvZGluZ11dKVxuICoqL1xuQnVmZmVyLmFsbG9jID0gZnVuY3Rpb24gKHNpemUsIGZpbGwsIGVuY29kaW5nKSB7XG4gICAgcmV0dXJuIGFsbG9jKHNpemUsIGZpbGwsIGVuY29kaW5nKTtcbn07XG5mdW5jdGlvbiBhbGxvY1Vuc2FmZShzaXplKSB7XG4gICAgYXNzZXJ0U2l6ZShzaXplKTtcbiAgICByZXR1cm4gY3JlYXRlQnVmZmVyKHNpemUgPCAwID8gMCA6IGNoZWNrZWQoc2l6ZSkgfCAwKTtcbn1cbi8qKlxuICogRXF1aXZhbGVudCB0byBCdWZmZXIobnVtKSwgYnkgZGVmYXVsdCBjcmVhdGVzIGEgbm9uLXplcm8tZmlsbGVkIEJ1ZmZlciBpbnN0YW5jZS5cbiAqICovXG5CdWZmZXIuYWxsb2NVbnNhZmUgPSBmdW5jdGlvbiAoc2l6ZSkge1xuICAgIHJldHVybiBhbGxvY1Vuc2FmZShzaXplKTtcbn07XG4vKipcbiAqIEVxdWl2YWxlbnQgdG8gU2xvd0J1ZmZlcihudW0pLCBieSBkZWZhdWx0IGNyZWF0ZXMgYSBub24temVyby1maWxsZWQgQnVmZmVyIGluc3RhbmNlLlxuICovXG5CdWZmZXIuYWxsb2NVbnNhZmVTbG93ID0gZnVuY3Rpb24gKHNpemUpIHtcbiAgICByZXR1cm4gYWxsb2NVbnNhZmUoc2l6ZSk7XG59O1xuZnVuY3Rpb24gZnJvbVN0cmluZyhzdHJpbmcsIGVuY29kaW5nKSB7XG4gICAgaWYgKHR5cGVvZiBlbmNvZGluZyAhPT0gJ3N0cmluZycgfHwgZW5jb2RpbmcgPT09ICcnKSB7XG4gICAgICAgIGVuY29kaW5nID0gJ3V0ZjgnO1xuICAgIH1cbiAgICBpZiAoIUJ1ZmZlci5pc0VuY29kaW5nKGVuY29kaW5nKSkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdVbmtub3duIGVuY29kaW5nOiAnICsgZW5jb2RpbmcpO1xuICAgIH1cbiAgICB2YXIgbGVuZ3RoID0gYnl0ZUxlbmd0aChzdHJpbmcsIGVuY29kaW5nKSB8IDA7XG4gICAgdmFyIGJ1ZiA9IGNyZWF0ZUJ1ZmZlcihsZW5ndGgpO1xuICAgIHZhciBhY3R1YWwgPSBidWYud3JpdGUoc3RyaW5nLCBlbmNvZGluZyk7XG4gICAgaWYgKGFjdHVhbCAhPT0gbGVuZ3RoKSB7XG4gICAgICAgIC8vIFdyaXRpbmcgYSBoZXggc3RyaW5nLCBmb3IgZXhhbXBsZSwgdGhhdCBjb250YWlucyBpbnZhbGlkIGNoYXJhY3RlcnMgd2lsbFxuICAgICAgICAvLyBjYXVzZSBldmVyeXRoaW5nIGFmdGVyIHRoZSBmaXJzdCBpbnZhbGlkIGNoYXJhY3RlciB0byBiZSBpZ25vcmVkLiAoZS5nLlxuICAgICAgICAvLyAnYWJ4eGNkJyB3aWxsIGJlIHRyZWF0ZWQgYXMgJ2FiJylcbiAgICAgICAgYnVmID0gYnVmLnNsaWNlKDAsIGFjdHVhbCk7XG4gICAgfVxuICAgIHJldHVybiBidWY7XG59XG5mdW5jdGlvbiBmcm9tQXJyYXlMaWtlKGFycmF5KSB7XG4gICAgdmFyIGxlbmd0aCA9IGFycmF5Lmxlbmd0aCA8IDAgPyAwIDogY2hlY2tlZChhcnJheS5sZW5ndGgpIHwgMDtcbiAgICB2YXIgYnVmID0gY3JlYXRlQnVmZmVyKGxlbmd0aCk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICBidWZbaV0gPSBhcnJheVtpXSAmIDI1NTtcbiAgICB9XG4gICAgcmV0dXJuIGJ1Zjtcbn1cbmZ1bmN0aW9uIGZyb21BcnJheVZpZXcoYXJyYXlWaWV3KSB7XG4gICAgaWYgKGlzSW5zdGFuY2UoYXJyYXlWaWV3LCBVaW50OEFycmF5KSkge1xuICAgICAgICB2YXIgY29weSA9IG5ldyBVaW50OEFycmF5KGFycmF5Vmlldyk7XG4gICAgICAgIHJldHVybiBmcm9tQXJyYXlCdWZmZXIoY29weS5idWZmZXIsIGNvcHkuYnl0ZU9mZnNldCwgY29weS5ieXRlTGVuZ3RoKTtcbiAgICB9XG4gICAgcmV0dXJuIGZyb21BcnJheUxpa2UoYXJyYXlWaWV3KTtcbn1cbmZ1bmN0aW9uIGZyb21BcnJheUJ1ZmZlcihhcnJheSwgYnl0ZU9mZnNldCwgbGVuZ3RoKSB7XG4gICAgaWYgKGJ5dGVPZmZzZXQgPCAwIHx8IGFycmF5LmJ5dGVMZW5ndGggPCBieXRlT2Zmc2V0KSB7XG4gICAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdcIm9mZnNldFwiIGlzIG91dHNpZGUgb2YgYnVmZmVyIGJvdW5kcycpO1xuICAgIH1cbiAgICBpZiAoYXJyYXkuYnl0ZUxlbmd0aCA8IGJ5dGVPZmZzZXQgKyAobGVuZ3RoIHx8IDApKSB7XG4gICAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdcImxlbmd0aFwiIGlzIG91dHNpZGUgb2YgYnVmZmVyIGJvdW5kcycpO1xuICAgIH1cbiAgICB2YXIgYnVmO1xuICAgIGlmIChieXRlT2Zmc2V0ID09PSB1bmRlZmluZWQgJiYgbGVuZ3RoID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgYnVmID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXkpO1xuICAgIH1cbiAgICBlbHNlIGlmIChsZW5ndGggPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBidWYgPSBuZXcgVWludDhBcnJheShhcnJheSwgYnl0ZU9mZnNldCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBidWYgPSBuZXcgVWludDhBcnJheShhcnJheSwgYnl0ZU9mZnNldCwgbGVuZ3RoKTtcbiAgICB9XG4gICAgLy8gUmV0dXJuIGFuIGF1Z21lbnRlZCBgVWludDhBcnJheWAgaW5zdGFuY2VcbiAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YoYnVmLCBCdWZmZXIucHJvdG90eXBlKTtcbiAgICByZXR1cm4gYnVmO1xufVxuZnVuY3Rpb24gZnJvbU9iamVjdChvYmopIHtcbiAgICBpZiAoQnVmZmVyLmlzQnVmZmVyKG9iaikpIHtcbiAgICAgICAgdmFyIGxlbiA9IGNoZWNrZWQob2JqLmxlbmd0aCkgfCAwO1xuICAgICAgICB2YXIgYnVmID0gY3JlYXRlQnVmZmVyKGxlbik7XG4gICAgICAgIGlmIChidWYubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gYnVmO1xuICAgICAgICB9XG4gICAgICAgIG9iai5jb3B5KGJ1ZiwgMCwgMCwgbGVuKTtcbiAgICAgICAgcmV0dXJuIGJ1ZjtcbiAgICB9XG4gICAgaWYgKG9iai5sZW5ndGggIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBpZiAodHlwZW9mIG9iai5sZW5ndGggIT09ICdudW1iZXInIHx8IG51bWJlcklzTmFOKG9iai5sZW5ndGgpKSB7XG4gICAgICAgICAgICByZXR1cm4gY3JlYXRlQnVmZmVyKDApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmcm9tQXJyYXlMaWtlKG9iaik7XG4gICAgfVxuICAgIGlmIChvYmoudHlwZSA9PT0gJ0J1ZmZlcicgJiYgQXJyYXkuaXNBcnJheShvYmouZGF0YSkpIHtcbiAgICAgICAgcmV0dXJuIGZyb21BcnJheUxpa2Uob2JqLmRhdGEpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGNoZWNrZWQobGVuZ3RoKSB7XG4gICAgLy8gTm90ZTogY2Fubm90IHVzZSBgbGVuZ3RoIDwgS19NQVhfTEVOR1RIYCBoZXJlIGJlY2F1c2UgdGhhdCBmYWlscyB3aGVuXG4gICAgLy8gbGVuZ3RoIGlzIE5hTiAod2hpY2ggaXMgb3RoZXJ3aXNlIGNvZXJjZWQgdG8gemVyby4pXG4gICAgaWYgKGxlbmd0aCA+PSBLX01BWF9MRU5HVEgpIHtcbiAgICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0F0dGVtcHQgdG8gYWxsb2NhdGUgQnVmZmVyIGxhcmdlciB0aGFuIG1heGltdW0gJyArXG4gICAgICAgICAgICAnc2l6ZTogMHgnICsgS19NQVhfTEVOR1RILnRvU3RyaW5nKDE2KSArICcgYnl0ZXMnKTtcbiAgICB9XG4gICAgcmV0dXJuIGxlbmd0aCB8IDA7XG59XG5mdW5jdGlvbiBTbG93QnVmZmVyKGxlbmd0aCkge1xuICAgIGlmICgrbGVuZ3RoICE9IGxlbmd0aCkgeyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIGVxZXFlcVxuICAgICAgICBsZW5ndGggPSAwO1xuICAgIH1cbiAgICByZXR1cm4gQnVmZmVyLmFsbG9jKCtsZW5ndGgpO1xufVxuQnVmZmVyLmlzQnVmZmVyID0gZnVuY3Rpb24gaXNCdWZmZXIoYikge1xuICAgIHJldHVybiBiICE9IG51bGwgJiYgYi5faXNCdWZmZXIgPT09IHRydWUgJiZcbiAgICAgICAgYiAhPT0gQnVmZmVyLnByb3RvdHlwZTsgLy8gc28gQnVmZmVyLmlzQnVmZmVyKEJ1ZmZlci5wcm90b3R5cGUpIHdpbGwgYmUgZmFsc2Vcbn07XG5CdWZmZXIuY29tcGFyZSA9IGZ1bmN0aW9uIGNvbXBhcmUoYSwgYikge1xuICAgIGlmIChpc0luc3RhbmNlKGEsIFVpbnQ4QXJyYXkpKVxuICAgICAgICBhID0gQnVmZmVyLmZyb20oYSwgYS5vZmZzZXQsIGEuYnl0ZUxlbmd0aCk7XG4gICAgaWYgKGlzSW5zdGFuY2UoYiwgVWludDhBcnJheSkpXG4gICAgICAgIGIgPSBCdWZmZXIuZnJvbShiLCBiLm9mZnNldCwgYi5ieXRlTGVuZ3RoKTtcbiAgICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihhKSB8fCAhQnVmZmVyLmlzQnVmZmVyKGIpKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1RoZSBcImJ1ZjFcIiwgXCJidWYyXCIgYXJndW1lbnRzIG11c3QgYmUgb25lIG9mIHR5cGUgQnVmZmVyIG9yIFVpbnQ4QXJyYXknKTtcbiAgICB9XG4gICAgaWYgKGEgPT09IGIpXG4gICAgICAgIHJldHVybiAwO1xuICAgIHZhciB4ID0gYS5sZW5ndGg7XG4gICAgdmFyIHkgPSBiLmxlbmd0aDtcbiAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gTWF0aC5taW4oeCwgeSk7IGkgPCBsZW47ICsraSkge1xuICAgICAgICBpZiAoYVtpXSAhPT0gYltpXSkge1xuICAgICAgICAgICAgeCA9IGFbaV07XG4gICAgICAgICAgICB5ID0gYltpXTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmICh4IDwgeSlcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIGlmICh5IDwgeClcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgcmV0dXJuIDA7XG59O1xuQnVmZmVyLmlzRW5jb2RpbmcgPSBmdW5jdGlvbiBpc0VuY29kaW5nKGVuY29kaW5nKSB7XG4gICAgc3dpdGNoIChTdHJpbmcoZW5jb2RpbmcpLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgY2FzZSAnaGV4JzpcbiAgICAgICAgY2FzZSAndXRmOCc6XG4gICAgICAgIGNhc2UgJ3V0Zi04JzpcbiAgICAgICAgY2FzZSAnYXNjaWknOlxuICAgICAgICBjYXNlICdsYXRpbjEnOlxuICAgICAgICBjYXNlICdiaW5hcnknOlxuICAgICAgICBjYXNlICdiYXNlNjQnOlxuICAgICAgICBjYXNlICd1Y3MyJzpcbiAgICAgICAgY2FzZSAndWNzLTInOlxuICAgICAgICBjYXNlICd1dGYxNmxlJzpcbiAgICAgICAgY2FzZSAndXRmLTE2bGUnOlxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufTtcbkJ1ZmZlci5jb25jYXQgPSBmdW5jdGlvbiBjb25jYXQobGlzdCwgbGVuZ3RoKSB7XG4gICAgaWYgKCFBcnJheS5pc0FycmF5KGxpc3QpKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1wibGlzdFwiIGFyZ3VtZW50IG11c3QgYmUgYW4gQXJyYXkgb2YgQnVmZmVycycpO1xuICAgIH1cbiAgICBpZiAobGlzdC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmV0dXJuIEJ1ZmZlci5hbGxvYygwKTtcbiAgICB9XG4gICAgdmFyIGk7XG4gICAgaWYgKGxlbmd0aCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGxlbmd0aCA9IDA7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICBsZW5ndGggKz0gbGlzdFtpXS5sZW5ndGg7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmFyIGJ1ZmZlciA9IEJ1ZmZlci5hbGxvY1Vuc2FmZShsZW5ndGgpO1xuICAgIHZhciBwb3MgPSAwO1xuICAgIGZvciAoaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgKytpKSB7XG4gICAgICAgIHZhciBidWYgPSBsaXN0W2ldO1xuICAgICAgICBpZiAoaXNJbnN0YW5jZShidWYsIFVpbnQ4QXJyYXkpKSB7XG4gICAgICAgICAgICBpZiAocG9zICsgYnVmLmxlbmd0aCA+IGJ1ZmZlci5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihidWYpKVxuICAgICAgICAgICAgICAgICAgICBidWYgPSBCdWZmZXIuZnJvbShidWYpO1xuICAgICAgICAgICAgICAgIGJ1Zi5jb3B5KGJ1ZmZlciwgcG9zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIFVpbnQ4QXJyYXkucHJvdG90eXBlLnNldC5jYWxsKGJ1ZmZlciwgYnVmLCBwb3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCFCdWZmZXIuaXNCdWZmZXIoYnVmKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignXCJsaXN0XCIgYXJndW1lbnQgbXVzdCBiZSBhbiBBcnJheSBvZiBCdWZmZXJzJyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBidWYuY29weShidWZmZXIsIHBvcyk7XG4gICAgICAgIH1cbiAgICAgICAgcG9zICs9IGJ1Zi5sZW5ndGg7XG4gICAgfVxuICAgIHJldHVybiBidWZmZXI7XG59O1xuZnVuY3Rpb24gYnl0ZUxlbmd0aChzdHJpbmcsIGVuY29kaW5nKSB7XG4gICAgaWYgKEJ1ZmZlci5pc0J1ZmZlcihzdHJpbmcpKSB7XG4gICAgICAgIHJldHVybiBzdHJpbmcubGVuZ3RoO1xuICAgIH1cbiAgICBpZiAoQXJyYXlCdWZmZXIuaXNWaWV3KHN0cmluZykgfHwgaXNJbnN0YW5jZShzdHJpbmcsIEFycmF5QnVmZmVyKSkge1xuICAgICAgICByZXR1cm4gc3RyaW5nLmJ5dGVMZW5ndGg7XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygc3RyaW5nICE9PSAnc3RyaW5nJykge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdUaGUgXCJzdHJpbmdcIiBhcmd1bWVudCBtdXN0IGJlIG9uZSBvZiB0eXBlIHN0cmluZywgQnVmZmVyLCBvciBBcnJheUJ1ZmZlci4gJyArXG4gICAgICAgICAgICAnUmVjZWl2ZWQgdHlwZSAnICsgdHlwZW9mIHN0cmluZyk7XG4gICAgfVxuICAgIHZhciBsZW4gPSBzdHJpbmcubGVuZ3RoO1xuICAgIHZhciBtdXN0TWF0Y2ggPSAoYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdID09PSB0cnVlKTtcbiAgICBpZiAoIW11c3RNYXRjaCAmJiBsZW4gPT09IDApXG4gICAgICAgIHJldHVybiAwO1xuICAgIC8vIFVzZSBhIGZvciBsb29wIHRvIGF2b2lkIHJlY3Vyc2lvblxuICAgIHZhciBsb3dlcmVkQ2FzZSA9IGZhbHNlO1xuICAgIGZvciAoOzspIHtcbiAgICAgICAgc3dpdGNoIChlbmNvZGluZykge1xuICAgICAgICAgICAgY2FzZSAnYXNjaWknOlxuICAgICAgICAgICAgY2FzZSAnbGF0aW4xJzpcbiAgICAgICAgICAgIGNhc2UgJ2JpbmFyeSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxlbjtcbiAgICAgICAgICAgIGNhc2UgJ3V0ZjgnOlxuICAgICAgICAgICAgY2FzZSAndXRmLTgnOlxuICAgICAgICAgICAgICAgIHJldHVybiB1dGY4VG9CeXRlcyhzdHJpbmcpLmxlbmd0aDtcbiAgICAgICAgICAgIGNhc2UgJ3VjczInOlxuICAgICAgICAgICAgY2FzZSAndWNzLTInOlxuICAgICAgICAgICAgY2FzZSAndXRmMTZsZSc6XG4gICAgICAgICAgICBjYXNlICd1dGYtMTZsZSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxlbiAqIDI7XG4gICAgICAgICAgICBjYXNlICdoZXgnOlxuICAgICAgICAgICAgICAgIHJldHVybiBsZW4gPj4+IDE7XG4gICAgICAgICAgICBjYXNlICdiYXNlNjQnOlxuICAgICAgICAgICAgICAgIHJldHVybiBiYXNlNjRUb0J5dGVzKHN0cmluZykubGVuZ3RoO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBpZiAobG93ZXJlZENhc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG11c3RNYXRjaCA/IC0xIDogdXRmOFRvQnl0ZXMoc3RyaW5nKS5sZW5ndGg7IC8vIGFzc3VtZSB1dGY4XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVuY29kaW5nID0gKCcnICsgZW5jb2RpbmcpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICAgICAgbG93ZXJlZENhc2UgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxufVxuQnVmZmVyLmJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoO1xuZnVuY3Rpb24gc2xvd1RvU3RyaW5nKGVuY29kaW5nLCBzdGFydCwgZW5kKSB7XG4gICAgdmFyIGxvd2VyZWRDYXNlID0gZmFsc2U7XG4gICAgLy8gTm8gbmVlZCB0byB2ZXJpZnkgdGhhdCBcInRoaXMubGVuZ3RoIDw9IE1BWF9VSU5UMzJcIiBzaW5jZSBpdCdzIGEgcmVhZC1vbmx5XG4gICAgLy8gcHJvcGVydHkgb2YgYSB0eXBlZCBhcnJheS5cbiAgICAvLyBUaGlzIGJlaGF2ZXMgbmVpdGhlciBsaWtlIFN0cmluZyBub3IgVWludDhBcnJheSBpbiB0aGF0IHdlIHNldCBzdGFydC9lbmRcbiAgICAvLyB0byB0aGVpciB1cHBlci9sb3dlciBib3VuZHMgaWYgdGhlIHZhbHVlIHBhc3NlZCBpcyBvdXQgb2YgcmFuZ2UuXG4gICAgLy8gdW5kZWZpbmVkIGlzIGhhbmRsZWQgc3BlY2lhbGx5IGFzIHBlciBFQ01BLTI2MiA2dGggRWRpdGlvbixcbiAgICAvLyBTZWN0aW9uIDEzLjMuMy43IFJ1bnRpbWUgU2VtYW50aWNzOiBLZXllZEJpbmRpbmdJbml0aWFsaXphdGlvbi5cbiAgICBpZiAoc3RhcnQgPT09IHVuZGVmaW5lZCB8fCBzdGFydCA8IDApIHtcbiAgICAgICAgc3RhcnQgPSAwO1xuICAgIH1cbiAgICAvLyBSZXR1cm4gZWFybHkgaWYgc3RhcnQgPiB0aGlzLmxlbmd0aC4gRG9uZSBoZXJlIHRvIHByZXZlbnQgcG90ZW50aWFsIHVpbnQzMlxuICAgIC8vIGNvZXJjaW9uIGZhaWwgYmVsb3cuXG4gICAgaWYgKHN0YXJ0ID4gdGhpcy5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgIH1cbiAgICBpZiAoZW5kID09PSB1bmRlZmluZWQgfHwgZW5kID4gdGhpcy5sZW5ndGgpIHtcbiAgICAgICAgZW5kID0gdGhpcy5sZW5ndGg7XG4gICAgfVxuICAgIGlmIChlbmQgPD0gMCkge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgfVxuICAgIC8vIEZvcmNlIGNvZXJjaW9uIHRvIHVpbnQzMi4gVGhpcyB3aWxsIGFsc28gY29lcmNlIGZhbHNleS9OYU4gdmFsdWVzIHRvIDAuXG4gICAgZW5kID4+Pj0gMDtcbiAgICBzdGFydCA+Pj49IDA7XG4gICAgaWYgKGVuZCA8PSBzdGFydCkge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgfVxuICAgIGlmICghZW5jb2RpbmcpXG4gICAgICAgIGVuY29kaW5nID0gJ3V0ZjgnO1xuICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgIHN3aXRjaCAoZW5jb2RpbmcpIHtcbiAgICAgICAgICAgIGNhc2UgJ2hleCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGhleFNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpO1xuICAgICAgICAgICAgY2FzZSAndXRmOCc6XG4gICAgICAgICAgICBjYXNlICd1dGYtOCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHV0ZjhTbGljZSh0aGlzLCBzdGFydCwgZW5kKTtcbiAgICAgICAgICAgIGNhc2UgJ2FzY2lpJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gYXNjaWlTbGljZSh0aGlzLCBzdGFydCwgZW5kKTtcbiAgICAgICAgICAgIGNhc2UgJ2xhdGluMSc6XG4gICAgICAgICAgICBjYXNlICdiaW5hcnknOlxuICAgICAgICAgICAgICAgIHJldHVybiBsYXRpbjFTbGljZSh0aGlzLCBzdGFydCwgZW5kKTtcbiAgICAgICAgICAgIGNhc2UgJ2Jhc2U2NCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGJhc2U2NFNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpO1xuICAgICAgICAgICAgY2FzZSAndWNzMic6XG4gICAgICAgICAgICBjYXNlICd1Y3MtMic6XG4gICAgICAgICAgICBjYXNlICd1dGYxNmxlJzpcbiAgICAgICAgICAgIGNhc2UgJ3V0Zi0xNmxlJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gdXRmMTZsZVNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBpZiAobG93ZXJlZENhc2UpXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1Vua25vd24gZW5jb2Rpbmc6ICcgKyBlbmNvZGluZyk7XG4gICAgICAgICAgICAgICAgZW5jb2RpbmcgPSAoZW5jb2RpbmcgKyAnJykudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgICBsb3dlcmVkQ2FzZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG59XG4vLyBUaGlzIHByb3BlcnR5IGlzIHVzZWQgYnkgYEJ1ZmZlci5pc0J1ZmZlcmAgKGFuZCB0aGUgYGlzLWJ1ZmZlcmAgbnBtIHBhY2thZ2UpXG4vLyB0byBkZXRlY3QgYSBCdWZmZXIgaW5zdGFuY2UuIEl0J3Mgbm90IHBvc3NpYmxlIHRvIHVzZSBgaW5zdGFuY2VvZiBCdWZmZXJgXG4vLyByZWxpYWJseSBpbiBhIGJyb3dzZXJpZnkgY29udGV4dCBiZWNhdXNlIHRoZXJlIGNvdWxkIGJlIG11bHRpcGxlIGRpZmZlcmVudFxuLy8gY29waWVzIG9mIHRoZSAnYnVmZmVyJyBwYWNrYWdlIGluIHVzZS4gVGhpcyBtZXRob2Qgd29ya3MgZXZlbiBmb3IgQnVmZmVyXG4vLyBpbnN0YW5jZXMgdGhhdCB3ZXJlIGNyZWF0ZWQgZnJvbSBhbm90aGVyIGNvcHkgb2YgdGhlIGBidWZmZXJgIHBhY2thZ2UuXG4vLyBTZWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9mZXJvc3MvYnVmZmVyL2lzc3Vlcy8xNTRcbkJ1ZmZlci5wcm90b3R5cGUuX2lzQnVmZmVyID0gdHJ1ZTtcbmZ1bmN0aW9uIHN3YXAoYiwgbiwgbSkge1xuICAgIHZhciBpID0gYltuXTtcbiAgICBiW25dID0gYlttXTtcbiAgICBiW21dID0gaTtcbn1cbkJ1ZmZlci5wcm90b3R5cGUuc3dhcDE2ID0gZnVuY3Rpb24gc3dhcDE2KCkge1xuICAgIHZhciBsZW4gPSB0aGlzLmxlbmd0aDtcbiAgICBpZiAobGVuICUgMiAhPT0gMCkge1xuICAgICAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignQnVmZmVyIHNpemUgbXVzdCBiZSBhIG11bHRpcGxlIG9mIDE2LWJpdHMnKTtcbiAgICB9XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkgKz0gMikge1xuICAgICAgICBzd2FwKHRoaXMsIGksIGkgKyAxKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuQnVmZmVyLnByb3RvdHlwZS5zd2FwMzIgPSBmdW5jdGlvbiBzd2FwMzIoKSB7XG4gICAgdmFyIGxlbiA9IHRoaXMubGVuZ3RoO1xuICAgIGlmIChsZW4gJSA0ICE9PSAwKSB7XG4gICAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdCdWZmZXIgc2l6ZSBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgMzItYml0cycpO1xuICAgIH1cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSArPSA0KSB7XG4gICAgICAgIHN3YXAodGhpcywgaSwgaSArIDMpO1xuICAgICAgICBzd2FwKHRoaXMsIGkgKyAxLCBpICsgMik7XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xufTtcbkJ1ZmZlci5wcm90b3R5cGUuc3dhcDY0ID0gZnVuY3Rpb24gc3dhcDY0KCkge1xuICAgIHZhciBsZW4gPSB0aGlzLmxlbmd0aDtcbiAgICBpZiAobGVuICUgOCAhPT0gMCkge1xuICAgICAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignQnVmZmVyIHNpemUgbXVzdCBiZSBhIG11bHRpcGxlIG9mIDY0LWJpdHMnKTtcbiAgICB9XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkgKz0gOCkge1xuICAgICAgICBzd2FwKHRoaXMsIGksIGkgKyA3KTtcbiAgICAgICAgc3dhcCh0aGlzLCBpICsgMSwgaSArIDYpO1xuICAgICAgICBzd2FwKHRoaXMsIGkgKyAyLCBpICsgNSk7XG4gICAgICAgIHN3YXAodGhpcywgaSArIDMsIGkgKyA0KTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuQnVmZmVyLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uIHRvU3RyaW5nKCkge1xuICAgIHZhciBsZW5ndGggPSB0aGlzLmxlbmd0aDtcbiAgICBpZiAobGVuZ3RoID09PSAwKVxuICAgICAgICByZXR1cm4gJyc7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApXG4gICAgICAgIHJldHVybiB1dGY4U2xpY2UodGhpcywgMCwgbGVuZ3RoKTtcbiAgICByZXR1cm4gc2xvd1RvU3RyaW5nLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59O1xuQnVmZmVyLnByb3RvdHlwZS50b0xvY2FsZVN0cmluZyA9IEJ1ZmZlci5wcm90b3R5cGUudG9TdHJpbmc7XG5CdWZmZXIucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIGVxdWFscyhiKSB7XG4gICAgaWYgKCFCdWZmZXIuaXNCdWZmZXIoYikpXG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FyZ3VtZW50IG11c3QgYmUgYSBCdWZmZXInKTtcbiAgICBpZiAodGhpcyA9PT0gYilcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgcmV0dXJuIEJ1ZmZlci5jb21wYXJlKHRoaXMsIGIpID09PSAwO1xufTtcbkJ1ZmZlci5wcm90b3R5cGUuaW5zcGVjdCA9IGZ1bmN0aW9uIGluc3BlY3QoKSB7XG4gICAgdmFyIHN0ciA9ICcnO1xuICAgIHZhciBtYXggPSBleHBvcnRzLklOU1BFQ1RfTUFYX0JZVEVTO1xuICAgIHN0ciA9IHRoaXMudG9TdHJpbmcoJ2hleCcsIDAsIG1heCkucmVwbGFjZSgvKC57Mn0pL2csICckMSAnKS50cmltKCk7XG4gICAgaWYgKHRoaXMubGVuZ3RoID4gbWF4KVxuICAgICAgICBzdHIgKz0gJyAuLi4gJztcbiAgICByZXR1cm4gJzxCdWZmZXIgJyArIHN0ciArICc+Jztcbn07XG5pZiAoY3VzdG9tSW5zcGVjdFN5bWJvbCkge1xuICAgIEJ1ZmZlci5wcm90b3R5cGVbY3VzdG9tSW5zcGVjdFN5bWJvbF0gPSBCdWZmZXIucHJvdG90eXBlLmluc3BlY3Q7XG59XG5CdWZmZXIucHJvdG90eXBlLmNvbXBhcmUgPSBmdW5jdGlvbiBjb21wYXJlKHRhcmdldCwgc3RhcnQsIGVuZCwgdGhpc1N0YXJ0LCB0aGlzRW5kKSB7XG4gICAgaWYgKGlzSW5zdGFuY2UodGFyZ2V0LCBVaW50OEFycmF5KSkge1xuICAgICAgICB0YXJnZXQgPSBCdWZmZXIuZnJvbSh0YXJnZXQsIHRhcmdldC5vZmZzZXQsIHRhcmdldC5ieXRlTGVuZ3RoKTtcbiAgICB9XG4gICAgaWYgKCFCdWZmZXIuaXNCdWZmZXIodGFyZ2V0KSkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdUaGUgXCJ0YXJnZXRcIiBhcmd1bWVudCBtdXN0IGJlIG9uZSBvZiB0eXBlIEJ1ZmZlciBvciBVaW50OEFycmF5LiAnICtcbiAgICAgICAgICAgICdSZWNlaXZlZCB0eXBlICcgKyAodHlwZW9mIHRhcmdldCkpO1xuICAgIH1cbiAgICBpZiAoc3RhcnQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBzdGFydCA9IDA7XG4gICAgfVxuICAgIGlmIChlbmQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBlbmQgPSB0YXJnZXQgPyB0YXJnZXQubGVuZ3RoIDogMDtcbiAgICB9XG4gICAgaWYgKHRoaXNTdGFydCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHRoaXNTdGFydCA9IDA7XG4gICAgfVxuICAgIGlmICh0aGlzRW5kID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhpc0VuZCA9IHRoaXMubGVuZ3RoO1xuICAgIH1cbiAgICBpZiAoc3RhcnQgPCAwIHx8IGVuZCA+IHRhcmdldC5sZW5ndGggfHwgdGhpc1N0YXJ0IDwgMCB8fCB0aGlzRW5kID4gdGhpcy5sZW5ndGgpIHtcbiAgICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ291dCBvZiByYW5nZSBpbmRleCcpO1xuICAgIH1cbiAgICBpZiAodGhpc1N0YXJ0ID49IHRoaXNFbmQgJiYgc3RhcnQgPj0gZW5kKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICBpZiAodGhpc1N0YXJ0ID49IHRoaXNFbmQpIHtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICBpZiAoc3RhcnQgPj0gZW5kKSB7XG4gICAgICAgIHJldHVybiAxO1xuICAgIH1cbiAgICBzdGFydCA+Pj49IDA7XG4gICAgZW5kID4+Pj0gMDtcbiAgICB0aGlzU3RhcnQgPj4+PSAwO1xuICAgIHRoaXNFbmQgPj4+PSAwO1xuICAgIGlmICh0aGlzID09PSB0YXJnZXQpXG4gICAgICAgIHJldHVybiAwO1xuICAgIHZhciB4ID0gdGhpc0VuZCAtIHRoaXNTdGFydDtcbiAgICB2YXIgeSA9IGVuZCAtIHN0YXJ0O1xuICAgIHZhciBsZW4gPSBNYXRoLm1pbih4LCB5KTtcbiAgICB2YXIgdGhpc0NvcHkgPSB0aGlzLnNsaWNlKHRoaXNTdGFydCwgdGhpc0VuZCk7XG4gICAgdmFyIHRhcmdldENvcHkgPSB0YXJnZXQuc2xpY2Uoc3RhcnQsIGVuZCk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47ICsraSkge1xuICAgICAgICBpZiAodGhpc0NvcHlbaV0gIT09IHRhcmdldENvcHlbaV0pIHtcbiAgICAgICAgICAgIHggPSB0aGlzQ29weVtpXTtcbiAgICAgICAgICAgIHkgPSB0YXJnZXRDb3B5W2ldO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKHggPCB5KVxuICAgICAgICByZXR1cm4gLTE7XG4gICAgaWYgKHkgPCB4KVxuICAgICAgICByZXR1cm4gMTtcbiAgICByZXR1cm4gMDtcbn07XG4vLyBGaW5kcyBlaXRoZXIgdGhlIGZpcnN0IGluZGV4IG9mIGB2YWxgIGluIGBidWZmZXJgIGF0IG9mZnNldCA+PSBgYnl0ZU9mZnNldGAsXG4vLyBPUiB0aGUgbGFzdCBpbmRleCBvZiBgdmFsYCBpbiBgYnVmZmVyYCBhdCBvZmZzZXQgPD0gYGJ5dGVPZmZzZXRgLlxuLy9cbi8vIEFyZ3VtZW50czpcbi8vIC0gYnVmZmVyIC0gYSBCdWZmZXIgdG8gc2VhcmNoXG4vLyAtIHZhbCAtIGEgc3RyaW5nLCBCdWZmZXIsIG9yIG51bWJlclxuLy8gLSBieXRlT2Zmc2V0IC0gYW4gaW5kZXggaW50byBgYnVmZmVyYDsgd2lsbCBiZSBjbGFtcGVkIHRvIGFuIGludDMyXG4vLyAtIGVuY29kaW5nIC0gYW4gb3B0aW9uYWwgZW5jb2RpbmcsIHJlbGV2YW50IGlzIHZhbCBpcyBhIHN0cmluZ1xuLy8gLSBkaXIgLSB0cnVlIGZvciBpbmRleE9mLCBmYWxzZSBmb3IgbGFzdEluZGV4T2ZcbmZ1bmN0aW9uIGJpZGlyZWN0aW9uYWxJbmRleE9mKGJ1ZmZlciwgdmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZywgZGlyKSB7XG4gICAgLy8gRW1wdHkgYnVmZmVyIG1lYW5zIG5vIG1hdGNoXG4gICAgaWYgKGJ1ZmZlci5sZW5ndGggPT09IDApXG4gICAgICAgIHJldHVybiAtMTtcbiAgICAvLyBOb3JtYWxpemUgYnl0ZU9mZnNldFxuICAgIGlmICh0eXBlb2YgYnl0ZU9mZnNldCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgZW5jb2RpbmcgPSBieXRlT2Zmc2V0O1xuICAgICAgICBieXRlT2Zmc2V0ID0gMDtcbiAgICB9XG4gICAgZWxzZSBpZiAoYnl0ZU9mZnNldCA+IDB4N2ZmZmZmZmYpIHtcbiAgICAgICAgYnl0ZU9mZnNldCA9IDB4N2ZmZmZmZmY7XG4gICAgfVxuICAgIGVsc2UgaWYgKGJ5dGVPZmZzZXQgPCAtMHg4MDAwMDAwMCkge1xuICAgICAgICBieXRlT2Zmc2V0ID0gLTB4ODAwMDAwMDA7XG4gICAgfVxuICAgIGJ5dGVPZmZzZXQgPSArYnl0ZU9mZnNldDsgLy8gQ29lcmNlIHRvIE51bWJlci5cbiAgICBpZiAobnVtYmVySXNOYU4oYnl0ZU9mZnNldCkpIHtcbiAgICAgICAgLy8gYnl0ZU9mZnNldDogaXQgaXQncyB1bmRlZmluZWQsIG51bGwsIE5hTiwgXCJmb29cIiwgZXRjLCBzZWFyY2ggd2hvbGUgYnVmZmVyXG4gICAgICAgIGJ5dGVPZmZzZXQgPSBkaXIgPyAwIDogKGJ1ZmZlci5sZW5ndGggLSAxKTtcbiAgICB9XG4gICAgLy8gTm9ybWFsaXplIGJ5dGVPZmZzZXQ6IG5lZ2F0aXZlIG9mZnNldHMgc3RhcnQgZnJvbSB0aGUgZW5kIG9mIHRoZSBidWZmZXJcbiAgICBpZiAoYnl0ZU9mZnNldCA8IDApXG4gICAgICAgIGJ5dGVPZmZzZXQgPSBidWZmZXIubGVuZ3RoICsgYnl0ZU9mZnNldDtcbiAgICBpZiAoYnl0ZU9mZnNldCA+PSBidWZmZXIubGVuZ3RoKSB7XG4gICAgICAgIGlmIChkaXIpXG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIGJ5dGVPZmZzZXQgPSBidWZmZXIubGVuZ3RoIC0gMTtcbiAgICB9XG4gICAgZWxzZSBpZiAoYnl0ZU9mZnNldCA8IDApIHtcbiAgICAgICAgaWYgKGRpcilcbiAgICAgICAgICAgIGJ5dGVPZmZzZXQgPSAwO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIC8vIE5vcm1hbGl6ZSB2YWxcbiAgICBpZiAodHlwZW9mIHZhbCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgdmFsID0gQnVmZmVyLmZyb20odmFsLCBlbmNvZGluZyk7XG4gICAgfVxuICAgIC8vIEZpbmFsbHksIHNlYXJjaCBlaXRoZXIgaW5kZXhPZiAoaWYgZGlyIGlzIHRydWUpIG9yIGxhc3RJbmRleE9mXG4gICAgaWYgKEJ1ZmZlci5pc0J1ZmZlcih2YWwpKSB7XG4gICAgICAgIC8vIFNwZWNpYWwgY2FzZTogbG9va2luZyBmb3IgZW1wdHkgc3RyaW5nL2J1ZmZlciBhbHdheXMgZmFpbHNcbiAgICAgICAgaWYgKHZhbC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXJyYXlJbmRleE9mKGJ1ZmZlciwgdmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZywgZGlyKTtcbiAgICB9XG4gICAgZWxzZSBpZiAodHlwZW9mIHZhbCA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgdmFsID0gdmFsICYgMHhGRjsgLy8gU2VhcmNoIGZvciBhIGJ5dGUgdmFsdWUgWzAtMjU1XVxuICAgICAgICBpZiAodHlwZW9mIFVpbnQ4QXJyYXkucHJvdG90eXBlLmluZGV4T2YgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGlmIChkaXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gVWludDhBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKGJ1ZmZlciwgdmFsLCBieXRlT2Zmc2V0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBVaW50OEFycmF5LnByb3RvdHlwZS5sYXN0SW5kZXhPZi5jYWxsKGJ1ZmZlciwgdmFsLCBieXRlT2Zmc2V0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXJyYXlJbmRleE9mKGJ1ZmZlciwgW3ZhbF0sIGJ5dGVPZmZzZXQsIGVuY29kaW5nLCBkaXIpO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCd2YWwgbXVzdCBiZSBzdHJpbmcsIG51bWJlciBvciBCdWZmZXInKTtcbn1cbmZ1bmN0aW9uIGFycmF5SW5kZXhPZihhcnIsIHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIGRpcikge1xuICAgIHZhciBpbmRleFNpemUgPSAxO1xuICAgIHZhciBhcnJMZW5ndGggPSBhcnIubGVuZ3RoO1xuICAgIHZhciB2YWxMZW5ndGggPSB2YWwubGVuZ3RoO1xuICAgIGlmIChlbmNvZGluZyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGVuY29kaW5nID0gU3RyaW5nKGVuY29kaW5nKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBpZiAoZW5jb2RpbmcgPT09ICd1Y3MyJyB8fCBlbmNvZGluZyA9PT0gJ3Vjcy0yJyB8fFxuICAgICAgICAgICAgZW5jb2RpbmcgPT09ICd1dGYxNmxlJyB8fCBlbmNvZGluZyA9PT0gJ3V0Zi0xNmxlJykge1xuICAgICAgICAgICAgaWYgKGFyci5sZW5ndGggPCAyIHx8IHZhbC5sZW5ndGggPCAyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaW5kZXhTaXplID0gMjtcbiAgICAgICAgICAgIGFyckxlbmd0aCAvPSAyO1xuICAgICAgICAgICAgdmFsTGVuZ3RoIC89IDI7XG4gICAgICAgICAgICBieXRlT2Zmc2V0IC89IDI7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gcmVhZChidWYsIGkpIHtcbiAgICAgICAgaWYgKGluZGV4U2l6ZSA9PT0gMSkge1xuICAgICAgICAgICAgcmV0dXJuIGJ1ZltpXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBidWYucmVhZFVJbnQxNkJFKGkgKiBpbmRleFNpemUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHZhciBpO1xuICAgIGlmIChkaXIpIHtcbiAgICAgICAgdmFyIGZvdW5kSW5kZXggPSAtMTtcbiAgICAgICAgZm9yIChpID0gYnl0ZU9mZnNldDsgaSA8IGFyckxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAocmVhZChhcnIsIGkpID09PSByZWFkKHZhbCwgZm91bmRJbmRleCA9PT0gLTEgPyAwIDogaSAtIGZvdW5kSW5kZXgpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGZvdW5kSW5kZXggPT09IC0xKVxuICAgICAgICAgICAgICAgICAgICBmb3VuZEluZGV4ID0gaTtcbiAgICAgICAgICAgICAgICBpZiAoaSAtIGZvdW5kSW5kZXggKyAxID09PSB2YWxMZW5ndGgpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmb3VuZEluZGV4ICogaW5kZXhTaXplO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGZvdW5kSW5kZXggIT09IC0xKVxuICAgICAgICAgICAgICAgICAgICBpIC09IGkgLSBmb3VuZEluZGV4O1xuICAgICAgICAgICAgICAgIGZvdW5kSW5kZXggPSAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgaWYgKGJ5dGVPZmZzZXQgKyB2YWxMZW5ndGggPiBhcnJMZW5ndGgpXG4gICAgICAgICAgICBieXRlT2Zmc2V0ID0gYXJyTGVuZ3RoIC0gdmFsTGVuZ3RoO1xuICAgICAgICBmb3IgKGkgPSBieXRlT2Zmc2V0OyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgdmFyIGZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdmFsTGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICBpZiAocmVhZChhcnIsIGkgKyBqKSAhPT0gcmVhZCh2YWwsIGopKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvdW5kID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChmb3VuZClcbiAgICAgICAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gLTE7XG59XG5CdWZmZXIucHJvdG90eXBlLmluY2x1ZGVzID0gZnVuY3Rpb24gaW5jbHVkZXModmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZykge1xuICAgIHJldHVybiB0aGlzLmluZGV4T2YodmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZykgIT09IC0xO1xufTtcbkJ1ZmZlci5wcm90b3R5cGUuaW5kZXhPZiA9IGZ1bmN0aW9uIGluZGV4T2YodmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZykge1xuICAgIHJldHVybiBiaWRpcmVjdGlvbmFsSW5kZXhPZih0aGlzLCB2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nLCB0cnVlKTtcbn07XG5CdWZmZXIucHJvdG90eXBlLmxhc3RJbmRleE9mID0gZnVuY3Rpb24gbGFzdEluZGV4T2YodmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZykge1xuICAgIHJldHVybiBiaWRpcmVjdGlvbmFsSW5kZXhPZih0aGlzLCB2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nLCBmYWxzZSk7XG59O1xuZnVuY3Rpb24gaGV4V3JpdGUoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7XG4gICAgb2Zmc2V0ID0gTnVtYmVyKG9mZnNldCkgfHwgMDtcbiAgICB2YXIgcmVtYWluaW5nID0gYnVmLmxlbmd0aCAtIG9mZnNldDtcbiAgICBpZiAoIWxlbmd0aCkge1xuICAgICAgICBsZW5ndGggPSByZW1haW5pbmc7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBsZW5ndGggPSBOdW1iZXIobGVuZ3RoKTtcbiAgICAgICAgaWYgKGxlbmd0aCA+IHJlbWFpbmluZykge1xuICAgICAgICAgICAgbGVuZ3RoID0gcmVtYWluaW5nO1xuICAgICAgICB9XG4gICAgfVxuICAgIHZhciBzdHJMZW4gPSBzdHJpbmcubGVuZ3RoO1xuICAgIGlmIChsZW5ndGggPiBzdHJMZW4gLyAyKSB7XG4gICAgICAgIGxlbmd0aCA9IHN0ckxlbiAvIDI7XG4gICAgfVxuICAgIHZhciBpO1xuICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgICAgICB2YXIgcGFyc2VkID0gcGFyc2VJbnQoc3RyaW5nLnN1YnN0cihpICogMiwgMiksIDE2KTtcbiAgICAgICAgaWYgKG51bWJlcklzTmFOKHBhcnNlZCkpXG4gICAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgYnVmW29mZnNldCArIGldID0gcGFyc2VkO1xuICAgIH1cbiAgICByZXR1cm4gaTtcbn1cbmZ1bmN0aW9uIHV0ZjhXcml0ZShidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHtcbiAgICByZXR1cm4gYmxpdEJ1ZmZlcih1dGY4VG9CeXRlcyhzdHJpbmcsIGJ1Zi5sZW5ndGggLSBvZmZzZXQpLCBidWYsIG9mZnNldCwgbGVuZ3RoKTtcbn1cbmZ1bmN0aW9uIGFzY2lpV3JpdGUoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7XG4gICAgcmV0dXJuIGJsaXRCdWZmZXIoYXNjaWlUb0J5dGVzKHN0cmluZyksIGJ1Ziwgb2Zmc2V0LCBsZW5ndGgpO1xufVxuZnVuY3Rpb24gYmFzZTY0V3JpdGUoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7XG4gICAgcmV0dXJuIGJsaXRCdWZmZXIoYmFzZTY0VG9CeXRlcyhzdHJpbmcpLCBidWYsIG9mZnNldCwgbGVuZ3RoKTtcbn1cbmZ1bmN0aW9uIHVjczJXcml0ZShidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHtcbiAgICByZXR1cm4gYmxpdEJ1ZmZlcih1dGYxNmxlVG9CeXRlcyhzdHJpbmcsIGJ1Zi5sZW5ndGggLSBvZmZzZXQpLCBidWYsIG9mZnNldCwgbGVuZ3RoKTtcbn1cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGUgPSBmdW5jdGlvbiB3cml0ZShzdHJpbmcsIG9mZnNldCwgbGVuZ3RoLCBlbmNvZGluZykge1xuICAgIC8vIEJ1ZmZlciN3cml0ZShzdHJpbmcpXG4gICAgaWYgKG9mZnNldCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGVuY29kaW5nID0gJ3V0ZjgnO1xuICAgICAgICBsZW5ndGggPSB0aGlzLmxlbmd0aDtcbiAgICAgICAgb2Zmc2V0ID0gMDtcbiAgICAgICAgLy8gQnVmZmVyI3dyaXRlKHN0cmluZywgZW5jb2RpbmcpXG4gICAgfVxuICAgIGVsc2UgaWYgKGxlbmd0aCA9PT0gdW5kZWZpbmVkICYmIHR5cGVvZiBvZmZzZXQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIGVuY29kaW5nID0gb2Zmc2V0O1xuICAgICAgICBsZW5ndGggPSB0aGlzLmxlbmd0aDtcbiAgICAgICAgb2Zmc2V0ID0gMDtcbiAgICAgICAgLy8gQnVmZmVyI3dyaXRlKHN0cmluZywgb2Zmc2V0WywgbGVuZ3RoXVssIGVuY29kaW5nXSlcbiAgICB9XG4gICAgZWxzZSBpZiAoaXNGaW5pdGUob2Zmc2V0KSkge1xuICAgICAgICBvZmZzZXQgPSBvZmZzZXQgPj4+IDA7XG4gICAgICAgIGlmIChpc0Zpbml0ZShsZW5ndGgpKSB7XG4gICAgICAgICAgICBsZW5ndGggPSBsZW5ndGggPj4+IDA7XG4gICAgICAgICAgICBpZiAoZW5jb2RpbmcgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgICAgICBlbmNvZGluZyA9ICd1dGY4JztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGVuY29kaW5nID0gbGVuZ3RoO1xuICAgICAgICAgICAgbGVuZ3RoID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0J1ZmZlci53cml0ZShzdHJpbmcsIGVuY29kaW5nLCBvZmZzZXRbLCBsZW5ndGhdKSBpcyBubyBsb25nZXIgc3VwcG9ydGVkJyk7XG4gICAgfVxuICAgIHZhciByZW1haW5pbmcgPSB0aGlzLmxlbmd0aCAtIG9mZnNldDtcbiAgICBpZiAobGVuZ3RoID09PSB1bmRlZmluZWQgfHwgbGVuZ3RoID4gcmVtYWluaW5nKVxuICAgICAgICBsZW5ndGggPSByZW1haW5pbmc7XG4gICAgaWYgKChzdHJpbmcubGVuZ3RoID4gMCAmJiAobGVuZ3RoIDwgMCB8fCBvZmZzZXQgPCAwKSkgfHwgb2Zmc2V0ID4gdGhpcy5sZW5ndGgpIHtcbiAgICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0F0dGVtcHQgdG8gd3JpdGUgb3V0c2lkZSBidWZmZXIgYm91bmRzJyk7XG4gICAgfVxuICAgIGlmICghZW5jb2RpbmcpXG4gICAgICAgIGVuY29kaW5nID0gJ3V0ZjgnO1xuICAgIHZhciBsb3dlcmVkQ2FzZSA9IGZhbHNlO1xuICAgIGZvciAoOzspIHtcbiAgICAgICAgc3dpdGNoIChlbmNvZGluZykge1xuICAgICAgICAgICAgY2FzZSAnaGV4JzpcbiAgICAgICAgICAgICAgICByZXR1cm4gaGV4V3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCk7XG4gICAgICAgICAgICBjYXNlICd1dGY4JzpcbiAgICAgICAgICAgIGNhc2UgJ3V0Zi04JzpcbiAgICAgICAgICAgICAgICByZXR1cm4gdXRmOFdyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpO1xuICAgICAgICAgICAgY2FzZSAnYXNjaWknOlxuICAgICAgICAgICAgY2FzZSAnbGF0aW4xJzpcbiAgICAgICAgICAgIGNhc2UgJ2JpbmFyeSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFzY2lpV3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCk7XG4gICAgICAgICAgICBjYXNlICdiYXNlNjQnOlxuICAgICAgICAgICAgICAgIC8vIFdhcm5pbmc6IG1heExlbmd0aCBub3QgdGFrZW4gaW50byBhY2NvdW50IGluIGJhc2U2NFdyaXRlXG4gICAgICAgICAgICAgICAgcmV0dXJuIGJhc2U2NFdyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpO1xuICAgICAgICAgICAgY2FzZSAndWNzMic6XG4gICAgICAgICAgICBjYXNlICd1Y3MtMic6XG4gICAgICAgICAgICBjYXNlICd1dGYxNmxlJzpcbiAgICAgICAgICAgIGNhc2UgJ3V0Zi0xNmxlJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gdWNzMldyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBpZiAobG93ZXJlZENhc2UpXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1Vua25vd24gZW5jb2Rpbmc6ICcgKyBlbmNvZGluZyk7XG4gICAgICAgICAgICAgICAgZW5jb2RpbmcgPSAoJycgKyBlbmNvZGluZykudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgICBsb3dlcmVkQ2FzZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG59O1xuQnVmZmVyLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiB0b0pTT04oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZTogJ0J1ZmZlcicsXG4gICAgICAgIGRhdGE6IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKHRoaXMuX2FyciB8fCB0aGlzLCAwKVxuICAgIH07XG59O1xuZnVuY3Rpb24gYmFzZTY0U2xpY2UoYnVmLCBzdGFydCwgZW5kKSB7XG4gICAgaWYgKHN0YXJ0ID09PSAwICYmIGVuZCA9PT0gYnVmLmxlbmd0aCkge1xuICAgICAgICByZXR1cm4gYmFzZTY0LmZyb21CeXRlQXJyYXkoYnVmKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBiYXNlNjQuZnJvbUJ5dGVBcnJheShidWYuc2xpY2Uoc3RhcnQsIGVuZCkpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHV0ZjhTbGljZShidWYsIHN0YXJ0LCBlbmQpIHtcbiAgICBlbmQgPSBNYXRoLm1pbihidWYubGVuZ3RoLCBlbmQpO1xuICAgIHZhciByZXMgPSBbXTtcbiAgICB2YXIgaSA9IHN0YXJ0O1xuICAgIHdoaWxlIChpIDwgZW5kKSB7XG4gICAgICAgIHZhciBmaXJzdEJ5dGUgPSBidWZbaV07XG4gICAgICAgIHZhciBjb2RlUG9pbnQgPSBudWxsO1xuICAgICAgICB2YXIgYnl0ZXNQZXJTZXF1ZW5jZSA9IChmaXJzdEJ5dGUgPiAweEVGKVxuICAgICAgICAgICAgPyA0XG4gICAgICAgICAgICA6IChmaXJzdEJ5dGUgPiAweERGKVxuICAgICAgICAgICAgICAgID8gM1xuICAgICAgICAgICAgICAgIDogKGZpcnN0Qnl0ZSA+IDB4QkYpXG4gICAgICAgICAgICAgICAgICAgID8gMlxuICAgICAgICAgICAgICAgICAgICA6IDE7XG4gICAgICAgIGlmIChpICsgYnl0ZXNQZXJTZXF1ZW5jZSA8PSBlbmQpIHtcbiAgICAgICAgICAgIHZhciBzZWNvbmRCeXRlID0gdm9pZCAwLCB0aGlyZEJ5dGUgPSB2b2lkIDAsIGZvdXJ0aEJ5dGUgPSB2b2lkIDAsIHRlbXBDb2RlUG9pbnQgPSB2b2lkIDA7XG4gICAgICAgICAgICBzd2l0Y2ggKGJ5dGVzUGVyU2VxdWVuY2UpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgIGlmIChmaXJzdEJ5dGUgPCAweDgwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2RlUG9pbnQgPSBmaXJzdEJ5dGU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICBzZWNvbmRCeXRlID0gYnVmW2kgKyAxXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKChzZWNvbmRCeXRlICYgMHhDMCkgPT09IDB4ODApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBDb2RlUG9pbnQgPSAoZmlyc3RCeXRlICYgMHgxRikgPDwgMHg2IHwgKHNlY29uZEJ5dGUgJiAweDNGKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ZW1wQ29kZVBvaW50ID4gMHg3Rikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvZGVQb2ludCA9IHRlbXBDb2RlUG9pbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICBzZWNvbmRCeXRlID0gYnVmW2kgKyAxXTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcmRCeXRlID0gYnVmW2kgKyAyXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKChzZWNvbmRCeXRlICYgMHhDMCkgPT09IDB4ODAgJiYgKHRoaXJkQnl0ZSAmIDB4QzApID09PSAweDgwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wQ29kZVBvaW50ID0gKGZpcnN0Qnl0ZSAmIDB4RikgPDwgMHhDIHwgKHNlY29uZEJ5dGUgJiAweDNGKSA8PCAweDYgfCAodGhpcmRCeXRlICYgMHgzRik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGVtcENvZGVQb2ludCA+IDB4N0ZGICYmICh0ZW1wQ29kZVBvaW50IDwgMHhEODAwIHx8IHRlbXBDb2RlUG9pbnQgPiAweERGRkYpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29kZVBvaW50ID0gdGVtcENvZGVQb2ludDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgIHNlY29uZEJ5dGUgPSBidWZbaSArIDFdO1xuICAgICAgICAgICAgICAgICAgICB0aGlyZEJ5dGUgPSBidWZbaSArIDJdO1xuICAgICAgICAgICAgICAgICAgICBmb3VydGhCeXRlID0gYnVmW2kgKyAzXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKChzZWNvbmRCeXRlICYgMHhDMCkgPT09IDB4ODAgJiYgKHRoaXJkQnl0ZSAmIDB4QzApID09PSAweDgwICYmIChmb3VydGhCeXRlICYgMHhDMCkgPT09IDB4ODApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBDb2RlUG9pbnQgPSAoZmlyc3RCeXRlICYgMHhGKSA8PCAweDEyIHwgKHNlY29uZEJ5dGUgJiAweDNGKSA8PCAweEMgfCAodGhpcmRCeXRlICYgMHgzRikgPDwgMHg2IHwgKGZvdXJ0aEJ5dGUgJiAweDNGKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ZW1wQ29kZVBvaW50ID4gMHhGRkZGICYmIHRlbXBDb2RlUG9pbnQgPCAweDExMDAwMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvZGVQb2ludCA9IHRlbXBDb2RlUG9pbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoY29kZVBvaW50ID09PSBudWxsKSB7XG4gICAgICAgICAgICAvLyB3ZSBkaWQgbm90IGdlbmVyYXRlIGEgdmFsaWQgY29kZVBvaW50IHNvIGluc2VydCBhXG4gICAgICAgICAgICAvLyByZXBsYWNlbWVudCBjaGFyIChVK0ZGRkQpIGFuZCBhZHZhbmNlIG9ubHkgMSBieXRlXG4gICAgICAgICAgICBjb2RlUG9pbnQgPSAweEZGRkQ7XG4gICAgICAgICAgICBieXRlc1BlclNlcXVlbmNlID0gMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjb2RlUG9pbnQgPiAweEZGRkYpIHtcbiAgICAgICAgICAgIC8vIGVuY29kZSB0byB1dGYxNiAoc3Vycm9nYXRlIHBhaXIgZGFuY2UpXG4gICAgICAgICAgICBjb2RlUG9pbnQgLT0gMHgxMDAwMDtcbiAgICAgICAgICAgIHJlcy5wdXNoKGNvZGVQb2ludCA+Pj4gMTAgJiAweDNGRiB8IDB4RDgwMCk7XG4gICAgICAgICAgICBjb2RlUG9pbnQgPSAweERDMDAgfCBjb2RlUG9pbnQgJiAweDNGRjtcbiAgICAgICAgfVxuICAgICAgICByZXMucHVzaChjb2RlUG9pbnQpO1xuICAgICAgICBpICs9IGJ5dGVzUGVyU2VxdWVuY2U7XG4gICAgfVxuICAgIHJldHVybiBkZWNvZGVDb2RlUG9pbnRzQXJyYXkocmVzKTtcbn1cbi8vIEJhc2VkIG9uIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzIyNzQ3MjcyLzY4MDc0MiwgdGhlIGJyb3dzZXIgd2l0aFxuLy8gdGhlIGxvd2VzdCBsaW1pdCBpcyBDaHJvbWUsIHdpdGggMHgxMDAwMCBhcmdzLlxuLy8gV2UgZ28gMSBtYWduaXR1ZGUgbGVzcywgZm9yIHNhZmV0eVxudmFyIE1BWF9BUkdVTUVOVFNfTEVOR1RIID0gMHgxMDAwO1xuZnVuY3Rpb24gZGVjb2RlQ29kZVBvaW50c0FycmF5KGNvZGVQb2ludHMpIHtcbiAgICB2YXIgbGVuID0gY29kZVBvaW50cy5sZW5ndGg7XG4gICAgaWYgKGxlbiA8PSBNQVhfQVJHVU1FTlRTX0xFTkdUSCkge1xuICAgICAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShTdHJpbmcsIGNvZGVQb2ludHMpOyAvLyBhdm9pZCBleHRyYSBzbGljZSgpXG4gICAgfVxuICAgIC8vIERlY29kZSBpbiBjaHVua3MgdG8gYXZvaWQgXCJjYWxsIHN0YWNrIHNpemUgZXhjZWVkZWRcIi5cbiAgICB2YXIgcmVzID0gJyc7XG4gICAgdmFyIGkgPSAwO1xuICAgIHdoaWxlIChpIDwgbGVuKSB7XG4gICAgICAgIHJlcyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KFN0cmluZywgY29kZVBvaW50cy5zbGljZShpLCBpICs9IE1BWF9BUkdVTUVOVFNfTEVOR1RIKSk7XG4gICAgfVxuICAgIHJldHVybiByZXM7XG59XG5mdW5jdGlvbiBhc2NpaVNsaWNlKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICAgIHZhciByZXQgPSAnJztcbiAgICBlbmQgPSBNYXRoLm1pbihidWYubGVuZ3RoLCBlbmQpO1xuICAgIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IGVuZDsgKytpKSB7XG4gICAgICAgIHJldCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGJ1ZltpXSAmIDB4N0YpO1xuICAgIH1cbiAgICByZXR1cm4gcmV0O1xufVxuZnVuY3Rpb24gbGF0aW4xU2xpY2UoYnVmLCBzdGFydCwgZW5kKSB7XG4gICAgdmFyIHJldCA9ICcnO1xuICAgIGVuZCA9IE1hdGgubWluKGJ1Zi5sZW5ndGgsIGVuZCk7XG4gICAgZm9yICh2YXIgaSA9IHN0YXJ0OyBpIDwgZW5kOyArK2kpIHtcbiAgICAgICAgcmV0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYnVmW2ldKTtcbiAgICB9XG4gICAgcmV0dXJuIHJldDtcbn1cbmZ1bmN0aW9uIGhleFNsaWNlKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICAgIHZhciBsZW4gPSBidWYubGVuZ3RoO1xuICAgIGlmICghc3RhcnQgfHwgc3RhcnQgPCAwKVxuICAgICAgICBzdGFydCA9IDA7XG4gICAgaWYgKCFlbmQgfHwgZW5kIDwgMCB8fCBlbmQgPiBsZW4pXG4gICAgICAgIGVuZCA9IGxlbjtcbiAgICB2YXIgb3V0ID0gJyc7XG4gICAgZm9yICh2YXIgaSA9IHN0YXJ0OyBpIDwgZW5kOyArK2kpIHtcbiAgICAgICAgb3V0ICs9IGhleFNsaWNlTG9va3VwVGFibGVbYnVmW2ldXTtcbiAgICB9XG4gICAgcmV0dXJuIG91dDtcbn1cbmZ1bmN0aW9uIHV0ZjE2bGVTbGljZShidWYsIHN0YXJ0LCBlbmQpIHtcbiAgICB2YXIgYnl0ZXMgPSBidWYuc2xpY2Uoc3RhcnQsIGVuZCk7XG4gICAgdmFyIHJlcyA9ICcnO1xuICAgIC8vIElmIGJ5dGVzLmxlbmd0aCBpcyBvZGQsIHRoZSBsYXN0IDggYml0cyBtdXN0IGJlIGlnbm9yZWQgKHNhbWUgYXMgbm9kZS5qcylcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJ5dGVzLmxlbmd0aCAtIDE7IGkgKz0gMikge1xuICAgICAgICByZXMgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShieXRlc1tpXSArIChieXRlc1tpICsgMV0gKiAyNTYpKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlcztcbn1cbkJ1ZmZlci5wcm90b3R5cGUuc2xpY2UgPSBmdW5jdGlvbiBzbGljZShzdGFydCwgZW5kKSB7XG4gICAgdmFyIGxlbiA9IHRoaXMubGVuZ3RoO1xuICAgIHN0YXJ0ID0gfn5zdGFydDtcbiAgICBlbmQgPSBlbmQgPT09IHVuZGVmaW5lZCA/IGxlbiA6IH5+ZW5kO1xuICAgIGlmIChzdGFydCA8IDApIHtcbiAgICAgICAgc3RhcnQgKz0gbGVuO1xuICAgICAgICBpZiAoc3RhcnQgPCAwKVxuICAgICAgICAgICAgc3RhcnQgPSAwO1xuICAgIH1cbiAgICBlbHNlIGlmIChzdGFydCA+IGxlbikge1xuICAgICAgICBzdGFydCA9IGxlbjtcbiAgICB9XG4gICAgaWYgKGVuZCA8IDApIHtcbiAgICAgICAgZW5kICs9IGxlbjtcbiAgICAgICAgaWYgKGVuZCA8IDApXG4gICAgICAgICAgICBlbmQgPSAwO1xuICAgIH1cbiAgICBlbHNlIGlmIChlbmQgPiBsZW4pIHtcbiAgICAgICAgZW5kID0gbGVuO1xuICAgIH1cbiAgICBpZiAoZW5kIDwgc3RhcnQpXG4gICAgICAgIGVuZCA9IHN0YXJ0O1xuICAgIHZhciBuZXdCdWYgPSB0aGlzLnN1YmFycmF5KHN0YXJ0LCBlbmQpO1xuICAgIC8vIFJldHVybiBhbiBhdWdtZW50ZWQgYFVpbnQ4QXJyYXlgIGluc3RhbmNlXG4gICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKG5ld0J1ZiwgQnVmZmVyLnByb3RvdHlwZSk7XG4gICAgcmV0dXJuIG5ld0J1Zjtcbn07XG4vKlxuICogTmVlZCB0byBtYWtlIHN1cmUgdGhhdCBidWZmZXIgaXNuJ3QgdHJ5aW5nIHRvIHdyaXRlIG91dCBvZiBib3VuZHMuXG4gKi9cbmZ1bmN0aW9uIGNoZWNrT2Zmc2V0KG9mZnNldCwgZXh0LCBsZW5ndGgpIHtcbiAgICBpZiAoKG9mZnNldCAlIDEpICE9PSAwIHx8IG9mZnNldCA8IDApXG4gICAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdvZmZzZXQgaXMgbm90IHVpbnQnKTtcbiAgICBpZiAob2Zmc2V0ICsgZXh0ID4gbGVuZ3RoKVxuICAgICAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignVHJ5aW5nIHRvIGFjY2VzcyBiZXlvbmQgYnVmZmVyIGxlbmd0aCcpO1xufVxuQnVmZmVyLnByb3RvdHlwZS5yZWFkVWludExFID1cbiAgICBCdWZmZXIucHJvdG90eXBlLnJlYWRVSW50TEUgPSBmdW5jdGlvbiByZWFkVUludExFKG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgICAgICAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwO1xuICAgICAgICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCA+Pj4gMDtcbiAgICAgICAgaWYgKCFub0Fzc2VydClcbiAgICAgICAgICAgIGNoZWNrT2Zmc2V0KG9mZnNldCwgYnl0ZUxlbmd0aCwgdGhpcy5sZW5ndGgpO1xuICAgICAgICB2YXIgdmFsID0gdGhpc1tvZmZzZXRdO1xuICAgICAgICB2YXIgbXVsID0gMTtcbiAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgICAgICAgICAgdmFsICs9IHRoaXNbb2Zmc2V0ICsgaV0gKiBtdWw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbDtcbiAgICB9O1xuQnVmZmVyLnByb3RvdHlwZS5yZWFkVWludEJFID1cbiAgICBCdWZmZXIucHJvdG90eXBlLnJlYWRVSW50QkUgPSBmdW5jdGlvbiByZWFkVUludEJFKG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgICAgICAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwO1xuICAgICAgICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCA+Pj4gMDtcbiAgICAgICAgaWYgKCFub0Fzc2VydCkge1xuICAgICAgICAgICAgY2hlY2tPZmZzZXQob2Zmc2V0LCBieXRlTGVuZ3RoLCB0aGlzLmxlbmd0aCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0ICsgLS1ieXRlTGVuZ3RoXTtcbiAgICAgICAgdmFyIG11bCA9IDE7XG4gICAgICAgIHdoaWxlIChieXRlTGVuZ3RoID4gMCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgICAgICAgICAgdmFsICs9IHRoaXNbb2Zmc2V0ICsgLS1ieXRlTGVuZ3RoXSAqIG11bDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsO1xuICAgIH07XG5CdWZmZXIucHJvdG90eXBlLnJlYWRVaW50OCA9XG4gICAgQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludDggPSBmdW5jdGlvbiByZWFkVUludDgob2Zmc2V0LCBub0Fzc2VydCkge1xuICAgICAgICBvZmZzZXQgPSBvZmZzZXQgPj4+IDA7XG4gICAgICAgIGlmICghbm9Bc3NlcnQpXG4gICAgICAgICAgICBjaGVja09mZnNldChvZmZzZXQsIDEsIHRoaXMubGVuZ3RoKTtcbiAgICAgICAgcmV0dXJuIHRoaXNbb2Zmc2V0XTtcbiAgICB9O1xuQnVmZmVyLnByb3RvdHlwZS5yZWFkVWludDE2TEUgPVxuICAgIEJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQxNkxFID0gZnVuY3Rpb24gcmVhZFVJbnQxNkxFKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgICAgICAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwO1xuICAgICAgICBpZiAoIW5vQXNzZXJ0KVxuICAgICAgICAgICAgY2hlY2tPZmZzZXQob2Zmc2V0LCAyLCB0aGlzLmxlbmd0aCk7XG4gICAgICAgIHJldHVybiB0aGlzW29mZnNldF0gfCAodGhpc1tvZmZzZXQgKyAxXSA8PCA4KTtcbiAgICB9O1xuQnVmZmVyLnByb3RvdHlwZS5yZWFkVWludDE2QkUgPVxuICAgIEJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQxNkJFID0gZnVuY3Rpb24gcmVhZFVJbnQxNkJFKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgICAgICAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwO1xuICAgICAgICBpZiAoIW5vQXNzZXJ0KVxuICAgICAgICAgICAgY2hlY2tPZmZzZXQob2Zmc2V0LCAyLCB0aGlzLmxlbmd0aCk7XG4gICAgICAgIHJldHVybiAodGhpc1tvZmZzZXRdIDw8IDgpIHwgdGhpc1tvZmZzZXQgKyAxXTtcbiAgICB9O1xuQnVmZmVyLnByb3RvdHlwZS5yZWFkVWludDMyTEUgPVxuICAgIEJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQzMkxFID0gZnVuY3Rpb24gcmVhZFVJbnQzMkxFKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgICAgICAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwO1xuICAgICAgICBpZiAoIW5vQXNzZXJ0KVxuICAgICAgICAgICAgY2hlY2tPZmZzZXQob2Zmc2V0LCA0LCB0aGlzLmxlbmd0aCk7XG4gICAgICAgIHJldHVybiAoKHRoaXNbb2Zmc2V0XSkgfFxuICAgICAgICAgICAgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgOCkgfFxuICAgICAgICAgICAgKHRoaXNbb2Zmc2V0ICsgMl0gPDwgMTYpKSArXG4gICAgICAgICAgICAodGhpc1tvZmZzZXQgKyAzXSAqIDB4MTAwMDAwMCk7XG4gICAgfTtcbkJ1ZmZlci5wcm90b3R5cGUucmVhZFVpbnQzMkJFID1cbiAgICBCdWZmZXIucHJvdG90eXBlLnJlYWRVSW50MzJCRSA9IGZ1bmN0aW9uIHJlYWRVSW50MzJCRShvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gICAgICAgIG9mZnNldCA9IG9mZnNldCA+Pj4gMDtcbiAgICAgICAgaWYgKCFub0Fzc2VydClcbiAgICAgICAgICAgIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpO1xuICAgICAgICByZXR1cm4gKHRoaXNbb2Zmc2V0XSAqIDB4MTAwMDAwMCkgK1xuICAgICAgICAgICAgKCh0aGlzW29mZnNldCArIDFdIDw8IDE2KSB8XG4gICAgICAgICAgICAgICAgKHRoaXNbb2Zmc2V0ICsgMl0gPDwgOCkgfFxuICAgICAgICAgICAgICAgIHRoaXNbb2Zmc2V0ICsgM10pO1xuICAgIH07XG5CdWZmZXIucHJvdG90eXBlLnJlYWRCaWdVSW50NjRMRSA9IGRlZmluZUJpZ0ludE1ldGhvZChmdW5jdGlvbiByZWFkQmlnVUludDY0TEUob2Zmc2V0KSB7XG4gICAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwO1xuICAgIHZhbGlkYXRlTnVtYmVyKG9mZnNldCwgJ29mZnNldCcpO1xuICAgIHZhciBmaXJzdCA9IHRoaXNbb2Zmc2V0XTtcbiAgICB2YXIgbGFzdCA9IHRoaXNbb2Zmc2V0ICsgN107XG4gICAgaWYgKGZpcnN0ID09PSB1bmRlZmluZWQgfHwgbGFzdCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGJvdW5kc0Vycm9yKG9mZnNldCwgdGhpcy5sZW5ndGggLSA4KTtcbiAgICB9XG4gICAgdmFyIGxvID0gZmlyc3QgK1xuICAgICAgICB0aGlzWysrb2Zmc2V0XSAqIE1hdGgucG93KDIsIDgpICtcbiAgICAgICAgdGhpc1srK29mZnNldF0gKiBNYXRoLnBvdygyLCAxNikgK1xuICAgICAgICB0aGlzWysrb2Zmc2V0XSAqIE1hdGgucG93KDIsIDI0KTtcbiAgICB2YXIgaGkgPSB0aGlzWysrb2Zmc2V0XSArXG4gICAgICAgIHRoaXNbKytvZmZzZXRdICogTWF0aC5wb3coMiwgOCkgK1xuICAgICAgICB0aGlzWysrb2Zmc2V0XSAqIE1hdGgucG93KDIsIDE2KSArXG4gICAgICAgIGxhc3QgKiBNYXRoLnBvdygyLCAyNCk7XG4gICAgcmV0dXJuIEJpZ0ludChsbykgKyAoQmlnSW50KGhpKSA8PCBCaWdJbnQoMzIpKTtcbn0pO1xuQnVmZmVyLnByb3RvdHlwZS5yZWFkQmlnVUludDY0QkUgPSBkZWZpbmVCaWdJbnRNZXRob2QoZnVuY3Rpb24gcmVhZEJpZ1VJbnQ2NEJFKG9mZnNldCkge1xuICAgIG9mZnNldCA9IG9mZnNldCA+Pj4gMDtcbiAgICB2YWxpZGF0ZU51bWJlcihvZmZzZXQsICdvZmZzZXQnKTtcbiAgICB2YXIgZmlyc3QgPSB0aGlzW29mZnNldF07XG4gICAgdmFyIGxhc3QgPSB0aGlzW29mZnNldCArIDddO1xuICAgIGlmIChmaXJzdCA9PT0gdW5kZWZpbmVkIHx8IGxhc3QgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBib3VuZHNFcnJvcihvZmZzZXQsIHRoaXMubGVuZ3RoIC0gOCk7XG4gICAgfVxuICAgIHZhciBoaSA9IGZpcnN0ICogTWF0aC5wb3coMiwgMjQpICtcbiAgICAgICAgdGhpc1srK29mZnNldF0gKiBNYXRoLnBvdygyLCAxNikgK1xuICAgICAgICB0aGlzWysrb2Zmc2V0XSAqIE1hdGgucG93KDIsIDgpICtcbiAgICAgICAgdGhpc1srK29mZnNldF07XG4gICAgdmFyIGxvID0gdGhpc1srK29mZnNldF0gKiBNYXRoLnBvdygyLCAyNCkgK1xuICAgICAgICB0aGlzWysrb2Zmc2V0XSAqIE1hdGgucG93KDIsIDE2KSArXG4gICAgICAgIHRoaXNbKytvZmZzZXRdICogTWF0aC5wb3coMiwgOCkgK1xuICAgICAgICBsYXN0O1xuICAgIHJldHVybiAoQmlnSW50KGhpKSA8PCBCaWdJbnQoMzIpKSArIEJpZ0ludChsbyk7XG59KTtcbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludExFID0gZnVuY3Rpb24gcmVhZEludExFKG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgICBvZmZzZXQgPSBvZmZzZXQgPj4+IDA7XG4gICAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggPj4+IDA7XG4gICAgaWYgKCFub0Fzc2VydClcbiAgICAgICAgY2hlY2tPZmZzZXQob2Zmc2V0LCBieXRlTGVuZ3RoLCB0aGlzLmxlbmd0aCk7XG4gICAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0XTtcbiAgICB2YXIgbXVsID0gMTtcbiAgICB2YXIgaSA9IDA7XG4gICAgd2hpbGUgKCsraSA8IGJ5dGVMZW5ndGggJiYgKG11bCAqPSAweDEwMCkpIHtcbiAgICAgICAgdmFsICs9IHRoaXNbb2Zmc2V0ICsgaV0gKiBtdWw7XG4gICAgfVxuICAgIG11bCAqPSAweDgwO1xuICAgIGlmICh2YWwgPj0gbXVsKVxuICAgICAgICB2YWwgLT0gTWF0aC5wb3coMiwgOCAqIGJ5dGVMZW5ndGgpO1xuICAgIHJldHVybiB2YWw7XG59O1xuQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50QkUgPSBmdW5jdGlvbiByZWFkSW50QkUob2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkge1xuICAgIG9mZnNldCA9IG9mZnNldCA+Pj4gMDtcbiAgICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCA+Pj4gMDtcbiAgICBpZiAoIW5vQXNzZXJ0KVxuICAgICAgICBjaGVja09mZnNldChvZmZzZXQsIGJ5dGVMZW5ndGgsIHRoaXMubGVuZ3RoKTtcbiAgICB2YXIgaSA9IGJ5dGVMZW5ndGg7XG4gICAgdmFyIG11bCA9IDE7XG4gICAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0ICsgLS1pXTtcbiAgICB3aGlsZSAoaSA+IDAgJiYgKG11bCAqPSAweDEwMCkpIHtcbiAgICAgICAgdmFsICs9IHRoaXNbb2Zmc2V0ICsgLS1pXSAqIG11bDtcbiAgICB9XG4gICAgbXVsICo9IDB4ODA7XG4gICAgaWYgKHZhbCA+PSBtdWwpXG4gICAgICAgIHZhbCAtPSBNYXRoLnBvdygyLCA4ICogYnl0ZUxlbmd0aCk7XG4gICAgcmV0dXJuIHZhbDtcbn07XG5CdWZmZXIucHJvdG90eXBlLnJlYWRJbnQ4ID0gZnVuY3Rpb24gcmVhZEludDgob2Zmc2V0LCBub0Fzc2VydCkge1xuICAgIG9mZnNldCA9IG9mZnNldCA+Pj4gMDtcbiAgICBpZiAoIW5vQXNzZXJ0KVxuICAgICAgICBjaGVja09mZnNldChvZmZzZXQsIDEsIHRoaXMubGVuZ3RoKTtcbiAgICBpZiAoISh0aGlzW29mZnNldF0gJiAweDgwKSlcbiAgICAgICAgcmV0dXJuICh0aGlzW29mZnNldF0pO1xuICAgIHJldHVybiAoKDB4ZmYgLSB0aGlzW29mZnNldF0gKyAxKSAqIC0xKTtcbn07XG5CdWZmZXIucHJvdG90eXBlLnJlYWRJbnQxNkxFID0gZnVuY3Rpb24gcmVhZEludDE2TEUob2Zmc2V0LCBub0Fzc2VydCkge1xuICAgIG9mZnNldCA9IG9mZnNldCA+Pj4gMDtcbiAgICBpZiAoIW5vQXNzZXJ0KVxuICAgICAgICBjaGVja09mZnNldChvZmZzZXQsIDIsIHRoaXMubGVuZ3RoKTtcbiAgICB2YXIgdmFsID0gdGhpc1tvZmZzZXRdIHwgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgOCk7XG4gICAgcmV0dXJuICh2YWwgJiAweDgwMDApID8gdmFsIHwgMHhGRkZGMDAwMCA6IHZhbDtcbn07XG5CdWZmZXIucHJvdG90eXBlLnJlYWRJbnQxNkJFID0gZnVuY3Rpb24gcmVhZEludDE2QkUob2Zmc2V0LCBub0Fzc2VydCkge1xuICAgIG9mZnNldCA9IG9mZnNldCA+Pj4gMDtcbiAgICBpZiAoIW5vQXNzZXJ0KVxuICAgICAgICBjaGVja09mZnNldChvZmZzZXQsIDIsIHRoaXMubGVuZ3RoKTtcbiAgICB2YXIgdmFsID0gdGhpc1tvZmZzZXQgKyAxXSB8ICh0aGlzW29mZnNldF0gPDwgOCk7XG4gICAgcmV0dXJuICh2YWwgJiAweDgwMDApID8gdmFsIHwgMHhGRkZGMDAwMCA6IHZhbDtcbn07XG5CdWZmZXIucHJvdG90eXBlLnJlYWRJbnQzMkxFID0gZnVuY3Rpb24gcmVhZEludDMyTEUob2Zmc2V0LCBub0Fzc2VydCkge1xuICAgIG9mZnNldCA9IG9mZnNldCA+Pj4gMDtcbiAgICBpZiAoIW5vQXNzZXJ0KVxuICAgICAgICBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKTtcbiAgICByZXR1cm4gKHRoaXNbb2Zmc2V0XSkgfFxuICAgICAgICAodGhpc1tvZmZzZXQgKyAxXSA8PCA4KSB8XG4gICAgICAgICh0aGlzW29mZnNldCArIDJdIDw8IDE2KSB8XG4gICAgICAgICh0aGlzW29mZnNldCArIDNdIDw8IDI0KTtcbn07XG5CdWZmZXIucHJvdG90eXBlLnJlYWRJbnQzMkJFID0gZnVuY3Rpb24gcmVhZEludDMyQkUob2Zmc2V0LCBub0Fzc2VydCkge1xuICAgIG9mZnNldCA9IG9mZnNldCA+Pj4gMDtcbiAgICBpZiAoIW5vQXNzZXJ0KVxuICAgICAgICBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKTtcbiAgICByZXR1cm4gKHRoaXNbb2Zmc2V0XSA8PCAyNCkgfFxuICAgICAgICAodGhpc1tvZmZzZXQgKyAxXSA8PCAxNikgfFxuICAgICAgICAodGhpc1tvZmZzZXQgKyAyXSA8PCA4KSB8XG4gICAgICAgICh0aGlzW29mZnNldCArIDNdKTtcbn07XG5CdWZmZXIucHJvdG90eXBlLnJlYWRCaWdJbnQ2NExFID0gZGVmaW5lQmlnSW50TWV0aG9kKGZ1bmN0aW9uIHJlYWRCaWdJbnQ2NExFKG9mZnNldCkge1xuICAgIG9mZnNldCA9IG9mZnNldCA+Pj4gMDtcbiAgICB2YWxpZGF0ZU51bWJlcihvZmZzZXQsICdvZmZzZXQnKTtcbiAgICB2YXIgZmlyc3QgPSB0aGlzW29mZnNldF07XG4gICAgdmFyIGxhc3QgPSB0aGlzW29mZnNldCArIDddO1xuICAgIGlmIChmaXJzdCA9PT0gdW5kZWZpbmVkIHx8IGxhc3QgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBib3VuZHNFcnJvcihvZmZzZXQsIHRoaXMubGVuZ3RoIC0gOCk7XG4gICAgfVxuICAgIHZhciB2YWwgPSB0aGlzW29mZnNldCArIDRdICtcbiAgICAgICAgdGhpc1tvZmZzZXQgKyA1XSAqIE1hdGgucG93KDIsIDgpICtcbiAgICAgICAgdGhpc1tvZmZzZXQgKyA2XSAqIE1hdGgucG93KDIsIDE2KSArXG4gICAgICAgIChsYXN0IDw8IDI0KTsgLy8gT3ZlcmZsb3dcbiAgICByZXR1cm4gKEJpZ0ludCh2YWwpIDw8IEJpZ0ludCgzMikpICtcbiAgICAgICAgQmlnSW50KGZpcnN0ICtcbiAgICAgICAgICAgIHRoaXNbKytvZmZzZXRdICogTWF0aC5wb3coMiwgOCkgK1xuICAgICAgICAgICAgdGhpc1srK29mZnNldF0gKiBNYXRoLnBvdygyLCAxNikgK1xuICAgICAgICAgICAgdGhpc1srK29mZnNldF0gKiBNYXRoLnBvdygyLCAyNCkpO1xufSk7XG5CdWZmZXIucHJvdG90eXBlLnJlYWRCaWdJbnQ2NEJFID0gZGVmaW5lQmlnSW50TWV0aG9kKGZ1bmN0aW9uIHJlYWRCaWdJbnQ2NEJFKG9mZnNldCkge1xuICAgIG9mZnNldCA9IG9mZnNldCA+Pj4gMDtcbiAgICB2YWxpZGF0ZU51bWJlcihvZmZzZXQsICdvZmZzZXQnKTtcbiAgICB2YXIgZmlyc3QgPSB0aGlzW29mZnNldF07XG4gICAgdmFyIGxhc3QgPSB0aGlzW29mZnNldCArIDddO1xuICAgIGlmIChmaXJzdCA9PT0gdW5kZWZpbmVkIHx8IGxhc3QgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBib3VuZHNFcnJvcihvZmZzZXQsIHRoaXMubGVuZ3RoIC0gOCk7XG4gICAgfVxuICAgIHZhciB2YWwgPSAoZmlyc3QgPDwgMjQpICsgLy8gT3ZlcmZsb3dcbiAgICAgICAgdGhpc1srK29mZnNldF0gKiBNYXRoLnBvdygyLCAxNikgK1xuICAgICAgICB0aGlzWysrb2Zmc2V0XSAqIE1hdGgucG93KDIsIDgpICtcbiAgICAgICAgdGhpc1srK29mZnNldF07XG4gICAgcmV0dXJuIChCaWdJbnQodmFsKSA8PCBCaWdJbnQoMzIpKSArXG4gICAgICAgIEJpZ0ludCh0aGlzWysrb2Zmc2V0XSAqIE1hdGgucG93KDIsIDI0KSArXG4gICAgICAgICAgICB0aGlzWysrb2Zmc2V0XSAqIE1hdGgucG93KDIsIDE2KSArXG4gICAgICAgICAgICB0aGlzWysrb2Zmc2V0XSAqIE1hdGgucG93KDIsIDgpICtcbiAgICAgICAgICAgIGxhc3QpO1xufSk7XG5CdWZmZXIucHJvdG90eXBlLnJlYWRGbG9hdExFID0gZnVuY3Rpb24gcmVhZEZsb2F0TEUob2Zmc2V0LCBub0Fzc2VydCkge1xuICAgIG9mZnNldCA9IG9mZnNldCA+Pj4gMDtcbiAgICBpZiAoIW5vQXNzZXJ0KVxuICAgICAgICBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKTtcbiAgICByZXR1cm4gaWVlZTc1NC5yZWFkKHRoaXMsIG9mZnNldCwgdHJ1ZSwgMjMsIDQpO1xufTtcbkJ1ZmZlci5wcm90b3R5cGUucmVhZEZsb2F0QkUgPSBmdW5jdGlvbiByZWFkRmxvYXRCRShvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gICAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwO1xuICAgIGlmICghbm9Bc3NlcnQpXG4gICAgICAgIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpO1xuICAgIHJldHVybiBpZWVlNzU0LnJlYWQodGhpcywgb2Zmc2V0LCBmYWxzZSwgMjMsIDQpO1xufTtcbkJ1ZmZlci5wcm90b3R5cGUucmVhZERvdWJsZUxFID0gZnVuY3Rpb24gcmVhZERvdWJsZUxFKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgICBvZmZzZXQgPSBvZmZzZXQgPj4+IDA7XG4gICAgaWYgKCFub0Fzc2VydClcbiAgICAgICAgY2hlY2tPZmZzZXQob2Zmc2V0LCA4LCB0aGlzLmxlbmd0aCk7XG4gICAgcmV0dXJuIGllZWU3NTQucmVhZCh0aGlzLCBvZmZzZXQsIHRydWUsIDUyLCA4KTtcbn07XG5CdWZmZXIucHJvdG90eXBlLnJlYWREb3VibGVCRSA9IGZ1bmN0aW9uIHJlYWREb3VibGVCRShvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gICAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwO1xuICAgIGlmICghbm9Bc3NlcnQpXG4gICAgICAgIGNoZWNrT2Zmc2V0KG9mZnNldCwgOCwgdGhpcy5sZW5ndGgpO1xuICAgIHJldHVybiBpZWVlNzU0LnJlYWQodGhpcywgb2Zmc2V0LCBmYWxzZSwgNTIsIDgpO1xufTtcbmZ1bmN0aW9uIGNoZWNrSW50KGJ1ZiwgdmFsdWUsIG9mZnNldCwgZXh0LCBtYXgsIG1pbikge1xuICAgIGlmICghQnVmZmVyLmlzQnVmZmVyKGJ1ZikpXG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1wiYnVmZmVyXCIgYXJndW1lbnQgbXVzdCBiZSBhIEJ1ZmZlciBpbnN0YW5jZScpO1xuICAgIGlmICh2YWx1ZSA+IG1heCB8fCB2YWx1ZSA8IG1pbilcbiAgICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1widmFsdWVcIiBhcmd1bWVudCBpcyBvdXQgb2YgYm91bmRzJyk7XG4gICAgaWYgKG9mZnNldCArIGV4dCA+IGJ1Zi5sZW5ndGgpXG4gICAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdJbmRleCBvdXQgb2YgcmFuZ2UnKTtcbn1cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVVaW50TEUgPVxuICAgIEJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50TEUgPSBmdW5jdGlvbiB3cml0ZVVJbnRMRSh2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkge1xuICAgICAgICB2YWx1ZSA9ICt2YWx1ZTtcbiAgICAgICAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwO1xuICAgICAgICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCA+Pj4gMDtcbiAgICAgICAgaWYgKCFub0Fzc2VydCkge1xuICAgICAgICAgICAgdmFyIG1heEJ5dGVzID0gTWF0aC5wb3coMiwgOCAqIGJ5dGVMZW5ndGgpIC0gMTtcbiAgICAgICAgICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG1heEJ5dGVzLCAwKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbXVsID0gMTtcbiAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICB0aGlzW29mZnNldF0gPSB2YWx1ZSAmIDB4RkY7XG4gICAgICAgIHdoaWxlICgrK2kgPCBieXRlTGVuZ3RoICYmIChtdWwgKj0gMHgxMDApKSB7XG4gICAgICAgICAgICB0aGlzW29mZnNldCArIGldID0gKHZhbHVlIC8gbXVsKSAmIDB4RkY7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9mZnNldCArIGJ5dGVMZW5ndGg7XG4gICAgfTtcbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVVaW50QkUgPVxuICAgIEJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50QkUgPSBmdW5jdGlvbiB3cml0ZVVJbnRCRSh2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkge1xuICAgICAgICB2YWx1ZSA9ICt2YWx1ZTtcbiAgICAgICAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwO1xuICAgICAgICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCA+Pj4gMDtcbiAgICAgICAgaWYgKCFub0Fzc2VydCkge1xuICAgICAgICAgICAgdmFyIG1heEJ5dGVzID0gTWF0aC5wb3coMiwgOCAqIGJ5dGVMZW5ndGgpIC0gMTtcbiAgICAgICAgICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG1heEJ5dGVzLCAwKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaSA9IGJ5dGVMZW5ndGggLSAxO1xuICAgICAgICB2YXIgbXVsID0gMTtcbiAgICAgICAgdGhpc1tvZmZzZXQgKyBpXSA9IHZhbHVlICYgMHhGRjtcbiAgICAgICAgd2hpbGUgKC0taSA+PSAwICYmIChtdWwgKj0gMHgxMDApKSB7XG4gICAgICAgICAgICB0aGlzW29mZnNldCArIGldID0gKHZhbHVlIC8gbXVsKSAmIDB4RkY7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9mZnNldCArIGJ5dGVMZW5ndGg7XG4gICAgfTtcbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVVaW50OCA9XG4gICAgQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQ4ID0gZnVuY3Rpb24gd3JpdGVVSW50OCh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICAgICAgICB2YWx1ZSA9ICt2YWx1ZTtcbiAgICAgICAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwO1xuICAgICAgICBpZiAoIW5vQXNzZXJ0KVxuICAgICAgICAgICAgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgMSwgMHhmZiwgMCk7XG4gICAgICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSAmIDB4ZmYpO1xuICAgICAgICByZXR1cm4gb2Zmc2V0ICsgMTtcbiAgICB9O1xuQnVmZmVyLnByb3RvdHlwZS53cml0ZVVpbnQxNkxFID1cbiAgICBCdWZmZXIucHJvdG90eXBlLndyaXRlVUludDE2TEUgPSBmdW5jdGlvbiB3cml0ZVVJbnQxNkxFKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gICAgICAgIHZhbHVlID0gK3ZhbHVlO1xuICAgICAgICBvZmZzZXQgPSBvZmZzZXQgPj4+IDA7XG4gICAgICAgIGlmICghbm9Bc3NlcnQpXG4gICAgICAgICAgICBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAyLCAweGZmZmYsIDApO1xuICAgICAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKTtcbiAgICAgICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gOCk7XG4gICAgICAgIHJldHVybiBvZmZzZXQgKyAyO1xuICAgIH07XG5CdWZmZXIucHJvdG90eXBlLndyaXRlVWludDE2QkUgPVxuICAgIEJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50MTZCRSA9IGZ1bmN0aW9uIHdyaXRlVUludDE2QkUodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgICAgICAgdmFsdWUgPSArdmFsdWU7XG4gICAgICAgIG9mZnNldCA9IG9mZnNldCA+Pj4gMDtcbiAgICAgICAgaWYgKCFub0Fzc2VydClcbiAgICAgICAgICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDIsIDB4ZmZmZiwgMCk7XG4gICAgICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSA+Pj4gOCk7XG4gICAgICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgJiAweGZmKTtcbiAgICAgICAgcmV0dXJuIG9mZnNldCArIDI7XG4gICAgfTtcbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVVaW50MzJMRSA9XG4gICAgQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQzMkxFID0gZnVuY3Rpb24gd3JpdGVVSW50MzJMRSh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICAgICAgICB2YWx1ZSA9ICt2YWx1ZTtcbiAgICAgICAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwO1xuICAgICAgICBpZiAoIW5vQXNzZXJ0KVxuICAgICAgICAgICAgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgNCwgMHhmZmZmZmZmZiwgMCk7XG4gICAgICAgIHRoaXNbb2Zmc2V0ICsgM10gPSAodmFsdWUgPj4+IDI0KTtcbiAgICAgICAgdGhpc1tvZmZzZXQgKyAyXSA9ICh2YWx1ZSA+Pj4gMTYpO1xuICAgICAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiA4KTtcbiAgICAgICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZik7XG4gICAgICAgIHJldHVybiBvZmZzZXQgKyA0O1xuICAgIH07XG5CdWZmZXIucHJvdG90eXBlLndyaXRlVWludDMyQkUgPVxuICAgIEJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50MzJCRSA9IGZ1bmN0aW9uIHdyaXRlVUludDMyQkUodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgICAgICAgdmFsdWUgPSArdmFsdWU7XG4gICAgICAgIG9mZnNldCA9IG9mZnNldCA+Pj4gMDtcbiAgICAgICAgaWYgKCFub0Fzc2VydClcbiAgICAgICAgICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDQsIDB4ZmZmZmZmZmYsIDApO1xuICAgICAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgPj4+IDI0KTtcbiAgICAgICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gMTYpO1xuICAgICAgICB0aGlzW29mZnNldCArIDJdID0gKHZhbHVlID4+PiA4KTtcbiAgICAgICAgdGhpc1tvZmZzZXQgKyAzXSA9ICh2YWx1ZSAmIDB4ZmYpO1xuICAgICAgICByZXR1cm4gb2Zmc2V0ICsgNDtcbiAgICB9O1xuZnVuY3Rpb24gd3J0QmlnVUludDY0TEUoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBtaW4sIG1heCkge1xuICAgIGNoZWNrSW50QkkodmFsdWUsIG1pbiwgbWF4LCBidWYsIG9mZnNldCwgNyk7XG4gICAgdmFyIGxvID0gTnVtYmVyKHZhbHVlICYgQmlnSW50KDB4ZmZmZmZmZmYpKTtcbiAgICBidWZbb2Zmc2V0KytdID0gbG87XG4gICAgbG8gPSBsbyA+PiA4O1xuICAgIGJ1ZltvZmZzZXQrK10gPSBsbztcbiAgICBsbyA9IGxvID4+IDg7XG4gICAgYnVmW29mZnNldCsrXSA9IGxvO1xuICAgIGxvID0gbG8gPj4gODtcbiAgICBidWZbb2Zmc2V0KytdID0gbG87XG4gICAgdmFyIGhpID0gTnVtYmVyKHZhbHVlID4+IEJpZ0ludCgzMikgJiBCaWdJbnQoMHhmZmZmZmZmZikpO1xuICAgIGJ1ZltvZmZzZXQrK10gPSBoaTtcbiAgICBoaSA9IGhpID4+IDg7XG4gICAgYnVmW29mZnNldCsrXSA9IGhpO1xuICAgIGhpID0gaGkgPj4gODtcbiAgICBidWZbb2Zmc2V0KytdID0gaGk7XG4gICAgaGkgPSBoaSA+PiA4O1xuICAgIGJ1ZltvZmZzZXQrK10gPSBoaTtcbiAgICByZXR1cm4gb2Zmc2V0O1xufVxuZnVuY3Rpb24gd3J0QmlnVUludDY0QkUoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBtaW4sIG1heCkge1xuICAgIGNoZWNrSW50QkkodmFsdWUsIG1pbiwgbWF4LCBidWYsIG9mZnNldCwgNyk7XG4gICAgdmFyIGxvID0gTnVtYmVyKHZhbHVlICYgQmlnSW50KDB4ZmZmZmZmZmYpKTtcbiAgICBidWZbb2Zmc2V0ICsgN10gPSBsbztcbiAgICBsbyA9IGxvID4+IDg7XG4gICAgYnVmW29mZnNldCArIDZdID0gbG87XG4gICAgbG8gPSBsbyA+PiA4O1xuICAgIGJ1ZltvZmZzZXQgKyA1XSA9IGxvO1xuICAgIGxvID0gbG8gPj4gODtcbiAgICBidWZbb2Zmc2V0ICsgNF0gPSBsbztcbiAgICB2YXIgaGkgPSBOdW1iZXIodmFsdWUgPj4gQmlnSW50KDMyKSAmIEJpZ0ludCgweGZmZmZmZmZmKSk7XG4gICAgYnVmW29mZnNldCArIDNdID0gaGk7XG4gICAgaGkgPSBoaSA+PiA4O1xuICAgIGJ1ZltvZmZzZXQgKyAyXSA9IGhpO1xuICAgIGhpID0gaGkgPj4gODtcbiAgICBidWZbb2Zmc2V0ICsgMV0gPSBoaTtcbiAgICBoaSA9IGhpID4+IDg7XG4gICAgYnVmW29mZnNldF0gPSBoaTtcbiAgICByZXR1cm4gb2Zmc2V0ICsgODtcbn1cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVCaWdVSW50NjRMRSA9IGRlZmluZUJpZ0ludE1ldGhvZChmdW5jdGlvbiB3cml0ZUJpZ1VJbnQ2NExFKHZhbHVlLCBvZmZzZXQpIHtcbiAgICBpZiAob2Zmc2V0ID09PSB2b2lkIDApIHsgb2Zmc2V0ID0gMDsgfVxuICAgIHJldHVybiB3cnRCaWdVSW50NjRMRSh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBCaWdJbnQoMCksIEJpZ0ludCgnMHhmZmZmZmZmZmZmZmZmZmZmJykpO1xufSk7XG5CdWZmZXIucHJvdG90eXBlLndyaXRlQmlnVUludDY0QkUgPSBkZWZpbmVCaWdJbnRNZXRob2QoZnVuY3Rpb24gd3JpdGVCaWdVSW50NjRCRSh2YWx1ZSwgb2Zmc2V0KSB7XG4gICAgaWYgKG9mZnNldCA9PT0gdm9pZCAwKSB7IG9mZnNldCA9IDA7IH1cbiAgICByZXR1cm4gd3J0QmlnVUludDY0QkUodGhpcywgdmFsdWUsIG9mZnNldCwgQmlnSW50KDApLCBCaWdJbnQoJzB4ZmZmZmZmZmZmZmZmZmZmZicpKTtcbn0pO1xuQnVmZmVyLnByb3RvdHlwZS53cml0ZUludExFID0gZnVuY3Rpb24gd3JpdGVJbnRMRSh2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkge1xuICAgIHZhbHVlID0gK3ZhbHVlO1xuICAgIG9mZnNldCA9IG9mZnNldCA+Pj4gMDtcbiAgICBpZiAoIW5vQXNzZXJ0KSB7XG4gICAgICAgIHZhciBsaW1pdCA9IE1hdGgucG93KDIsICg4ICogYnl0ZUxlbmd0aCkgLSAxKTtcbiAgICAgICAgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgYnl0ZUxlbmd0aCwgbGltaXQgLSAxLCAtbGltaXQpO1xuICAgIH1cbiAgICB2YXIgaSA9IDA7XG4gICAgdmFyIG11bCA9IDE7XG4gICAgdmFyIHN1YiA9IDA7XG4gICAgdGhpc1tvZmZzZXRdID0gdmFsdWUgJiAweEZGO1xuICAgIHdoaWxlICgrK2kgPCBieXRlTGVuZ3RoICYmIChtdWwgKj0gMHgxMDApKSB7XG4gICAgICAgIGlmICh2YWx1ZSA8IDAgJiYgc3ViID09PSAwICYmIHRoaXNbb2Zmc2V0ICsgaSAtIDFdICE9PSAwKSB7XG4gICAgICAgICAgICBzdWIgPSAxO1xuICAgICAgICB9XG4gICAgICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAoKHZhbHVlIC8gbXVsKSA+PiAwKSAtIHN1YiAmIDB4RkY7XG4gICAgfVxuICAgIHJldHVybiBvZmZzZXQgKyBieXRlTGVuZ3RoO1xufTtcbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnRCRSA9IGZ1bmN0aW9uIHdyaXRlSW50QkUodmFsdWUsIG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgICB2YWx1ZSA9ICt2YWx1ZTtcbiAgICBvZmZzZXQgPSBvZmZzZXQgPj4+IDA7XG4gICAgaWYgKCFub0Fzc2VydCkge1xuICAgICAgICB2YXIgbGltaXQgPSBNYXRoLnBvdygyLCAoOCAqIGJ5dGVMZW5ndGgpIC0gMSk7XG4gICAgICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIGxpbWl0IC0gMSwgLWxpbWl0KTtcbiAgICB9XG4gICAgdmFyIGkgPSBieXRlTGVuZ3RoIC0gMTtcbiAgICB2YXIgbXVsID0gMTtcbiAgICB2YXIgc3ViID0gMDtcbiAgICB0aGlzW29mZnNldCArIGldID0gdmFsdWUgJiAweEZGO1xuICAgIHdoaWxlICgtLWkgPj0gMCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgICAgICBpZiAodmFsdWUgPCAwICYmIHN1YiA9PT0gMCAmJiB0aGlzW29mZnNldCArIGkgKyAxXSAhPT0gMCkge1xuICAgICAgICAgICAgc3ViID0gMTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzW29mZnNldCArIGldID0gKCh2YWx1ZSAvIG11bCkgPj4gMCkgLSBzdWIgJiAweEZGO1xuICAgIH1cbiAgICByZXR1cm4gb2Zmc2V0ICsgYnl0ZUxlbmd0aDtcbn07XG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50OCA9IGZ1bmN0aW9uIHdyaXRlSW50OCh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICAgIHZhbHVlID0gK3ZhbHVlO1xuICAgIG9mZnNldCA9IG9mZnNldCA+Pj4gMDtcbiAgICBpZiAoIW5vQXNzZXJ0KVxuICAgICAgICBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAxLCAweDdmLCAtMHg4MCk7XG4gICAgaWYgKHZhbHVlIDwgMClcbiAgICAgICAgdmFsdWUgPSAweGZmICsgdmFsdWUgKyAxO1xuICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSAmIDB4ZmYpO1xuICAgIHJldHVybiBvZmZzZXQgKyAxO1xufTtcbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnQxNkxFID0gZnVuY3Rpb24gd3JpdGVJbnQxNkxFKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gICAgdmFsdWUgPSArdmFsdWU7XG4gICAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwO1xuICAgIGlmICghbm9Bc3NlcnQpXG4gICAgICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDIsIDB4N2ZmZiwgLTB4ODAwMCk7XG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZik7XG4gICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gOCk7XG4gICAgcmV0dXJuIG9mZnNldCArIDI7XG59O1xuQnVmZmVyLnByb3RvdHlwZS53cml0ZUludDE2QkUgPSBmdW5jdGlvbiB3cml0ZUludDE2QkUodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgICB2YWx1ZSA9ICt2YWx1ZTtcbiAgICBvZmZzZXQgPSBvZmZzZXQgPj4+IDA7XG4gICAgaWYgKCFub0Fzc2VydClcbiAgICAgICAgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgMiwgMHg3ZmZmLCAtMHg4MDAwKTtcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgPj4+IDgpO1xuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgJiAweGZmKTtcbiAgICByZXR1cm4gb2Zmc2V0ICsgMjtcbn07XG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50MzJMRSA9IGZ1bmN0aW9uIHdyaXRlSW50MzJMRSh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICAgIHZhbHVlID0gK3ZhbHVlO1xuICAgIG9mZnNldCA9IG9mZnNldCA+Pj4gMDtcbiAgICBpZiAoIW5vQXNzZXJ0KVxuICAgICAgICBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCA0LCAweDdmZmZmZmZmLCAtMHg4MDAwMDAwMCk7XG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZik7XG4gICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gOCk7XG4gICAgdGhpc1tvZmZzZXQgKyAyXSA9ICh2YWx1ZSA+Pj4gMTYpO1xuICAgIHRoaXNbb2Zmc2V0ICsgM10gPSAodmFsdWUgPj4+IDI0KTtcbiAgICByZXR1cm4gb2Zmc2V0ICsgNDtcbn07XG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50MzJCRSA9IGZ1bmN0aW9uIHdyaXRlSW50MzJCRSh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICAgIHZhbHVlID0gK3ZhbHVlO1xuICAgIG9mZnNldCA9IG9mZnNldCA+Pj4gMDtcbiAgICBpZiAoIW5vQXNzZXJ0KVxuICAgICAgICBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCA0LCAweDdmZmZmZmZmLCAtMHg4MDAwMDAwMCk7XG4gICAgaWYgKHZhbHVlIDwgMClcbiAgICAgICAgdmFsdWUgPSAweGZmZmZmZmZmICsgdmFsdWUgKyAxO1xuICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSA+Pj4gMjQpO1xuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDE2KTtcbiAgICB0aGlzW29mZnNldCArIDJdID0gKHZhbHVlID4+PiA4KTtcbiAgICB0aGlzW29mZnNldCArIDNdID0gKHZhbHVlICYgMHhmZik7XG4gICAgcmV0dXJuIG9mZnNldCArIDQ7XG59O1xuQnVmZmVyLnByb3RvdHlwZS53cml0ZUJpZ0ludDY0TEUgPSBkZWZpbmVCaWdJbnRNZXRob2QoZnVuY3Rpb24gd3JpdGVCaWdJbnQ2NExFKHZhbHVlLCBvZmZzZXQpIHtcbiAgICBpZiAob2Zmc2V0ID09PSB2b2lkIDApIHsgb2Zmc2V0ID0gMDsgfVxuICAgIHJldHVybiB3cnRCaWdVSW50NjRMRSh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAtQmlnSW50KCcweDgwMDAwMDAwMDAwMDAwMDAnKSwgQmlnSW50KCcweDdmZmZmZmZmZmZmZmZmZmYnKSk7XG59KTtcbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVCaWdJbnQ2NEJFID0gZGVmaW5lQmlnSW50TWV0aG9kKGZ1bmN0aW9uIHdyaXRlQmlnSW50NjRCRSh2YWx1ZSwgb2Zmc2V0KSB7XG4gICAgaWYgKG9mZnNldCA9PT0gdm9pZCAwKSB7IG9mZnNldCA9IDA7IH1cbiAgICByZXR1cm4gd3J0QmlnVUludDY0QkUodGhpcywgdmFsdWUsIG9mZnNldCwgLUJpZ0ludCgnMHg4MDAwMDAwMDAwMDAwMDAwJyksIEJpZ0ludCgnMHg3ZmZmZmZmZmZmZmZmZmZmJykpO1xufSk7XG5mdW5jdGlvbiBjaGVja0lFRUU3NTQoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBleHQsIG1heCwgbWluKSB7XG4gICAgaWYgKG9mZnNldCArIGV4dCA+IGJ1Zi5sZW5ndGgpXG4gICAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdJbmRleCBvdXQgb2YgcmFuZ2UnKTtcbiAgICBpZiAob2Zmc2V0IDwgMClcbiAgICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0luZGV4IG91dCBvZiByYW5nZScpO1xufVxuZnVuY3Rpb24gd3JpdGVGbG9hdChidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbiwgbm9Bc3NlcnQpIHtcbiAgICB2YWx1ZSA9ICt2YWx1ZTtcbiAgICBvZmZzZXQgPSBvZmZzZXQgPj4+IDA7XG4gICAgaWYgKCFub0Fzc2VydCkge1xuICAgICAgICBjaGVja0lFRUU3NTQoYnVmLCB2YWx1ZSwgb2Zmc2V0LCA0LCAzLjQwMjgyMzQ2NjM4NTI4ODZlKzM4LCAtMy40MDI4MjM0NjYzODUyODg2ZSszOCk7XG4gICAgfVxuICAgIGllZWU3NTQud3JpdGUoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4sIDIzLCA0KTtcbiAgICByZXR1cm4gb2Zmc2V0ICsgNDtcbn1cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVGbG9hdExFID0gZnVuY3Rpb24gd3JpdGVGbG9hdExFKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gICAgcmV0dXJuIHdyaXRlRmxvYXQodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSwgbm9Bc3NlcnQpO1xufTtcbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVGbG9hdEJFID0gZnVuY3Rpb24gd3JpdGVGbG9hdEJFKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gICAgcmV0dXJuIHdyaXRlRmxvYXQodGhpcywgdmFsdWUsIG9mZnNldCwgZmFsc2UsIG5vQXNzZXJ0KTtcbn07XG5mdW5jdGlvbiB3cml0ZURvdWJsZShidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbiwgbm9Bc3NlcnQpIHtcbiAgICB2YWx1ZSA9ICt2YWx1ZTtcbiAgICBvZmZzZXQgPSBvZmZzZXQgPj4+IDA7XG4gICAgaWYgKCFub0Fzc2VydCkge1xuICAgICAgICBjaGVja0lFRUU3NTQoYnVmLCB2YWx1ZSwgb2Zmc2V0LCA4LCAxLjc5NzY5MzEzNDg2MjMxNTdFKzMwOCwgLTEuNzk3NjkzMTM0ODYyMzE1N0UrMzA4KTtcbiAgICB9XG4gICAgaWVlZTc1NC53cml0ZShidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbiwgNTIsIDgpO1xuICAgIHJldHVybiBvZmZzZXQgKyA4O1xufVxuQnVmZmVyLnByb3RvdHlwZS53cml0ZURvdWJsZUxFID0gZnVuY3Rpb24gd3JpdGVEb3VibGVMRSh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICAgIHJldHVybiB3cml0ZURvdWJsZSh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCB0cnVlLCBub0Fzc2VydCk7XG59O1xuQnVmZmVyLnByb3RvdHlwZS53cml0ZURvdWJsZUJFID0gZnVuY3Rpb24gd3JpdGVEb3VibGVCRSh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICAgIHJldHVybiB3cml0ZURvdWJsZSh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSwgbm9Bc3NlcnQpO1xufTtcbi8vIGNvcHkodGFyZ2V0QnVmZmVyLCB0YXJnZXRTdGFydD0wLCBzb3VyY2VTdGFydD0wLCBzb3VyY2VFbmQ9YnVmZmVyLmxlbmd0aClcbkJ1ZmZlci5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIGNvcHkodGFyZ2V0LCB0YXJnZXRTdGFydCwgc3RhcnQsIGVuZCkge1xuICAgIGlmICghQnVmZmVyLmlzQnVmZmVyKHRhcmdldCkpXG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2FyZ3VtZW50IHNob3VsZCBiZSBhIEJ1ZmZlcicpO1xuICAgIGlmICghc3RhcnQpXG4gICAgICAgIHN0YXJ0ID0gMDtcbiAgICBpZiAoIWVuZCAmJiBlbmQgIT09IDApXG4gICAgICAgIGVuZCA9IHRoaXMubGVuZ3RoO1xuICAgIGlmICh0YXJnZXRTdGFydCA+PSB0YXJnZXQubGVuZ3RoKVxuICAgICAgICB0YXJnZXRTdGFydCA9IHRhcmdldC5sZW5ndGg7XG4gICAgaWYgKCF0YXJnZXRTdGFydClcbiAgICAgICAgdGFyZ2V0U3RhcnQgPSAwO1xuICAgIGlmIChlbmQgPiAwICYmIGVuZCA8IHN0YXJ0KVxuICAgICAgICBlbmQgPSBzdGFydDtcbiAgICAvLyBDb3B5IDAgYnl0ZXM7IHdlJ3JlIGRvbmVcbiAgICBpZiAoZW5kID09PSBzdGFydClcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgaWYgKHRhcmdldC5sZW5ndGggPT09IDAgfHwgdGhpcy5sZW5ndGggPT09IDApXG4gICAgICAgIHJldHVybiAwO1xuICAgIC8vIEZhdGFsIGVycm9yIGNvbmRpdGlvbnNcbiAgICBpZiAodGFyZ2V0U3RhcnQgPCAwKSB7XG4gICAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCd0YXJnZXRTdGFydCBvdXQgb2YgYm91bmRzJyk7XG4gICAgfVxuICAgIGlmIChzdGFydCA8IDAgfHwgc3RhcnQgPj0gdGhpcy5sZW5ndGgpXG4gICAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdJbmRleCBvdXQgb2YgcmFuZ2UnKTtcbiAgICBpZiAoZW5kIDwgMClcbiAgICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ3NvdXJjZUVuZCBvdXQgb2YgYm91bmRzJyk7XG4gICAgLy8gQXJlIHdlIG9vYj9cbiAgICBpZiAoZW5kID4gdGhpcy5sZW5ndGgpXG4gICAgICAgIGVuZCA9IHRoaXMubGVuZ3RoO1xuICAgIGlmICh0YXJnZXQubGVuZ3RoIC0gdGFyZ2V0U3RhcnQgPCBlbmQgLSBzdGFydCkge1xuICAgICAgICBlbmQgPSB0YXJnZXQubGVuZ3RoIC0gdGFyZ2V0U3RhcnQgKyBzdGFydDtcbiAgICB9XG4gICAgdmFyIGxlbiA9IGVuZCAtIHN0YXJ0O1xuICAgIGlmICh0aGlzID09PSB0YXJnZXQgJiYgdHlwZW9mIFVpbnQ4QXJyYXkucHJvdG90eXBlLmNvcHlXaXRoaW4gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgLy8gVXNlIGJ1aWx0LWluIHdoZW4gYXZhaWxhYmxlLCBtaXNzaW5nIGZyb20gSUUxMVxuICAgICAgICB0aGlzLmNvcHlXaXRoaW4odGFyZ2V0U3RhcnQsIHN0YXJ0LCBlbmQpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgVWludDhBcnJheS5wcm90b3R5cGUuc2V0LmNhbGwodGFyZ2V0LCB0aGlzLnN1YmFycmF5KHN0YXJ0LCBlbmQpLCB0YXJnZXRTdGFydCk7XG4gICAgfVxuICAgIHJldHVybiBsZW47XG59O1xuLy8gVXNhZ2U6XG4vLyAgICBidWZmZXIuZmlsbChudW1iZXJbLCBvZmZzZXRbLCBlbmRdXSlcbi8vICAgIGJ1ZmZlci5maWxsKGJ1ZmZlclssIG9mZnNldFssIGVuZF1dKVxuLy8gICAgYnVmZmVyLmZpbGwoc3RyaW5nWywgb2Zmc2V0WywgZW5kXV1bLCBlbmNvZGluZ10pXG5CdWZmZXIucHJvdG90eXBlLmZpbGwgPSBmdW5jdGlvbiBmaWxsKHZhbCwgc3RhcnQsIGVuZCwgZW5jb2RpbmcpIHtcbiAgICAvLyBIYW5kbGUgc3RyaW5nIGNhc2VzOlxuICAgIGlmICh0eXBlb2YgdmFsID09PSAnc3RyaW5nJykge1xuICAgICAgICBpZiAodHlwZW9mIHN0YXJ0ID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgZW5jb2RpbmcgPSBzdGFydDtcbiAgICAgICAgICAgIHN0YXJ0ID0gMDtcbiAgICAgICAgICAgIGVuZCA9IHRoaXMubGVuZ3RoO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHR5cGVvZiBlbmQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICBlbmNvZGluZyA9IGVuZDtcbiAgICAgICAgICAgIGVuZCA9IHRoaXMubGVuZ3RoO1xuICAgICAgICB9XG4gICAgICAgIGlmIChlbmNvZGluZyAhPT0gdW5kZWZpbmVkICYmIHR5cGVvZiBlbmNvZGluZyAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2VuY29kaW5nIG11c3QgYmUgYSBzdHJpbmcnKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGVuY29kaW5nID09PSAnc3RyaW5nJyAmJiAhQnVmZmVyLmlzRW5jb2RpbmcoZW5jb2RpbmcpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdVbmtub3duIGVuY29kaW5nOiAnICsgZW5jb2RpbmcpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2YWwubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICB2YXIgY29kZSA9IHZhbC5jaGFyQ29kZUF0KDApO1xuICAgICAgICAgICAgaWYgKChlbmNvZGluZyA9PT0gJ3V0ZjgnICYmIGNvZGUgPCAxMjgpIHx8XG4gICAgICAgICAgICAgICAgZW5jb2RpbmcgPT09ICdsYXRpbjEnKSB7XG4gICAgICAgICAgICAgICAgLy8gRmFzdCBwYXRoOiBJZiBgdmFsYCBmaXRzIGludG8gYSBzaW5nbGUgYnl0ZSwgdXNlIHRoYXQgbnVtZXJpYyB2YWx1ZS5cbiAgICAgICAgICAgICAgICB2YWwgPSBjb2RlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKHR5cGVvZiB2YWwgPT09ICdudW1iZXInKSB7XG4gICAgICAgIHZhbCA9IHZhbCAmIDI1NTtcbiAgICB9XG4gICAgZWxzZSBpZiAodHlwZW9mIHZhbCA9PT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgIHZhbCA9IE51bWJlcih2YWwpO1xuICAgIH1cbiAgICAvLyBJbnZhbGlkIHJhbmdlcyBhcmUgbm90IHNldCB0byBhIGRlZmF1bHQsIHNvIGNhbiByYW5nZSBjaGVjayBlYXJseS5cbiAgICBpZiAoc3RhcnQgPCAwIHx8IHRoaXMubGVuZ3RoIDwgc3RhcnQgfHwgdGhpcy5sZW5ndGggPCBlbmQpIHtcbiAgICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ091dCBvZiByYW5nZSBpbmRleCcpO1xuICAgIH1cbiAgICBpZiAoZW5kIDw9IHN0YXJ0KSB7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBzdGFydCA9IHN0YXJ0ID4+PiAwO1xuICAgIGVuZCA9IGVuZCA9PT0gdW5kZWZpbmVkID8gdGhpcy5sZW5ndGggOiBlbmQgPj4+IDA7XG4gICAgaWYgKCF2YWwpXG4gICAgICAgIHZhbCA9IDA7XG4gICAgdmFyIGk7XG4gICAgaWYgKHR5cGVvZiB2YWwgPT09ICdudW1iZXInKSB7XG4gICAgICAgIGZvciAoaSA9IHN0YXJ0OyBpIDwgZW5kOyArK2kpIHtcbiAgICAgICAgICAgIHRoaXNbaV0gPSB2YWw7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHZhciBieXRlcyA9IEJ1ZmZlci5pc0J1ZmZlcih2YWwpXG4gICAgICAgICAgICA/IHZhbFxuICAgICAgICAgICAgOiBCdWZmZXIuZnJvbSh2YWwsIGVuY29kaW5nKTtcbiAgICAgICAgdmFyIGxlbiA9IGJ5dGVzLmxlbmd0aDtcbiAgICAgICAgaWYgKGxlbiA9PT0gMCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignVGhlIHZhbHVlIFwiJyArIHZhbCArXG4gICAgICAgICAgICAgICAgJ1wiIGlzIGludmFsaWQgZm9yIGFyZ3VtZW50IFwidmFsdWVcIicpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBlbmQgLSBzdGFydDsgKytpKSB7XG4gICAgICAgICAgICB0aGlzW2kgKyBzdGFydF0gPSBieXRlc1tpICUgbGVuXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbn07XG4vLyBDVVNUT00gRVJST1JTXG4vLyA9PT09PT09PT09PT09XG4vLyBTaW1wbGlmaWVkIHZlcnNpb25zIGZyb20gTm9kZSwgY2hhbmdlZCBmb3IgQnVmZmVyLW9ubHkgdXNhZ2VcbnZhciBlcnJvcnMgPSB7fTtcbmZ1bmN0aW9uIEUoc3ltLCBnZXRNZXNzYWdlLCBCYXNlKSB7XG4gICAgZXJyb3JzW3N5bV0gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhOb2RlRXJyb3IsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIE5vZGVFcnJvcigpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoX3RoaXMsICdtZXNzYWdlJywge1xuICAgICAgICAgICAgICAgIHZhbHVlOiBnZXRNZXNzYWdlLmFwcGx5KF90aGlzLCBhcmd1bWVudHMpLFxuICAgICAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvLyBBZGQgdGhlIGVycm9yIGNvZGUgdG8gdGhlIG5hbWUgdG8gaW5jbHVkZSBpdCBpbiB0aGUgc3RhY2sgdHJhY2UuXG4gICAgICAgICAgICBfdGhpcy5uYW1lID0gXCJcIi5jb25jYXQoX3RoaXMubmFtZSwgXCIgW1wiKS5jb25jYXQoc3ltLCBcIl1cIik7XG4gICAgICAgICAgICAvLyBBY2Nlc3MgdGhlIHN0YWNrIHRvIGdlbmVyYXRlIHRoZSBlcnJvciBtZXNzYWdlIGluY2x1ZGluZyB0aGUgZXJyb3IgY29kZVxuICAgICAgICAgICAgLy8gZnJvbSB0aGUgbmFtZS5cbiAgICAgICAgICAgIF90aGlzLnN0YWNrOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVudXNlZC1leHByZXNzaW9uc1xuICAgICAgICAgICAgLy8gUmVzZXQgdGhlIG5hbWUgdG8gdGhlIGFjdHVhbCBuYW1lLlxuICAgICAgICAgICAgZGVsZXRlIF90aGlzLm5hbWU7XG4gICAgICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICAgIH1cbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE5vZGVFcnJvci5wcm90b3R5cGUsIFwiY29kZVwiLCB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc3ltO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICdjb2RlJywge1xuICAgICAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgd3JpdGFibGU6IHRydWVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgICAgTm9kZUVycm9yLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBcIlwiLmNvbmNhdCh0aGlzLm5hbWUsIFwiIFtcIikuY29uY2F0KHN5bSwgXCJdOiBcIikuY29uY2F0KHRoaXMubWVzc2FnZSk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBOb2RlRXJyb3I7XG4gICAgfShCYXNlKSk7XG59XG5FKCdFUlJfQlVGRkVSX09VVF9PRl9CT1VORFMnLCBmdW5jdGlvbiAobmFtZSkge1xuICAgIGlmIChuYW1lKSB7XG4gICAgICAgIHJldHVybiBcIlwiLmNvbmNhdChuYW1lLCBcIiBpcyBvdXRzaWRlIG9mIGJ1ZmZlciBib3VuZHNcIik7XG4gICAgfVxuICAgIHJldHVybiAnQXR0ZW1wdCB0byBhY2Nlc3MgbWVtb3J5IG91dHNpZGUgYnVmZmVyIGJvdW5kcyc7XG59LCBSYW5nZUVycm9yKTtcbkUoJ0VSUl9JTlZBTElEX0FSR19UWVBFJywgZnVuY3Rpb24gKG5hbWUsIGFjdHVhbCkge1xuICAgIHJldHVybiBcIlRoZSBcXFwiXCIuY29uY2F0KG5hbWUsIFwiXFxcIiBhcmd1bWVudCBtdXN0IGJlIG9mIHR5cGUgbnVtYmVyLiBSZWNlaXZlZCB0eXBlIFwiKS5jb25jYXQodHlwZW9mIGFjdHVhbCk7XG59LCBUeXBlRXJyb3IpO1xuRSgnRVJSX09VVF9PRl9SQU5HRScsIGZ1bmN0aW9uIChzdHIsIHJhbmdlLCBpbnB1dCkge1xuICAgIHZhciBtc2cgPSBcIlRoZSB2YWx1ZSBvZiBcXFwiXCIuY29uY2F0KHN0ciwgXCJcXFwiIGlzIG91dCBvZiByYW5nZS5cIik7XG4gICAgdmFyIHJlY2VpdmVkID0gaW5wdXQ7XG4gICAgaWYgKE51bWJlci5pc0ludGVnZXIoaW5wdXQpICYmIE1hdGguYWJzKGlucHV0KSA+IE1hdGgucG93KDIsIDMyKSkge1xuICAgICAgICByZWNlaXZlZCA9IGFkZE51bWVyaWNhbFNlcGFyYXRvcihTdHJpbmcoaW5wdXQpKTtcbiAgICB9XG4gICAgZWxzZSBpZiAodHlwZW9mIGlucHV0ID09PSAnYmlnaW50Jykge1xuICAgICAgICByZWNlaXZlZCA9IFN0cmluZyhpbnB1dCk7XG4gICAgICAgIGlmIChpbnB1dCA+IE1hdGgucG93KEJpZ0ludCgyKSwgQmlnSW50KDMyKSkgfHwgaW5wdXQgPCAtKE1hdGgucG93KEJpZ0ludCgyKSwgQmlnSW50KDMyKSkpKSB7XG4gICAgICAgICAgICByZWNlaXZlZCA9IGFkZE51bWVyaWNhbFNlcGFyYXRvcihyZWNlaXZlZCk7XG4gICAgICAgIH1cbiAgICAgICAgcmVjZWl2ZWQgKz0gJ24nO1xuICAgIH1cbiAgICBtc2cgKz0gXCIgSXQgbXVzdCBiZSBcIi5jb25jYXQocmFuZ2UsIFwiLiBSZWNlaXZlZCBcIikuY29uY2F0KHJlY2VpdmVkKTtcbiAgICByZXR1cm4gbXNnO1xufSwgUmFuZ2VFcnJvcik7XG5mdW5jdGlvbiBhZGROdW1lcmljYWxTZXBhcmF0b3IodmFsKSB7XG4gICAgdmFyIHJlcyA9ICcnO1xuICAgIHZhciBpID0gdmFsLmxlbmd0aDtcbiAgICB2YXIgc3RhcnQgPSB2YWxbMF0gPT09ICctJyA/IDEgOiAwO1xuICAgIGZvciAoOyBpID49IHN0YXJ0ICsgNDsgaSAtPSAzKSB7XG4gICAgICAgIHJlcyA9IFwiX1wiLmNvbmNhdCh2YWwuc2xpY2UoaSAtIDMsIGkpKS5jb25jYXQocmVzKTtcbiAgICB9XG4gICAgcmV0dXJuIFwiXCIuY29uY2F0KHZhbC5zbGljZSgwLCBpKSkuY29uY2F0KHJlcyk7XG59XG4vLyBDSEVDSyBGVU5DVElPTlNcbi8vID09PT09PT09PT09PT09PVxuZnVuY3Rpb24gY2hlY2tCb3VuZHMoYnVmLCBvZmZzZXQsIGJ5dGVMZW5ndGgpIHtcbiAgICB2YWxpZGF0ZU51bWJlcihvZmZzZXQsICdvZmZzZXQnKTtcbiAgICBpZiAoYnVmW29mZnNldF0gPT09IHVuZGVmaW5lZCB8fCBidWZbb2Zmc2V0ICsgYnl0ZUxlbmd0aF0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBib3VuZHNFcnJvcihvZmZzZXQsIGJ1Zi5sZW5ndGggLSAoYnl0ZUxlbmd0aCArIDEpKTtcbiAgICB9XG59XG5mdW5jdGlvbiBjaGVja0ludEJJKHZhbHVlLCBtaW4sIG1heCwgYnVmLCBvZmZzZXQsIGJ5dGVMZW5ndGgpIHtcbiAgICBpZiAodmFsdWUgPiBtYXggfHwgdmFsdWUgPCBtaW4pIHtcbiAgICAgICAgdmFyIG4gPSB0eXBlb2YgbWluID09PSAnYmlnaW50JyA/ICduJyA6ICcnO1xuICAgICAgICB2YXIgcmFuZ2UgPSB2b2lkIDA7XG4gICAgICAgIGlmIChieXRlTGVuZ3RoID4gMykge1xuICAgICAgICAgICAgaWYgKG1pbiA9PT0gMCB8fCBtaW4gPT09IEJpZ0ludCgwKSkge1xuICAgICAgICAgICAgICAgIHJhbmdlID0gXCI+PSAwXCIuY29uY2F0KG4sIFwiIGFuZCA8IDJcIikuY29uY2F0KG4sIFwiICoqIFwiKS5jb25jYXQoKGJ5dGVMZW5ndGggKyAxKSAqIDgpLmNvbmNhdChuKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJhbmdlID0gXCI+PSAtKDJcIi5jb25jYXQobiwgXCIgKiogXCIpLmNvbmNhdCgoYnl0ZUxlbmd0aCArIDEpICogOCAtIDEpLmNvbmNhdChuLCBcIikgYW5kIDwgMiAqKiBcIikgK1xuICAgICAgICAgICAgICAgICAgICBcIlwiLmNvbmNhdCgoYnl0ZUxlbmd0aCArIDEpICogOCAtIDEpLmNvbmNhdChuKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJhbmdlID0gXCI+PSBcIi5jb25jYXQobWluKS5jb25jYXQobiwgXCIgYW5kIDw9IFwiKS5jb25jYXQobWF4KS5jb25jYXQobik7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IGVycm9ycy5FUlJfT1VUX09GX1JBTkdFKCd2YWx1ZScsIHJhbmdlLCB2YWx1ZSk7XG4gICAgfVxuICAgIGNoZWNrQm91bmRzKGJ1Ziwgb2Zmc2V0LCBieXRlTGVuZ3RoKTtcbn1cbmZ1bmN0aW9uIHZhbGlkYXRlTnVtYmVyKHZhbHVlLCBuYW1lKSB7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ251bWJlcicpIHtcbiAgICAgICAgdGhyb3cgbmV3IGVycm9ycy5FUlJfSU5WQUxJRF9BUkdfVFlQRShuYW1lLCAnbnVtYmVyJywgdmFsdWUpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGJvdW5kc0Vycm9yKHZhbHVlLCBsZW5ndGgsIHR5cGUpIHtcbiAgICBpZiAoTWF0aC5mbG9vcih2YWx1ZSkgIT09IHZhbHVlKSB7XG4gICAgICAgIHZhbGlkYXRlTnVtYmVyKHZhbHVlLCB0eXBlKTtcbiAgICAgICAgdGhyb3cgbmV3IGVycm9ycy5FUlJfT1VUX09GX1JBTkdFKHR5cGUgfHwgJ29mZnNldCcsICdhbiBpbnRlZ2VyJywgdmFsdWUpO1xuICAgIH1cbiAgICBpZiAobGVuZ3RoIDwgMCkge1xuICAgICAgICB0aHJvdyBuZXcgZXJyb3JzLkVSUl9CVUZGRVJfT1VUX09GX0JPVU5EUygpO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgZXJyb3JzLkVSUl9PVVRfT0ZfUkFOR0UodHlwZSB8fCAnb2Zmc2V0JywgXCI+PSBcIi5jb25jYXQodHlwZSA/IDEgOiAwLCBcIiBhbmQgPD0gXCIpLmNvbmNhdChsZW5ndGgpLCB2YWx1ZSk7XG59XG4vLyBIRUxQRVIgRlVOQ1RJT05TXG4vLyA9PT09PT09PT09PT09PT09XG52YXIgSU5WQUxJRF9CQVNFNjRfUkUgPSAvW14rLzAtOUEtWmEtei1fXS9nO1xuZnVuY3Rpb24gYmFzZTY0Y2xlYW4oc3RyKSB7XG4gICAgLy8gTm9kZSB0YWtlcyBlcXVhbCBzaWducyBhcyBlbmQgb2YgdGhlIEJhc2U2NCBlbmNvZGluZ1xuICAgIHN0ciA9IHN0ci5zcGxpdCgnPScpWzBdO1xuICAgIC8vIE5vZGUgc3RyaXBzIG91dCBpbnZhbGlkIGNoYXJhY3RlcnMgbGlrZSBcXG4gYW5kIFxcdCBmcm9tIHRoZSBzdHJpbmcsIGJhc2U2NC1qcyBkb2VzIG5vdFxuICAgIHN0ciA9IHN0ci50cmltKCkucmVwbGFjZShJTlZBTElEX0JBU0U2NF9SRSwgJycpO1xuICAgIC8vIE5vZGUgY29udmVydHMgc3RyaW5ncyB3aXRoIGxlbmd0aCA8IDIgdG8gJydcbiAgICBpZiAoc3RyLmxlbmd0aCA8IDIpXG4gICAgICAgIHJldHVybiAnJztcbiAgICAvLyBOb2RlIGFsbG93cyBmb3Igbm9uLXBhZGRlZCBiYXNlNjQgc3RyaW5ncyAobWlzc2luZyB0cmFpbGluZyA9PT0pLCBiYXNlNjQtanMgZG9lcyBub3RcbiAgICB3aGlsZSAoc3RyLmxlbmd0aCAlIDQgIT09IDApIHtcbiAgICAgICAgc3RyID0gc3RyICsgJz0nO1xuICAgIH1cbiAgICByZXR1cm4gc3RyO1xufVxuZnVuY3Rpb24gdXRmOFRvQnl0ZXMoc3RyaW5nLCB1bml0cykge1xuICAgIHVuaXRzID0gdW5pdHMgfHwgSW5maW5pdHk7XG4gICAgdmFyIGNvZGVQb2ludDtcbiAgICB2YXIgbGVuZ3RoID0gc3RyaW5nLmxlbmd0aDtcbiAgICB2YXIgbGVhZFN1cnJvZ2F0ZSA9IG51bGw7XG4gICAgdmFyIGJ5dGVzID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgICAgICBjb2RlUG9pbnQgPSBzdHJpbmcuY2hhckNvZGVBdChpKTtcbiAgICAgICAgLy8gaXMgc3Vycm9nYXRlIGNvbXBvbmVudFxuICAgICAgICBpZiAoY29kZVBvaW50ID4gMHhEN0ZGICYmIGNvZGVQb2ludCA8IDB4RTAwMCkge1xuICAgICAgICAgICAgLy8gbGFzdCBjaGFyIHdhcyBhIGxlYWRcbiAgICAgICAgICAgIGlmICghbGVhZFN1cnJvZ2F0ZSkge1xuICAgICAgICAgICAgICAgIC8vIG5vIGxlYWQgeWV0XG4gICAgICAgICAgICAgICAgaWYgKGNvZGVQb2ludCA+IDB4REJGRikge1xuICAgICAgICAgICAgICAgICAgICAvLyB1bmV4cGVjdGVkIHRyYWlsXG4gICAgICAgICAgICAgICAgICAgIGlmICgodW5pdHMgLT0gMykgPiAtMSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ5dGVzLnB1c2goMHhFRiwgMHhCRiwgMHhCRCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChpICsgMSA9PT0gbGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHVucGFpcmVkIGxlYWRcbiAgICAgICAgICAgICAgICAgICAgaWYgKCh1bml0cyAtPSAzKSA+IC0xKVxuICAgICAgICAgICAgICAgICAgICAgICAgYnl0ZXMucHVzaCgweEVGLCAweEJGLCAweEJEKTtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIHZhbGlkIGxlYWRcbiAgICAgICAgICAgICAgICBsZWFkU3Vycm9nYXRlID0gY29kZVBvaW50O1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gMiBsZWFkcyBpbiBhIHJvd1xuICAgICAgICAgICAgaWYgKGNvZGVQb2ludCA8IDB4REMwMCkge1xuICAgICAgICAgICAgICAgIGlmICgodW5pdHMgLT0gMykgPiAtMSlcbiAgICAgICAgICAgICAgICAgICAgYnl0ZXMucHVzaCgweEVGLCAweEJGLCAweEJEKTtcbiAgICAgICAgICAgICAgICBsZWFkU3Vycm9nYXRlID0gY29kZVBvaW50O1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gdmFsaWQgc3Vycm9nYXRlIHBhaXJcbiAgICAgICAgICAgIGNvZGVQb2ludCA9IChsZWFkU3Vycm9nYXRlIC0gMHhEODAwIDw8IDEwIHwgY29kZVBvaW50IC0gMHhEQzAwKSArIDB4MTAwMDA7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAobGVhZFN1cnJvZ2F0ZSkge1xuICAgICAgICAgICAgLy8gdmFsaWQgYm1wIGNoYXIsIGJ1dCBsYXN0IGNoYXIgd2FzIGEgbGVhZFxuICAgICAgICAgICAgaWYgKCh1bml0cyAtPSAzKSA+IC0xKVxuICAgICAgICAgICAgICAgIGJ5dGVzLnB1c2goMHhFRiwgMHhCRiwgMHhCRCk7XG4gICAgICAgIH1cbiAgICAgICAgbGVhZFN1cnJvZ2F0ZSA9IG51bGw7XG4gICAgICAgIC8vIGVuY29kZSB1dGY4XG4gICAgICAgIGlmIChjb2RlUG9pbnQgPCAweDgwKSB7XG4gICAgICAgICAgICBpZiAoKHVuaXRzIC09IDEpIDwgMClcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGJ5dGVzLnB1c2goY29kZVBvaW50KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjb2RlUG9pbnQgPCAweDgwMCkge1xuICAgICAgICAgICAgaWYgKCh1bml0cyAtPSAyKSA8IDApXG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBieXRlcy5wdXNoKGNvZGVQb2ludCA+PiAweDYgfCAweEMwLCBjb2RlUG9pbnQgJiAweDNGIHwgMHg4MCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoY29kZVBvaW50IDwgMHgxMDAwMCkge1xuICAgICAgICAgICAgaWYgKCh1bml0cyAtPSAzKSA8IDApXG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBieXRlcy5wdXNoKGNvZGVQb2ludCA+PiAweEMgfCAweEUwLCBjb2RlUG9pbnQgPj4gMHg2ICYgMHgzRiB8IDB4ODAsIGNvZGVQb2ludCAmIDB4M0YgfCAweDgwKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjb2RlUG9pbnQgPCAweDExMDAwMCkge1xuICAgICAgICAgICAgaWYgKCh1bml0cyAtPSA0KSA8IDApXG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBieXRlcy5wdXNoKGNvZGVQb2ludCA+PiAweDEyIHwgMHhGMCwgY29kZVBvaW50ID4+IDB4QyAmIDB4M0YgfCAweDgwLCBjb2RlUG9pbnQgPj4gMHg2ICYgMHgzRiB8IDB4ODAsIGNvZGVQb2ludCAmIDB4M0YgfCAweDgwKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBjb2RlIHBvaW50Jyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGJ5dGVzO1xufVxuZnVuY3Rpb24gYXNjaWlUb0J5dGVzKHN0cikge1xuICAgIHZhciBieXRlQXJyYXkgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN0ci5sZW5ndGg7ICsraSkge1xuICAgICAgICAvLyBOb2RlJ3MgY29kZSBzZWVtcyB0byBiZSBkb2luZyB0aGlzIGFuZCBub3QgJiAweDdGLi5cbiAgICAgICAgYnl0ZUFycmF5LnB1c2goc3RyLmNoYXJDb2RlQXQoaSkgJiAweEZGKTtcbiAgICB9XG4gICAgcmV0dXJuIGJ5dGVBcnJheTtcbn1cbmZ1bmN0aW9uIHV0ZjE2bGVUb0J5dGVzKHN0ciwgdW5pdHMpIHtcbiAgICB2YXIgYywgaGksIGxvO1xuICAgIHZhciBieXRlQXJyYXkgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN0ci5sZW5ndGg7ICsraSkge1xuICAgICAgICBpZiAoKHVuaXRzIC09IDIpIDwgMClcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjID0gc3RyLmNoYXJDb2RlQXQoaSk7XG4gICAgICAgIGhpID0gYyA+PiA4O1xuICAgICAgICBsbyA9IGMgJSAyNTY7XG4gICAgICAgIGJ5dGVBcnJheS5wdXNoKGxvKTtcbiAgICAgICAgYnl0ZUFycmF5LnB1c2goaGkpO1xuICAgIH1cbiAgICByZXR1cm4gYnl0ZUFycmF5O1xufVxuZnVuY3Rpb24gYmFzZTY0VG9CeXRlcyhzdHIpIHtcbiAgICByZXR1cm4gYmFzZTY0LnRvQnl0ZUFycmF5KGJhc2U2NGNsZWFuKHN0cikpO1xufVxuZnVuY3Rpb24gYmxpdEJ1ZmZlcihzcmMsIGRzdCwgb2Zmc2V0LCBsZW5ndGgpIHtcbiAgICB2YXIgaTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHtcbiAgICAgICAgaWYgKChpICsgb2Zmc2V0ID49IGRzdC5sZW5ndGgpIHx8IChpID49IHNyYy5sZW5ndGgpKVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRzdFtpICsgb2Zmc2V0XSA9IHNyY1tpXTtcbiAgICB9XG4gICAgcmV0dXJuIGk7XG59XG4vLyBBcnJheUJ1ZmZlciBvciBVaW50OEFycmF5IG9iamVjdHMgZnJvbSBvdGhlciBjb250ZXh0cyAoaS5lLiBpZnJhbWVzKSBkbyBub3QgcGFzc1xuLy8gdGhlIGBpbnN0YW5jZW9mYCBjaGVjayBidXQgdGhleSBzaG91bGQgYmUgdHJlYXRlZCBhcyBvZiB0aGF0IHR5cGUuXG4vLyBTZWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9mZXJvc3MvYnVmZmVyL2lzc3Vlcy8xNjZcbmZ1bmN0aW9uIGlzSW5zdGFuY2Uob2JqLCB0eXBlKSB7XG4gICAgcmV0dXJuIG9iaiBpbnN0YW5jZW9mIHR5cGUgfHxcbiAgICAgICAgKG9iaiAhPSBudWxsICYmIG9iai5jb25zdHJ1Y3RvciAhPSBudWxsICYmIG9iai5jb25zdHJ1Y3Rvci5uYW1lICE9IG51bGwgJiZcbiAgICAgICAgICAgIG9iai5jb25zdHJ1Y3Rvci5uYW1lID09PSB0eXBlLm5hbWUpO1xufVxuZnVuY3Rpb24gbnVtYmVySXNOYU4ob2JqKSB7XG4gICAgLy8gRm9yIElFMTEgc3VwcG9ydFxuICAgIHJldHVybiBvYmogIT09IG9iajsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1zZWxmLWNvbXBhcmVcbn1cbi8vIENyZWF0ZSBsb29rdXAgdGFibGUgZm9yIGB0b1N0cmluZygnaGV4JylgXG4vLyBTZWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9mZXJvc3MvYnVmZmVyL2lzc3Vlcy8yMTlcbnZhciBoZXhTbGljZUxvb2t1cFRhYmxlID0gKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgYWxwaGFiZXQgPSAnMDEyMzQ1Njc4OWFiY2RlZic7XG4gICAgdmFyIHRhYmxlID0gbmV3IEFycmF5KDI1Nik7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxNjsgKytpKSB7XG4gICAgICAgIHZhciBpMTYgPSBpICogMTY7XG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgMTY7ICsraikge1xuICAgICAgICAgICAgdGFibGVbaTE2ICsgal0gPSBhbHBoYWJldFtpXSArIGFscGhhYmV0W2pdO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0YWJsZTtcbn0pKCk7XG4vLyBSZXR1cm4gbm90IGZ1bmN0aW9uIHdpdGggRXJyb3IgaWYgQmlnSW50IG5vdCBzdXBwb3J0ZWRcbmZ1bmN0aW9uIGRlZmluZUJpZ0ludE1ldGhvZChmbikge1xuICAgIHJldHVybiB0eXBlb2YgQmlnSW50ID09PSAndW5kZWZpbmVkJyA/IEJ1ZmZlckJpZ0ludE5vdERlZmluZWQgOiBmbjtcbn1cbmZ1bmN0aW9uIEJ1ZmZlckJpZ0ludE5vdERlZmluZWQoKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdCaWdJbnQgbm90IHN1cHBvcnRlZCcpO1xufVxuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL0BmbHVlbmNlbGFicy9tYXJpbmUud29ya2VyLXNjcmlwdC8uLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vYnVmZmVyQDYuMC4zL25vZGVfbW9kdWxlcy9idWZmZXIvaW5kZXguanM/Iik7CgovKioqLyB9KSwKCi8qKiovICIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vZGVidWdANC4zLjQvbm9kZV9tb2R1bGVzL2RlYnVnL3NyYy9icm93c2VyLmpzIjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiAuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vZGVidWdANC4zLjQvbm9kZV9tb2R1bGVzL2RlYnVnL3NyYy9icm93c2VyLmpzICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgPT4gewoKZXZhbCgiXG4vKiBlc2xpbnQtZW52IGJyb3dzZXIgKi9cbi8qKlxuICogVGhpcyBpcyB0aGUgd2ViIGJyb3dzZXIgaW1wbGVtZW50YXRpb24gb2YgYGRlYnVnKClgLlxuICovXG5leHBvcnRzLmZvcm1hdEFyZ3MgPSBmb3JtYXRBcmdzO1xuZXhwb3J0cy5zYXZlID0gc2F2ZTtcbmV4cG9ydHMubG9hZCA9IGxvYWQ7XG5leHBvcnRzLnVzZUNvbG9ycyA9IHVzZUNvbG9ycztcbmV4cG9ydHMuc3RvcmFnZSA9IGxvY2Fsc3RvcmFnZSgpO1xuZXhwb3J0cy5kZXN0cm95ID0gKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgd2FybmVkID0gZmFsc2U7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF3YXJuZWQpIHtcbiAgICAgICAgICAgIHdhcm5lZCA9IHRydWU7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ0luc3RhbmNlIG1ldGhvZCBgZGVidWcuZGVzdHJveSgpYCBpcyBkZXByZWNhdGVkIGFuZCBubyBsb25nZXIgZG9lcyBhbnl0aGluZy4gSXQgd2lsbCBiZSByZW1vdmVkIGluIHRoZSBuZXh0IG1ham9yIHZlcnNpb24gb2YgYGRlYnVnYC4nKTtcbiAgICAgICAgfVxuICAgIH07XG59KSgpO1xuLyoqXG4gKiBDb2xvcnMuXG4gKi9cbmV4cG9ydHMuY29sb3JzID0gW1xuICAgICcjMDAwMENDJyxcbiAgICAnIzAwMDBGRicsXG4gICAgJyMwMDMzQ0MnLFxuICAgICcjMDAzM0ZGJyxcbiAgICAnIzAwNjZDQycsXG4gICAgJyMwMDY2RkYnLFxuICAgICcjMDA5OUNDJyxcbiAgICAnIzAwOTlGRicsXG4gICAgJyMwMENDMDAnLFxuICAgICcjMDBDQzMzJyxcbiAgICAnIzAwQ0M2NicsXG4gICAgJyMwMENDOTknLFxuICAgICcjMDBDQ0NDJyxcbiAgICAnIzAwQ0NGRicsXG4gICAgJyMzMzAwQ0MnLFxuICAgICcjMzMwMEZGJyxcbiAgICAnIzMzMzNDQycsXG4gICAgJyMzMzMzRkYnLFxuICAgICcjMzM2NkNDJyxcbiAgICAnIzMzNjZGRicsXG4gICAgJyMzMzk5Q0MnLFxuICAgICcjMzM5OUZGJyxcbiAgICAnIzMzQ0MwMCcsXG4gICAgJyMzM0NDMzMnLFxuICAgICcjMzNDQzY2JyxcbiAgICAnIzMzQ0M5OScsXG4gICAgJyMzM0NDQ0MnLFxuICAgICcjMzNDQ0ZGJyxcbiAgICAnIzY2MDBDQycsXG4gICAgJyM2NjAwRkYnLFxuICAgICcjNjYzM0NDJyxcbiAgICAnIzY2MzNGRicsXG4gICAgJyM2NkNDMDAnLFxuICAgICcjNjZDQzMzJyxcbiAgICAnIzk5MDBDQycsXG4gICAgJyM5OTAwRkYnLFxuICAgICcjOTkzM0NDJyxcbiAgICAnIzk5MzNGRicsXG4gICAgJyM5OUNDMDAnLFxuICAgICcjOTlDQzMzJyxcbiAgICAnI0NDMDAwMCcsXG4gICAgJyNDQzAwMzMnLFxuICAgICcjQ0MwMDY2JyxcbiAgICAnI0NDMDA5OScsXG4gICAgJyNDQzAwQ0MnLFxuICAgICcjQ0MwMEZGJyxcbiAgICAnI0NDMzMwMCcsXG4gICAgJyNDQzMzMzMnLFxuICAgICcjQ0MzMzY2JyxcbiAgICAnI0NDMzM5OScsXG4gICAgJyNDQzMzQ0MnLFxuICAgICcjQ0MzM0ZGJyxcbiAgICAnI0NDNjYwMCcsXG4gICAgJyNDQzY2MzMnLFxuICAgICcjQ0M5OTAwJyxcbiAgICAnI0NDOTkzMycsXG4gICAgJyNDQ0NDMDAnLFxuICAgICcjQ0NDQzMzJyxcbiAgICAnI0ZGMDAwMCcsXG4gICAgJyNGRjAwMzMnLFxuICAgICcjRkYwMDY2JyxcbiAgICAnI0ZGMDA5OScsXG4gICAgJyNGRjAwQ0MnLFxuICAgICcjRkYwMEZGJyxcbiAgICAnI0ZGMzMwMCcsXG4gICAgJyNGRjMzMzMnLFxuICAgICcjRkYzMzY2JyxcbiAgICAnI0ZGMzM5OScsXG4gICAgJyNGRjMzQ0MnLFxuICAgICcjRkYzM0ZGJyxcbiAgICAnI0ZGNjYwMCcsXG4gICAgJyNGRjY2MzMnLFxuICAgICcjRkY5OTAwJyxcbiAgICAnI0ZGOTkzMycsXG4gICAgJyNGRkNDMDAnLFxuICAgICcjRkZDQzMzJ1xuXTtcbi8qKlxuICogQ3VycmVudGx5IG9ubHkgV2ViS2l0LWJhc2VkIFdlYiBJbnNwZWN0b3JzLCBGaXJlZm94ID49IHYzMSxcbiAqIGFuZCB0aGUgRmlyZWJ1ZyBleHRlbnNpb24gKGFueSBGaXJlZm94IHZlcnNpb24pIGFyZSBrbm93blxuICogdG8gc3VwcG9ydCBcIiVjXCIgQ1NTIGN1c3RvbWl6YXRpb25zLlxuICpcbiAqIFRPRE86IGFkZCBhIGBsb2NhbFN0b3JhZ2VgIHZhcmlhYmxlIHRvIGV4cGxpY2l0bHkgZW5hYmxlL2Rpc2FibGUgY29sb3JzXG4gKi9cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBjb21wbGV4aXR5XG5mdW5jdGlvbiB1c2VDb2xvcnMoKSB7XG4gICAgLy8gTkI6IEluIGFuIEVsZWN0cm9uIHByZWxvYWQgc2NyaXB0LCBkb2N1bWVudCB3aWxsIGJlIGRlZmluZWQgYnV0IG5vdCBmdWxseVxuICAgIC8vIGluaXRpYWxpemVkLiBTaW5jZSB3ZSBrbm93IHdlJ3JlIGluIENocm9tZSwgd2UnbGwganVzdCBkZXRlY3QgdGhpcyBjYXNlXG4gICAgLy8gZXhwbGljaXRseVxuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cucHJvY2VzcyAmJiAod2luZG93LnByb2Nlc3MudHlwZSA9PT0gJ3JlbmRlcmVyJyB8fCB3aW5kb3cucHJvY2Vzcy5fX253anMpKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICAvLyBJbnRlcm5ldCBFeHBsb3JlciBhbmQgRWRnZSBkbyBub3Qgc3VwcG9ydCBjb2xvcnMuXG4gICAgaWYgKHR5cGVvZiBuYXZpZ2F0b3IgIT09ICd1bmRlZmluZWQnICYmIG5hdmlnYXRvci51c2VyQWdlbnQgJiYgbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpLm1hdGNoKC8oZWRnZXx0cmlkZW50KVxcLyhcXGQrKS8pKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgLy8gSXMgd2Via2l0PyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xNjQ1OTYwNi8zNzY3NzNcbiAgICAvLyBkb2N1bWVudCBpcyB1bmRlZmluZWQgaW4gcmVhY3QtbmF0aXZlOiBodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svcmVhY3QtbmF0aXZlL3B1bGwvMTYzMlxuICAgIHJldHVybiAodHlwZW9mIGRvY3VtZW50ICE9PSAndW5kZWZpbmVkJyAmJiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQgJiYgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlICYmIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5XZWJraXRBcHBlYXJhbmNlKSB8fFxuICAgICAgICAvLyBJcyBmaXJlYnVnPyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8zOTgxMjAvMzc2NzczXG4gICAgICAgICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cuY29uc29sZSAmJiAod2luZG93LmNvbnNvbGUuZmlyZWJ1ZyB8fCAod2luZG93LmNvbnNvbGUuZXhjZXB0aW9uICYmIHdpbmRvdy5jb25zb2xlLnRhYmxlKSkpIHx8XG4gICAgICAgIC8vIElzIGZpcmVmb3ggPj0gdjMxP1xuICAgICAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1Rvb2xzL1dlYl9Db25zb2xlI1N0eWxpbmdfbWVzc2FnZXNcbiAgICAgICAgKHR5cGVvZiBuYXZpZ2F0b3IgIT09ICd1bmRlZmluZWQnICYmIG5hdmlnYXRvci51c2VyQWdlbnQgJiYgbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpLm1hdGNoKC9maXJlZm94XFwvKFxcZCspLykgJiYgcGFyc2VJbnQoUmVnRXhwLiQxLCAxMCkgPj0gMzEpIHx8XG4gICAgICAgIC8vIERvdWJsZSBjaGVjayB3ZWJraXQgaW4gdXNlckFnZW50IGp1c3QgaW4gY2FzZSB3ZSBhcmUgaW4gYSB3b3JrZXJcbiAgICAgICAgKHR5cGVvZiBuYXZpZ2F0b3IgIT09ICd1bmRlZmluZWQnICYmIG5hdmlnYXRvci51c2VyQWdlbnQgJiYgbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpLm1hdGNoKC9hcHBsZXdlYmtpdFxcLyhcXGQrKS8pKTtcbn1cbi8qKlxuICogQ29sb3JpemUgbG9nIGFyZ3VtZW50cyBpZiBlbmFibGVkLlxuICpcbiAqIEBhcGkgcHVibGljXG4gKi9cbmZ1bmN0aW9uIGZvcm1hdEFyZ3MoYXJncykge1xuICAgIGFyZ3NbMF0gPSAodGhpcy51c2VDb2xvcnMgPyAnJWMnIDogJycpICtcbiAgICAgICAgdGhpcy5uYW1lc3BhY2UgK1xuICAgICAgICAodGhpcy51c2VDb2xvcnMgPyAnICVjJyA6ICcgJykgK1xuICAgICAgICBhcmdzWzBdICtcbiAgICAgICAgKHRoaXMudXNlQ29sb3JzID8gJyVjICcgOiAnICcpICtcbiAgICAgICAgJysnICsgbW9kdWxlLmV4cG9ydHMuaHVtYW5pemUodGhpcy5kaWZmKTtcbiAgICBpZiAoIXRoaXMudXNlQ29sb3JzKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIGMgPSAnY29sb3I6ICcgKyB0aGlzLmNvbG9yO1xuICAgIGFyZ3Muc3BsaWNlKDEsIDAsIGMsICdjb2xvcjogaW5oZXJpdCcpO1xuICAgIC8vIFRoZSBmaW5hbCBcIiVjXCIgaXMgc29tZXdoYXQgdHJpY2t5LCBiZWNhdXNlIHRoZXJlIGNvdWxkIGJlIG90aGVyXG4gICAgLy8gYXJndW1lbnRzIHBhc3NlZCBlaXRoZXIgYmVmb3JlIG9yIGFmdGVyIHRoZSAlYywgc28gd2UgbmVlZCB0b1xuICAgIC8vIGZpZ3VyZSBvdXQgdGhlIGNvcnJlY3QgaW5kZXggdG8gaW5zZXJ0IHRoZSBDU1MgaW50b1xuICAgIHZhciBpbmRleCA9IDA7XG4gICAgdmFyIGxhc3RDID0gMDtcbiAgICBhcmdzWzBdLnJlcGxhY2UoLyVbYS16QS1aJV0vZywgZnVuY3Rpb24gKG1hdGNoKSB7XG4gICAgICAgIGlmIChtYXRjaCA9PT0gJyUlJykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGluZGV4Kys7XG4gICAgICAgIGlmIChtYXRjaCA9PT0gJyVjJykge1xuICAgICAgICAgICAgLy8gV2Ugb25seSBhcmUgaW50ZXJlc3RlZCBpbiB0aGUgKmxhc3QqICVjXG4gICAgICAgICAgICAvLyAodGhlIHVzZXIgbWF5IGhhdmUgcHJvdmlkZWQgdGhlaXIgb3duKVxuICAgICAgICAgICAgbGFzdEMgPSBpbmRleDtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIGFyZ3Muc3BsaWNlKGxhc3RDLCAwLCBjKTtcbn1cbi8qKlxuICogSW52b2tlcyBgY29uc29sZS5kZWJ1ZygpYCB3aGVuIGF2YWlsYWJsZS5cbiAqIE5vLW9wIHdoZW4gYGNvbnNvbGUuZGVidWdgIGlzIG5vdCBhIFwiZnVuY3Rpb25cIi5cbiAqIElmIGBjb25zb2xlLmRlYnVnYCBpcyBub3QgYXZhaWxhYmxlLCBmYWxscyBiYWNrXG4gKiB0byBgY29uc29sZS5sb2dgLlxuICpcbiAqIEBhcGkgcHVibGljXG4gKi9cbmV4cG9ydHMubG9nID0gY29uc29sZS5kZWJ1ZyB8fCBjb25zb2xlLmxvZyB8fCAoZnVuY3Rpb24gKCkgeyB9KTtcbi8qKlxuICogU2F2ZSBgbmFtZXNwYWNlc2AuXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IG5hbWVzcGFjZXNcbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5mdW5jdGlvbiBzYXZlKG5hbWVzcGFjZXMpIHtcbiAgICB0cnkge1xuICAgICAgICBpZiAobmFtZXNwYWNlcykge1xuICAgICAgICAgICAgZXhwb3J0cy5zdG9yYWdlLnNldEl0ZW0oJ2RlYnVnJywgbmFtZXNwYWNlcyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBleHBvcnRzLnN0b3JhZ2UucmVtb3ZlSXRlbSgnZGVidWcnKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgLy8gU3dhbGxvd1xuICAgICAgICAvLyBYWFggKEBRaXgtKSBzaG91bGQgd2UgYmUgbG9nZ2luZyB0aGVzZT9cbiAgICB9XG59XG4vKipcbiAqIExvYWQgYG5hbWVzcGFjZXNgLlxuICpcbiAqIEByZXR1cm4ge1N0cmluZ30gcmV0dXJucyB0aGUgcHJldmlvdXNseSBwZXJzaXN0ZWQgZGVidWcgbW9kZXNcbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5mdW5jdGlvbiBsb2FkKCkge1xuICAgIHZhciByO1xuICAgIHRyeSB7XG4gICAgICAgIHIgPSBleHBvcnRzLnN0b3JhZ2UuZ2V0SXRlbSgnZGVidWcnKTtcbiAgICB9XG4gICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIC8vIFN3YWxsb3dcbiAgICAgICAgLy8gWFhYIChAUWl4LSkgc2hvdWxkIHdlIGJlIGxvZ2dpbmcgdGhlc2U/XG4gICAgfVxuICAgIC8vIElmIGRlYnVnIGlzbid0IHNldCBpbiBMUywgYW5kIHdlJ3JlIGluIEVsZWN0cm9uLCB0cnkgdG8gbG9hZCAkREVCVUdcbiAgICBpZiAoIXIgJiYgdHlwZW9mIHByb2Nlc3MgIT09ICd1bmRlZmluZWQnICYmICdlbnYnIGluIHByb2Nlc3MpIHtcbiAgICAgICAgciA9IHByb2Nlc3MuZW52LkRFQlVHO1xuICAgIH1cbiAgICByZXR1cm4gcjtcbn1cbi8qKlxuICogTG9jYWxzdG9yYWdlIGF0dGVtcHRzIHRvIHJldHVybiB0aGUgbG9jYWxzdG9yYWdlLlxuICpcbiAqIFRoaXMgaXMgbmVjZXNzYXJ5IGJlY2F1c2Ugc2FmYXJpIHRocm93c1xuICogd2hlbiBhIHVzZXIgZGlzYWJsZXMgY29va2llcy9sb2NhbHN0b3JhZ2VcbiAqIGFuZCB5b3UgYXR0ZW1wdCB0byBhY2Nlc3MgaXQuXG4gKlxuICogQHJldHVybiB7TG9jYWxTdG9yYWdlfVxuICogQGFwaSBwcml2YXRlXG4gKi9cbmZ1bmN0aW9uIGxvY2Fsc3RvcmFnZSgpIHtcbiAgICB0cnkge1xuICAgICAgICAvLyBUVk1MS2l0IChBcHBsZSBUViBKUyBSdW50aW1lKSBkb2VzIG5vdCBoYXZlIGEgd2luZG93IG9iamVjdCwganVzdCBsb2NhbFN0b3JhZ2UgaW4gdGhlIGdsb2JhbCBjb250ZXh0XG4gICAgICAgIC8vIFRoZSBCcm93c2VyIGFsc28gaGFzIGxvY2FsU3RvcmFnZSBpbiB0aGUgZ2xvYmFsIGNvbnRleHQuXG4gICAgICAgIHJldHVybiBsb2NhbFN0b3JhZ2U7XG4gICAgfVxuICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAvLyBTd2FsbG93XG4gICAgICAgIC8vIFhYWCAoQFFpeC0pIHNob3VsZCB3ZSBiZSBsb2dnaW5nIHRoZXNlP1xuICAgIH1cbn1cbm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9jb21tb24gKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vZGVidWdANC4zLjQvbm9kZV9tb2R1bGVzL2RlYnVnL3NyYy9jb21tb24uanNcIikoZXhwb3J0cyk7XG52YXIgZm9ybWF0dGVycyA9IG1vZHVsZS5leHBvcnRzLmZvcm1hdHRlcnM7XG4vKipcbiAqIE1hcCAlaiB0byBgSlNPTi5zdHJpbmdpZnkoKWAsIHNpbmNlIG5vIFdlYiBJbnNwZWN0b3JzIGRvIHRoYXQgYnkgZGVmYXVsdC5cbiAqL1xuZm9ybWF0dGVycy5qID0gZnVuY3Rpb24gKHYpIHtcbiAgICB0cnkge1xuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodik7XG4gICAgfVxuICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICByZXR1cm4gJ1tVbmV4cGVjdGVkSlNPTlBhcnNlRXJyb3JdOiAnICsgZXJyb3IubWVzc2FnZTtcbiAgICB9XG59O1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL0BmbHVlbmNlbGFicy9tYXJpbmUud29ya2VyLXNjcmlwdC8uLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vZGVidWdANC4zLjQvbm9kZV9tb2R1bGVzL2RlYnVnL3NyYy9icm93c2VyLmpzPyIpOwoKLyoqKi8gfSksCgovKioqLyAiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL2RlYnVnQDQuMy40L25vZGVfbW9kdWxlcy9kZWJ1Zy9zcmMvY29tbW9uLmpzIjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAhKioqIC4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9kZWJ1Z0A0LjMuNC9ub2RlX21vZHVsZXMvZGVidWcvc3JjL2NvbW1vbi5qcyAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCmV2YWwoIlxuLyoqXG4gKiBUaGlzIGlzIHRoZSBjb21tb24gbG9naWMgZm9yIGJvdGggdGhlIE5vZGUuanMgYW5kIHdlYiBicm93c2VyXG4gKiBpbXBsZW1lbnRhdGlvbnMgb2YgYGRlYnVnKClgLlxuICovXG52YXIgX19zcHJlYWRBcnJheSA9ICh0aGlzICYmIHRoaXMuX19zcHJlYWRBcnJheSkgfHwgZnVuY3Rpb24gKHRvLCBmcm9tLCBwYWNrKSB7XG4gICAgaWYgKHBhY2sgfHwgYXJndW1lbnRzLmxlbmd0aCA9PT0gMikgZm9yICh2YXIgaSA9IDAsIGwgPSBmcm9tLmxlbmd0aCwgYXI7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgaWYgKGFyIHx8ICEoaSBpbiBmcm9tKSkge1xuICAgICAgICAgICAgaWYgKCFhcikgYXIgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tLCAwLCBpKTtcbiAgICAgICAgICAgIGFyW2ldID0gZnJvbVtpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdG8uY29uY2F0KGFyIHx8IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20pKTtcbn07XG5mdW5jdGlvbiBzZXR1cChlbnYpIHtcbiAgICBjcmVhdGVEZWJ1Zy5kZWJ1ZyA9IGNyZWF0ZURlYnVnO1xuICAgIGNyZWF0ZURlYnVnLmRlZmF1bHQgPSBjcmVhdGVEZWJ1ZztcbiAgICBjcmVhdGVEZWJ1Zy5jb2VyY2UgPSBjb2VyY2U7XG4gICAgY3JlYXRlRGVidWcuZGlzYWJsZSA9IGRpc2FibGU7XG4gICAgY3JlYXRlRGVidWcuZW5hYmxlID0gZW5hYmxlO1xuICAgIGNyZWF0ZURlYnVnLmVuYWJsZWQgPSBlbmFibGVkO1xuICAgIGNyZWF0ZURlYnVnLmh1bWFuaXplID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgbXMgKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vbXNAMi4xLjIvbm9kZV9tb2R1bGVzL21zL2luZGV4LmpzXCIpO1xuICAgIGNyZWF0ZURlYnVnLmRlc3Ryb3kgPSBkZXN0cm95O1xuICAgIE9iamVjdC5rZXlzKGVudikuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIGNyZWF0ZURlYnVnW2tleV0gPSBlbnZba2V5XTtcbiAgICB9KTtcbiAgICAvKipcbiAgICAqIFRoZSBjdXJyZW50bHkgYWN0aXZlIGRlYnVnIG1vZGUgbmFtZXMsIGFuZCBuYW1lcyB0byBza2lwLlxuICAgICovXG4gICAgY3JlYXRlRGVidWcubmFtZXMgPSBbXTtcbiAgICBjcmVhdGVEZWJ1Zy5za2lwcyA9IFtdO1xuICAgIC8qKlxuICAgICogTWFwIG9mIHNwZWNpYWwgXCIlblwiIGhhbmRsaW5nIGZ1bmN0aW9ucywgZm9yIHRoZSBkZWJ1ZyBcImZvcm1hdFwiIGFyZ3VtZW50LlxuICAgICpcbiAgICAqIFZhbGlkIGtleSBuYW1lcyBhcmUgYSBzaW5nbGUsIGxvd2VyIG9yIHVwcGVyLWNhc2UgbGV0dGVyLCBpLmUuIFwiblwiIGFuZCBcIk5cIi5cbiAgICAqL1xuICAgIGNyZWF0ZURlYnVnLmZvcm1hdHRlcnMgPSB7fTtcbiAgICAvKipcbiAgICAqIFNlbGVjdHMgYSBjb2xvciBmb3IgYSBkZWJ1ZyBuYW1lc3BhY2VcbiAgICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lc3BhY2UgVGhlIG5hbWVzcGFjZSBzdHJpbmcgZm9yIHRoZSBkZWJ1ZyBpbnN0YW5jZSB0byBiZSBjb2xvcmVkXG4gICAgKiBAcmV0dXJuIHtOdW1iZXJ8U3RyaW5nfSBBbiBBTlNJIGNvbG9yIGNvZGUgZm9yIHRoZSBnaXZlbiBuYW1lc3BhY2VcbiAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICovXG4gICAgZnVuY3Rpb24gc2VsZWN0Q29sb3IobmFtZXNwYWNlKSB7XG4gICAgICAgIHZhciBoYXNoID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuYW1lc3BhY2UubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGhhc2ggPSAoKGhhc2ggPDwgNSkgLSBoYXNoKSArIG5hbWVzcGFjZS5jaGFyQ29kZUF0KGkpO1xuICAgICAgICAgICAgaGFzaCB8PSAwOyAvLyBDb252ZXJ0IHRvIDMyYml0IGludGVnZXJcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY3JlYXRlRGVidWcuY29sb3JzW01hdGguYWJzKGhhc2gpICUgY3JlYXRlRGVidWcuY29sb3JzLmxlbmd0aF07XG4gICAgfVxuICAgIGNyZWF0ZURlYnVnLnNlbGVjdENvbG9yID0gc2VsZWN0Q29sb3I7XG4gICAgLyoqXG4gICAgKiBDcmVhdGUgYSBkZWJ1Z2dlciB3aXRoIHRoZSBnaXZlbiBgbmFtZXNwYWNlYC5cbiAgICAqXG4gICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZXNwYWNlXG4gICAgKiBAcmV0dXJuIHtGdW5jdGlvbn1cbiAgICAqIEBhcGkgcHVibGljXG4gICAgKi9cbiAgICBmdW5jdGlvbiBjcmVhdGVEZWJ1ZyhuYW1lc3BhY2UpIHtcbiAgICAgICAgdmFyIHByZXZUaW1lO1xuICAgICAgICB2YXIgZW5hYmxlT3ZlcnJpZGUgPSBudWxsO1xuICAgICAgICB2YXIgbmFtZXNwYWNlc0NhY2hlO1xuICAgICAgICB2YXIgZW5hYmxlZENhY2hlO1xuICAgICAgICBmdW5jdGlvbiBkZWJ1ZygpIHtcbiAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIERpc2FibGVkP1xuICAgICAgICAgICAgaWYgKCFkZWJ1Zy5lbmFibGVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHNlbGYgPSBkZWJ1ZztcbiAgICAgICAgICAgIC8vIFNldCBgZGlmZmAgdGltZXN0YW1wXG4gICAgICAgICAgICB2YXIgY3VyciA9IE51bWJlcihuZXcgRGF0ZSgpKTtcbiAgICAgICAgICAgIHZhciBtcyA9IGN1cnIgLSAocHJldlRpbWUgfHwgY3Vycik7XG4gICAgICAgICAgICBzZWxmLmRpZmYgPSBtcztcbiAgICAgICAgICAgIHNlbGYucHJldiA9IHByZXZUaW1lO1xuICAgICAgICAgICAgc2VsZi5jdXJyID0gY3VycjtcbiAgICAgICAgICAgIHByZXZUaW1lID0gY3VycjtcbiAgICAgICAgICAgIGFyZ3NbMF0gPSBjcmVhdGVEZWJ1Zy5jb2VyY2UoYXJnc1swXSk7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGFyZ3NbMF0gIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgLy8gQW55dGhpbmcgZWxzZSBsZXQncyBpbnNwZWN0IHdpdGggJU9cbiAgICAgICAgICAgICAgICBhcmdzLnVuc2hpZnQoJyVPJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBBcHBseSBhbnkgYGZvcm1hdHRlcnNgIHRyYW5zZm9ybWF0aW9uc1xuICAgICAgICAgICAgdmFyIGluZGV4ID0gMDtcbiAgICAgICAgICAgIGFyZ3NbMF0gPSBhcmdzWzBdLnJlcGxhY2UoLyUoW2EtekEtWiVdKS9nLCBmdW5jdGlvbiAobWF0Y2gsIGZvcm1hdCkge1xuICAgICAgICAgICAgICAgIC8vIElmIHdlIGVuY291bnRlciBhbiBlc2NhcGVkICUgdGhlbiBkb24ndCBpbmNyZWFzZSB0aGUgYXJyYXkgaW5kZXhcbiAgICAgICAgICAgICAgICBpZiAobWF0Y2ggPT09ICclJScpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICclJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaW5kZXgrKztcbiAgICAgICAgICAgICAgICB2YXIgZm9ybWF0dGVyID0gY3JlYXRlRGVidWcuZm9ybWF0dGVyc1tmb3JtYXRdO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZm9ybWF0dGVyID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB2YWwgPSBhcmdzW2luZGV4XTtcbiAgICAgICAgICAgICAgICAgICAgbWF0Y2ggPSBmb3JtYXR0ZXIuY2FsbChzZWxmLCB2YWwpO1xuICAgICAgICAgICAgICAgICAgICAvLyBOb3cgd2UgbmVlZCB0byByZW1vdmUgYGFyZ3NbaW5kZXhdYCBzaW5jZSBpdCdzIGlubGluZWQgaW4gdGhlIGBmb3JtYXRgXG4gICAgICAgICAgICAgICAgICAgIGFyZ3Muc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICAgICAgaW5kZXgtLTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1hdGNoO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvLyBBcHBseSBlbnYtc3BlY2lmaWMgZm9ybWF0dGluZyAoY29sb3JzLCBldGMuKVxuICAgICAgICAgICAgY3JlYXRlRGVidWcuZm9ybWF0QXJncy5jYWxsKHNlbGYsIGFyZ3MpO1xuICAgICAgICAgICAgdmFyIGxvZ0ZuID0gc2VsZi5sb2cgfHwgY3JlYXRlRGVidWcubG9nO1xuICAgICAgICAgICAgbG9nRm4uYXBwbHkoc2VsZiwgYXJncyk7XG4gICAgICAgIH1cbiAgICAgICAgZGVidWcubmFtZXNwYWNlID0gbmFtZXNwYWNlO1xuICAgICAgICBkZWJ1Zy51c2VDb2xvcnMgPSBjcmVhdGVEZWJ1Zy51c2VDb2xvcnMoKTtcbiAgICAgICAgZGVidWcuY29sb3IgPSBjcmVhdGVEZWJ1Zy5zZWxlY3RDb2xvcihuYW1lc3BhY2UpO1xuICAgICAgICBkZWJ1Zy5leHRlbmQgPSBleHRlbmQ7XG4gICAgICAgIGRlYnVnLmRlc3Ryb3kgPSBjcmVhdGVEZWJ1Zy5kZXN0cm95OyAvLyBYWFggVGVtcG9yYXJ5LiBXaWxsIGJlIHJlbW92ZWQgaW4gdGhlIG5leHQgbWFqb3IgcmVsZWFzZS5cbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGRlYnVnLCAnZW5hYmxlZCcsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IGZhbHNlLFxuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKGVuYWJsZU92ZXJyaWRlICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBlbmFibGVPdmVycmlkZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG5hbWVzcGFjZXNDYWNoZSAhPT0gY3JlYXRlRGVidWcubmFtZXNwYWNlcykge1xuICAgICAgICAgICAgICAgICAgICBuYW1lc3BhY2VzQ2FjaGUgPSBjcmVhdGVEZWJ1Zy5uYW1lc3BhY2VzO1xuICAgICAgICAgICAgICAgICAgICBlbmFibGVkQ2FjaGUgPSBjcmVhdGVEZWJ1Zy5lbmFibGVkKG5hbWVzcGFjZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBlbmFibGVkQ2FjaGU7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiAodikge1xuICAgICAgICAgICAgICAgIGVuYWJsZU92ZXJyaWRlID0gdjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIC8vIEVudi1zcGVjaWZpYyBpbml0aWFsaXphdGlvbiBsb2dpYyBmb3IgZGVidWcgaW5zdGFuY2VzXG4gICAgICAgIGlmICh0eXBlb2YgY3JlYXRlRGVidWcuaW5pdCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgY3JlYXRlRGVidWcuaW5pdChkZWJ1Zyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRlYnVnO1xuICAgIH1cbiAgICBmdW5jdGlvbiBleHRlbmQobmFtZXNwYWNlLCBkZWxpbWl0ZXIpIHtcbiAgICAgICAgdmFyIG5ld0RlYnVnID0gY3JlYXRlRGVidWcodGhpcy5uYW1lc3BhY2UgKyAodHlwZW9mIGRlbGltaXRlciA9PT0gJ3VuZGVmaW5lZCcgPyAnOicgOiBkZWxpbWl0ZXIpICsgbmFtZXNwYWNlKTtcbiAgICAgICAgbmV3RGVidWcubG9nID0gdGhpcy5sb2c7XG4gICAgICAgIHJldHVybiBuZXdEZWJ1ZztcbiAgICB9XG4gICAgLyoqXG4gICAgKiBFbmFibGVzIGEgZGVidWcgbW9kZSBieSBuYW1lc3BhY2VzLiBUaGlzIGNhbiBpbmNsdWRlIG1vZGVzXG4gICAgKiBzZXBhcmF0ZWQgYnkgYSBjb2xvbiBhbmQgd2lsZGNhcmRzLlxuICAgICpcbiAgICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lc3BhY2VzXG4gICAgKiBAYXBpIHB1YmxpY1xuICAgICovXG4gICAgZnVuY3Rpb24gZW5hYmxlKG5hbWVzcGFjZXMpIHtcbiAgICAgICAgY3JlYXRlRGVidWcuc2F2ZShuYW1lc3BhY2VzKTtcbiAgICAgICAgY3JlYXRlRGVidWcubmFtZXNwYWNlcyA9IG5hbWVzcGFjZXM7XG4gICAgICAgIGNyZWF0ZURlYnVnLm5hbWVzID0gW107XG4gICAgICAgIGNyZWF0ZURlYnVnLnNraXBzID0gW107XG4gICAgICAgIHZhciBpO1xuICAgICAgICB2YXIgc3BsaXQgPSAodHlwZW9mIG5hbWVzcGFjZXMgPT09ICdzdHJpbmcnID8gbmFtZXNwYWNlcyA6ICcnKS5zcGxpdCgvW1xccyxdKy8pO1xuICAgICAgICB2YXIgbGVuID0gc3BsaXQubGVuZ3RoO1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIGlmICghc3BsaXRbaV0pIHtcbiAgICAgICAgICAgICAgICAvLyBpZ25vcmUgZW1wdHkgc3RyaW5nc1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbmFtZXNwYWNlcyA9IHNwbGl0W2ldLnJlcGxhY2UoL1xcKi9nLCAnLio/Jyk7XG4gICAgICAgICAgICBpZiAobmFtZXNwYWNlc1swXSA9PT0gJy0nKSB7XG4gICAgICAgICAgICAgICAgY3JlYXRlRGVidWcuc2tpcHMucHVzaChuZXcgUmVnRXhwKCdeJyArIG5hbWVzcGFjZXMuc2xpY2UoMSkgKyAnJCcpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNyZWF0ZURlYnVnLm5hbWVzLnB1c2gobmV3IFJlZ0V4cCgnXicgKyBuYW1lc3BhY2VzICsgJyQnKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgKiBEaXNhYmxlIGRlYnVnIG91dHB1dC5cbiAgICAqXG4gICAgKiBAcmV0dXJuIHtTdHJpbmd9IG5hbWVzcGFjZXNcbiAgICAqIEBhcGkgcHVibGljXG4gICAgKi9cbiAgICBmdW5jdGlvbiBkaXNhYmxlKCkge1xuICAgICAgICB2YXIgbmFtZXNwYWNlcyA9IF9fc3ByZWFkQXJyYXkoX19zcHJlYWRBcnJheShbXSwgY3JlYXRlRGVidWcubmFtZXMubWFwKHRvTmFtZXNwYWNlKSwgdHJ1ZSksIGNyZWF0ZURlYnVnLnNraXBzLm1hcCh0b05hbWVzcGFjZSkubWFwKGZ1bmN0aW9uIChuYW1lc3BhY2UpIHsgcmV0dXJuICctJyArIG5hbWVzcGFjZTsgfSksIHRydWUpLmpvaW4oJywnKTtcbiAgICAgICAgY3JlYXRlRGVidWcuZW5hYmxlKCcnKTtcbiAgICAgICAgcmV0dXJuIG5hbWVzcGFjZXM7XG4gICAgfVxuICAgIC8qKlxuICAgICogUmV0dXJucyB0cnVlIGlmIHRoZSBnaXZlbiBtb2RlIG5hbWUgaXMgZW5hYmxlZCwgZmFsc2Ugb3RoZXJ3aXNlLlxuICAgICpcbiAgICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lXG4gICAgKiBAcmV0dXJuIHtCb29sZWFufVxuICAgICogQGFwaSBwdWJsaWNcbiAgICAqL1xuICAgIGZ1bmN0aW9uIGVuYWJsZWQobmFtZSkge1xuICAgICAgICBpZiAobmFtZVtuYW1lLmxlbmd0aCAtIDFdID09PSAnKicpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpO1xuICAgICAgICB2YXIgbGVuO1xuICAgICAgICBmb3IgKGkgPSAwLCBsZW4gPSBjcmVhdGVEZWJ1Zy5za2lwcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgaWYgKGNyZWF0ZURlYnVnLnNraXBzW2ldLnRlc3QobmFtZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChpID0gMCwgbGVuID0gY3JlYXRlRGVidWcubmFtZXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChjcmVhdGVEZWJ1Zy5uYW1lc1tpXS50ZXN0KG5hbWUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICAvKipcbiAgICAqIENvbnZlcnQgcmVnZXhwIHRvIG5hbWVzcGFjZVxuICAgICpcbiAgICAqIEBwYXJhbSB7UmVnRXhwfSByZWd4ZXBcbiAgICAqIEByZXR1cm4ge1N0cmluZ30gbmFtZXNwYWNlXG4gICAgKiBAYXBpIHByaXZhdGVcbiAgICAqL1xuICAgIGZ1bmN0aW9uIHRvTmFtZXNwYWNlKHJlZ2V4cCkge1xuICAgICAgICByZXR1cm4gcmVnZXhwLnRvU3RyaW5nKClcbiAgICAgICAgICAgIC5zdWJzdHJpbmcoMiwgcmVnZXhwLnRvU3RyaW5nKCkubGVuZ3RoIC0gMilcbiAgICAgICAgICAgIC5yZXBsYWNlKC9cXC5cXCpcXD8kLywgJyonKTtcbiAgICB9XG4gICAgLyoqXG4gICAgKiBDb2VyY2UgYHZhbGAuXG4gICAgKlxuICAgICogQHBhcmFtIHtNaXhlZH0gdmFsXG4gICAgKiBAcmV0dXJuIHtNaXhlZH1cbiAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICovXG4gICAgZnVuY3Rpb24gY29lcmNlKHZhbCkge1xuICAgICAgICBpZiAodmFsIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB2YWwuc3RhY2sgfHwgdmFsLm1lc3NhZ2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbDtcbiAgICB9XG4gICAgLyoqXG4gICAgKiBYWFggRE8gTk9UIFVTRS4gVGhpcyBpcyBhIHRlbXBvcmFyeSBzdHViIGZ1bmN0aW9uLlxuICAgICogWFhYIEl0IFdJTEwgYmUgcmVtb3ZlZCBpbiB0aGUgbmV4dCBtYWpvciByZWxlYXNlLlxuICAgICovXG4gICAgZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdJbnN0YW5jZSBtZXRob2QgYGRlYnVnLmRlc3Ryb3koKWAgaXMgZGVwcmVjYXRlZCBhbmQgbm8gbG9uZ2VyIGRvZXMgYW55dGhpbmcuIEl0IHdpbGwgYmUgcmVtb3ZlZCBpbiB0aGUgbmV4dCBtYWpvciB2ZXJzaW9uIG9mIGBkZWJ1Z2AuJyk7XG4gICAgfVxuICAgIGNyZWF0ZURlYnVnLmVuYWJsZShjcmVhdGVEZWJ1Zy5sb2FkKCkpO1xuICAgIHJldHVybiBjcmVhdGVEZWJ1Zztcbn1cbm1vZHVsZS5leHBvcnRzID0gc2V0dXA7XG5cblxuLy8jIHNvdXJjZVVSTD13ZWJwYWNrOi8vQGZsdWVuY2VsYWJzL21hcmluZS53b3JrZXItc2NyaXB0Ly4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9kZWJ1Z0A0LjMuNC9ub2RlX21vZHVsZXMvZGVidWcvc3JjL2NvbW1vbi5qcz8iKTsKCi8qKiovIH0pLAoKLyoqKi8gIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9pZWVlNzU0QDEuMi4xL25vZGVfbW9kdWxlcy9pZWVlNzU0L2luZGV4LmpzIjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL2llZWU3NTRAMS4yLjEvbm9kZV9tb2R1bGVzL2llZWU3NTQvaW5kZXguanMgKioqIQogIFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSA9PiB7CgpldmFsKCJcbi8qISBpZWVlNzU0LiBCU0QtMy1DbGF1c2UgTGljZW5zZS4gRmVyb3NzIEFib3VraGFkaWplaCA8aHR0cHM6Ly9mZXJvc3Mub3JnL29wZW5zb3VyY2U+ICovXG5leHBvcnRzLnJlYWQgPSBmdW5jdGlvbiAoYnVmZmVyLCBvZmZzZXQsIGlzTEUsIG1MZW4sIG5CeXRlcykge1xuICAgIHZhciBlLCBtO1xuICAgIHZhciBlTGVuID0gKG5CeXRlcyAqIDgpIC0gbUxlbiAtIDE7XG4gICAgdmFyIGVNYXggPSAoMSA8PCBlTGVuKSAtIDE7XG4gICAgdmFyIGVCaWFzID0gZU1heCA+PiAxO1xuICAgIHZhciBuQml0cyA9IC03O1xuICAgIHZhciBpID0gaXNMRSA/IChuQnl0ZXMgLSAxKSA6IDA7XG4gICAgdmFyIGQgPSBpc0xFID8gLTEgOiAxO1xuICAgIHZhciBzID0gYnVmZmVyW29mZnNldCArIGldO1xuICAgIGkgKz0gZDtcbiAgICBlID0gcyAmICgoMSA8PCAoLW5CaXRzKSkgLSAxKTtcbiAgICBzID4+PSAoLW5CaXRzKTtcbiAgICBuQml0cyArPSBlTGVuO1xuICAgIGZvciAoOyBuQml0cyA+IDA7IGUgPSAoZSAqIDI1NikgKyBidWZmZXJbb2Zmc2V0ICsgaV0sIGkgKz0gZCwgbkJpdHMgLT0gOCkgeyB9XG4gICAgbSA9IGUgJiAoKDEgPDwgKC1uQml0cykpIC0gMSk7XG4gICAgZSA+Pj0gKC1uQml0cyk7XG4gICAgbkJpdHMgKz0gbUxlbjtcbiAgICBmb3IgKDsgbkJpdHMgPiAwOyBtID0gKG0gKiAyNTYpICsgYnVmZmVyW29mZnNldCArIGldLCBpICs9IGQsIG5CaXRzIC09IDgpIHsgfVxuICAgIGlmIChlID09PSAwKSB7XG4gICAgICAgIGUgPSAxIC0gZUJpYXM7XG4gICAgfVxuICAgIGVsc2UgaWYgKGUgPT09IGVNYXgpIHtcbiAgICAgICAgcmV0dXJuIG0gPyBOYU4gOiAoKHMgPyAtMSA6IDEpICogSW5maW5pdHkpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgbSA9IG0gKyBNYXRoLnBvdygyLCBtTGVuKTtcbiAgICAgICAgZSA9IGUgLSBlQmlhcztcbiAgICB9XG4gICAgcmV0dXJuIChzID8gLTEgOiAxKSAqIG0gKiBNYXRoLnBvdygyLCBlIC0gbUxlbik7XG59O1xuZXhwb3J0cy53cml0ZSA9IGZ1bmN0aW9uIChidWZmZXIsIHZhbHVlLCBvZmZzZXQsIGlzTEUsIG1MZW4sIG5CeXRlcykge1xuICAgIHZhciBlLCBtLCBjO1xuICAgIHZhciBlTGVuID0gKG5CeXRlcyAqIDgpIC0gbUxlbiAtIDE7XG4gICAgdmFyIGVNYXggPSAoMSA8PCBlTGVuKSAtIDE7XG4gICAgdmFyIGVCaWFzID0gZU1heCA+PiAxO1xuICAgIHZhciBydCA9IChtTGVuID09PSAyMyA/IE1hdGgucG93KDIsIC0yNCkgLSBNYXRoLnBvdygyLCAtNzcpIDogMCk7XG4gICAgdmFyIGkgPSBpc0xFID8gMCA6IChuQnl0ZXMgLSAxKTtcbiAgICB2YXIgZCA9IGlzTEUgPyAxIDogLTE7XG4gICAgdmFyIHMgPSB2YWx1ZSA8IDAgfHwgKHZhbHVlID09PSAwICYmIDEgLyB2YWx1ZSA8IDApID8gMSA6IDA7XG4gICAgdmFsdWUgPSBNYXRoLmFicyh2YWx1ZSk7XG4gICAgaWYgKGlzTmFOKHZhbHVlKSB8fCB2YWx1ZSA9PT0gSW5maW5pdHkpIHtcbiAgICAgICAgbSA9IGlzTmFOKHZhbHVlKSA/IDEgOiAwO1xuICAgICAgICBlID0gZU1heDtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGUgPSBNYXRoLmZsb29yKE1hdGgubG9nKHZhbHVlKSAvIE1hdGguTE4yKTtcbiAgICAgICAgaWYgKHZhbHVlICogKGMgPSBNYXRoLnBvdygyLCAtZSkpIDwgMSkge1xuICAgICAgICAgICAgZS0tO1xuICAgICAgICAgICAgYyAqPSAyO1xuICAgICAgICB9XG4gICAgICAgIGlmIChlICsgZUJpYXMgPj0gMSkge1xuICAgICAgICAgICAgdmFsdWUgKz0gcnQgLyBjO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFsdWUgKz0gcnQgKiBNYXRoLnBvdygyLCAxIC0gZUJpYXMpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2YWx1ZSAqIGMgPj0gMikge1xuICAgICAgICAgICAgZSsrO1xuICAgICAgICAgICAgYyAvPSAyO1xuICAgICAgICB9XG4gICAgICAgIGlmIChlICsgZUJpYXMgPj0gZU1heCkge1xuICAgICAgICAgICAgbSA9IDA7XG4gICAgICAgICAgICBlID0gZU1heDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChlICsgZUJpYXMgPj0gMSkge1xuICAgICAgICAgICAgbSA9ICgodmFsdWUgKiBjKSAtIDEpICogTWF0aC5wb3coMiwgbUxlbik7XG4gICAgICAgICAgICBlID0gZSArIGVCaWFzO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbSA9IHZhbHVlICogTWF0aC5wb3coMiwgZUJpYXMgLSAxKSAqIE1hdGgucG93KDIsIG1MZW4pO1xuICAgICAgICAgICAgZSA9IDA7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZm9yICg7IG1MZW4gPj0gODsgYnVmZmVyW29mZnNldCArIGldID0gbSAmIDB4ZmYsIGkgKz0gZCwgbSAvPSAyNTYsIG1MZW4gLT0gOCkgeyB9XG4gICAgZSA9IChlIDw8IG1MZW4pIHwgbTtcbiAgICBlTGVuICs9IG1MZW47XG4gICAgZm9yICg7IGVMZW4gPiAwOyBidWZmZXJbb2Zmc2V0ICsgaV0gPSBlICYgMHhmZiwgaSArPSBkLCBlIC89IDI1NiwgZUxlbiAtPSA4KSB7IH1cbiAgICBidWZmZXJbb2Zmc2V0ICsgaSAtIGRdIHw9IHMgKiAxMjg7XG59O1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL0BmbHVlbmNlbGFicy9tYXJpbmUud29ya2VyLXNjcmlwdC8uLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vaWVlZTc1NEAxLjIuMS9ub2RlX21vZHVsZXMvaWVlZTc1NC9pbmRleC5qcz8iKTsKCi8qKiovIH0pLAoKLyoqKi8gIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9pcy1vYnNlcnZhYmxlQDIuMS4wL25vZGVfbW9kdWxlcy9pcy1vYnNlcnZhYmxlL2luZGV4LmpzIjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL2lzLW9ic2VydmFibGVAMi4xLjAvbm9kZV9tb2R1bGVzL2lzLW9ic2VydmFibGUvaW5kZXguanMgKioqIQogIFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoKG1vZHVsZSkgPT4gewoKZXZhbCgiXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIGlmICghdmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdXNlLWV4dGVuZC1uYXRpdmUvbm8tdXNlLWV4dGVuZC1uYXRpdmVcbiAgICBpZiAodHlwZW9mIFN5bWJvbC5vYnNlcnZhYmxlID09PSAnc3ltYm9sJyAmJiB0eXBlb2YgdmFsdWVbU3ltYm9sLm9ic2VydmFibGVdID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11c2UtZXh0ZW5kLW5hdGl2ZS9uby11c2UtZXh0ZW5kLW5hdGl2ZVxuICAgICAgICByZXR1cm4gdmFsdWUgPT09IHZhbHVlW1N5bWJvbC5vYnNlcnZhYmxlXSgpO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIHZhbHVlWydAQG9ic2VydmFibGUnXSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICByZXR1cm4gdmFsdWUgPT09IHZhbHVlWydAQG9ic2VydmFibGUnXSgpO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59O1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL0BmbHVlbmNlbGFicy9tYXJpbmUud29ya2VyLXNjcmlwdC8uLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vaXMtb2JzZXJ2YWJsZUAyLjEuMC9ub2RlX21vZHVsZXMvaXMtb2JzZXJ2YWJsZS9pbmRleC5qcz8iKTsKCi8qKiovIH0pLAoKLyoqKi8gIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9tc0AyLjEuMi9ub2RlX21vZHVsZXMvbXMvaW5kZXguanMiOgovKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAhKioqIC4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9tc0AyLjEuMi9ub2RlX21vZHVsZXMvbXMvaW5kZXguanMgKioqIQogIFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKiovICgobW9kdWxlKSA9PiB7CgpldmFsKCJcbi8qKlxuICogSGVscGVycy5cbiAqL1xudmFyIHMgPSAxMDAwO1xudmFyIG0gPSBzICogNjA7XG52YXIgaCA9IG0gKiA2MDtcbnZhciBkID0gaCAqIDI0O1xudmFyIHcgPSBkICogNztcbnZhciB5ID0gZCAqIDM2NS4yNTtcbi8qKlxuICogUGFyc2Ugb3IgZm9ybWF0IHRoZSBnaXZlbiBgdmFsYC5cbiAqXG4gKiBPcHRpb25zOlxuICpcbiAqICAtIGBsb25nYCB2ZXJib3NlIGZvcm1hdHRpbmcgW2ZhbHNlXVxuICpcbiAqIEBwYXJhbSB7U3RyaW5nfE51bWJlcn0gdmFsXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdXG4gKiBAdGhyb3dzIHtFcnJvcn0gdGhyb3cgYW4gZXJyb3IgaWYgdmFsIGlzIG5vdCBhIG5vbi1lbXB0eSBzdHJpbmcgb3IgYSBudW1iZXJcbiAqIEByZXR1cm4ge1N0cmluZ3xOdW1iZXJ9XG4gKiBAYXBpIHB1YmxpY1xuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uICh2YWwsIG9wdGlvbnMpIHtcbiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICB2YXIgdHlwZSA9IHR5cGVvZiB2YWw7XG4gICAgaWYgKHR5cGUgPT09ICdzdHJpbmcnICYmIHZhbC5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJldHVybiBwYXJzZSh2YWwpO1xuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlID09PSAnbnVtYmVyJyAmJiBpc0Zpbml0ZSh2YWwpKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmxvbmcgPyBmbXRMb25nKHZhbCkgOiBmbXRTaG9ydCh2YWwpO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3ZhbCBpcyBub3QgYSBub24tZW1wdHkgc3RyaW5nIG9yIGEgdmFsaWQgbnVtYmVyLiB2YWw9JyArXG4gICAgICAgIEpTT04uc3RyaW5naWZ5KHZhbCkpO1xufTtcbi8qKlxuICogUGFyc2UgdGhlIGdpdmVuIGBzdHJgIGFuZCByZXR1cm4gbWlsbGlzZWNvbmRzLlxuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSBzdHJcbiAqIEByZXR1cm4ge051bWJlcn1cbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5mdW5jdGlvbiBwYXJzZShzdHIpIHtcbiAgICBzdHIgPSBTdHJpbmcoc3RyKTtcbiAgICBpZiAoc3RyLmxlbmd0aCA+IDEwMCkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBtYXRjaCA9IC9eKC0/KD86XFxkKyk/XFwuP1xcZCspICoobWlsbGlzZWNvbmRzP3xtc2Vjcz98bXN8c2Vjb25kcz98c2Vjcz98c3xtaW51dGVzP3xtaW5zP3xtfGhvdXJzP3xocnM/fGh8ZGF5cz98ZHx3ZWVrcz98d3x5ZWFycz98eXJzP3x5KT8kL2kuZXhlYyhzdHIpO1xuICAgIGlmICghbWF0Y2gpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgbiA9IHBhcnNlRmxvYXQobWF0Y2hbMV0pO1xuICAgIHZhciB0eXBlID0gKG1hdGNoWzJdIHx8ICdtcycpLnRvTG93ZXJDYXNlKCk7XG4gICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICAgIGNhc2UgJ3llYXJzJzpcbiAgICAgICAgY2FzZSAneWVhcic6XG4gICAgICAgIGNhc2UgJ3lycyc6XG4gICAgICAgIGNhc2UgJ3lyJzpcbiAgICAgICAgY2FzZSAneSc6XG4gICAgICAgICAgICByZXR1cm4gbiAqIHk7XG4gICAgICAgIGNhc2UgJ3dlZWtzJzpcbiAgICAgICAgY2FzZSAnd2Vlayc6XG4gICAgICAgIGNhc2UgJ3cnOlxuICAgICAgICAgICAgcmV0dXJuIG4gKiB3O1xuICAgICAgICBjYXNlICdkYXlzJzpcbiAgICAgICAgY2FzZSAnZGF5JzpcbiAgICAgICAgY2FzZSAnZCc6XG4gICAgICAgICAgICByZXR1cm4gbiAqIGQ7XG4gICAgICAgIGNhc2UgJ2hvdXJzJzpcbiAgICAgICAgY2FzZSAnaG91cic6XG4gICAgICAgIGNhc2UgJ2hycyc6XG4gICAgICAgIGNhc2UgJ2hyJzpcbiAgICAgICAgY2FzZSAnaCc6XG4gICAgICAgICAgICByZXR1cm4gbiAqIGg7XG4gICAgICAgIGNhc2UgJ21pbnV0ZXMnOlxuICAgICAgICBjYXNlICdtaW51dGUnOlxuICAgICAgICBjYXNlICdtaW5zJzpcbiAgICAgICAgY2FzZSAnbWluJzpcbiAgICAgICAgY2FzZSAnbSc6XG4gICAgICAgICAgICByZXR1cm4gbiAqIG07XG4gICAgICAgIGNhc2UgJ3NlY29uZHMnOlxuICAgICAgICBjYXNlICdzZWNvbmQnOlxuICAgICAgICBjYXNlICdzZWNzJzpcbiAgICAgICAgY2FzZSAnc2VjJzpcbiAgICAgICAgY2FzZSAncyc6XG4gICAgICAgICAgICByZXR1cm4gbiAqIHM7XG4gICAgICAgIGNhc2UgJ21pbGxpc2Vjb25kcyc6XG4gICAgICAgIGNhc2UgJ21pbGxpc2Vjb25kJzpcbiAgICAgICAgY2FzZSAnbXNlY3MnOlxuICAgICAgICBjYXNlICdtc2VjJzpcbiAgICAgICAgY2FzZSAnbXMnOlxuICAgICAgICAgICAgcmV0dXJuIG47XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbn1cbi8qKlxuICogU2hvcnQgZm9ybWF0IGZvciBgbXNgLlxuICpcbiAqIEBwYXJhbSB7TnVtYmVyfSBtc1xuICogQHJldHVybiB7U3RyaW5nfVxuICogQGFwaSBwcml2YXRlXG4gKi9cbmZ1bmN0aW9uIGZtdFNob3J0KG1zKSB7XG4gICAgdmFyIG1zQWJzID0gTWF0aC5hYnMobXMpO1xuICAgIGlmIChtc0FicyA+PSBkKSB7XG4gICAgICAgIHJldHVybiBNYXRoLnJvdW5kKG1zIC8gZCkgKyAnZCc7XG4gICAgfVxuICAgIGlmIChtc0FicyA+PSBoKSB7XG4gICAgICAgIHJldHVybiBNYXRoLnJvdW5kKG1zIC8gaCkgKyAnaCc7XG4gICAgfVxuICAgIGlmIChtc0FicyA+PSBtKSB7XG4gICAgICAgIHJldHVybiBNYXRoLnJvdW5kKG1zIC8gbSkgKyAnbSc7XG4gICAgfVxuICAgIGlmIChtc0FicyA+PSBzKSB7XG4gICAgICAgIHJldHVybiBNYXRoLnJvdW5kKG1zIC8gcykgKyAncyc7XG4gICAgfVxuICAgIHJldHVybiBtcyArICdtcyc7XG59XG4vKipcbiAqIExvbmcgZm9ybWF0IGZvciBgbXNgLlxuICpcbiAqIEBwYXJhbSB7TnVtYmVyfSBtc1xuICogQHJldHVybiB7U3RyaW5nfVxuICogQGFwaSBwcml2YXRlXG4gKi9cbmZ1bmN0aW9uIGZtdExvbmcobXMpIHtcbiAgICB2YXIgbXNBYnMgPSBNYXRoLmFicyhtcyk7XG4gICAgaWYgKG1zQWJzID49IGQpIHtcbiAgICAgICAgcmV0dXJuIHBsdXJhbChtcywgbXNBYnMsIGQsICdkYXknKTtcbiAgICB9XG4gICAgaWYgKG1zQWJzID49IGgpIHtcbiAgICAgICAgcmV0dXJuIHBsdXJhbChtcywgbXNBYnMsIGgsICdob3VyJyk7XG4gICAgfVxuICAgIGlmIChtc0FicyA+PSBtKSB7XG4gICAgICAgIHJldHVybiBwbHVyYWwobXMsIG1zQWJzLCBtLCAnbWludXRlJyk7XG4gICAgfVxuICAgIGlmIChtc0FicyA+PSBzKSB7XG4gICAgICAgIHJldHVybiBwbHVyYWwobXMsIG1zQWJzLCBzLCAnc2Vjb25kJyk7XG4gICAgfVxuICAgIHJldHVybiBtcyArICcgbXMnO1xufVxuLyoqXG4gKiBQbHVyYWxpemF0aW9uIGhlbHBlci5cbiAqL1xuZnVuY3Rpb24gcGx1cmFsKG1zLCBtc0FicywgbiwgbmFtZSkge1xuICAgIHZhciBpc1BsdXJhbCA9IG1zQWJzID49IG4gKiAxLjU7XG4gICAgcmV0dXJuIE1hdGgucm91bmQobXMgLyBuKSArICcgJyArIG5hbWUgKyAoaXNQbHVyYWwgPyAncycgOiAnJyk7XG59XG5cblxuLy8jIHNvdXJjZVVSTD13ZWJwYWNrOi8vQGZsdWVuY2VsYWJzL21hcmluZS53b3JrZXItc2NyaXB0Ly4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9tc0AyLjEuMi9ub2RlX21vZHVsZXMvbXMvaW5kZXguanM/Iik7CgovKioqLyB9KSwKCi8qKiovICIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vb2JzZXJ2YWJsZS1mbnNAMC42LjEvbm9kZV9tb2R1bGVzL29ic2VydmFibGUtZm5zL2Rpc3QuZXNtL19zY2hlZHVsZXIuanMiOgovKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL29ic2VydmFibGUtZm5zQDAuNi4xL25vZGVfbW9kdWxlcy9vYnNlcnZhYmxlLWZucy9kaXN0LmVzbS9fc2NoZWR1bGVyLmpzICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKiovIChmdW5jdGlvbihfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykgewoKZXZhbCgiXG52YXIgX19nZW5lcmF0b3IgPSAodGhpcyAmJiB0aGlzLl9fZ2VuZXJhdG9yKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgYm9keSkge1xuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XG4gICAgcmV0dXJuIGcgPSB7IG5leHQ6IHZlcmIoMCksIFwidGhyb3dcIjogdmVyYigxKSwgXCJyZXR1cm5cIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IHJldHVybiBmdW5jdGlvbiAodikgeyByZXR1cm4gc3RlcChbbiwgdl0pOyB9OyB9XG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xuICAgICAgICBpZiAoZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XG4gICAgICAgIHdoaWxlIChfKSB0cnkge1xuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xuICAgICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFtvcFswXSAmIDIsIHQudmFsdWVdO1xuICAgICAgICAgICAgc3dpdGNoIChvcFswXSkge1xuICAgICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XG4gICAgICAgICAgICAgICAgY2FzZSA1OiBfLmxhYmVsKys7IHkgPSBvcFsxXTsgb3AgPSBbMF07IGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBpZiAoISh0ID0gXy50cnlzLCB0ID0gdC5sZW5ndGggPiAwICYmIHRbdC5sZW5ndGggLSAxXSkgJiYgKG9wWzBdID09PSA2IHx8IG9wWzBdID09PSAyKSkgeyBfID0gMDsgY29udGludWU7IH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0ICYmIF8ubGFiZWwgPCB0WzJdKSB7IF8ubGFiZWwgPSB0WzJdOyBfLm9wcy5wdXNoKG9wKTsgYnJlYWs7IH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xuICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cbiAgICAgICAgaWYgKG9wWzBdICYgNSkgdGhyb3cgb3BbMV07IHJldHVybiB7IHZhbHVlOiBvcFswXSA/IG9wWzFdIDogdm9pZCAwLCBkb25lOiB0cnVlIH07XG4gICAgfVxufTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHsgdmFsdWU6IHRydWUgfSkpO1xuZXhwb3J0cy5Bc3luY1NlcmlhbFNjaGVkdWxlciA9IHZvaWQgMDtcbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHtcbiAgICAgICAgICAgIHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHtcbiAgICAgICAgICAgIHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbnZhciBBc3luY1NlcmlhbFNjaGVkdWxlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBBc3luY1NlcmlhbFNjaGVkdWxlcihvYnNlcnZlcikge1xuICAgICAgICB0aGlzLl9iYXNlT2JzZXJ2ZXIgPSBvYnNlcnZlcjtcbiAgICAgICAgdGhpcy5fcGVuZGluZ1Byb21pc2VzID0gbmV3IFNldCgpO1xuICAgIH1cbiAgICBBc3luY1NlcmlhbFNjaGVkdWxlci5wcm90b3R5cGUuY29tcGxldGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIFByb21pc2UuYWxsKHRoaXMuX3BlbmRpbmdQcm9taXNlcylcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLl9iYXNlT2JzZXJ2ZXIuY29tcGxldGUoKTsgfSlcbiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsgcmV0dXJuIF90aGlzLl9iYXNlT2JzZXJ2ZXIuZXJyb3IoZXJyb3IpOyB9KTtcbiAgICB9O1xuICAgIEFzeW5jU2VyaWFsU2NoZWR1bGVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICB0aGlzLl9iYXNlT2JzZXJ2ZXIuZXJyb3IoZXJyb3IpO1xuICAgIH07XG4gICAgQXN5bmNTZXJpYWxTY2hlZHVsZXIucHJvdG90eXBlLnNjaGVkdWxlID0gZnVuY3Rpb24gKHRhc2spIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIHByZXZQcm9taXNlc0NvbXBsZXRpb24gPSBQcm9taXNlLmFsbCh0aGlzLl9wZW5kaW5nUHJvbWlzZXMpO1xuICAgICAgICB2YXIgdmFsdWVzID0gW107XG4gICAgICAgIHZhciBuZXh0ID0gZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiB2YWx1ZXMucHVzaCh2YWx1ZSk7IH07XG4gICAgICAgIHZhciBwcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKClcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHsgcmV0dXJuIF9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBfaSwgdmFsdWVzXzEsIHZhbHVlO1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gWzQgLyp5aWVsZCovLCBwcmV2UHJvbWlzZXNDb21wbGV0aW9uXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGFzayhuZXh0KV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdQcm9taXNlcy5kZWxldGUocHJvbWlzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKF9pID0gMCwgdmFsdWVzXzEgPSB2YWx1ZXM7IF9pIDwgdmFsdWVzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZXNfMVtfaV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fYmFzZU9ic2VydmVyLm5leHQodmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTsgfSlcbiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgIF90aGlzLl9wZW5kaW5nUHJvbWlzZXMuZGVsZXRlKHByb21pc2UpO1xuICAgICAgICAgICAgX3RoaXMuX2Jhc2VPYnNlcnZlci5lcnJvcihlcnJvcik7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9wZW5kaW5nUHJvbWlzZXMuYWRkKHByb21pc2UpO1xuICAgIH07XG4gICAgcmV0dXJuIEFzeW5jU2VyaWFsU2NoZWR1bGVyO1xufSgpKTtcbmV4cG9ydHMuQXN5bmNTZXJpYWxTY2hlZHVsZXIgPSBBc3luY1NlcmlhbFNjaGVkdWxlcjtcblxuXG4vLyMgc291cmNlVVJMPXdlYnBhY2s6Ly9AZmx1ZW5jZWxhYnMvbWFyaW5lLndvcmtlci1zY3JpcHQvLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL29ic2VydmFibGUtZm5zQDAuNi4xL25vZGVfbW9kdWxlcy9vYnNlcnZhYmxlLWZucy9kaXN0LmVzbS9fc2NoZWR1bGVyLmpzPyIpOwoKLyoqKi8gfSksCgovKioqLyAiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL29ic2VydmFibGUtZm5zQDAuNi4xL25vZGVfbW9kdWxlcy9vYnNlcnZhYmxlLWZucy9kaXN0LmVzbS9fc3ltYm9scy5qcyI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL29ic2VydmFibGUtZm5zQDAuNi4xL25vZGVfbW9kdWxlcy9vYnNlcnZhYmxlLWZucy9kaXN0LmVzbS9fc3ltYm9scy5qcyAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykgPT4gewoKZXZhbCgiXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7IHZhbHVlOiB0cnVlIH0pKTtcbmV4cG9ydHMucmVnaXN0ZXJPYnNlcnZhYmxlU3ltYm9sID0gZXhwb3J0cy5nZXRTeW1ib2wgPSBleHBvcnRzLmhhc1N5bWJvbCA9IGV4cG9ydHMuaGFzU3ltYm9scyA9IHZvaWQgMDtcbnZhciBoYXNTeW1ib2xzID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiOyB9O1xuZXhwb3J0cy5oYXNTeW1ib2xzID0gaGFzU3ltYm9scztcbnZhciBoYXNTeW1ib2wgPSBmdW5jdGlvbiAobmFtZSkgeyByZXR1cm4gKDAsIGV4cG9ydHMuaGFzU3ltYm9scykoKSAmJiBCb29sZWFuKFN5bWJvbFtuYW1lXSk7IH07XG5leHBvcnRzLmhhc1N5bWJvbCA9IGhhc1N5bWJvbDtcbnZhciBnZXRTeW1ib2wgPSBmdW5jdGlvbiAobmFtZSkgeyByZXR1cm4gKDAsIGV4cG9ydHMuaGFzU3ltYm9sKShuYW1lKSA/IFN5bWJvbFtuYW1lXSA6IFwiQEBcIiArIG5hbWU7IH07XG5leHBvcnRzLmdldFN5bWJvbCA9IGdldFN5bWJvbDtcbmZ1bmN0aW9uIHJlZ2lzdGVyT2JzZXJ2YWJsZVN5bWJvbCgpIHtcbiAgICBpZiAoKDAsIGV4cG9ydHMuaGFzU3ltYm9scykoKSAmJiAhKDAsIGV4cG9ydHMuaGFzU3ltYm9sKShcIm9ic2VydmFibGVcIikpIHtcbiAgICAgICAgU3ltYm9sLm9ic2VydmFibGUgPSBTeW1ib2woXCJvYnNlcnZhYmxlXCIpO1xuICAgIH1cbn1cbmV4cG9ydHMucmVnaXN0ZXJPYnNlcnZhYmxlU3ltYm9sID0gcmVnaXN0ZXJPYnNlcnZhYmxlU3ltYm9sO1xuaWYgKCEoMCwgZXhwb3J0cy5oYXNTeW1ib2wpKFwiYXN5bmNJdGVyYXRvclwiKSkge1xuICAgIFN5bWJvbC5hc3luY0l0ZXJhdG9yID0gU3ltYm9sLmFzeW5jSXRlcmF0b3IgfHwgU3ltYm9sLmZvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yXCIpO1xufVxuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL0BmbHVlbmNlbGFicy9tYXJpbmUud29ya2VyLXNjcmlwdC8uLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vb2JzZXJ2YWJsZS1mbnNAMC42LjEvbm9kZV9tb2R1bGVzL29ic2VydmFibGUtZm5zL2Rpc3QuZXNtL19zeW1ib2xzLmpzPyIpOwoKLyoqKi8gfSksCgovKioqLyAiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL29ic2VydmFibGUtZm5zQDAuNi4xL25vZGVfbW9kdWxlcy9vYnNlcnZhYmxlLWZucy9kaXN0LmVzbS9fdXRpbC5qcyI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL29ic2VydmFibGUtZm5zQDAuNi4xL25vZGVfbW9kdWxlcy9vYnNlcnZhYmxlLWZucy9kaXN0LmVzbS9fdXRpbC5qcyAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgPT4gewoKZXZhbCgiXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7IHZhbHVlOiB0cnVlIH0pKTtcbmV4cG9ydHMuaXNJdGVyYXRvciA9IGV4cG9ydHMuaXNBc3luY0l0ZXJhdG9yID0gdm9pZCAwO1xuLy8vIDxyZWZlcmVuY2UgbGliPVwiZXMyMDE4XCIgLz5cbnZhciBfc3ltYm9sc18xID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9fc3ltYm9scyAqLyBcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9vYnNlcnZhYmxlLWZuc0AwLjYuMS9ub2RlX21vZHVsZXMvb2JzZXJ2YWJsZS1mbnMvZGlzdC5lc20vX3N5bWJvbHMuanNcIik7XG5mdW5jdGlvbiBpc0FzeW5jSXRlcmF0b3IodGhpbmcpIHtcbiAgICByZXR1cm4gdGhpbmcgJiYgKDAsIF9zeW1ib2xzXzEuaGFzU3ltYm9sKShcImFzeW5jSXRlcmF0b3JcIikgJiYgdGhpbmdbU3ltYm9sLmFzeW5jSXRlcmF0b3JdO1xufVxuZXhwb3J0cy5pc0FzeW5jSXRlcmF0b3IgPSBpc0FzeW5jSXRlcmF0b3I7XG5mdW5jdGlvbiBpc0l0ZXJhdG9yKHRoaW5nKSB7XG4gICAgcmV0dXJuIHRoaW5nICYmICgwLCBfc3ltYm9sc18xLmhhc1N5bWJvbCkoXCJpdGVyYXRvclwiKSAmJiB0aGluZ1tTeW1ib2wuaXRlcmF0b3JdO1xufVxuZXhwb3J0cy5pc0l0ZXJhdG9yID0gaXNJdGVyYXRvcjtcblxuXG4vLyMgc291cmNlVVJMPXdlYnBhY2s6Ly9AZmx1ZW5jZWxhYnMvbWFyaW5lLndvcmtlci1zY3JpcHQvLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL29ic2VydmFibGUtZm5zQDAuNi4xL25vZGVfbW9kdWxlcy9vYnNlcnZhYmxlLWZucy9kaXN0LmVzbS9fdXRpbC5qcz8iKTsKCi8qKiovIH0pLAoKLyoqKi8gIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9vYnNlcnZhYmxlLWZuc0AwLjYuMS9ub2RlX21vZHVsZXMvb2JzZXJ2YWJsZS1mbnMvZGlzdC5lc20vZmlsdGVyLmpzIjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL29ic2VydmFibGUtZm5zQDAuNi4xL25vZGVfbW9kdWxlcy9vYnNlcnZhYmxlLWZucy9kaXN0LmVzbS9maWx0ZXIuanMgKioqIQogIFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoZnVuY3Rpb24oX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCmV2YWwoIlxudmFyIF9fZ2VuZXJhdG9yID0gKHRoaXMgJiYgdGhpcy5fX2dlbmVyYXRvcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIGJvZHkpIHtcbiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnO1xuICAgIHJldHVybiBnID0geyBuZXh0OiB2ZXJiKDApLCBcInRocm93XCI6IHZlcmIoMSksIFwicmV0dXJuXCI6IHZlcmIoMikgfSwgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnO1xuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxuICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHtcbiAgICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcbiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IG9wWzBdICYgMiA/IHlbXCJyZXR1cm5cIl0gOiBvcFswXSA/IHlbXCJ0aHJvd1wiXSB8fCAoKHQgPSB5W1wicmV0dXJuXCJdKSAmJiB0LmNhbGwoeSksIDApIDogeS5uZXh0KSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDtcbiAgICAgICAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTtcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9O1xuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xuICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9XG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xuICAgIH1cbn07XG52YXIgX19pbXBvcnREZWZhdWx0ID0gKHRoaXMgJiYgdGhpcy5fX2ltcG9ydERlZmF1bHQpIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IFwiZGVmYXVsdFwiOiBtb2QgfTtcbn07XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7IHZhbHVlOiB0cnVlIH0pKTtcbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHtcbiAgICAgICAgICAgIHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHtcbiAgICAgICAgICAgIHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbnZhciBfc2NoZWR1bGVyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL19zY2hlZHVsZXIgKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vb2JzZXJ2YWJsZS1mbnNAMC42LjEvbm9kZV9tb2R1bGVzL29ic2VydmFibGUtZm5zL2Rpc3QuZXNtL19zY2hlZHVsZXIuanNcIik7XG52YXIgb2JzZXJ2YWJsZV8xID0gX19pbXBvcnREZWZhdWx0KF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vb2JzZXJ2YWJsZSAqLyBcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9vYnNlcnZhYmxlLWZuc0AwLjYuMS9ub2RlX21vZHVsZXMvb2JzZXJ2YWJsZS1mbnMvZGlzdC5lc20vb2JzZXJ2YWJsZS5qc1wiKSk7XG52YXIgdW5zdWJzY3JpYmVfMSA9IF9faW1wb3J0RGVmYXVsdChfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL3Vuc3Vic2NyaWJlICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL29ic2VydmFibGUtZm5zQDAuNi4xL25vZGVfbW9kdWxlcy9vYnNlcnZhYmxlLWZucy9kaXN0LmVzbS91bnN1YnNjcmliZS5qc1wiKSk7XG4vKipcbiAqIEZpbHRlcnMgdGhlIHZhbHVlcyBlbWl0dGVkIGJ5IGFub3RoZXIgb2JzZXJ2YWJsZS5cbiAqIFRvIGJlIGFwcGxpZWQgdG8gYW4gaW5wdXQgb2JzZXJ2YWJsZSB1c2luZyBgcGlwZSgpYC5cbiAqL1xuZnVuY3Rpb24gZmlsdGVyKHRlc3QpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG9ic2VydmFibGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBvYnNlcnZhYmxlXzEuZGVmYXVsdChmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgICAgICAgIHZhciBzY2hlZHVsZXIgPSBuZXcgX3NjaGVkdWxlcl8xLkFzeW5jU2VyaWFsU2NoZWR1bGVyKG9ic2VydmVyKTtcbiAgICAgICAgICAgIHZhciBzdWJzY3JpcHRpb24gPSBvYnNlcnZhYmxlLnN1YnNjcmliZSh7XG4gICAgICAgICAgICAgICAgY29tcGxldGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgc2NoZWR1bGVyLmNvbXBsZXRlKCk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHNjaGVkdWxlci5lcnJvcihlcnJvcik7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBuZXh0OiBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgc2NoZWR1bGVyLnNjaGVkdWxlKGZ1bmN0aW9uIChuZXh0KSB7IHJldHVybiBfX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRlc3QoaW5wdXQpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9hLnNlbnQoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5leHQoaW5wdXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KTsgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkgeyByZXR1cm4gKDAsIHVuc3Vic2NyaWJlXzEuZGVmYXVsdCkoc3Vic2NyaXB0aW9uKTsgfTtcbiAgICAgICAgfSk7XG4gICAgfTtcbn1cbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gZmlsdGVyO1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL0BmbHVlbmNlbGFicy9tYXJpbmUud29ya2VyLXNjcmlwdC8uLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vb2JzZXJ2YWJsZS1mbnNAMC42LjEvbm9kZV9tb2R1bGVzL29ic2VydmFibGUtZm5zL2Rpc3QuZXNtL2ZpbHRlci5qcz8iKTsKCi8qKiovIH0pLAoKLyoqKi8gIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9vYnNlcnZhYmxlLWZuc0AwLjYuMS9ub2RlX21vZHVsZXMvb2JzZXJ2YWJsZS1mbnMvZGlzdC5lc20vZmxhdE1hcC5qcyI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiAuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vb2JzZXJ2YWJsZS1mbnNAMC42LjEvbm9kZV9tb2R1bGVzL29ic2VydmFibGUtZm5zL2Rpc3QuZXNtL2ZsYXRNYXAuanMgKioqIQogIFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKGZ1bmN0aW9uKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpldmFsKCJcbnZhciBfX2dlbmVyYXRvciA9ICh0aGlzICYmIHRoaXMuX19nZW5lcmF0b3IpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBib2R5KSB7XG4gICAgdmFyIF8gPSB7IGxhYmVsOiAwLCBzZW50OiBmdW5jdGlvbigpIHsgaWYgKHRbMF0gJiAxKSB0aHJvdyB0WzFdOyByZXR1cm4gdFsxXTsgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZztcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cbiAgICBmdW5jdGlvbiBzdGVwKG9wKSB7XG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcbiAgICAgICAgd2hpbGUgKF8pIHRyeSB7XG4gICAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5W1wicmV0dXJuXCJdIDogb3BbMF0gPyB5W1widGhyb3dcIl0gfHwgKCh0ID0geVtcInJldHVyblwiXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7XG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XG4gICAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7XG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcbiAgICB9XG59O1xudmFyIF9faW1wb3J0RGVmYXVsdCA9ICh0aGlzICYmIHRoaXMuX19pbXBvcnREZWZhdWx0KSB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBcImRlZmF1bHRcIjogbW9kIH07XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoeyB2YWx1ZTogdHJ1ZSB9KSk7XG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7XG4gICAgICAgICAgICBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7XG4gICAgICAgICAgICBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG52YXIgX19hc3luY1ZhbHVlcyA9ICh0aGlzICYmIHRoaXMuX19hc3luY1ZhbHVlcykgfHwgZnVuY3Rpb24gKG8pIHtcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKVxuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xuICAgIHZhciBtID0gb1tTeW1ib2wuYXN5bmNJdGVyYXRvcl0sIGk7XG4gICAgcmV0dXJuIG0gPyBtLmNhbGwobykgOiAobyA9IHR5cGVvZiBfX3ZhbHVlcyA9PT0gXCJmdW5jdGlvblwiID8gX192YWx1ZXMobykgOiBvW1N5bWJvbC5pdGVyYXRvcl0oKSwgaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGkpO1xuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpW25dID0gb1tuXSAmJiBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgeyB2ID0gb1tuXSh2KSwgc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgdi5kb25lLCB2LnZhbHVlKTsgfSk7IH07IH1cbiAgICBmdW5jdGlvbiBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCBkLCB2KSB7IFByb21pc2UucmVzb2x2ZSh2KS50aGVuKGZ1bmN0aW9uICh2KSB7IHJlc29sdmUoeyB2YWx1ZTogdiwgZG9uZTogZCB9KTsgfSwgcmVqZWN0KTsgfVxufTtcbnZhciBfc2NoZWR1bGVyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL19zY2hlZHVsZXIgKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vb2JzZXJ2YWJsZS1mbnNAMC42LjEvbm9kZV9tb2R1bGVzL29ic2VydmFibGUtZm5zL2Rpc3QuZXNtL19zY2hlZHVsZXIuanNcIik7XG52YXIgX3V0aWxfMSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX3V0aWwgKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vb2JzZXJ2YWJsZS1mbnNAMC42LjEvbm9kZV9tb2R1bGVzL29ic2VydmFibGUtZm5zL2Rpc3QuZXNtL191dGlsLmpzXCIpO1xudmFyIG9ic2VydmFibGVfMSA9IF9faW1wb3J0RGVmYXVsdChfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL29ic2VydmFibGUgKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vb2JzZXJ2YWJsZS1mbnNAMC42LjEvbm9kZV9tb2R1bGVzL29ic2VydmFibGUtZm5zL2Rpc3QuZXNtL29ic2VydmFibGUuanNcIikpO1xudmFyIHVuc3Vic2NyaWJlXzEgPSBfX2ltcG9ydERlZmF1bHQoX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi91bnN1YnNjcmliZSAqLyBcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9vYnNlcnZhYmxlLWZuc0AwLjYuMS9ub2RlX21vZHVsZXMvb2JzZXJ2YWJsZS1mbnMvZGlzdC5lc20vdW5zdWJzY3JpYmUuanNcIikpO1xuLyoqXG4gKiBNYXBzIHRoZSB2YWx1ZXMgZW1pdHRlZCBieSBhbm90aGVyIG9ic2VydmFibGUuIEluIGNvbnRyYXN0IHRvIGBtYXAoKWBcbiAqIHRoZSBgbWFwcGVyYCBmdW5jdGlvbiByZXR1cm5zIGFuIGFycmF5IG9mIHZhbHVlcyB0aGF0IHdpbGwgYmUgZW1pdHRlZFxuICogc2VwYXJhdGVseS5cbiAqIFVzZSBgZmxhdE1hcCgpYCB0byBtYXAgaW5wdXQgdmFsdWVzIHRvIHplcm8sIG9uZSBvciBtdWx0aXBsZSBvdXRwdXRcbiAqIHZhbHVlcy4gVG8gYmUgYXBwbGllZCB0byBhbiBpbnB1dCBvYnNlcnZhYmxlIHVzaW5nIGBwaXBlKClgLlxuICovXG5mdW5jdGlvbiBmbGF0TWFwKG1hcHBlcikge1xuICAgIHJldHVybiBmdW5jdGlvbiAob2JzZXJ2YWJsZSkge1xuICAgICAgICByZXR1cm4gbmV3IG9ic2VydmFibGVfMS5kZWZhdWx0KGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgICAgICAgdmFyIHNjaGVkdWxlciA9IG5ldyBfc2NoZWR1bGVyXzEuQXN5bmNTZXJpYWxTY2hlZHVsZXIob2JzZXJ2ZXIpO1xuICAgICAgICAgICAgdmFyIHN1YnNjcmlwdGlvbiA9IG9ic2VydmFibGUuc3Vic2NyaWJlKHtcbiAgICAgICAgICAgICAgICBjb21wbGV0ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBzY2hlZHVsZXIuY29tcGxldGUoKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgc2NoZWR1bGVyLmVycm9yKGVycm9yKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG5leHQ6IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICBzY2hlZHVsZXIuc2NoZWR1bGUoZnVuY3Rpb24gKG5leHQpIHsgcmV0dXJuIF9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlXzEsIF9hLCBtYXBwZWQsIG1hcHBlZF8xLCBtYXBwZWRfMV8xLCBlbGVtZW50LCBlXzFfMV8xO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2IubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gWzQgLyp5aWVsZCovLCBtYXBwZXIoaW5wdXQpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwcGVkID0gX2Iuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoKDAsIF91dGlsXzEuaXNJdGVyYXRvcikobWFwcGVkKSB8fCAoMCwgX3V0aWxfMS5pc0FzeW5jSXRlcmF0b3IpKG1hcHBlZCkpKSByZXR1cm4gWzMgLypicmVhayovLCAxNF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYi5sYWJlbCA9IDI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9iLnRyeXMucHVzaChbMiwgNywgOCwgMTNdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcHBlZF8xID0gX19hc3luY1ZhbHVlcyhtYXBwZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2IubGFiZWwgPSAzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbNCAvKnlpZWxkKi8sIG1hcHBlZF8xLm5leHQoKV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKG1hcHBlZF8xXzEgPSBfYi5zZW50KCksICFtYXBwZWRfMV8xLmRvbmUpKSByZXR1cm4gWzMgLypicmVhayovLCA2XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQgPSBtYXBwZWRfMV8xLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV4dChlbGVtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gNTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA1OiByZXR1cm4gWzMgLypicmVhayovLCAzXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA2OiByZXR1cm4gWzMgLypicmVhayovLCAxM107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVfMV8xXzEgPSBfYi5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlXzEgPSB7IGVycm9yOiBlXzFfMV8xIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCAxM107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9iLnRyeXMucHVzaChbOCwgLCAxMSwgMTJdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKG1hcHBlZF8xXzEgJiYgIW1hcHBlZF8xXzEuZG9uZSAmJiAoX2EgPSBtYXBwZWRfMS5yZXR1cm4pKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMTBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgX2EuY2FsbChtYXBwZWRfMSldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDk6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYi5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYi5sYWJlbCA9IDEwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEwOiByZXR1cm4gWzMgLypicmVhayovLCAxMl07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTE6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZV8xKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IGVfMS5lcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNyAvKmVuZGZpbmFsbHkqL107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTI6IHJldHVybiBbNyAvKmVuZGZpbmFsbHkqL107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTM6IHJldHVybiBbMyAvKmJyZWFrKi8sIDE1XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxNDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcHBlZC5tYXAoZnVuY3Rpb24gKG91dHB1dCkgeyByZXR1cm4gbmV4dChvdXRwdXQpOyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gMTU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTU6IHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7IH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsgcmV0dXJuICgwLCB1bnN1YnNjcmliZV8xLmRlZmF1bHQpKHN1YnNjcmlwdGlvbik7IH07XG4gICAgICAgIH0pO1xuICAgIH07XG59XG5leHBvcnRzW1wiZGVmYXVsdFwiXSA9IGZsYXRNYXA7XG5cblxuLy8jIHNvdXJjZVVSTD13ZWJwYWNrOi8vQGZsdWVuY2VsYWJzL21hcmluZS53b3JrZXItc2NyaXB0Ly4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9vYnNlcnZhYmxlLWZuc0AwLjYuMS9ub2RlX21vZHVsZXMvb2JzZXJ2YWJsZS1mbnMvZGlzdC5lc20vZmxhdE1hcC5qcz8iKTsKCi8qKiovIH0pLAoKLyoqKi8gIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9vYnNlcnZhYmxlLWZuc0AwLjYuMS9ub2RlX21vZHVsZXMvb2JzZXJ2YWJsZS1mbnMvZGlzdC5lc20vaW5kZXguanMiOgovKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAhKioqIC4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9vYnNlcnZhYmxlLWZuc0AwLjYuMS9ub2RlX21vZHVsZXMvb2JzZXJ2YWJsZS1mbnMvZGlzdC5lc20vaW5kZXguanMgKioqIQogIFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKiovIChmdW5jdGlvbihfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKZXZhbCgiXG52YXIgX19pbXBvcnREZWZhdWx0ID0gKHRoaXMgJiYgdGhpcy5fX2ltcG9ydERlZmF1bHQpIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IFwiZGVmYXVsdFwiOiBtb2QgfTtcbn07XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7IHZhbHVlOiB0cnVlIH0pKTtcbmV4cG9ydHMudW5zdWJzY3JpYmUgPSBleHBvcnRzLlN1YmplY3QgPSBleHBvcnRzLnNjYW4gPSBleHBvcnRzLk9ic2VydmFibGUgPSBleHBvcnRzLm11bHRpY2FzdCA9IGV4cG9ydHMubWVyZ2UgPSBleHBvcnRzLm1hcCA9IGV4cG9ydHMuaW50ZXJ2YWwgPSBleHBvcnRzLmZsYXRNYXAgPSBleHBvcnRzLmZpbHRlciA9IHZvaWQgMDtcbnZhciBmaWx0ZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vZmlsdGVyICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL29ic2VydmFibGUtZm5zQDAuNi4xL25vZGVfbW9kdWxlcy9vYnNlcnZhYmxlLWZucy9kaXN0LmVzbS9maWx0ZXIuanNcIik7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJmaWx0ZXJcIiwgKHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBfX2ltcG9ydERlZmF1bHQoZmlsdGVyXzEpLmRlZmF1bHQ7IH0gfSkpO1xudmFyIGZsYXRNYXBfMSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vZmxhdE1hcCAqLyBcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9vYnNlcnZhYmxlLWZuc0AwLjYuMS9ub2RlX21vZHVsZXMvb2JzZXJ2YWJsZS1mbnMvZGlzdC5lc20vZmxhdE1hcC5qc1wiKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcImZsYXRNYXBcIiwgKHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBfX2ltcG9ydERlZmF1bHQoZmxhdE1hcF8xKS5kZWZhdWx0OyB9IH0pKTtcbnZhciBpbnRlcnZhbF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9pbnRlcnZhbCAqLyBcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9vYnNlcnZhYmxlLWZuc0AwLjYuMS9ub2RlX21vZHVsZXMvb2JzZXJ2YWJsZS1mbnMvZGlzdC5lc20vaW50ZXJ2YWwuanNcIik7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJpbnRlcnZhbFwiLCAoeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF9faW1wb3J0RGVmYXVsdChpbnRlcnZhbF8xKS5kZWZhdWx0OyB9IH0pKTtcbnZhciBtYXBfMSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vbWFwICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL29ic2VydmFibGUtZm5zQDAuNi4xL25vZGVfbW9kdWxlcy9vYnNlcnZhYmxlLWZucy9kaXN0LmVzbS9tYXAuanNcIik7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJtYXBcIiwgKHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBfX2ltcG9ydERlZmF1bHQobWFwXzEpLmRlZmF1bHQ7IH0gfSkpO1xudmFyIG1lcmdlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL21lcmdlICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL29ic2VydmFibGUtZm5zQDAuNi4xL25vZGVfbW9kdWxlcy9vYnNlcnZhYmxlLWZucy9kaXN0LmVzbS9tZXJnZS5qc1wiKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIm1lcmdlXCIsICh7IGVudW1lcmFibGU6IHRydWUsIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gX19pbXBvcnREZWZhdWx0KG1lcmdlXzEpLmRlZmF1bHQ7IH0gfSkpO1xudmFyIG11bHRpY2FzdF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9tdWx0aWNhc3QgKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vb2JzZXJ2YWJsZS1mbnNAMC42LjEvbm9kZV9tb2R1bGVzL29ic2VydmFibGUtZm5zL2Rpc3QuZXNtL211bHRpY2FzdC5qc1wiKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIm11bHRpY2FzdFwiLCAoeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF9faW1wb3J0RGVmYXVsdChtdWx0aWNhc3RfMSkuZGVmYXVsdDsgfSB9KSk7XG52YXIgb2JzZXJ2YWJsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9vYnNlcnZhYmxlICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL29ic2VydmFibGUtZm5zQDAuNi4xL25vZGVfbW9kdWxlcy9vYnNlcnZhYmxlLWZucy9kaXN0LmVzbS9vYnNlcnZhYmxlLmpzXCIpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiT2JzZXJ2YWJsZVwiLCAoeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF9faW1wb3J0RGVmYXVsdChvYnNlcnZhYmxlXzEpLmRlZmF1bHQ7IH0gfSkpO1xudmFyIHNjYW5fMSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vc2NhbiAqLyBcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9vYnNlcnZhYmxlLWZuc0AwLjYuMS9ub2RlX21vZHVsZXMvb2JzZXJ2YWJsZS1mbnMvZGlzdC5lc20vc2Nhbi5qc1wiKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcInNjYW5cIiwgKHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBfX2ltcG9ydERlZmF1bHQoc2Nhbl8xKS5kZWZhdWx0OyB9IH0pKTtcbnZhciBzdWJqZWN0XzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL3N1YmplY3QgKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vb2JzZXJ2YWJsZS1mbnNAMC42LjEvbm9kZV9tb2R1bGVzL29ic2VydmFibGUtZm5zL2Rpc3QuZXNtL3N1YmplY3QuanNcIik7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJTdWJqZWN0XCIsICh7IGVudW1lcmFibGU6IHRydWUsIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gX19pbXBvcnREZWZhdWx0KHN1YmplY3RfMSkuZGVmYXVsdDsgfSB9KSk7XG52YXIgdW5zdWJzY3JpYmVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vdW5zdWJzY3JpYmUgKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vb2JzZXJ2YWJsZS1mbnNAMC42LjEvbm9kZV9tb2R1bGVzL29ic2VydmFibGUtZm5zL2Rpc3QuZXNtL3Vuc3Vic2NyaWJlLmpzXCIpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwidW5zdWJzY3JpYmVcIiwgKHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBfX2ltcG9ydERlZmF1bHQodW5zdWJzY3JpYmVfMSkuZGVmYXVsdDsgfSB9KSk7XG5cblxuLy8jIHNvdXJjZVVSTD13ZWJwYWNrOi8vQGZsdWVuY2VsYWJzL21hcmluZS53b3JrZXItc2NyaXB0Ly4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9vYnNlcnZhYmxlLWZuc0AwLjYuMS9ub2RlX21vZHVsZXMvb2JzZXJ2YWJsZS1mbnMvZGlzdC5lc20vaW5kZXguanM/Iik7CgovKioqLyB9KSwKCi8qKiovICIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vb2JzZXJ2YWJsZS1mbnNAMC42LjEvbm9kZV9tb2R1bGVzL29ic2VydmFibGUtZm5zL2Rpc3QuZXNtL2ludGVydmFsLmpzIjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiAuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vb2JzZXJ2YWJsZS1mbnNAMC42LjEvbm9kZV9tb2R1bGVzL29ic2VydmFibGUtZm5zL2Rpc3QuZXNtL2ludGVydmFsLmpzICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSA9PiB7CgpldmFsKCJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHsgdmFsdWU6IHRydWUgfSkpO1xudmFyIG9ic2VydmFibGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vb2JzZXJ2YWJsZSAqLyBcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9vYnNlcnZhYmxlLWZuc0AwLjYuMS9ub2RlX21vZHVsZXMvb2JzZXJ2YWJsZS1mbnMvZGlzdC5lc20vb2JzZXJ2YWJsZS5qc1wiKTtcbi8qKlxuICogQ3JlYXRlcyBhbiBvYnNlcnZhYmxlIHRoYXQgeWllbGRzIGEgbmV3IHZhbHVlIGV2ZXJ5IGBwZXJpb2RgIG1pbGxpc2Vjb25kcy5cbiAqIFRoZSBmaXJzdCB2YWx1ZSBlbWl0dGVkIGlzIDAsIHRoZW4gMSwgMiwgZXRjLiBUaGUgZmlyc3QgdmFsdWUgaXMgbm90IGVtaXR0ZWRcbiAqIGltbWVkaWF0ZWx5LCBidXQgYWZ0ZXIgdGhlIGZpcnN0IGludGVydmFsLlxuICovXG5mdW5jdGlvbiBpbnRlcnZhbChwZXJpb2QpIHtcbiAgICByZXR1cm4gbmV3IG9ic2VydmFibGVfMS5PYnNlcnZhYmxlKGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgICB2YXIgY291bnRlciA9IDA7XG4gICAgICAgIHZhciBoYW5kbGUgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBvYnNlcnZlci5uZXh0KGNvdW50ZXIrKyk7XG4gICAgICAgIH0sIHBlcmlvZCk7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7IHJldHVybiBjbGVhckludGVydmFsKGhhbmRsZSk7IH07XG4gICAgfSk7XG59XG5leHBvcnRzW1wiZGVmYXVsdFwiXSA9IGludGVydmFsO1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL0BmbHVlbmNlbGFicy9tYXJpbmUud29ya2VyLXNjcmlwdC8uLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vb2JzZXJ2YWJsZS1mbnNAMC42LjEvbm9kZV9tb2R1bGVzL29ic2VydmFibGUtZm5zL2Rpc3QuZXNtL2ludGVydmFsLmpzPyIpOwoKLyoqKi8gfSksCgovKioqLyAiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL29ic2VydmFibGUtZm5zQDAuNi4xL25vZGVfbW9kdWxlcy9vYnNlcnZhYmxlLWZucy9kaXN0LmVzbS9tYXAuanMiOgovKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiAuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vb2JzZXJ2YWJsZS1mbnNAMC42LjEvbm9kZV9tb2R1bGVzL29ic2VydmFibGUtZm5zL2Rpc3QuZXNtL21hcC5qcyAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKiovIChmdW5jdGlvbihfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKZXZhbCgiXG52YXIgX19nZW5lcmF0b3IgPSAodGhpcyAmJiB0aGlzLl9fZ2VuZXJhdG9yKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgYm9keSkge1xuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XG4gICAgcmV0dXJuIGcgPSB7IG5leHQ6IHZlcmIoMCksIFwidGhyb3dcIjogdmVyYigxKSwgXCJyZXR1cm5cIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IHJldHVybiBmdW5jdGlvbiAodikgeyByZXR1cm4gc3RlcChbbiwgdl0pOyB9OyB9XG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xuICAgICAgICBpZiAoZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XG4gICAgICAgIHdoaWxlIChfKSB0cnkge1xuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xuICAgICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFtvcFswXSAmIDIsIHQudmFsdWVdO1xuICAgICAgICAgICAgc3dpdGNoIChvcFswXSkge1xuICAgICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XG4gICAgICAgICAgICAgICAgY2FzZSA1OiBfLmxhYmVsKys7IHkgPSBvcFsxXTsgb3AgPSBbMF07IGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBpZiAoISh0ID0gXy50cnlzLCB0ID0gdC5sZW5ndGggPiAwICYmIHRbdC5sZW5ndGggLSAxXSkgJiYgKG9wWzBdID09PSA2IHx8IG9wWzBdID09PSAyKSkgeyBfID0gMDsgY29udGludWU7IH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0ICYmIF8ubGFiZWwgPCB0WzJdKSB7IF8ubGFiZWwgPSB0WzJdOyBfLm9wcy5wdXNoKG9wKTsgYnJlYWs7IH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xuICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cbiAgICAgICAgaWYgKG9wWzBdICYgNSkgdGhyb3cgb3BbMV07IHJldHVybiB7IHZhbHVlOiBvcFswXSA/IG9wWzFdIDogdm9pZCAwLCBkb25lOiB0cnVlIH07XG4gICAgfVxufTtcbnZhciBfX2ltcG9ydERlZmF1bHQgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0RGVmYXVsdCkgfHwgZnVuY3Rpb24gKG1vZCkge1xuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgXCJkZWZhdWx0XCI6IG1vZCB9O1xufTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHsgdmFsdWU6IHRydWUgfSkpO1xudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkge1xuICAgICAgICAgICAgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgIH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkge1xuICAgICAgICAgICAgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgIH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xudmFyIF9zY2hlZHVsZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX3NjaGVkdWxlciAqLyBcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9vYnNlcnZhYmxlLWZuc0AwLjYuMS9ub2RlX21vZHVsZXMvb2JzZXJ2YWJsZS1mbnMvZGlzdC5lc20vX3NjaGVkdWxlci5qc1wiKTtcbnZhciBvYnNlcnZhYmxlXzEgPSBfX2ltcG9ydERlZmF1bHQoX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9vYnNlcnZhYmxlICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL29ic2VydmFibGUtZm5zQDAuNi4xL25vZGVfbW9kdWxlcy9vYnNlcnZhYmxlLWZucy9kaXN0LmVzbS9vYnNlcnZhYmxlLmpzXCIpKTtcbnZhciB1bnN1YnNjcmliZV8xID0gX19pbXBvcnREZWZhdWx0KF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vdW5zdWJzY3JpYmUgKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vb2JzZXJ2YWJsZS1mbnNAMC42LjEvbm9kZV9tb2R1bGVzL29ic2VydmFibGUtZm5zL2Rpc3QuZXNtL3Vuc3Vic2NyaWJlLmpzXCIpKTtcbi8qKlxuICogTWFwcyB0aGUgdmFsdWVzIGVtaXR0ZWQgYnkgYW5vdGhlciBvYnNlcnZhYmxlIHRvIGRpZmZlcmVudCB2YWx1ZXMuXG4gKiBUbyBiZSBhcHBsaWVkIHRvIGFuIGlucHV0IG9ic2VydmFibGUgdXNpbmcgYHBpcGUoKWAuXG4gKi9cbmZ1bmN0aW9uIG1hcChtYXBwZXIpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG9ic2VydmFibGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBvYnNlcnZhYmxlXzEuZGVmYXVsdChmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgICAgICAgIHZhciBzY2hlZHVsZXIgPSBuZXcgX3NjaGVkdWxlcl8xLkFzeW5jU2VyaWFsU2NoZWR1bGVyKG9ic2VydmVyKTtcbiAgICAgICAgICAgIHZhciBzdWJzY3JpcHRpb24gPSBvYnNlcnZhYmxlLnN1YnNjcmliZSh7XG4gICAgICAgICAgICAgICAgY29tcGxldGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgc2NoZWR1bGVyLmNvbXBsZXRlKCk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHNjaGVkdWxlci5lcnJvcihlcnJvcik7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBuZXh0OiBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgc2NoZWR1bGVyLnNjaGVkdWxlKGZ1bmN0aW9uIChuZXh0KSB7IHJldHVybiBfX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWFwcGVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gWzQgLyp5aWVsZCovLCBtYXBwZXIoaW5wdXQpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwcGVkID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV4dChtYXBwZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KTsgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkgeyByZXR1cm4gKDAsIHVuc3Vic2NyaWJlXzEuZGVmYXVsdCkoc3Vic2NyaXB0aW9uKTsgfTtcbiAgICAgICAgfSk7XG4gICAgfTtcbn1cbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gbWFwO1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL0BmbHVlbmNlbGFicy9tYXJpbmUud29ya2VyLXNjcmlwdC8uLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vb2JzZXJ2YWJsZS1mbnNAMC42LjEvbm9kZV9tb2R1bGVzL29ic2VydmFibGUtZm5zL2Rpc3QuZXNtL21hcC5qcz8iKTsKCi8qKiovIH0pLAoKLyoqKi8gIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9vYnNlcnZhYmxlLWZuc0AwLjYuMS9ub2RlX21vZHVsZXMvb2JzZXJ2YWJsZS1mbnMvZGlzdC5lc20vbWVyZ2UuanMiOgovKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAhKioqIC4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9vYnNlcnZhYmxlLWZuc0AwLjYuMS9ub2RlX21vZHVsZXMvb2JzZXJ2YWJsZS1mbnMvZGlzdC5lc20vbWVyZ2UuanMgKioqIQogIFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKiovIChmdW5jdGlvbihfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKZXZhbCgiXG52YXIgX19pbXBvcnREZWZhdWx0ID0gKHRoaXMgJiYgdGhpcy5fX2ltcG9ydERlZmF1bHQpIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IFwiZGVmYXVsdFwiOiBtb2QgfTtcbn07XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7IHZhbHVlOiB0cnVlIH0pKTtcbnZhciBvYnNlcnZhYmxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL29ic2VydmFibGUgKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vb2JzZXJ2YWJsZS1mbnNAMC42LjEvbm9kZV9tb2R1bGVzL29ic2VydmFibGUtZm5zL2Rpc3QuZXNtL29ic2VydmFibGUuanNcIik7XG52YXIgdW5zdWJzY3JpYmVfMSA9IF9faW1wb3J0RGVmYXVsdChfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL3Vuc3Vic2NyaWJlICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL29ic2VydmFibGUtZm5zQDAuNi4xL25vZGVfbW9kdWxlcy9vYnNlcnZhYmxlLWZucy9kaXN0LmVzbS91bnN1YnNjcmliZS5qc1wiKSk7XG5mdW5jdGlvbiBtZXJnZSgpIHtcbiAgICB2YXIgb2JzZXJ2YWJsZXMgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICBvYnNlcnZhYmxlc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgIH1cbiAgICBpZiAob2JzZXJ2YWJsZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybiBvYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZS5mcm9tKFtdKTtcbiAgICB9XG4gICAgcmV0dXJuIG5ldyBvYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZShmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgICAgdmFyIGNvbXBsZXRlZCA9IDA7XG4gICAgICAgIHZhciBzdWJzY3JpcHRpb25zID0gb2JzZXJ2YWJsZXMubWFwKGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICAgICAgcmV0dXJuIGlucHV0LnN1YnNjcmliZSh7XG4gICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlci5lcnJvcihlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIHVuc3Vic2NyaWJlQWxsKCk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBuZXh0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIubmV4dCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBjb21wbGV0ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoKytjb21wbGV0ZWQgPT09IG9ic2VydmFibGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIuY29tcGxldGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVuc3Vic2NyaWJlQWxsKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHZhciB1bnN1YnNjcmliZUFsbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHN1YnNjcmlwdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoc3Vic2NyaXB0aW9uKSB7IHJldHVybiAoMCwgdW5zdWJzY3JpYmVfMS5kZWZhdWx0KShzdWJzY3JpcHRpb24pOyB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHVuc3Vic2NyaWJlQWxsO1xuICAgIH0pO1xufVxuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBtZXJnZTtcblxuXG4vLyMgc291cmNlVVJMPXdlYnBhY2s6Ly9AZmx1ZW5jZWxhYnMvbWFyaW5lLndvcmtlci1zY3JpcHQvLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL29ic2VydmFibGUtZm5zQDAuNi4xL25vZGVfbW9kdWxlcy9vYnNlcnZhYmxlLWZucy9kaXN0LmVzbS9tZXJnZS5qcz8iKTsKCi8qKiovIH0pLAoKLyoqKi8gIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9vYnNlcnZhYmxlLWZuc0AwLjYuMS9ub2RlX21vZHVsZXMvb2JzZXJ2YWJsZS1mbnMvZGlzdC5lc20vbXVsdGljYXN0LmpzIjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL29ic2VydmFibGUtZm5zQDAuNi4xL25vZGVfbW9kdWxlcy9vYnNlcnZhYmxlLWZucy9kaXN0LmVzbS9tdWx0aWNhc3QuanMgKioqIQogIFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoZnVuY3Rpb24oX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCmV2YWwoIlxudmFyIF9faW1wb3J0RGVmYXVsdCA9ICh0aGlzICYmIHRoaXMuX19pbXBvcnREZWZhdWx0KSB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBcImRlZmF1bHRcIjogbW9kIH07XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoeyB2YWx1ZTogdHJ1ZSB9KSk7XG52YXIgb2JzZXJ2YWJsZV8xID0gX19pbXBvcnREZWZhdWx0KF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vb2JzZXJ2YWJsZSAqLyBcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9vYnNlcnZhYmxlLWZuc0AwLjYuMS9ub2RlX21vZHVsZXMvb2JzZXJ2YWJsZS1mbnMvZGlzdC5lc20vb2JzZXJ2YWJsZS5qc1wiKSk7XG52YXIgc3ViamVjdF8xID0gX19pbXBvcnREZWZhdWx0KF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vc3ViamVjdCAqLyBcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9vYnNlcnZhYmxlLWZuc0AwLjYuMS9ub2RlX21vZHVsZXMvb2JzZXJ2YWJsZS1mbnMvZGlzdC5lc20vc3ViamVjdC5qc1wiKSk7XG52YXIgdW5zdWJzY3JpYmVfMSA9IF9faW1wb3J0RGVmYXVsdChfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL3Vuc3Vic2NyaWJlICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL29ic2VydmFibGUtZm5zQDAuNi4xL25vZGVfbW9kdWxlcy9vYnNlcnZhYmxlLWZucy9kaXN0LmVzbS91bnN1YnNjcmliZS5qc1wiKSk7XG4vLyBUT0RPOiBTdWJqZWN0IGFscmVhZHkgY3JlYXRlcyBhZGRpdGlvbmFsIG9ic2VydmFibGVzIFwidW5kZXIgdGhlIGhvb2RcIixcbi8vICAgICAgIG5vdyB3ZSBpbnRyb2R1Y2UgZXZlbiBtb3JlLiBBIHRydWUgbmF0aXZlIE11bHRpY2FzdE9ic2VydmFibGVcbi8vICAgICAgIHdvdWxkIGJlIHByZWZlcmFibGUuXG4vKipcbiAqIFRha2VzIGEgXCJjb2xkXCIgb2JzZXJ2YWJsZSBhbmQgcmV0dXJucyBhIHdyYXBwaW5nIFwiaG90XCIgb2JzZXJ2YWJsZSB0aGF0XG4gKiBwcm94aWVzIHRoZSBpbnB1dCBvYnNlcnZhYmxlJ3MgdmFsdWVzIGFuZCBlcnJvcnMuXG4gKlxuICogQW4gb2JzZXJ2YWJsZSBpcyBjYWxsZWQgXCJjb2xkXCIgd2hlbiBpdHMgaW5pdGlhbGl6YXRpb24gZnVuY3Rpb24gaXMgcnVuXG4gKiBmb3IgZWFjaCBuZXcgc3Vic2NyaWJlci4gVGhpcyBpcyBob3cgb2JzZXJ2YWJsZS1mbnMncyBgT2JzZXJ2YWJsZWBcbiAqIGltcGxlbWVudGF0aW9uIHdvcmtzLlxuICpcbiAqIEEgaG90IG9ic2VydmFibGUgaXMgYW4gb2JzZXJ2YWJsZSB3aGVyZSBuZXcgc3Vic2NyaWJlcnMgc3Vic2NyaWJlIHRvXG4gKiB0aGUgdXBjb21pbmcgdmFsdWVzIG9mIGFuIGFscmVhZHktaW5pdGlhbGlhemVkIG9ic2VydmFibGUuXG4gKlxuICogVGhlIG11bHRpY2FzdCBvYnNlcnZhYmxlIHdpbGwgbGF6aWx5IHN1YnNjcmliZSB0byB0aGUgc291cmNlIG9ic2VydmFibGVcbiAqIG9uY2UgaXQgaGFzIGl0cyBmaXJzdCBvd24gc3Vic2NyaWJlciBhbmQgd2lsbCB1bnN1YnNjcmliZSBmcm9tIHRoZVxuICogc291cmNlIG9ic2VydmFibGUgd2hlbiBpdHMgbGFzdCBvd24gc3Vic2NyaWJlciB1bnN1YnNjcmliZWQuXG4gKi9cbmZ1bmN0aW9uIG11bHRpY2FzdChjb2xkT2JzZXJ2YWJsZSkge1xuICAgIHZhciBzdWJqZWN0ID0gbmV3IHN1YmplY3RfMS5kZWZhdWx0KCk7XG4gICAgdmFyIHNvdXJjZVN1YnNjcmlwdGlvbjtcbiAgICB2YXIgc3Vic2NyaWJlckNvdW50ID0gMDtcbiAgICByZXR1cm4gbmV3IG9ic2VydmFibGVfMS5kZWZhdWx0KGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgICAvLyBJbml0IHNvdXJjZSBzdWJzY3JpcHRpb24gbGF6aWx5XG4gICAgICAgIGlmICghc291cmNlU3Vic2NyaXB0aW9uKSB7XG4gICAgICAgICAgICBzb3VyY2VTdWJzY3JpcHRpb24gPSBjb2xkT2JzZXJ2YWJsZS5zdWJzY3JpYmUoc3ViamVjdCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gUGlwZSBhbGwgZXZlbnRzIGZyb20gYHN1YmplY3RgIGludG8gdGhpcyBvYnNlcnZhYmxlXG4gICAgICAgIHZhciBzdWJzY3JpcHRpb24gPSBzdWJqZWN0LnN1YnNjcmliZShvYnNlcnZlcik7XG4gICAgICAgIHN1YnNjcmliZXJDb3VudCsrO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgc3Vic2NyaWJlckNvdW50LS07XG4gICAgICAgICAgICBzdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICAgIC8vIENsb3NlIHNvdXJjZSBzdWJzY3JpcHRpb24gb25jZSBsYXN0IHN1YnNjcmliZXIgaGFzIHVuc3Vic2NyaWJlZFxuICAgICAgICAgICAgaWYgKHN1YnNjcmliZXJDb3VudCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICgwLCB1bnN1YnNjcmliZV8xLmRlZmF1bHQpKHNvdXJjZVN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICAgICAgc291cmNlU3Vic2NyaXB0aW9uID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0pO1xufVxuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBtdWx0aWNhc3Q7XG5cblxuLy8jIHNvdXJjZVVSTD13ZWJwYWNrOi8vQGZsdWVuY2VsYWJzL21hcmluZS53b3JrZXItc2NyaXB0Ly4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9vYnNlcnZhYmxlLWZuc0AwLjYuMS9ub2RlX21vZHVsZXMvb2JzZXJ2YWJsZS1mbnMvZGlzdC5lc20vbXVsdGljYXN0LmpzPyIpOwoKLyoqKi8gfSksCgovKioqLyAiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL29ic2VydmFibGUtZm5zQDAuNi4xL25vZGVfbW9kdWxlcy9vYnNlcnZhYmxlLWZucy9kaXN0LmVzbS9vYnNlcnZhYmxlLmpzIjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAhKioqIC4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9vYnNlcnZhYmxlLWZuc0AwLjYuMS9ub2RlX21vZHVsZXMvb2JzZXJ2YWJsZS1mbnMvZGlzdC5lc20vb2JzZXJ2YWJsZS5qcyAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoZnVuY3Rpb24oX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCmV2YWwoIlxudmFyIF9fc3ByZWFkQXJyYXkgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXkpIHx8IGZ1bmN0aW9uICh0bywgZnJvbSwgcGFjaykge1xuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoeyB2YWx1ZTogdHJ1ZSB9KSk7XG5leHBvcnRzLk9ic2VydmFibGUgPSBleHBvcnRzLlN1YnNjcmlwdGlvbk9ic2VydmVyID0gZXhwb3J0cy5TdWJzY3JpcHRpb24gPSB2b2lkIDA7XG4vKipcbiAqIEJhc2VkIG9uIDxodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vemVucGFyc2luZy96ZW4tb2JzZXJ2YWJsZS9tYXN0ZXIvc3JjL09ic2VydmFibGUuanM+XG4gKiBBdCBjb21taXQ6IGY2Mzg0OWE4YzYwYWY1ZDUxNGVmYzhlOWQ2MTM4ZDgyNzNjNDlhZDZcbiAqL1xuX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9zeW1ib2xzICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL29ic2VydmFibGUtZm5zQDAuNi4xL25vZGVfbW9kdWxlcy9vYnNlcnZhYmxlLWZucy9kaXN0LmVzbS9zeW1ib2xzLmpzXCIpO1xudmFyIF9zeW1ib2xzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL19zeW1ib2xzICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL29ic2VydmFibGUtZm5zQDAuNi4xL25vZGVfbW9kdWxlcy9vYnNlcnZhYmxlLWZucy9kaXN0LmVzbS9fc3ltYm9scy5qc1wiKTtcbnZhciBTeW1ib2xJdGVyYXRvciA9ICgwLCBfc3ltYm9sc18xLmdldFN5bWJvbCkoXCJpdGVyYXRvclwiKTtcbnZhciBTeW1ib2xPYnNlcnZhYmxlID0gKDAsIF9zeW1ib2xzXzEuZ2V0U3ltYm9sKShcIm9ic2VydmFibGVcIik7XG52YXIgU3ltYm9sU3BlY2llcyA9ICgwLCBfc3ltYm9sc18xLmdldFN5bWJvbCkoXCJzcGVjaWVzXCIpO1xuLy8gPT09IEFic3RyYWN0IE9wZXJhdGlvbnMgPT09XG5mdW5jdGlvbiBnZXRNZXRob2Qob2JqLCBrZXkpIHtcbiAgICB2YXIgdmFsdWUgPSBvYmpba2V5XTtcbiAgICBpZiAodmFsdWUgPT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIHZhbHVlICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcih2YWx1ZSArIFwiIGlzIG5vdCBhIGZ1bmN0aW9uXCIpO1xuICAgIH1cbiAgICByZXR1cm4gdmFsdWU7XG59XG5mdW5jdGlvbiBnZXRTcGVjaWVzKG9iaikge1xuICAgIHZhciBjdG9yID0gb2JqLmNvbnN0cnVjdG9yO1xuICAgIGlmIChjdG9yICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgY3RvciA9IGN0b3JbU3ltYm9sU3BlY2llc107XG4gICAgICAgIGlmIChjdG9yID09PSBudWxsKSB7XG4gICAgICAgICAgICBjdG9yID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBjdG9yICE9PSB1bmRlZmluZWQgPyBjdG9yIDogT2JzZXJ2YWJsZTtcbn1cbmZ1bmN0aW9uIGlzT2JzZXJ2YWJsZSh4KSB7XG4gICAgcmV0dXJuIHggaW5zdGFuY2VvZiBPYnNlcnZhYmxlOyAvLyBTUEVDOiBCcmFuZCBjaGVja1xufVxuZnVuY3Rpb24gaG9zdFJlcG9ydEVycm9yKGVycm9yKSB7XG4gICAgaWYgKGhvc3RSZXBvcnRFcnJvci5sb2cpIHtcbiAgICAgICAgaG9zdFJlcG9ydEVycm9yLmxvZyhlcnJvcik7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgdGhyb3cgZXJyb3I7IH0sIDApO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGVucXVldWUoZm4pIHtcbiAgICBQcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGZuKCk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGhvc3RSZXBvcnRFcnJvcihlKTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuZnVuY3Rpb24gY2xlYW51cFN1YnNjcmlwdGlvbihzdWJzY3JpcHRpb24pIHtcbiAgICB2YXIgY2xlYW51cCA9IHN1YnNjcmlwdGlvbi5fY2xlYW51cDtcbiAgICBpZiAoY2xlYW51cCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgc3Vic2NyaXB0aW9uLl9jbGVhbnVwID0gdW5kZWZpbmVkO1xuICAgIGlmICghY2xlYW51cCkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIGlmICh0eXBlb2YgY2xlYW51cCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICBjbGVhbnVwKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgdW5zdWJzY3JpYmUgPSBnZXRNZXRob2QoY2xlYW51cCwgXCJ1bnN1YnNjcmliZVwiKTtcbiAgICAgICAgICAgIGlmICh1bnN1YnNjcmliZSkge1xuICAgICAgICAgICAgICAgIHVuc3Vic2NyaWJlLmNhbGwoY2xlYW51cCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgaG9zdFJlcG9ydEVycm9yKGUpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGNsb3NlU3Vic2NyaXB0aW9uKHN1YnNjcmlwdGlvbikge1xuICAgIHN1YnNjcmlwdGlvbi5fb2JzZXJ2ZXIgPSB1bmRlZmluZWQ7XG4gICAgc3Vic2NyaXB0aW9uLl9xdWV1ZSA9IHVuZGVmaW5lZDtcbiAgICBzdWJzY3JpcHRpb24uX3N0YXRlID0gXCJjbG9zZWRcIjtcbn1cbmZ1bmN0aW9uIGZsdXNoU3Vic2NyaXB0aW9uKHN1YnNjcmlwdGlvbikge1xuICAgIHZhciBxdWV1ZSA9IHN1YnNjcmlwdGlvbi5fcXVldWU7XG4gICAgaWYgKCFxdWV1ZSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHN1YnNjcmlwdGlvbi5fcXVldWUgPSB1bmRlZmluZWQ7XG4gICAgc3Vic2NyaXB0aW9uLl9zdGF0ZSA9IFwicmVhZHlcIjtcbiAgICBmb3IgKHZhciBfaSA9IDAsIHF1ZXVlXzEgPSBxdWV1ZTsgX2kgPCBxdWV1ZV8xLmxlbmd0aDsgX2krKykge1xuICAgICAgICB2YXIgaXRlbSA9IHF1ZXVlXzFbX2ldO1xuICAgICAgICBub3RpZnlTdWJzY3JpcHRpb24oc3Vic2NyaXB0aW9uLCBpdGVtLnR5cGUsIGl0ZW0udmFsdWUpO1xuICAgICAgICBpZiAoc3Vic2NyaXB0aW9uLl9zdGF0ZSA9PT0gXCJjbG9zZWRcIikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiBub3RpZnlTdWJzY3JpcHRpb24oc3Vic2NyaXB0aW9uLCB0eXBlLCB2YWx1ZSkge1xuICAgIHN1YnNjcmlwdGlvbi5fc3RhdGUgPSBcInJ1bm5pbmdcIjtcbiAgICB2YXIgb2JzZXJ2ZXIgPSBzdWJzY3JpcHRpb24uX29ic2VydmVyO1xuICAgIHRyeSB7XG4gICAgICAgIHZhciBtID0gb2JzZXJ2ZXIgPyBnZXRNZXRob2Qob2JzZXJ2ZXIsIHR5cGUpIDogdW5kZWZpbmVkO1xuICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgXCJuZXh0XCI6XG4gICAgICAgICAgICAgICAgaWYgKG0pXG4gICAgICAgICAgICAgICAgICAgIG0uY2FsbChvYnNlcnZlciwgdmFsdWUpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcImVycm9yXCI6XG4gICAgICAgICAgICAgICAgY2xvc2VTdWJzY3JpcHRpb24oc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgICAgICBpZiAobSlcbiAgICAgICAgICAgICAgICAgICAgbS5jYWxsKG9ic2VydmVyLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICB0aHJvdyB2YWx1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJjb21wbGV0ZVwiOlxuICAgICAgICAgICAgICAgIGNsb3NlU3Vic2NyaXB0aW9uKHN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICAgICAgaWYgKG0pXG4gICAgICAgICAgICAgICAgICAgIG0uY2FsbChvYnNlcnZlcik7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgaG9zdFJlcG9ydEVycm9yKGUpO1xuICAgIH1cbiAgICBpZiAoc3Vic2NyaXB0aW9uLl9zdGF0ZSA9PT0gXCJjbG9zZWRcIikge1xuICAgICAgICBjbGVhbnVwU3Vic2NyaXB0aW9uKHN1YnNjcmlwdGlvbik7XG4gICAgfVxuICAgIGVsc2UgaWYgKHN1YnNjcmlwdGlvbi5fc3RhdGUgPT09IFwicnVubmluZ1wiKSB7XG4gICAgICAgIHN1YnNjcmlwdGlvbi5fc3RhdGUgPSBcInJlYWR5XCI7XG4gICAgfVxufVxuZnVuY3Rpb24gb25Ob3RpZnkoc3Vic2NyaXB0aW9uLCB0eXBlLCB2YWx1ZSkge1xuICAgIGlmIChzdWJzY3JpcHRpb24uX3N0YXRlID09PSBcImNsb3NlZFwiKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHN1YnNjcmlwdGlvbi5fc3RhdGUgPT09IFwiYnVmZmVyaW5nXCIpIHtcbiAgICAgICAgc3Vic2NyaXB0aW9uLl9xdWV1ZSA9IHN1YnNjcmlwdGlvbi5fcXVldWUgfHwgW107XG4gICAgICAgIHN1YnNjcmlwdGlvbi5fcXVldWUucHVzaCh7IHR5cGU6IHR5cGUsIHZhbHVlOiB2YWx1ZSB9KTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoc3Vic2NyaXB0aW9uLl9zdGF0ZSAhPT0gXCJyZWFkeVwiKSB7XG4gICAgICAgIHN1YnNjcmlwdGlvbi5fc3RhdGUgPSBcImJ1ZmZlcmluZ1wiO1xuICAgICAgICBzdWJzY3JpcHRpb24uX3F1ZXVlID0gW3sgdHlwZTogdHlwZSwgdmFsdWU6IHZhbHVlIH1dO1xuICAgICAgICBlbnF1ZXVlKGZ1bmN0aW9uICgpIHsgcmV0dXJuIGZsdXNoU3Vic2NyaXB0aW9uKHN1YnNjcmlwdGlvbik7IH0pO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIG5vdGlmeVN1YnNjcmlwdGlvbihzdWJzY3JpcHRpb24sIHR5cGUsIHZhbHVlKTtcbn1cbnZhciBTdWJzY3JpcHRpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gU3Vic2NyaXB0aW9uKG9ic2VydmVyLCBzdWJzY3JpYmVyKSB7XG4gICAgICAgIC8vIEFTU0VSVDogb2JzZXJ2ZXIgaXMgYW4gb2JqZWN0XG4gICAgICAgIC8vIEFTU0VSVDogc3Vic2NyaWJlciBpcyBjYWxsYWJsZVxuICAgICAgICB0aGlzLl9jbGVhbnVwID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLl9vYnNlcnZlciA9IG9ic2VydmVyO1xuICAgICAgICB0aGlzLl9xdWV1ZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5fc3RhdGUgPSBcImluaXRpYWxpemluZ1wiO1xuICAgICAgICB2YXIgc3Vic2NyaXB0aW9uT2JzZXJ2ZXIgPSBuZXcgU3Vic2NyaXB0aW9uT2JzZXJ2ZXIodGhpcyk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLl9jbGVhbnVwID0gc3Vic2NyaWJlci5jYWxsKHVuZGVmaW5lZCwgc3Vic2NyaXB0aW9uT2JzZXJ2ZXIpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICBzdWJzY3JpcHRpb25PYnNlcnZlci5lcnJvcihlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fc3RhdGUgPT09IFwiaW5pdGlhbGl6aW5nXCIpIHtcbiAgICAgICAgICAgIHRoaXMuX3N0YXRlID0gXCJyZWFkeVwiO1xuICAgICAgICB9XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdWJzY3JpcHRpb24ucHJvdG90eXBlLCBcImNsb3NlZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3N0YXRlID09PSBcImNsb3NlZFwiO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgU3Vic2NyaXB0aW9uLnByb3RvdHlwZS51bnN1YnNjcmliZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuX3N0YXRlICE9PSBcImNsb3NlZFwiKSB7XG4gICAgICAgICAgICBjbG9zZVN1YnNjcmlwdGlvbih0aGlzKTtcbiAgICAgICAgICAgIGNsZWFudXBTdWJzY3JpcHRpb24odGhpcyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBTdWJzY3JpcHRpb247XG59KCkpO1xuZXhwb3J0cy5TdWJzY3JpcHRpb24gPSBTdWJzY3JpcHRpb247XG52YXIgU3Vic2NyaXB0aW9uT2JzZXJ2ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gU3Vic2NyaXB0aW9uT2JzZXJ2ZXIoc3Vic2NyaXB0aW9uKSB7XG4gICAgICAgIHRoaXMuX3N1YnNjcmlwdGlvbiA9IHN1YnNjcmlwdGlvbjtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1YnNjcmlwdGlvbk9ic2VydmVyLnByb3RvdHlwZSwgXCJjbG9zZWRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX3N1YnNjcmlwdGlvbi5fc3RhdGUgPT09IFwiY2xvc2VkXCI7IH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTdWJzY3JpcHRpb25PYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh2YWx1ZSkgeyBvbk5vdGlmeSh0aGlzLl9zdWJzY3JpcHRpb24sIFwibmV4dFwiLCB2YWx1ZSk7IH07XG4gICAgU3Vic2NyaXB0aW9uT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKHZhbHVlKSB7IG9uTm90aWZ5KHRoaXMuX3N1YnNjcmlwdGlvbiwgXCJlcnJvclwiLCB2YWx1ZSk7IH07XG4gICAgU3Vic2NyaXB0aW9uT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlID0gZnVuY3Rpb24gKCkgeyBvbk5vdGlmeSh0aGlzLl9zdWJzY3JpcHRpb24sIFwiY29tcGxldGVcIik7IH07XG4gICAgcmV0dXJuIFN1YnNjcmlwdGlvbk9ic2VydmVyO1xufSgpKTtcbmV4cG9ydHMuU3Vic2NyaXB0aW9uT2JzZXJ2ZXIgPSBTdWJzY3JpcHRpb25PYnNlcnZlcjtcbi8qKlxuICogVGhlIGJhc2ljIE9ic2VydmFibGUgY2xhc3MuIFRoaXMgcHJpbWl0aXZlIGlzIHVzZWQgdG8gd3JhcCBhc3luY2hyb25vdXNcbiAqIGRhdGEgc3RyZWFtcyBpbiBhIGNvbW1vbiBzdGFuZGFyZGl6ZWQgZGF0YSB0eXBlIHRoYXQgaXMgaW50ZXJvcGVyYWJsZVxuICogYmV0d2VlbiBsaWJyYXJpZXMgYW5kIGNhbiBiZSBjb21wb3NlZCB0byByZXByZXNlbnQgbW9yZSBjb21wbGV4IHByb2Nlc3Nlcy5cbiAqL1xudmFyIE9ic2VydmFibGUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gT2JzZXJ2YWJsZShzdWJzY3JpYmVyKSB7XG4gICAgICAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBPYnNlcnZhYmxlKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIk9ic2VydmFibGUgY2Fubm90IGJlIGNhbGxlZCBhcyBhIGZ1bmN0aW9uXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2Ygc3Vic2NyaWJlciAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiT2JzZXJ2YWJsZSBpbml0aWFsaXplciBtdXN0IGJlIGEgZnVuY3Rpb25cIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fc3Vic2NyaWJlciA9IHN1YnNjcmliZXI7XG4gICAgfVxuICAgIE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZSA9IGZ1bmN0aW9uIChuZXh0T3JPYnNlcnZlciwgb25FcnJvciwgb25Db21wbGV0ZSkge1xuICAgICAgICBpZiAodHlwZW9mIG5leHRPck9ic2VydmVyICE9PSBcIm9iamVjdFwiIHx8IG5leHRPck9ic2VydmVyID09PSBudWxsKSB7XG4gICAgICAgICAgICBuZXh0T3JPYnNlcnZlciA9IHtcbiAgICAgICAgICAgICAgICBuZXh0OiBuZXh0T3JPYnNlcnZlcixcbiAgICAgICAgICAgICAgICBlcnJvcjogb25FcnJvcixcbiAgICAgICAgICAgICAgICBjb21wbGV0ZTogb25Db21wbGV0ZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IFN1YnNjcmlwdGlvbihuZXh0T3JPYnNlcnZlciwgdGhpcy5fc3Vic2NyaWJlcik7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS5waXBlID0gZnVuY3Rpb24gKGZpcnN0KSB7XG4gICAgICAgIHZhciBtYXBwZXJzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBtYXBwZXJzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZSBuby10aGlzLWFzc2lnbm1lbnRcbiAgICAgICAgdmFyIGludGVybWVkaWF0ZSA9IHRoaXM7XG4gICAgICAgIGZvciAodmFyIF9hID0gMCwgX2IgPSBfX3NwcmVhZEFycmF5KFtmaXJzdF0sIG1hcHBlcnMsIHRydWUpOyBfYSA8IF9iLmxlbmd0aDsgX2ErKykge1xuICAgICAgICAgICAgdmFyIG1hcHBlciA9IF9iW19hXTtcbiAgICAgICAgICAgIGludGVybWVkaWF0ZSA9IG1hcHBlcihpbnRlcm1lZGlhdGUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpbnRlcm1lZGlhdGU7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS50YXAgPSBmdW5jdGlvbiAobmV4dE9yT2JzZXJ2ZXIsIG9uRXJyb3IsIG9uQ29tcGxldGUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIHRhcE9ic2VydmVyID0gdHlwZW9mIG5leHRPck9ic2VydmVyICE9PSBcIm9iamVjdFwiIHx8IG5leHRPck9ic2VydmVyID09PSBudWxsXG4gICAgICAgICAgICA/IHtcbiAgICAgICAgICAgICAgICBuZXh0OiBuZXh0T3JPYnNlcnZlcixcbiAgICAgICAgICAgICAgICBlcnJvcjogb25FcnJvcixcbiAgICAgICAgICAgICAgICBjb21wbGV0ZTogb25Db21wbGV0ZVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgOiBuZXh0T3JPYnNlcnZlcjtcbiAgICAgICAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlKGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzLnN1YnNjcmliZSh7XG4gICAgICAgICAgICAgICAgbmV4dDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcE9ic2VydmVyLm5leHQgJiYgdGFwT2JzZXJ2ZXIubmV4dCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLm5leHQodmFsdWUpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICB0YXBPYnNlcnZlci5lcnJvciAmJiB0YXBPYnNlcnZlci5lcnJvcihlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLmVycm9yKGVycm9yKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcE9ic2VydmVyLmNvbXBsZXRlICYmIHRhcE9ic2VydmVyLmNvbXBsZXRlKCk7XG4gICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLmNvbXBsZXRlKCk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBzdGFydDogZnVuY3Rpb24gKHN1YnNjcmlwdGlvbikge1xuICAgICAgICAgICAgICAgICAgICB0YXBPYnNlcnZlci5zdGFydCAmJiB0YXBPYnNlcnZlci5zdGFydChzdWJzY3JpcHRpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIE9ic2VydmFibGUucHJvdG90eXBlLmZvckVhY2ggPSBmdW5jdGlvbiAoZm4pIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZm4gIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgIHJlamVjdChuZXcgVHlwZUVycm9yKGZuICsgXCIgaXMgbm90IGEgZnVuY3Rpb25cIikpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZ1bmN0aW9uIGRvbmUoKSB7XG4gICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh1bmRlZmluZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHN1YnNjcmlwdGlvbiA9IF90aGlzLnN1YnNjcmliZSh7XG4gICAgICAgICAgICAgICAgbmV4dDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmbih2YWx1ZSwgZG9uZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBjb21wbGV0ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHVuZGVmaW5lZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZS5wcm90b3R5cGUubWFwID0gZnVuY3Rpb24gKGZuKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICh0eXBlb2YgZm4gIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihmbiArIFwiIGlzIG5vdCBhIGZ1bmN0aW9uXCIpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBDID0gZ2V0U3BlY2llcyh0aGlzKTtcbiAgICAgICAgcmV0dXJuIG5ldyBDKGZ1bmN0aW9uIChvYnNlcnZlcikgeyByZXR1cm4gX3RoaXMuc3Vic2NyaWJlKHtcbiAgICAgICAgICAgIG5leHQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHZhciBwcm9wYWdhdGVkVmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBwcm9wYWdhdGVkVmFsdWUgPSBmbih2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvYnNlcnZlci5lcnJvcihlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXIubmV4dChwcm9wYWdhdGVkVmFsdWUpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoZSkgeyBvYnNlcnZlci5lcnJvcihlKTsgfSxcbiAgICAgICAgICAgIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7IG9ic2VydmVyLmNvbXBsZXRlKCk7IH0sXG4gICAgICAgIH0pOyB9KTtcbiAgICB9O1xuICAgIE9ic2VydmFibGUucHJvdG90eXBlLmZpbHRlciA9IGZ1bmN0aW9uIChmbikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAodHlwZW9mIGZuICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoZm4gKyBcIiBpcyBub3QgYSBmdW5jdGlvblwiKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgQyA9IGdldFNwZWNpZXModGhpcyk7XG4gICAgICAgIHJldHVybiBuZXcgQyhmdW5jdGlvbiAob2JzZXJ2ZXIpIHsgcmV0dXJuIF90aGlzLnN1YnNjcmliZSh7XG4gICAgICAgICAgICBuZXh0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWZuKHZhbHVlKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9ic2VydmVyLmVycm9yKGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBvYnNlcnZlci5uZXh0KHZhbHVlKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKGUpIHsgb2JzZXJ2ZXIuZXJyb3IoZSk7IH0sXG4gICAgICAgICAgICBjb21wbGV0ZTogZnVuY3Rpb24gKCkgeyBvYnNlcnZlci5jb21wbGV0ZSgpOyB9LFxuICAgICAgICB9KTsgfSk7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS5yZWR1Y2UgPSBmdW5jdGlvbiAoZm4sIHNlZWQpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKHR5cGVvZiBmbiAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGZuICsgXCIgaXMgbm90IGEgZnVuY3Rpb25cIik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIEMgPSBnZXRTcGVjaWVzKHRoaXMpO1xuICAgICAgICB2YXIgaGFzU2VlZCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxO1xuICAgICAgICB2YXIgaGFzVmFsdWUgPSBmYWxzZTtcbiAgICAgICAgdmFyIGFjYyA9IHNlZWQ7XG4gICAgICAgIHJldHVybiBuZXcgQyhmdW5jdGlvbiAob2JzZXJ2ZXIpIHsgcmV0dXJuIF90aGlzLnN1YnNjcmliZSh7XG4gICAgICAgICAgICBuZXh0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICB2YXIgZmlyc3QgPSAhaGFzVmFsdWU7XG4gICAgICAgICAgICAgICAgaGFzVmFsdWUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGlmICghZmlyc3QgfHwgaGFzU2VlZCkge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWNjID0gZm4oYWNjLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvYnNlcnZlci5lcnJvcihlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYWNjID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoZSkgeyBvYnNlcnZlci5lcnJvcihlKTsgfSxcbiAgICAgICAgICAgIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFoYXNWYWx1ZSAmJiAhaGFzU2VlZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2JzZXJ2ZXIuZXJyb3IobmV3IFR5cGVFcnJvcihcIkNhbm5vdCByZWR1Y2UgYW4gZW1wdHkgc2VxdWVuY2VcIikpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBvYnNlcnZlci5uZXh0KGFjYyk7XG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXIuY29tcGxldGUoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pOyB9KTtcbiAgICB9O1xuICAgIE9ic2VydmFibGUucHJvdG90eXBlLmNvbmNhdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIHNvdXJjZXMgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHNvdXJjZXNbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgQyA9IGdldFNwZWNpZXModGhpcyk7XG4gICAgICAgIHJldHVybiBuZXcgQyhmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgICAgICAgIHZhciBzdWJzY3JpcHRpb247XG4gICAgICAgICAgICB2YXIgaW5kZXggPSAwO1xuICAgICAgICAgICAgZnVuY3Rpb24gc3RhcnROZXh0KG5leHQpIHtcbiAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb24gPSBuZXh0LnN1YnNjcmliZSh7XG4gICAgICAgICAgICAgICAgICAgIG5leHQ6IGZ1bmN0aW9uICh2KSB7IG9ic2VydmVyLm5leHQodik7IH0sXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoZSkgeyBvYnNlcnZlci5lcnJvcihlKTsgfSxcbiAgICAgICAgICAgICAgICAgICAgY29tcGxldGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmRleCA9PT0gc291cmNlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb24gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIuY29tcGxldGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0TmV4dChDLmZyb20oc291cmNlc1tpbmRleCsrXSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3RhcnROZXh0KF90aGlzKTtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHN1YnNjcmlwdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9uID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZS5wcm90b3R5cGUuZmxhdE1hcCA9IGZ1bmN0aW9uIChmbikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAodHlwZW9mIGZuICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoZm4gKyBcIiBpcyBub3QgYSBmdW5jdGlvblwiKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgQyA9IGdldFNwZWNpZXModGhpcyk7XG4gICAgICAgIHJldHVybiBuZXcgQyhmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgICAgICAgIHZhciBzdWJzY3JpcHRpb25zID0gW107XG4gICAgICAgICAgICB2YXIgb3V0ZXIgPSBfdGhpcy5zdWJzY3JpYmUoe1xuICAgICAgICAgICAgICAgIG5leHQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9ybWFsaXplZFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZm4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9ybWFsaXplZFZhbHVlID0gZm4odmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2JzZXJ2ZXIuZXJyb3IoZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub3JtYWxpemVkVmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5uZXIgPSBDLmZyb20obm9ybWFsaXplZFZhbHVlKS5zdWJzY3JpYmUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dDogZnVuY3Rpb24gKGlubmVyVmFsdWUpIHsgb2JzZXJ2ZXIubmV4dChpbm5lclZhbHVlKTsgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoZSkgeyBvYnNlcnZlci5lcnJvcihlKTsgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSBzdWJzY3JpcHRpb25zLmluZGV4T2YoaW5uZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpID49IDApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbnMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlSWZEb25lKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9ucy5wdXNoKGlubmVyKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoZSkgeyBvYnNlcnZlci5lcnJvcihlKTsgfSxcbiAgICAgICAgICAgICAgICBjb21wbGV0ZTogZnVuY3Rpb24gKCkgeyBjb21wbGV0ZUlmRG9uZSgpOyB9LFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBmdW5jdGlvbiBjb21wbGV0ZUlmRG9uZSgpIHtcbiAgICAgICAgICAgICAgICBpZiAob3V0ZXIuY2xvc2VkICYmIHN1YnNjcmlwdGlvbnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLmNvbXBsZXRlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb25zLmZvckVhY2goZnVuY3Rpb24gKHMpIHsgcmV0dXJuIHMudW5zdWJzY3JpYmUoKTsgfSk7XG4gICAgICAgICAgICAgICAgb3V0ZXIudW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZS5wcm90b3R5cGVbKFN5bWJvbC5vYnNlcnZhYmxlLCBTeW1ib2xPYnNlcnZhYmxlKV0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9O1xuICAgIE9ic2VydmFibGUuZnJvbSA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICAgIHZhciBDID0gKHR5cGVvZiB0aGlzID09PSBcImZ1bmN0aW9uXCIgPyB0aGlzIDogT2JzZXJ2YWJsZSk7XG4gICAgICAgIGlmICh4ID09IG51bGwpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoeCArIFwiIGlzIG5vdCBhbiBvYmplY3RcIik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG9ic2VydmFibGVNZXRob2QgPSBnZXRNZXRob2QoeCwgU3ltYm9sT2JzZXJ2YWJsZSk7XG4gICAgICAgIGlmIChvYnNlcnZhYmxlTWV0aG9kKSB7XG4gICAgICAgICAgICB2YXIgb2JzZXJ2YWJsZV8xID0gb2JzZXJ2YWJsZU1ldGhvZC5jYWxsKHgpO1xuICAgICAgICAgICAgaWYgKE9iamVjdChvYnNlcnZhYmxlXzEpICE9PSBvYnNlcnZhYmxlXzEpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKG9ic2VydmFibGVfMSArIFwiIGlzIG5vdCBhbiBvYmplY3RcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaXNPYnNlcnZhYmxlKG9ic2VydmFibGVfMSkgJiYgb2JzZXJ2YWJsZV8xLmNvbnN0cnVjdG9yID09PSBDKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9ic2VydmFibGVfMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuZXcgQyhmdW5jdGlvbiAob2JzZXJ2ZXIpIHsgcmV0dXJuIG9ic2VydmFibGVfMS5zdWJzY3JpYmUob2JzZXJ2ZXIpOyB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoKDAsIF9zeW1ib2xzXzEuaGFzU3ltYm9sKShcIml0ZXJhdG9yXCIpKSB7XG4gICAgICAgICAgICB2YXIgaXRlcmF0b3JNZXRob2RfMSA9IGdldE1ldGhvZCh4LCBTeW1ib2xJdGVyYXRvcik7XG4gICAgICAgICAgICBpZiAoaXRlcmF0b3JNZXRob2RfMSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQyhmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgZW5xdWV1ZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob2JzZXJ2ZXIuY2xvc2VkKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBpdGVyYXRvck1ldGhvZF8xLmNhbGwoeCk7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSBfYVtfaV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIubmV4dChpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob2JzZXJ2ZXIuY2xvc2VkKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBvYnNlcnZlci5jb21wbGV0ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh4KSkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBDKGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgICAgICAgICAgIGVucXVldWUoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAob2JzZXJ2ZXIuY2xvc2VkKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIHhfMSA9IHg7IF9pIDwgeF8xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSB4XzFbX2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIubmV4dChpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvYnNlcnZlci5jbG9zZWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLmNvbXBsZXRlKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHggKyBcIiBpcyBub3Qgb2JzZXJ2YWJsZVwiKTtcbiAgICB9O1xuICAgIE9ic2VydmFibGUub2YgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBpdGVtcyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgaXRlbXNbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgQyA9ICh0eXBlb2YgdGhpcyA9PT0gXCJmdW5jdGlvblwiID8gdGhpcyA6IE9ic2VydmFibGUpO1xuICAgICAgICByZXR1cm4gbmV3IEMoZnVuY3Rpb24gKG9ic2VydmVyKSB7XG4gICAgICAgICAgICBlbnF1ZXVlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAob2JzZXJ2ZXIuY2xvc2VkKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBpdGVtc18xID0gaXRlbXM7IF9pIDwgaXRlbXNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSBpdGVtc18xW19pXTtcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIubmV4dChpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9ic2VydmVyLmNsb3NlZClcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXIuY29tcGxldGUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShPYnNlcnZhYmxlLCBTeW1ib2xTcGVjaWVzLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIHJldHVybiBPYnNlcnZhYmxlO1xufSgpKTtcbmV4cG9ydHMuT2JzZXJ2YWJsZSA9IE9ic2VydmFibGU7XG5pZiAoKDAsIF9zeW1ib2xzXzEuaGFzU3ltYm9scykoKSkge1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShPYnNlcnZhYmxlLCBTeW1ib2woXCJleHRlbnNpb25zXCIpLCB7XG4gICAgICAgIHZhbHVlOiB7XG4gICAgICAgICAgICBzeW1ib2w6IFN5bWJvbE9ic2VydmFibGUsXG4gICAgICAgICAgICBob3N0UmVwb3J0RXJyb3I6IGhvc3RSZXBvcnRFcnJvcixcbiAgICAgICAgfSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgIH0pO1xufVxuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBPYnNlcnZhYmxlO1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL0BmbHVlbmNlbGFicy9tYXJpbmUud29ya2VyLXNjcmlwdC8uLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vb2JzZXJ2YWJsZS1mbnNAMC42LjEvbm9kZV9tb2R1bGVzL29ic2VydmFibGUtZm5zL2Rpc3QuZXNtL29ic2VydmFibGUuanM/Iik7CgovKioqLyB9KSwKCi8qKiovICIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vb2JzZXJ2YWJsZS1mbnNAMC42LjEvbm9kZV9tb2R1bGVzL29ic2VydmFibGUtZm5zL2Rpc3QuZXNtL3NjYW4uanMiOgovKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL29ic2VydmFibGUtZm5zQDAuNi4xL25vZGVfbW9kdWxlcy9vYnNlcnZhYmxlLWZucy9kaXN0LmVzbS9zY2FuLmpzICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKiovIChmdW5jdGlvbihfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKZXZhbCgiXG52YXIgX19nZW5lcmF0b3IgPSAodGhpcyAmJiB0aGlzLl9fZ2VuZXJhdG9yKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgYm9keSkge1xuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XG4gICAgcmV0dXJuIGcgPSB7IG5leHQ6IHZlcmIoMCksIFwidGhyb3dcIjogdmVyYigxKSwgXCJyZXR1cm5cIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IHJldHVybiBmdW5jdGlvbiAodikgeyByZXR1cm4gc3RlcChbbiwgdl0pOyB9OyB9XG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xuICAgICAgICBpZiAoZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XG4gICAgICAgIHdoaWxlIChfKSB0cnkge1xuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xuICAgICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFtvcFswXSAmIDIsIHQudmFsdWVdO1xuICAgICAgICAgICAgc3dpdGNoIChvcFswXSkge1xuICAgICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XG4gICAgICAgICAgICAgICAgY2FzZSA1OiBfLmxhYmVsKys7IHkgPSBvcFsxXTsgb3AgPSBbMF07IGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBpZiAoISh0ID0gXy50cnlzLCB0ID0gdC5sZW5ndGggPiAwICYmIHRbdC5sZW5ndGggLSAxXSkgJiYgKG9wWzBdID09PSA2IHx8IG9wWzBdID09PSAyKSkgeyBfID0gMDsgY29udGludWU7IH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0ICYmIF8ubGFiZWwgPCB0WzJdKSB7IF8ubGFiZWwgPSB0WzJdOyBfLm9wcy5wdXNoKG9wKTsgYnJlYWs7IH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xuICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cbiAgICAgICAgaWYgKG9wWzBdICYgNSkgdGhyb3cgb3BbMV07IHJldHVybiB7IHZhbHVlOiBvcFswXSA/IG9wWzFdIDogdm9pZCAwLCBkb25lOiB0cnVlIH07XG4gICAgfVxufTtcbnZhciBfX2ltcG9ydERlZmF1bHQgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0RGVmYXVsdCkgfHwgZnVuY3Rpb24gKG1vZCkge1xuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgXCJkZWZhdWx0XCI6IG1vZCB9O1xufTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHsgdmFsdWU6IHRydWUgfSkpO1xudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkge1xuICAgICAgICAgICAgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgIH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkge1xuICAgICAgICAgICAgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgIH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xudmFyIF9zY2hlZHVsZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX3NjaGVkdWxlciAqLyBcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9vYnNlcnZhYmxlLWZuc0AwLjYuMS9ub2RlX21vZHVsZXMvb2JzZXJ2YWJsZS1mbnMvZGlzdC5lc20vX3NjaGVkdWxlci5qc1wiKTtcbnZhciBvYnNlcnZhYmxlXzEgPSBfX2ltcG9ydERlZmF1bHQoX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9vYnNlcnZhYmxlICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL29ic2VydmFibGUtZm5zQDAuNi4xL25vZGVfbW9kdWxlcy9vYnNlcnZhYmxlLWZucy9kaXN0LmVzbS9vYnNlcnZhYmxlLmpzXCIpKTtcbnZhciB1bnN1YnNjcmliZV8xID0gX19pbXBvcnREZWZhdWx0KF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vdW5zdWJzY3JpYmUgKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vb2JzZXJ2YWJsZS1mbnNAMC42LjEvbm9kZV9tb2R1bGVzL29ic2VydmFibGUtZm5zL2Rpc3QuZXNtL3Vuc3Vic2NyaWJlLmpzXCIpKTtcbmZ1bmN0aW9uIHNjYW4oYWNjdW11bGF0b3IsIHNlZWQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG9ic2VydmFibGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBvYnNlcnZhYmxlXzEuZGVmYXVsdChmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgICAgICAgIHZhciBhY2N1bXVsYXRlZDtcbiAgICAgICAgICAgIHZhciBpbmRleCA9IDA7XG4gICAgICAgICAgICB2YXIgc2NoZWR1bGVyID0gbmV3IF9zY2hlZHVsZXJfMS5Bc3luY1NlcmlhbFNjaGVkdWxlcihvYnNlcnZlcik7XG4gICAgICAgICAgICB2YXIgc3Vic2NyaXB0aW9uID0gb2JzZXJ2YWJsZS5zdWJzY3JpYmUoe1xuICAgICAgICAgICAgICAgIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHNjaGVkdWxlci5jb21wbGV0ZSgpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBzY2hlZHVsZXIuZXJyb3IoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgbmV4dDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgIHNjaGVkdWxlci5zY2hlZHVsZShmdW5jdGlvbiAobmV4dCkgeyByZXR1cm4gX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByZXZBY2M7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2QWNjID0gaW5kZXggPT09IDBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/ICh0eXBlb2Ygc2VlZCA9PT0gXCJ1bmRlZmluZWRcIiA/IHZhbHVlIDogc2VlZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IGFjY3VtdWxhdGVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgYWNjdW11bGF0b3IocHJldkFjYywgdmFsdWUsIGluZGV4KyspXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjdW11bGF0ZWQgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXh0KGFjY3VtdWxhdGVkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7IH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsgcmV0dXJuICgwLCB1bnN1YnNjcmliZV8xLmRlZmF1bHQpKHN1YnNjcmlwdGlvbik7IH07XG4gICAgICAgIH0pO1xuICAgIH07XG59XG5leHBvcnRzW1wiZGVmYXVsdFwiXSA9IHNjYW47XG5cblxuLy8jIHNvdXJjZVVSTD13ZWJwYWNrOi8vQGZsdWVuY2VsYWJzL21hcmluZS53b3JrZXItc2NyaXB0Ly4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9vYnNlcnZhYmxlLWZuc0AwLjYuMS9ub2RlX21vZHVsZXMvb2JzZXJ2YWJsZS1mbnMvZGlzdC5lc20vc2Nhbi5qcz8iKTsKCi8qKiovIH0pLAoKLyoqKi8gIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9vYnNlcnZhYmxlLWZuc0AwLjYuMS9ub2RlX21vZHVsZXMvb2JzZXJ2YWJsZS1mbnMvZGlzdC5lc20vc3ViamVjdC5qcyI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiAuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vb2JzZXJ2YWJsZS1mbnNAMC42LjEvbm9kZV9tb2R1bGVzL29ic2VydmFibGUtZm5zL2Rpc3QuZXNtL3N1YmplY3QuanMgKioqIQogIFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKGZ1bmN0aW9uKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpldmFsKCJcbnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG52YXIgX19pbXBvcnREZWZhdWx0ID0gKHRoaXMgJiYgdGhpcy5fX2ltcG9ydERlZmF1bHQpIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IFwiZGVmYXVsdFwiOiBtb2QgfTtcbn07XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7IHZhbHVlOiB0cnVlIH0pKTtcbnZhciBvYnNlcnZhYmxlXzEgPSBfX2ltcG9ydERlZmF1bHQoX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9vYnNlcnZhYmxlICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL29ic2VydmFibGUtZm5zQDAuNi4xL25vZGVfbW9kdWxlcy9vYnNlcnZhYmxlLWZucy9kaXN0LmVzbS9vYnNlcnZhYmxlLmpzXCIpKTtcbi8vIFRPRE86IFRoaXMgb2JzZXJ2ZXIgaXRlcmF0aW9uIGFwcHJvYWNoIGxvb2tzIGluZWxlZ2FudCBhbmQgZXhwZW5zaXZlXG4vLyBJZGVhOiBDb21lIHVwIHdpdGggc3VwZXIgY2xhc3MgZm9yIFN1YnNjcmlwdGlvbiB0aGF0IGNvbnRhaW5zIHRoZVxuLy8gICAgICAgbm90aWZ5KiwgLi4uIG1ldGhvZHMgYW5kIHVzZSBpdCBoZXJlXG4vKipcbiAqIEEgc3ViamVjdCBpcyBhIFwiaG90XCIgb2JzZXJ2YWJsZSAoc2VlIGBtdWx0aWNhc3RgKSB0aGF0IGhhcyBpdHMgb2JzZXJ2ZXJcbiAqIG1ldGhvZHMgKGAubmV4dCh2YWx1ZSlgLCBgLmVycm9yKGVycm9yKWAsIGAuY29tcGxldGUoKWApIGV4cG9zZWQuXG4gKlxuICogQmUgY2FyZWZ1bCwgdGhvdWdoISBXaXRoIGdyZWF0IHBvd2VyIGNvbWVzIGdyZWF0IHJlc3BvbnNpYmlsaXR5LiBPbmx5IHVzZVxuICogdGhlIGBTdWJqZWN0YCB3aGVuIHlvdSByZWFsbHkgbmVlZCB0byB0cmlnZ2VyIHVwZGF0ZXMgXCJmcm9tIHRoZSBvdXRzaWRlXCIgYW5kXG4gKiB0cnkgdG8ga2VlcCB0aGUgY29kZSB0aGF0IGNhbiBhY2Nlc3MgaXQgdG8gYSBtaW5pbXVtLiBSZXR1cm5cbiAqIGBPYnNlcnZhYmxlLmZyb20obXlTdWJqZWN0KWAgdG8gbm90IGFsbG93IG90aGVyIGNvZGUgdG8gbXV0YXRlLlxuICovXG52YXIgTXVsdGljYXN0U3ViamVjdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoTXVsdGljYXN0U3ViamVjdCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBNdWx0aWNhc3RTdWJqZWN0KCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgICAgICAgIF90aGlzLl9vYnNlcnZlcnMuYWRkKG9ic2VydmVyKTtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5fb2JzZXJ2ZXJzLmRlbGV0ZShvYnNlcnZlcik7IH07XG4gICAgICAgIH0pIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLl9vYnNlcnZlcnMgPSBuZXcgU2V0KCk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgTXVsdGljYXN0U3ViamVjdC5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5fb2JzZXJ2ZXJzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIG9ic2VydmVyID0gX2FbX2ldO1xuICAgICAgICAgICAgb2JzZXJ2ZXIubmV4dCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE11bHRpY2FzdFN1YmplY3QucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB0aGlzLl9vYnNlcnZlcnM7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgb2JzZXJ2ZXIgPSBfYVtfaV07XG4gICAgICAgICAgICBvYnNlcnZlci5lcnJvcihlcnJvcik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE11bHRpY2FzdFN1YmplY3QucHJvdG90eXBlLmNvbXBsZXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5fb2JzZXJ2ZXJzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIG9ic2VydmVyID0gX2FbX2ldO1xuICAgICAgICAgICAgb2JzZXJ2ZXIuY29tcGxldGUoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIE11bHRpY2FzdFN1YmplY3Q7XG59KG9ic2VydmFibGVfMS5kZWZhdWx0KSk7XG5leHBvcnRzW1wiZGVmYXVsdFwiXSA9IE11bHRpY2FzdFN1YmplY3Q7XG5cblxuLy8jIHNvdXJjZVVSTD13ZWJwYWNrOi8vQGZsdWVuY2VsYWJzL21hcmluZS53b3JrZXItc2NyaXB0Ly4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9vYnNlcnZhYmxlLWZuc0AwLjYuMS9ub2RlX21vZHVsZXMvb2JzZXJ2YWJsZS1mbnMvZGlzdC5lc20vc3ViamVjdC5qcz8iKTsKCi8qKiovIH0pLAoKLyoqKi8gIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9vYnNlcnZhYmxlLWZuc0AwLjYuMS9ub2RlX21vZHVsZXMvb2JzZXJ2YWJsZS1mbnMvZGlzdC5lc20vc3ltYm9scy5qcyI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiAuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vb2JzZXJ2YWJsZS1mbnNAMC42LjEvbm9kZV9tb2R1bGVzL29ic2VydmFibGUtZm5zL2Rpc3QuZXNtL3N5bWJvbHMuanMgKioqIQogIFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykgPT4gewoKZXZhbCgiXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7IHZhbHVlOiB0cnVlIH0pKTtcblxuXG4vLyMgc291cmNlVVJMPXdlYnBhY2s6Ly9AZmx1ZW5jZWxhYnMvbWFyaW5lLndvcmtlci1zY3JpcHQvLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL29ic2VydmFibGUtZm5zQDAuNi4xL25vZGVfbW9kdWxlcy9vYnNlcnZhYmxlLWZucy9kaXN0LmVzbS9zeW1ib2xzLmpzPyIpOwoKLyoqKi8gfSksCgovKioqLyAiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL29ic2VydmFibGUtZm5zQDAuNi4xL25vZGVfbW9kdWxlcy9vYnNlcnZhYmxlLWZucy9kaXN0LmVzbS91bnN1YnNjcmliZS5qcyI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL29ic2VydmFibGUtZm5zQDAuNi4xL25vZGVfbW9kdWxlcy9vYnNlcnZhYmxlLWZucy9kaXN0LmVzbS91bnN1YnNjcmliZS5qcyAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykgPT4gewoKZXZhbCgiXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7IHZhbHVlOiB0cnVlIH0pKTtcbi8qKlxuICogVW5zdWJzY3JpYmUgZnJvbSBhIHN1YnNjcmlwdGlvbiByZXR1cm5lZCBieSBzb21ldGhpbmcgdGhhdCBsb29rcyBsaWtlIGFuIG9ic2VydmFibGUsXG4gKiBidXQgaXMgbm90IG5lY2Vzc2FyaWx5IG91ciBvYnNlcnZhYmxlIGltcGxlbWVudGF0aW9uLlxuICovXG5mdW5jdGlvbiB1bnN1YnNjcmliZShzdWJzY3JpcHRpb24pIHtcbiAgICBpZiAodHlwZW9mIHN1YnNjcmlwdGlvbiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHN1YnNjcmlwdGlvbigpO1xuICAgIH1cbiAgICBlbHNlIGlmIChzdWJzY3JpcHRpb24gJiYgdHlwZW9mIHN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgIH1cbn1cbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gdW5zdWJzY3JpYmU7XG5cblxuLy8jIHNvdXJjZVVSTD13ZWJwYWNrOi8vQGZsdWVuY2VsYWJzL21hcmluZS53b3JrZXItc2NyaXB0Ly4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9vYnNlcnZhYmxlLWZuc0AwLjYuMS9ub2RlX21vZHVsZXMvb2JzZXJ2YWJsZS1mbnMvZGlzdC5lc20vdW5zdWJzY3JpYmUuanM/Iik7CgovKioqLyB9KSwKCi8qKiovICIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vcGF0aC1icm93c2VyaWZ5QDEuMC4xL25vZGVfbW9kdWxlcy9wYXRoLWJyb3dzZXJpZnkvaW5kZXguanMiOgovKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3BhdGgtYnJvd3NlcmlmeUAxLjAuMS9ub2RlX21vZHVsZXMvcGF0aC1icm93c2VyaWZ5L2luZGV4LmpzICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKiovICgobW9kdWxlKSA9PiB7CgpldmFsKCIvLyAncGF0aCcgbW9kdWxlIGV4dHJhY3RlZCBmcm9tIE5vZGUuanMgdjguMTEuMSAob25seSB0aGUgcG9zaXggcGFydClcbi8vIHRyYW5zcGxpdGVkIHdpdGggQmFiZWxcbi8vIENvcHlyaWdodCBKb3llbnQsIEluYy4gYW5kIG90aGVyIE5vZGUgY29udHJpYnV0b3JzLlxuLy9cbi8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhXG4vLyBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlXG4vLyBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmdcbi8vIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCxcbi8vIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXRcbi8vIHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZVxuLy8gZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4vL1xuLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWRcbi8vIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuLy9cbi8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1Ncbi8vIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0Zcbi8vIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU5cbi8vIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLFxuLy8gREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SXG4vLyBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFXG4vLyBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLlxuXG5mdW5jdGlvbiBhc3NlcnRQYXRoKHBhdGgpIHtcbiAgICBpZiAodHlwZW9mIHBhdGggIT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1BhdGggbXVzdCBiZSBhIHN0cmluZy4gUmVjZWl2ZWQgJyArIEpTT04uc3RyaW5naWZ5KHBhdGgpKTtcbiAgICB9XG59XG4vLyBSZXNvbHZlcyAuIGFuZCAuLiBlbGVtZW50cyBpbiBhIHBhdGggd2l0aCBkaXJlY3RvcnkgbmFtZXNcbmZ1bmN0aW9uIG5vcm1hbGl6ZVN0cmluZ1Bvc2l4KHBhdGgsIGFsbG93QWJvdmVSb290KSB7XG4gICAgdmFyIHJlcyA9ICcnO1xuICAgIHZhciBsYXN0U2VnbWVudExlbmd0aCA9IDA7XG4gICAgdmFyIGxhc3RTbGFzaCA9IC0xO1xuICAgIHZhciBkb3RzID0gMDtcbiAgICB2YXIgY29kZTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8PSBwYXRoLmxlbmd0aDsgKytpKSB7XG4gICAgICAgIGlmIChpIDwgcGF0aC5sZW5ndGgpXG4gICAgICAgICAgICBjb2RlID0gcGF0aC5jaGFyQ29kZUF0KGkpO1xuICAgICAgICBlbHNlIGlmIChjb2RlID09PSA0NyAvKi8qLylcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICBjb2RlID0gNDcgLyovKi87XG4gICAgICAgIGlmIChjb2RlID09PSA0NyAvKi8qLykge1xuICAgICAgICAgICAgaWYgKGxhc3RTbGFzaCA9PT0gaSAtIDEgfHwgZG90cyA9PT0gMSkge1xuICAgICAgICAgICAgICAgIC8vIE5PT1BcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGxhc3RTbGFzaCAhPT0gaSAtIDEgJiYgZG90cyA9PT0gMikge1xuICAgICAgICAgICAgICAgIGlmIChyZXMubGVuZ3RoIDwgMiB8fCBsYXN0U2VnbWVudExlbmd0aCAhPT0gMiB8fCByZXMuY2hhckNvZGVBdChyZXMubGVuZ3RoIC0gMSkgIT09IDQ2IC8qLiovIHx8IHJlcy5jaGFyQ29kZUF0KHJlcy5sZW5ndGggLSAyKSAhPT0gNDYgLyouKi8pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5sZW5ndGggPiAyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGFzdFNsYXNoSW5kZXggPSByZXMubGFzdEluZGV4T2YoJy8nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsYXN0U2xhc2hJbmRleCAhPT0gcmVzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobGFzdFNsYXNoSW5kZXggPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0U2VnbWVudExlbmd0aCA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXMgPSByZXMuc2xpY2UoMCwgbGFzdFNsYXNoSW5kZXgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0U2VnbWVudExlbmd0aCA9IHJlcy5sZW5ndGggLSAxIC0gcmVzLmxhc3RJbmRleE9mKCcvJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RTbGFzaCA9IGk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZG90cyA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAocmVzLmxlbmd0aCA9PT0gMiB8fCByZXMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXMgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RTZWdtZW50TGVuZ3RoID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RTbGFzaCA9IGk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkb3RzID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChhbGxvd0Fib3ZlUm9vdCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzLmxlbmd0aCA+IDApXG4gICAgICAgICAgICAgICAgICAgICAgICByZXMgKz0gJy8uLic7XG4gICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9ICcuLic7XG4gICAgICAgICAgICAgICAgICAgIGxhc3RTZWdtZW50TGVuZ3RoID0gMjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzLmxlbmd0aCA+IDApXG4gICAgICAgICAgICAgICAgICAgIHJlcyArPSAnLycgKyBwYXRoLnNsaWNlKGxhc3RTbGFzaCArIDEsIGkpO1xuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgcmVzID0gcGF0aC5zbGljZShsYXN0U2xhc2ggKyAxLCBpKTtcbiAgICAgICAgICAgICAgICBsYXN0U2VnbWVudExlbmd0aCA9IGkgLSBsYXN0U2xhc2ggLSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGFzdFNsYXNoID0gaTtcbiAgICAgICAgICAgIGRvdHMgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGNvZGUgPT09IDQ2IC8qLiovICYmIGRvdHMgIT09IC0xKSB7XG4gICAgICAgICAgICArK2RvdHM7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBkb3RzID0gLTE7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlcztcbn1cbmZ1bmN0aW9uIF9mb3JtYXQoc2VwLCBwYXRoT2JqZWN0KSB7XG4gICAgdmFyIGRpciA9IHBhdGhPYmplY3QuZGlyIHx8IHBhdGhPYmplY3Qucm9vdDtcbiAgICB2YXIgYmFzZSA9IHBhdGhPYmplY3QuYmFzZSB8fCAocGF0aE9iamVjdC5uYW1lIHx8ICcnKSArIChwYXRoT2JqZWN0LmV4dCB8fCAnJyk7XG4gICAgaWYgKCFkaXIpIHtcbiAgICAgICAgcmV0dXJuIGJhc2U7XG4gICAgfVxuICAgIGlmIChkaXIgPT09IHBhdGhPYmplY3Qucm9vdCkge1xuICAgICAgICByZXR1cm4gZGlyICsgYmFzZTtcbiAgICB9XG4gICAgcmV0dXJuIGRpciArIHNlcCArIGJhc2U7XG59XG52YXIgcG9zaXggPSB7XG4gICAgLy8gcGF0aC5yZXNvbHZlKFtmcm9tIC4uLl0sIHRvKVxuICAgIHJlc29sdmU6IGZ1bmN0aW9uIHJlc29sdmUoKSB7XG4gICAgICAgIHZhciByZXNvbHZlZFBhdGggPSAnJztcbiAgICAgICAgdmFyIHJlc29sdmVkQWJzb2x1dGUgPSBmYWxzZTtcbiAgICAgICAgdmFyIGN3ZDtcbiAgICAgICAgZm9yICh2YXIgaSA9IGFyZ3VtZW50cy5sZW5ndGggLSAxOyBpID49IC0xICYmICFyZXNvbHZlZEFic29sdXRlOyBpLS0pIHtcbiAgICAgICAgICAgIHZhciBwYXRoO1xuICAgICAgICAgICAgaWYgKGkgPj0gMClcbiAgICAgICAgICAgICAgICBwYXRoID0gYXJndW1lbnRzW2ldO1xuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGN3ZCA9PT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgICAgICBjd2QgPSBwcm9jZXNzLmN3ZCgpO1xuICAgICAgICAgICAgICAgIHBhdGggPSBjd2Q7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhc3NlcnRQYXRoKHBhdGgpO1xuICAgICAgICAgICAgLy8gU2tpcCBlbXB0eSBlbnRyaWVzXG4gICAgICAgICAgICBpZiAocGF0aC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlc29sdmVkUGF0aCA9IHBhdGggKyAnLycgKyByZXNvbHZlZFBhdGg7XG4gICAgICAgICAgICByZXNvbHZlZEFic29sdXRlID0gcGF0aC5jaGFyQ29kZUF0KDApID09PSA0NyAvKi8qLztcbiAgICAgICAgfVxuICAgICAgICAvLyBBdCB0aGlzIHBvaW50IHRoZSBwYXRoIHNob3VsZCBiZSByZXNvbHZlZCB0byBhIGZ1bGwgYWJzb2x1dGUgcGF0aCwgYnV0XG4gICAgICAgIC8vIGhhbmRsZSByZWxhdGl2ZSBwYXRocyB0byBiZSBzYWZlIChtaWdodCBoYXBwZW4gd2hlbiBwcm9jZXNzLmN3ZCgpIGZhaWxzKVxuICAgICAgICAvLyBOb3JtYWxpemUgdGhlIHBhdGhcbiAgICAgICAgcmVzb2x2ZWRQYXRoID0gbm9ybWFsaXplU3RyaW5nUG9zaXgocmVzb2x2ZWRQYXRoLCAhcmVzb2x2ZWRBYnNvbHV0ZSk7XG4gICAgICAgIGlmIChyZXNvbHZlZEFic29sdXRlKSB7XG4gICAgICAgICAgICBpZiAocmVzb2x2ZWRQYXRoLmxlbmd0aCA+IDApXG4gICAgICAgICAgICAgICAgcmV0dXJuICcvJyArIHJlc29sdmVkUGF0aDtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICByZXR1cm4gJy8nO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHJlc29sdmVkUGF0aC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzb2x2ZWRQYXRoO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuICcuJztcbiAgICAgICAgfVxuICAgIH0sXG4gICAgbm9ybWFsaXplOiBmdW5jdGlvbiBub3JtYWxpemUocGF0aCkge1xuICAgICAgICBhc3NlcnRQYXRoKHBhdGgpO1xuICAgICAgICBpZiAocGF0aC5sZW5ndGggPT09IDApXG4gICAgICAgICAgICByZXR1cm4gJy4nO1xuICAgICAgICB2YXIgaXNBYnNvbHV0ZSA9IHBhdGguY2hhckNvZGVBdCgwKSA9PT0gNDcgLyovKi87XG4gICAgICAgIHZhciB0cmFpbGluZ1NlcGFyYXRvciA9IHBhdGguY2hhckNvZGVBdChwYXRoLmxlbmd0aCAtIDEpID09PSA0NyAvKi8qLztcbiAgICAgICAgLy8gTm9ybWFsaXplIHRoZSBwYXRoXG4gICAgICAgIHBhdGggPSBub3JtYWxpemVTdHJpbmdQb3NpeChwYXRoLCAhaXNBYnNvbHV0ZSk7XG4gICAgICAgIGlmIChwYXRoLmxlbmd0aCA9PT0gMCAmJiAhaXNBYnNvbHV0ZSlcbiAgICAgICAgICAgIHBhdGggPSAnLic7XG4gICAgICAgIGlmIChwYXRoLmxlbmd0aCA+IDAgJiYgdHJhaWxpbmdTZXBhcmF0b3IpXG4gICAgICAgICAgICBwYXRoICs9ICcvJztcbiAgICAgICAgaWYgKGlzQWJzb2x1dGUpXG4gICAgICAgICAgICByZXR1cm4gJy8nICsgcGF0aDtcbiAgICAgICAgcmV0dXJuIHBhdGg7XG4gICAgfSxcbiAgICBpc0Fic29sdXRlOiBmdW5jdGlvbiBpc0Fic29sdXRlKHBhdGgpIHtcbiAgICAgICAgYXNzZXJ0UGF0aChwYXRoKTtcbiAgICAgICAgcmV0dXJuIHBhdGgubGVuZ3RoID4gMCAmJiBwYXRoLmNoYXJDb2RlQXQoMCkgPT09IDQ3IC8qLyovO1xuICAgIH0sXG4gICAgam9pbjogZnVuY3Rpb24gam9pbigpIHtcbiAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApXG4gICAgICAgICAgICByZXR1cm4gJy4nO1xuICAgICAgICB2YXIgam9pbmVkO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgdmFyIGFyZyA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgICAgIGFzc2VydFBhdGgoYXJnKTtcbiAgICAgICAgICAgIGlmIChhcmcubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGlmIChqb2luZWQgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgICAgICAgICAgam9pbmVkID0gYXJnO1xuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgam9pbmVkICs9ICcvJyArIGFyZztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoam9pbmVkID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICByZXR1cm4gJy4nO1xuICAgICAgICByZXR1cm4gcG9zaXgubm9ybWFsaXplKGpvaW5lZCk7XG4gICAgfSxcbiAgICByZWxhdGl2ZTogZnVuY3Rpb24gcmVsYXRpdmUoZnJvbSwgdG8pIHtcbiAgICAgICAgYXNzZXJ0UGF0aChmcm9tKTtcbiAgICAgICAgYXNzZXJ0UGF0aCh0byk7XG4gICAgICAgIGlmIChmcm9tID09PSB0bylcbiAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgZnJvbSA9IHBvc2l4LnJlc29sdmUoZnJvbSk7XG4gICAgICAgIHRvID0gcG9zaXgucmVzb2x2ZSh0byk7XG4gICAgICAgIGlmIChmcm9tID09PSB0bylcbiAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgLy8gVHJpbSBhbnkgbGVhZGluZyBiYWNrc2xhc2hlc1xuICAgICAgICB2YXIgZnJvbVN0YXJ0ID0gMTtcbiAgICAgICAgZm9yICg7IGZyb21TdGFydCA8IGZyb20ubGVuZ3RoOyArK2Zyb21TdGFydCkge1xuICAgICAgICAgICAgaWYgKGZyb20uY2hhckNvZGVBdChmcm9tU3RhcnQpICE9PSA0NyAvKi8qLylcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICB2YXIgZnJvbUVuZCA9IGZyb20ubGVuZ3RoO1xuICAgICAgICB2YXIgZnJvbUxlbiA9IGZyb21FbmQgLSBmcm9tU3RhcnQ7XG4gICAgICAgIC8vIFRyaW0gYW55IGxlYWRpbmcgYmFja3NsYXNoZXNcbiAgICAgICAgdmFyIHRvU3RhcnQgPSAxO1xuICAgICAgICBmb3IgKDsgdG9TdGFydCA8IHRvLmxlbmd0aDsgKyt0b1N0YXJ0KSB7XG4gICAgICAgICAgICBpZiAodG8uY2hhckNvZGVBdCh0b1N0YXJ0KSAhPT0gNDcgLyovKi8pXG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHRvRW5kID0gdG8ubGVuZ3RoO1xuICAgICAgICB2YXIgdG9MZW4gPSB0b0VuZCAtIHRvU3RhcnQ7XG4gICAgICAgIC8vIENvbXBhcmUgcGF0aHMgdG8gZmluZCB0aGUgbG9uZ2VzdCBjb21tb24gcGF0aCBmcm9tIHJvb3RcbiAgICAgICAgdmFyIGxlbmd0aCA9IGZyb21MZW4gPCB0b0xlbiA/IGZyb21MZW4gOiB0b0xlbjtcbiAgICAgICAgdmFyIGxhc3RDb21tb25TZXAgPSAtMTtcbiAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICBmb3IgKDsgaSA8PSBsZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgaWYgKGkgPT09IGxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGlmICh0b0xlbiA+IGxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodG8uY2hhckNvZGVBdCh0b1N0YXJ0ICsgaSkgPT09IDQ3IC8qLyovKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBnZXQgaGVyZSBpZiBgZnJvbWAgaXMgdGhlIGV4YWN0IGJhc2UgcGF0aCBmb3IgYHRvYC5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZvciBleGFtcGxlOiBmcm9tPScvZm9vL2Jhcic7IHRvPScvZm9vL2Jhci9iYXonXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdG8uc2xpY2UodG9TdGFydCArIGkgKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChpID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBnZXQgaGVyZSBpZiBgZnJvbWAgaXMgdGhlIHJvb3RcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZvciBleGFtcGxlOiBmcm9tPScvJzsgdG89Jy9mb28nXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdG8uc2xpY2UodG9TdGFydCArIGkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGZyb21MZW4gPiBsZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZyb20uY2hhckNvZGVBdChmcm9tU3RhcnQgKyBpKSA9PT0gNDcgLyovKi8pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFdlIGdldCBoZXJlIGlmIGB0b2AgaXMgdGhlIGV4YWN0IGJhc2UgcGF0aCBmb3IgYGZyb21gLlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRm9yIGV4YW1wbGU6IGZyb209Jy9mb28vYmFyL2Jheic7IHRvPScvZm9vL2JhcidcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RDb21tb25TZXAgPSBpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGkgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFdlIGdldCBoZXJlIGlmIGB0b2AgaXMgdGhlIHJvb3QuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBGb3IgZXhhbXBsZTogZnJvbT0nL2Zvbyc7IHRvPScvJ1xuICAgICAgICAgICAgICAgICAgICAgICAgbGFzdENvbW1vblNlcCA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZnJvbUNvZGUgPSBmcm9tLmNoYXJDb2RlQXQoZnJvbVN0YXJ0ICsgaSk7XG4gICAgICAgICAgICB2YXIgdG9Db2RlID0gdG8uY2hhckNvZGVBdCh0b1N0YXJ0ICsgaSk7XG4gICAgICAgICAgICBpZiAoZnJvbUNvZGUgIT09IHRvQ29kZSlcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGVsc2UgaWYgKGZyb21Db2RlID09PSA0NyAvKi8qLylcbiAgICAgICAgICAgICAgICBsYXN0Q29tbW9uU2VwID0gaTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgb3V0ID0gJyc7XG4gICAgICAgIC8vIEdlbmVyYXRlIHRoZSByZWxhdGl2ZSBwYXRoIGJhc2VkIG9uIHRoZSBwYXRoIGRpZmZlcmVuY2UgYmV0d2VlbiBgdG9gXG4gICAgICAgIC8vIGFuZCBgZnJvbWBcbiAgICAgICAgZm9yIChpID0gZnJvbVN0YXJ0ICsgbGFzdENvbW1vblNlcCArIDE7IGkgPD0gZnJvbUVuZDsgKytpKSB7XG4gICAgICAgICAgICBpZiAoaSA9PT0gZnJvbUVuZCB8fCBmcm9tLmNoYXJDb2RlQXQoaSkgPT09IDQ3IC8qLyovKSB7XG4gICAgICAgICAgICAgICAgaWYgKG91dC5sZW5ndGggPT09IDApXG4gICAgICAgICAgICAgICAgICAgIG91dCArPSAnLi4nO1xuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgb3V0ICs9ICcvLi4nO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIExhc3RseSwgYXBwZW5kIHRoZSByZXN0IG9mIHRoZSBkZXN0aW5hdGlvbiAoYHRvYCkgcGF0aCB0aGF0IGNvbWVzIGFmdGVyXG4gICAgICAgIC8vIHRoZSBjb21tb24gcGF0aCBwYXJ0c1xuICAgICAgICBpZiAob3V0Lmxlbmd0aCA+IDApXG4gICAgICAgICAgICByZXR1cm4gb3V0ICsgdG8uc2xpY2UodG9TdGFydCArIGxhc3RDb21tb25TZXApO1xuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRvU3RhcnQgKz0gbGFzdENvbW1vblNlcDtcbiAgICAgICAgICAgIGlmICh0by5jaGFyQ29kZUF0KHRvU3RhcnQpID09PSA0NyAvKi8qLylcbiAgICAgICAgICAgICAgICArK3RvU3RhcnQ7XG4gICAgICAgICAgICByZXR1cm4gdG8uc2xpY2UodG9TdGFydCk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIF9tYWtlTG9uZzogZnVuY3Rpb24gX21ha2VMb25nKHBhdGgpIHtcbiAgICAgICAgcmV0dXJuIHBhdGg7XG4gICAgfSxcbiAgICBkaXJuYW1lOiBmdW5jdGlvbiBkaXJuYW1lKHBhdGgpIHtcbiAgICAgICAgYXNzZXJ0UGF0aChwYXRoKTtcbiAgICAgICAgaWYgKHBhdGgubGVuZ3RoID09PSAwKVxuICAgICAgICAgICAgcmV0dXJuICcuJztcbiAgICAgICAgdmFyIGNvZGUgPSBwYXRoLmNoYXJDb2RlQXQoMCk7XG4gICAgICAgIHZhciBoYXNSb290ID0gY29kZSA9PT0gNDcgLyovKi87XG4gICAgICAgIHZhciBlbmQgPSAtMTtcbiAgICAgICAgdmFyIG1hdGNoZWRTbGFzaCA9IHRydWU7XG4gICAgICAgIGZvciAodmFyIGkgPSBwYXRoLmxlbmd0aCAtIDE7IGkgPj0gMTsgLS1pKSB7XG4gICAgICAgICAgICBjb2RlID0gcGF0aC5jaGFyQ29kZUF0KGkpO1xuICAgICAgICAgICAgaWYgKGNvZGUgPT09IDQ3IC8qLyovKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFtYXRjaGVkU2xhc2gpIHtcbiAgICAgICAgICAgICAgICAgICAgZW5kID0gaTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gV2Ugc2F3IHRoZSBmaXJzdCBub24tcGF0aCBzZXBhcmF0b3JcbiAgICAgICAgICAgICAgICBtYXRjaGVkU2xhc2ggPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoZW5kID09PSAtMSlcbiAgICAgICAgICAgIHJldHVybiBoYXNSb290ID8gJy8nIDogJy4nO1xuICAgICAgICBpZiAoaGFzUm9vdCAmJiBlbmQgPT09IDEpXG4gICAgICAgICAgICByZXR1cm4gJy8vJztcbiAgICAgICAgcmV0dXJuIHBhdGguc2xpY2UoMCwgZW5kKTtcbiAgICB9LFxuICAgIGJhc2VuYW1lOiBmdW5jdGlvbiBiYXNlbmFtZShwYXRoLCBleHQpIHtcbiAgICAgICAgaWYgKGV4dCAhPT0gdW5kZWZpbmVkICYmIHR5cGVvZiBleHQgIT09ICdzdHJpbmcnKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignXCJleHRcIiBhcmd1bWVudCBtdXN0IGJlIGEgc3RyaW5nJyk7XG4gICAgICAgIGFzc2VydFBhdGgocGF0aCk7XG4gICAgICAgIHZhciBzdGFydCA9IDA7XG4gICAgICAgIHZhciBlbmQgPSAtMTtcbiAgICAgICAgdmFyIG1hdGNoZWRTbGFzaCA9IHRydWU7XG4gICAgICAgIHZhciBpO1xuICAgICAgICBpZiAoZXh0ICE9PSB1bmRlZmluZWQgJiYgZXh0Lmxlbmd0aCA+IDAgJiYgZXh0Lmxlbmd0aCA8PSBwYXRoLmxlbmd0aCkge1xuICAgICAgICAgICAgaWYgKGV4dC5sZW5ndGggPT09IHBhdGgubGVuZ3RoICYmIGV4dCA9PT0gcGF0aClcbiAgICAgICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgICAgICB2YXIgZXh0SWR4ID0gZXh0Lmxlbmd0aCAtIDE7XG4gICAgICAgICAgICB2YXIgZmlyc3ROb25TbGFzaEVuZCA9IC0xO1xuICAgICAgICAgICAgZm9yIChpID0gcGF0aC5sZW5ndGggLSAxOyBpID49IDA7IC0taSkge1xuICAgICAgICAgICAgICAgIHZhciBjb2RlID0gcGF0aC5jaGFyQ29kZUF0KGkpO1xuICAgICAgICAgICAgICAgIGlmIChjb2RlID09PSA0NyAvKi8qLykge1xuICAgICAgICAgICAgICAgICAgICAvLyBJZiB3ZSByZWFjaGVkIGEgcGF0aCBzZXBhcmF0b3IgdGhhdCB3YXMgbm90IHBhcnQgb2YgYSBzZXQgb2YgcGF0aFxuICAgICAgICAgICAgICAgICAgICAvLyBzZXBhcmF0b3JzIGF0IHRoZSBlbmQgb2YgdGhlIHN0cmluZywgc3RvcCBub3dcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFtYXRjaGVkU2xhc2gpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0ID0gaSArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZpcnN0Tm9uU2xhc2hFbmQgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBzYXcgdGhlIGZpcnN0IG5vbi1wYXRoIHNlcGFyYXRvciwgcmVtZW1iZXIgdGhpcyBpbmRleCBpbiBjYXNlXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB3ZSBuZWVkIGl0IGlmIHRoZSBleHRlbnNpb24gZW5kcyB1cCBub3QgbWF0Y2hpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoZWRTbGFzaCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3ROb25TbGFzaEVuZCA9IGkgKyAxO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChleHRJZHggPj0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVHJ5IHRvIG1hdGNoIHRoZSBleHBsaWNpdCBleHRlbnNpb25cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb2RlID09PSBleHQuY2hhckNvZGVBdChleHRJZHgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKC0tZXh0SWR4ID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBtYXRjaGVkIHRoZSBleHRlbnNpb24sIHNvIG1hcmsgdGhpcyBhcyB0aGUgZW5kIG9mIG91ciBwYXRoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbXBvbmVudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQgPSBpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEV4dGVuc2lvbiBkb2VzIG5vdCBtYXRjaCwgc28gb3VyIHJlc3VsdCBpcyB0aGUgZW50aXJlIHBhdGhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb21wb25lbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHRJZHggPSAtMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQgPSBmaXJzdE5vblNsYXNoRW5kO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHN0YXJ0ID09PSBlbmQpXG4gICAgICAgICAgICAgICAgZW5kID0gZmlyc3ROb25TbGFzaEVuZDtcbiAgICAgICAgICAgIGVsc2UgaWYgKGVuZCA9PT0gLTEpXG4gICAgICAgICAgICAgICAgZW5kID0gcGF0aC5sZW5ndGg7XG4gICAgICAgICAgICByZXR1cm4gcGF0aC5zbGljZShzdGFydCwgZW5kKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGZvciAoaSA9IHBhdGgubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHtcbiAgICAgICAgICAgICAgICBpZiAocGF0aC5jaGFyQ29kZUF0KGkpID09PSA0NyAvKi8qLykge1xuICAgICAgICAgICAgICAgICAgICAvLyBJZiB3ZSByZWFjaGVkIGEgcGF0aCBzZXBhcmF0b3IgdGhhdCB3YXMgbm90IHBhcnQgb2YgYSBzZXQgb2YgcGF0aFxuICAgICAgICAgICAgICAgICAgICAvLyBzZXBhcmF0b3JzIGF0IHRoZSBlbmQgb2YgdGhlIHN0cmluZywgc3RvcCBub3dcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFtYXRjaGVkU2xhc2gpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0ID0gaSArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChlbmQgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFdlIHNhdyB0aGUgZmlyc3Qgbm9uLXBhdGggc2VwYXJhdG9yLCBtYXJrIHRoaXMgYXMgdGhlIGVuZCBvZiBvdXJcbiAgICAgICAgICAgICAgICAgICAgLy8gcGF0aCBjb21wb25lbnRcbiAgICAgICAgICAgICAgICAgICAgbWF0Y2hlZFNsYXNoID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGVuZCA9IGkgKyAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlbmQgPT09IC0xKVxuICAgICAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgICAgIHJldHVybiBwYXRoLnNsaWNlKHN0YXJ0LCBlbmQpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBleHRuYW1lOiBmdW5jdGlvbiBleHRuYW1lKHBhdGgpIHtcbiAgICAgICAgYXNzZXJ0UGF0aChwYXRoKTtcbiAgICAgICAgdmFyIHN0YXJ0RG90ID0gLTE7XG4gICAgICAgIHZhciBzdGFydFBhcnQgPSAwO1xuICAgICAgICB2YXIgZW5kID0gLTE7XG4gICAgICAgIHZhciBtYXRjaGVkU2xhc2ggPSB0cnVlO1xuICAgICAgICAvLyBUcmFjayB0aGUgc3RhdGUgb2YgY2hhcmFjdGVycyAoaWYgYW55KSB3ZSBzZWUgYmVmb3JlIG91ciBmaXJzdCBkb3QgYW5kXG4gICAgICAgIC8vIGFmdGVyIGFueSBwYXRoIHNlcGFyYXRvciB3ZSBmaW5kXG4gICAgICAgIHZhciBwcmVEb3RTdGF0ZSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSBwYXRoLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7XG4gICAgICAgICAgICB2YXIgY29kZSA9IHBhdGguY2hhckNvZGVBdChpKTtcbiAgICAgICAgICAgIGlmIChjb2RlID09PSA0NyAvKi8qLykge1xuICAgICAgICAgICAgICAgIC8vIElmIHdlIHJlYWNoZWQgYSBwYXRoIHNlcGFyYXRvciB0aGF0IHdhcyBub3QgcGFydCBvZiBhIHNldCBvZiBwYXRoXG4gICAgICAgICAgICAgICAgLy8gc2VwYXJhdG9ycyBhdCB0aGUgZW5kIG9mIHRoZSBzdHJpbmcsIHN0b3Agbm93XG4gICAgICAgICAgICAgICAgaWYgKCFtYXRjaGVkU2xhc2gpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhcnRQYXJ0ID0gaSArIDE7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlbmQgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgLy8gV2Ugc2F3IHRoZSBmaXJzdCBub24tcGF0aCBzZXBhcmF0b3IsIG1hcmsgdGhpcyBhcyB0aGUgZW5kIG9mIG91clxuICAgICAgICAgICAgICAgIC8vIGV4dGVuc2lvblxuICAgICAgICAgICAgICAgIG1hdGNoZWRTbGFzaCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGVuZCA9IGkgKyAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNvZGUgPT09IDQ2IC8qLiovKSB7XG4gICAgICAgICAgICAgICAgLy8gSWYgdGhpcyBpcyBvdXIgZmlyc3QgZG90LCBtYXJrIGl0IGFzIHRoZSBzdGFydCBvZiBvdXIgZXh0ZW5zaW9uXG4gICAgICAgICAgICAgICAgaWYgKHN0YXJ0RG90ID09PSAtMSlcbiAgICAgICAgICAgICAgICAgICAgc3RhcnREb3QgPSBpO1xuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHByZURvdFN0YXRlICE9PSAxKVxuICAgICAgICAgICAgICAgICAgICBwcmVEb3RTdGF0ZSA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzdGFydERvdCAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAvLyBXZSBzYXcgYSBub24tZG90IGFuZCBub24tcGF0aCBzZXBhcmF0b3IgYmVmb3JlIG91ciBkb3QsIHNvIHdlIHNob3VsZFxuICAgICAgICAgICAgICAgIC8vIGhhdmUgYSBnb29kIGNoYW5jZSBhdCBoYXZpbmcgYSBub24tZW1wdHkgZXh0ZW5zaW9uXG4gICAgICAgICAgICAgICAgcHJlRG90U3RhdGUgPSAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RhcnREb3QgPT09IC0xIHx8IGVuZCA9PT0gLTEgfHxcbiAgICAgICAgICAgIC8vIFdlIHNhdyBhIG5vbi1kb3QgY2hhcmFjdGVyIGltbWVkaWF0ZWx5IGJlZm9yZSB0aGUgZG90XG4gICAgICAgICAgICBwcmVEb3RTdGF0ZSA9PT0gMCB8fFxuICAgICAgICAgICAgLy8gVGhlIChyaWdodC1tb3N0KSB0cmltbWVkIHBhdGggY29tcG9uZW50IGlzIGV4YWN0bHkgJy4uJ1xuICAgICAgICAgICAgcHJlRG90U3RhdGUgPT09IDEgJiYgc3RhcnREb3QgPT09IGVuZCAtIDEgJiYgc3RhcnREb3QgPT09IHN0YXJ0UGFydCArIDEpIHtcbiAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcGF0aC5zbGljZShzdGFydERvdCwgZW5kKTtcbiAgICB9LFxuICAgIGZvcm1hdDogZnVuY3Rpb24gZm9ybWF0KHBhdGhPYmplY3QpIHtcbiAgICAgICAgaWYgKHBhdGhPYmplY3QgPT09IG51bGwgfHwgdHlwZW9mIHBhdGhPYmplY3QgIT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdUaGUgXCJwYXRoT2JqZWN0XCIgYXJndW1lbnQgbXVzdCBiZSBvZiB0eXBlIE9iamVjdC4gUmVjZWl2ZWQgdHlwZSAnICsgdHlwZW9mIHBhdGhPYmplY3QpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfZm9ybWF0KCcvJywgcGF0aE9iamVjdCk7XG4gICAgfSxcbiAgICBwYXJzZTogZnVuY3Rpb24gcGFyc2UocGF0aCkge1xuICAgICAgICBhc3NlcnRQYXRoKHBhdGgpO1xuICAgICAgICB2YXIgcmV0ID0geyByb290OiAnJywgZGlyOiAnJywgYmFzZTogJycsIGV4dDogJycsIG5hbWU6ICcnIH07XG4gICAgICAgIGlmIChwYXRoLmxlbmd0aCA9PT0gMClcbiAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgIHZhciBjb2RlID0gcGF0aC5jaGFyQ29kZUF0KDApO1xuICAgICAgICB2YXIgaXNBYnNvbHV0ZSA9IGNvZGUgPT09IDQ3IC8qLyovO1xuICAgICAgICB2YXIgc3RhcnQ7XG4gICAgICAgIGlmIChpc0Fic29sdXRlKSB7XG4gICAgICAgICAgICByZXQucm9vdCA9ICcvJztcbiAgICAgICAgICAgIHN0YXJ0ID0gMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHN0YXJ0ID0gMDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc3RhcnREb3QgPSAtMTtcbiAgICAgICAgdmFyIHN0YXJ0UGFydCA9IDA7XG4gICAgICAgIHZhciBlbmQgPSAtMTtcbiAgICAgICAgdmFyIG1hdGNoZWRTbGFzaCA9IHRydWU7XG4gICAgICAgIHZhciBpID0gcGF0aC5sZW5ndGggLSAxO1xuICAgICAgICAvLyBUcmFjayB0aGUgc3RhdGUgb2YgY2hhcmFjdGVycyAoaWYgYW55KSB3ZSBzZWUgYmVmb3JlIG91ciBmaXJzdCBkb3QgYW5kXG4gICAgICAgIC8vIGFmdGVyIGFueSBwYXRoIHNlcGFyYXRvciB3ZSBmaW5kXG4gICAgICAgIHZhciBwcmVEb3RTdGF0ZSA9IDA7XG4gICAgICAgIC8vIEdldCBub24tZGlyIGluZm9cbiAgICAgICAgZm9yICg7IGkgPj0gc3RhcnQ7IC0taSkge1xuICAgICAgICAgICAgY29kZSA9IHBhdGguY2hhckNvZGVBdChpKTtcbiAgICAgICAgICAgIGlmIChjb2RlID09PSA0NyAvKi8qLykge1xuICAgICAgICAgICAgICAgIC8vIElmIHdlIHJlYWNoZWQgYSBwYXRoIHNlcGFyYXRvciB0aGF0IHdhcyBub3QgcGFydCBvZiBhIHNldCBvZiBwYXRoXG4gICAgICAgICAgICAgICAgLy8gc2VwYXJhdG9ycyBhdCB0aGUgZW5kIG9mIHRoZSBzdHJpbmcsIHN0b3Agbm93XG4gICAgICAgICAgICAgICAgaWYgKCFtYXRjaGVkU2xhc2gpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhcnRQYXJ0ID0gaSArIDE7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlbmQgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgLy8gV2Ugc2F3IHRoZSBmaXJzdCBub24tcGF0aCBzZXBhcmF0b3IsIG1hcmsgdGhpcyBhcyB0aGUgZW5kIG9mIG91clxuICAgICAgICAgICAgICAgIC8vIGV4dGVuc2lvblxuICAgICAgICAgICAgICAgIG1hdGNoZWRTbGFzaCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGVuZCA9IGkgKyAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNvZGUgPT09IDQ2IC8qLiovKSB7XG4gICAgICAgICAgICAgICAgLy8gSWYgdGhpcyBpcyBvdXIgZmlyc3QgZG90LCBtYXJrIGl0IGFzIHRoZSBzdGFydCBvZiBvdXIgZXh0ZW5zaW9uXG4gICAgICAgICAgICAgICAgaWYgKHN0YXJ0RG90ID09PSAtMSlcbiAgICAgICAgICAgICAgICAgICAgc3RhcnREb3QgPSBpO1xuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHByZURvdFN0YXRlICE9PSAxKVxuICAgICAgICAgICAgICAgICAgICBwcmVEb3RTdGF0ZSA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzdGFydERvdCAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAvLyBXZSBzYXcgYSBub24tZG90IGFuZCBub24tcGF0aCBzZXBhcmF0b3IgYmVmb3JlIG91ciBkb3QsIHNvIHdlIHNob3VsZFxuICAgICAgICAgICAgICAgIC8vIGhhdmUgYSBnb29kIGNoYW5jZSBhdCBoYXZpbmcgYSBub24tZW1wdHkgZXh0ZW5zaW9uXG4gICAgICAgICAgICAgICAgcHJlRG90U3RhdGUgPSAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RhcnREb3QgPT09IC0xIHx8IGVuZCA9PT0gLTEgfHxcbiAgICAgICAgICAgIC8vIFdlIHNhdyBhIG5vbi1kb3QgY2hhcmFjdGVyIGltbWVkaWF0ZWx5IGJlZm9yZSB0aGUgZG90XG4gICAgICAgICAgICBwcmVEb3RTdGF0ZSA9PT0gMCB8fFxuICAgICAgICAgICAgLy8gVGhlIChyaWdodC1tb3N0KSB0cmltbWVkIHBhdGggY29tcG9uZW50IGlzIGV4YWN0bHkgJy4uJ1xuICAgICAgICAgICAgcHJlRG90U3RhdGUgPT09IDEgJiYgc3RhcnREb3QgPT09IGVuZCAtIDEgJiYgc3RhcnREb3QgPT09IHN0YXJ0UGFydCArIDEpIHtcbiAgICAgICAgICAgIGlmIChlbmQgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgaWYgKHN0YXJ0UGFydCA9PT0gMCAmJiBpc0Fic29sdXRlKVxuICAgICAgICAgICAgICAgICAgICByZXQuYmFzZSA9IHJldC5uYW1lID0gcGF0aC5zbGljZSgxLCBlbmQpO1xuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgcmV0LmJhc2UgPSByZXQubmFtZSA9IHBhdGguc2xpY2Uoc3RhcnRQYXJ0LCBlbmQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKHN0YXJ0UGFydCA9PT0gMCAmJiBpc0Fic29sdXRlKSB7XG4gICAgICAgICAgICAgICAgcmV0Lm5hbWUgPSBwYXRoLnNsaWNlKDEsIHN0YXJ0RG90KTtcbiAgICAgICAgICAgICAgICByZXQuYmFzZSA9IHBhdGguc2xpY2UoMSwgZW5kKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldC5uYW1lID0gcGF0aC5zbGljZShzdGFydFBhcnQsIHN0YXJ0RG90KTtcbiAgICAgICAgICAgICAgICByZXQuYmFzZSA9IHBhdGguc2xpY2Uoc3RhcnRQYXJ0LCBlbmQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0LmV4dCA9IHBhdGguc2xpY2Uoc3RhcnREb3QsIGVuZCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0YXJ0UGFydCA+IDApXG4gICAgICAgICAgICByZXQuZGlyID0gcGF0aC5zbGljZSgwLCBzdGFydFBhcnQgLSAxKTtcbiAgICAgICAgZWxzZSBpZiAoaXNBYnNvbHV0ZSlcbiAgICAgICAgICAgIHJldC5kaXIgPSAnLyc7XG4gICAgICAgIHJldHVybiByZXQ7XG4gICAgfSxcbiAgICBzZXA6ICcvJyxcbiAgICBkZWxpbWl0ZXI6ICc6JyxcbiAgICB3aW4zMjogbnVsbCxcbiAgICBwb3NpeDogbnVsbFxufTtcbnBvc2l4LnBvc2l4ID0gcG9zaXg7XG5tb2R1bGUuZXhwb3J0cyA9IHBvc2l4O1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL0BmbHVlbmNlbGFicy9tYXJpbmUud29ya2VyLXNjcmlwdC8uLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vcGF0aC1icm93c2VyaWZ5QDEuMC4xL25vZGVfbW9kdWxlcy9wYXRoLWJyb3dzZXJpZnkvaW5kZXguanM/Iik7CgovKioqLyB9KSwKCi8qKiovICIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vcmFuZG9tYnl0ZXNAMi4xLjAvbm9kZV9tb2R1bGVzL3JhbmRvbWJ5dGVzL2Jyb3dzZXIuanMiOgovKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3JhbmRvbWJ5dGVzQDIuMS4wL25vZGVfbW9kdWxlcy9yYW5kb21ieXRlcy9icm93c2VyLmpzICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pID0+IHsKCmV2YWwoIlxuLy8gbGltaXQgb2YgQ3J5cHRvLmdldFJhbmRvbVZhbHVlcygpXG4vLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvQ3J5cHRvL2dldFJhbmRvbVZhbHVlc1xudmFyIE1BWF9CWVRFUyA9IDY1NTM2O1xuLy8gTm9kZSBzdXBwb3J0cyByZXF1ZXN0aW5nIHVwIHRvIHRoaXMgbnVtYmVyIG9mIGJ5dGVzXG4vLyBodHRwczovL2dpdGh1Yi5jb20vbm9kZWpzL25vZGUvYmxvYi9tYXN0ZXIvbGliL2ludGVybmFsL2NyeXB0by9yYW5kb20uanMjTDQ4XG52YXIgTUFYX1VJTlQzMiA9IDQyOTQ5NjcyOTU7XG5mdW5jdGlvbiBvbGRCcm93c2VyKCkge1xuICAgIHRocm93IG5ldyBFcnJvcignU2VjdXJlIHJhbmRvbSBudW1iZXIgZ2VuZXJhdGlvbiBpcyBub3Qgc3VwcG9ydGVkIGJ5IHRoaXMgYnJvd3Nlci5cXG5Vc2UgQ2hyb21lLCBGaXJlZm94IG9yIEludGVybmV0IEV4cGxvcmVyIDExJyk7XG59XG52YXIgQnVmZmVyID0gKF9fd2VicGFja19yZXF1aXJlX18oLyohIHNhZmUtYnVmZmVyICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3NhZmUtYnVmZmVyQDUuMi4xL25vZGVfbW9kdWxlcy9zYWZlLWJ1ZmZlci9pbmRleC5qc1wiKS5CdWZmZXIpO1xudmFyIGNyeXB0byA9IF9fd2VicGFja19yZXF1aXJlX18uZy5jcnlwdG8gfHwgX193ZWJwYWNrX3JlcXVpcmVfXy5nLm1zQ3J5cHRvO1xuaWYgKGNyeXB0byAmJiBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSByYW5kb21CeXRlcztcbn1cbmVsc2Uge1xuICAgIG1vZHVsZS5leHBvcnRzID0gb2xkQnJvd3Nlcjtcbn1cbmZ1bmN0aW9uIHJhbmRvbUJ5dGVzKHNpemUsIGNiKSB7XG4gICAgLy8gcGhhbnRvbWpzIG5lZWRzIHRvIHRocm93XG4gICAgaWYgKHNpemUgPiBNQVhfVUlOVDMyKVxuICAgICAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcigncmVxdWVzdGVkIHRvbyBtYW55IHJhbmRvbSBieXRlcycpO1xuICAgIHZhciBieXRlcyA9IEJ1ZmZlci5hbGxvY1Vuc2FmZShzaXplKTtcbiAgICBpZiAoc2l6ZSA+IDApIHsgLy8gZ2V0UmFuZG9tVmFsdWVzIGZhaWxzIG9uIElFIGlmIHNpemUgPT0gMFxuICAgICAgICBpZiAoc2l6ZSA+IE1BWF9CWVRFUykgeyAvLyB0aGlzIGlzIHRoZSBtYXggYnl0ZXMgY3J5cHRvLmdldFJhbmRvbVZhbHVlc1xuICAgICAgICAgICAgLy8gY2FuIGRvIGF0IG9uY2Ugc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS93aW5kb3cuY3J5cHRvLmdldFJhbmRvbVZhbHVlc1xuICAgICAgICAgICAgZm9yICh2YXIgZ2VuZXJhdGVkID0gMDsgZ2VuZXJhdGVkIDwgc2l6ZTsgZ2VuZXJhdGVkICs9IE1BWF9CWVRFUykge1xuICAgICAgICAgICAgICAgIC8vIGJ1ZmZlci5zbGljZSBhdXRvbWF0aWNhbGx5IGNoZWNrcyBpZiB0aGUgZW5kIGlzIHBhc3QgdGhlIGVuZCBvZlxuICAgICAgICAgICAgICAgIC8vIHRoZSBidWZmZXIgc28gd2UgZG9uJ3QgaGF2ZSB0byBoZXJlXG4gICAgICAgICAgICAgICAgY3J5cHRvLmdldFJhbmRvbVZhbHVlcyhieXRlcy5zbGljZShnZW5lcmF0ZWQsIGdlbmVyYXRlZCArIE1BWF9CWVRFUykpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY3J5cHRvLmdldFJhbmRvbVZhbHVlcyhieXRlcyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKHR5cGVvZiBjYiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICByZXR1cm4gcHJvY2Vzcy5uZXh0VGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBjYihudWxsLCBieXRlcyk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gYnl0ZXM7XG59XG5cblxuLy8jIHNvdXJjZVVSTD13ZWJwYWNrOi8vQGZsdWVuY2VsYWJzL21hcmluZS53b3JrZXItc2NyaXB0Ly4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9yYW5kb21ieXRlc0AyLjEuMC9ub2RlX21vZHVsZXMvcmFuZG9tYnl0ZXMvYnJvd3Nlci5qcz8iKTsKCi8qKiovIH0pLAoKLyoqKi8gIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9yYW5kb21maWxsQDEuMC40L25vZGVfbW9kdWxlcy9yYW5kb21maWxsL2Jyb3dzZXIuanMiOgovKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAhKioqIC4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9yYW5kb21maWxsQDEuMC40L25vZGVfbW9kdWxlcy9yYW5kb21maWxsL2Jyb3dzZXIuanMgKioqIQogIFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pID0+IHsKCmV2YWwoIlxuZnVuY3Rpb24gb2xkQnJvd3NlcigpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3NlY3VyZSByYW5kb20gbnVtYmVyIGdlbmVyYXRpb24gbm90IHN1cHBvcnRlZCBieSB0aGlzIGJyb3dzZXJcXG51c2UgY2hyb21lLCBGaXJlRm94IG9yIEludGVybmV0IEV4cGxvcmVyIDExJyk7XG59XG52YXIgc2FmZUJ1ZmZlciA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIHNhZmUtYnVmZmVyICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3NhZmUtYnVmZmVyQDUuMi4xL25vZGVfbW9kdWxlcy9zYWZlLWJ1ZmZlci9pbmRleC5qc1wiKTtcbnZhciByYW5kb21ieXRlcyA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIHJhbmRvbWJ5dGVzICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3JhbmRvbWJ5dGVzQDIuMS4wL25vZGVfbW9kdWxlcy9yYW5kb21ieXRlcy9icm93c2VyLmpzXCIpO1xudmFyIEJ1ZmZlciA9IHNhZmVCdWZmZXIuQnVmZmVyO1xudmFyIGtCdWZmZXJNYXhMZW5ndGggPSBzYWZlQnVmZmVyLmtNYXhMZW5ndGg7XG52YXIgY3J5cHRvID0gX193ZWJwYWNrX3JlcXVpcmVfXy5nLmNyeXB0byB8fCBfX3dlYnBhY2tfcmVxdWlyZV9fLmcubXNDcnlwdG87XG52YXIga01heFVpbnQzMiA9IE1hdGgucG93KDIsIDMyKSAtIDE7XG5mdW5jdGlvbiBhc3NlcnRPZmZzZXQob2Zmc2V0LCBsZW5ndGgpIHtcbiAgICBpZiAodHlwZW9mIG9mZnNldCAhPT0gJ251bWJlcicgfHwgb2Zmc2V0ICE9PSBvZmZzZXQpIHsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1zZWxmLWNvbXBhcmVcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignb2Zmc2V0IG11c3QgYmUgYSBudW1iZXInKTtcbiAgICB9XG4gICAgaWYgKG9mZnNldCA+IGtNYXhVaW50MzIgfHwgb2Zmc2V0IDwgMCkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdvZmZzZXQgbXVzdCBiZSBhIHVpbnQzMicpO1xuICAgIH1cbiAgICBpZiAob2Zmc2V0ID4ga0J1ZmZlck1heExlbmd0aCB8fCBvZmZzZXQgPiBsZW5ndGgpIHtcbiAgICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ29mZnNldCBvdXQgb2YgcmFuZ2UnKTtcbiAgICB9XG59XG5mdW5jdGlvbiBhc3NlcnRTaXplKHNpemUsIG9mZnNldCwgbGVuZ3RoKSB7XG4gICAgaWYgKHR5cGVvZiBzaXplICE9PSAnbnVtYmVyJyB8fCBzaXplICE9PSBzaXplKSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tc2VsZi1jb21wYXJlXG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ3NpemUgbXVzdCBiZSBhIG51bWJlcicpO1xuICAgIH1cbiAgICBpZiAoc2l6ZSA+IGtNYXhVaW50MzIgfHwgc2l6ZSA8IDApIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignc2l6ZSBtdXN0IGJlIGEgdWludDMyJyk7XG4gICAgfVxuICAgIGlmIChzaXplICsgb2Zmc2V0ID4gbGVuZ3RoIHx8IHNpemUgPiBrQnVmZmVyTWF4TGVuZ3RoKSB7XG4gICAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdidWZmZXIgdG9vIHNtYWxsJyk7XG4gICAgfVxufVxuaWYgKChjcnlwdG8gJiYgY3J5cHRvLmdldFJhbmRvbVZhbHVlcykgfHwgIXByb2Nlc3MuYnJvd3Nlcikge1xuICAgIGV4cG9ydHMucmFuZG9tRmlsbCA9IHJhbmRvbUZpbGw7XG4gICAgZXhwb3J0cy5yYW5kb21GaWxsU3luYyA9IHJhbmRvbUZpbGxTeW5jO1xufVxuZWxzZSB7XG4gICAgZXhwb3J0cy5yYW5kb21GaWxsID0gb2xkQnJvd3NlcjtcbiAgICBleHBvcnRzLnJhbmRvbUZpbGxTeW5jID0gb2xkQnJvd3Nlcjtcbn1cbmZ1bmN0aW9uIHJhbmRvbUZpbGwoYnVmLCBvZmZzZXQsIHNpemUsIGNiKSB7XG4gICAgaWYgKCFCdWZmZXIuaXNCdWZmZXIoYnVmKSAmJiAhKGJ1ZiBpbnN0YW5jZW9mIF9fd2VicGFja19yZXF1aXJlX18uZy5VaW50OEFycmF5KSkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdcImJ1ZlwiIGFyZ3VtZW50IG11c3QgYmUgYSBCdWZmZXIgb3IgVWludDhBcnJheScpO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIG9mZnNldCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBjYiA9IG9mZnNldDtcbiAgICAgICAgb2Zmc2V0ID0gMDtcbiAgICAgICAgc2l6ZSA9IGJ1Zi5sZW5ndGg7XG4gICAgfVxuICAgIGVsc2UgaWYgKHR5cGVvZiBzaXplID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIGNiID0gc2l6ZTtcbiAgICAgICAgc2l6ZSA9IGJ1Zi5sZW5ndGggLSBvZmZzZXQ7XG4gICAgfVxuICAgIGVsc2UgaWYgKHR5cGVvZiBjYiAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdcImNiXCIgYXJndW1lbnQgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XG4gICAgfVxuICAgIGFzc2VydE9mZnNldChvZmZzZXQsIGJ1Zi5sZW5ndGgpO1xuICAgIGFzc2VydFNpemUoc2l6ZSwgb2Zmc2V0LCBidWYubGVuZ3RoKTtcbiAgICByZXR1cm4gYWN0dWFsRmlsbChidWYsIG9mZnNldCwgc2l6ZSwgY2IpO1xufVxuZnVuY3Rpb24gYWN0dWFsRmlsbChidWYsIG9mZnNldCwgc2l6ZSwgY2IpIHtcbiAgICBpZiAocHJvY2Vzcy5icm93c2VyKSB7XG4gICAgICAgIHZhciBvdXJCdWYgPSBidWYuYnVmZmVyO1xuICAgICAgICB2YXIgdWludCA9IG5ldyBVaW50OEFycmF5KG91ckJ1Ziwgb2Zmc2V0LCBzaXplKTtcbiAgICAgICAgY3J5cHRvLmdldFJhbmRvbVZhbHVlcyh1aW50KTtcbiAgICAgICAgaWYgKGNiKSB7XG4gICAgICAgICAgICBwcm9jZXNzLm5leHRUaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBjYihudWxsLCBidWYpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGJ1ZjtcbiAgICB9XG4gICAgaWYgKGNiKSB7XG4gICAgICAgIHJhbmRvbWJ5dGVzKHNpemUsIGZ1bmN0aW9uIChlcnIsIGJ5dGVzKSB7XG4gICAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNiKGVycik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBieXRlcy5jb3B5KGJ1Ziwgb2Zmc2V0KTtcbiAgICAgICAgICAgIGNiKG51bGwsIGJ1Zik7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBieXRlcyA9IHJhbmRvbWJ5dGVzKHNpemUpO1xuICAgIGJ5dGVzLmNvcHkoYnVmLCBvZmZzZXQpO1xuICAgIHJldHVybiBidWY7XG59XG5mdW5jdGlvbiByYW5kb21GaWxsU3luYyhidWYsIG9mZnNldCwgc2l6ZSkge1xuICAgIGlmICh0eXBlb2Ygb2Zmc2V0ID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICBvZmZzZXQgPSAwO1xuICAgIH1cbiAgICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihidWYpICYmICEoYnVmIGluc3RhbmNlb2YgX193ZWJwYWNrX3JlcXVpcmVfXy5nLlVpbnQ4QXJyYXkpKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1wiYnVmXCIgYXJndW1lbnQgbXVzdCBiZSBhIEJ1ZmZlciBvciBVaW50OEFycmF5Jyk7XG4gICAgfVxuICAgIGFzc2VydE9mZnNldChvZmZzZXQsIGJ1Zi5sZW5ndGgpO1xuICAgIGlmIChzaXplID09PSB1bmRlZmluZWQpXG4gICAgICAgIHNpemUgPSBidWYubGVuZ3RoIC0gb2Zmc2V0O1xuICAgIGFzc2VydFNpemUoc2l6ZSwgb2Zmc2V0LCBidWYubGVuZ3RoKTtcbiAgICByZXR1cm4gYWN0dWFsRmlsbChidWYsIG9mZnNldCwgc2l6ZSk7XG59XG5cblxuLy8jIHNvdXJjZVVSTD13ZWJwYWNrOi8vQGZsdWVuY2VsYWJzL21hcmluZS53b3JrZXItc2NyaXB0Ly4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9yYW5kb21maWxsQDEuMC40L25vZGVfbW9kdWxlcy9yYW5kb21maWxsL2Jyb3dzZXIuanM/Iik7CgovKioqLyB9KSwKCi8qKiovICIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vc2FmZS1idWZmZXJANS4yLjEvbm9kZV9tb2R1bGVzL3NhZmUtYnVmZmVyL2luZGV4LmpzIjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiAuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vc2FmZS1idWZmZXJANS4yLjEvbm9kZV9tb2R1bGVzL3NhZmUtYnVmZmVyL2luZGV4LmpzICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgPT4gewoKZXZhbCgiXG4vKiEgc2FmZS1idWZmZXIuIE1JVCBMaWNlbnNlLiBGZXJvc3MgQWJvdWtoYWRpamVoIDxodHRwczovL2Zlcm9zcy5vcmcvb3BlbnNvdXJjZT4gKi9cbi8qIGVzbGludC1kaXNhYmxlIG5vZGUvbm8tZGVwcmVjYXRlZC1hcGkgKi9cbnZhciBidWZmZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBidWZmZXIgKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vYnVmZmVyQDYuMC4zL25vZGVfbW9kdWxlcy9idWZmZXIvaW5kZXguanNcIik7XG52YXIgQnVmZmVyID0gYnVmZmVyLkJ1ZmZlcjtcbi8vIGFsdGVybmF0aXZlIHRvIHVzaW5nIE9iamVjdC5rZXlzIGZvciBvbGQgYnJvd3NlcnNcbmZ1bmN0aW9uIGNvcHlQcm9wcyhzcmMsIGRzdCkge1xuICAgIGZvciAodmFyIGtleSBpbiBzcmMpIHtcbiAgICAgICAgZHN0W2tleV0gPSBzcmNba2V5XTtcbiAgICB9XG59XG5pZiAoQnVmZmVyLmZyb20gJiYgQnVmZmVyLmFsbG9jICYmIEJ1ZmZlci5hbGxvY1Vuc2FmZSAmJiBCdWZmZXIuYWxsb2NVbnNhZmVTbG93KSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBidWZmZXI7XG59XG5lbHNlIHtcbiAgICAvLyBDb3B5IHByb3BlcnRpZXMgZnJvbSByZXF1aXJlKCdidWZmZXInKVxuICAgIGNvcHlQcm9wcyhidWZmZXIsIGV4cG9ydHMpO1xuICAgIGV4cG9ydHMuQnVmZmVyID0gU2FmZUJ1ZmZlcjtcbn1cbmZ1bmN0aW9uIFNhZmVCdWZmZXIoYXJnLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpIHtcbiAgICByZXR1cm4gQnVmZmVyKGFyZywgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKTtcbn1cblNhZmVCdWZmZXIucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShCdWZmZXIucHJvdG90eXBlKTtcbi8vIENvcHkgc3RhdGljIG1ldGhvZHMgZnJvbSBCdWZmZXJcbmNvcHlQcm9wcyhCdWZmZXIsIFNhZmVCdWZmZXIpO1xuU2FmZUJ1ZmZlci5mcm9tID0gZnVuY3Rpb24gKGFyZywgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKSB7XG4gICAgaWYgKHR5cGVvZiBhcmcgPT09ICdudW1iZXInKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FyZ3VtZW50IG11c3Qgbm90IGJlIGEgbnVtYmVyJyk7XG4gICAgfVxuICAgIHJldHVybiBCdWZmZXIoYXJnLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpO1xufTtcblNhZmVCdWZmZXIuYWxsb2MgPSBmdW5jdGlvbiAoc2l6ZSwgZmlsbCwgZW5jb2RpbmcpIHtcbiAgICBpZiAodHlwZW9mIHNpemUgIT09ICdudW1iZXInKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FyZ3VtZW50IG11c3QgYmUgYSBudW1iZXInKTtcbiAgICB9XG4gICAgdmFyIGJ1ZiA9IEJ1ZmZlcihzaXplKTtcbiAgICBpZiAoZmlsbCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGlmICh0eXBlb2YgZW5jb2RpbmcgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICBidWYuZmlsbChmaWxsLCBlbmNvZGluZyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBidWYuZmlsbChmaWxsKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgYnVmLmZpbGwoMCk7XG4gICAgfVxuICAgIHJldHVybiBidWY7XG59O1xuU2FmZUJ1ZmZlci5hbGxvY1Vuc2FmZSA9IGZ1bmN0aW9uIChzaXplKSB7XG4gICAgaWYgKHR5cGVvZiBzaXplICE9PSAnbnVtYmVyJykge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcmd1bWVudCBtdXN0IGJlIGEgbnVtYmVyJyk7XG4gICAgfVxuICAgIHJldHVybiBCdWZmZXIoc2l6ZSk7XG59O1xuU2FmZUJ1ZmZlci5hbGxvY1Vuc2FmZVNsb3cgPSBmdW5jdGlvbiAoc2l6ZSkge1xuICAgIGlmICh0eXBlb2Ygc2l6ZSAhPT0gJ251bWJlcicpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJndW1lbnQgbXVzdCBiZSBhIG51bWJlcicpO1xuICAgIH1cbiAgICByZXR1cm4gYnVmZmVyLlNsb3dCdWZmZXIoc2l6ZSk7XG59O1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL0BmbHVlbmNlbGFicy9tYXJpbmUud29ya2VyLXNjcmlwdC8uLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vc2FmZS1idWZmZXJANS4yLjEvbm9kZV9tb2R1bGVzL3NhZmUtYnVmZmVyL2luZGV4LmpzPyIpOwoKLyoqKi8gfSksCgovKioqLyAiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC9jb21tb24uanMiOgovKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiAuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vdGhyZWFkc0AxLjcuMC9ub2RlX21vZHVsZXMvdGhyZWFkcy9kaXN0L2NvbW1vbi5qcyAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pID0+IHsKCmV2YWwoIlxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoeyB2YWx1ZTogdHJ1ZSB9KSk7XG5leHBvcnRzLnNlcmlhbGl6ZSA9IGV4cG9ydHMuZGVzZXJpYWxpemUgPSBleHBvcnRzLnJlZ2lzdGVyU2VyaWFsaXplciA9IHZvaWQgMDtcbnZhciBzZXJpYWxpemVyc18xID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9zZXJpYWxpemVycyAqLyBcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS90aHJlYWRzQDEuNy4wL25vZGVfbW9kdWxlcy90aHJlYWRzL2Rpc3Qvc2VyaWFsaXplcnMuanNcIik7XG52YXIgcmVnaXN0ZXJlZFNlcmlhbGl6ZXIgPSBzZXJpYWxpemVyc18xLkRlZmF1bHRTZXJpYWxpemVyO1xuZnVuY3Rpb24gcmVnaXN0ZXJTZXJpYWxpemVyKHNlcmlhbGl6ZXIpIHtcbiAgICByZWdpc3RlcmVkU2VyaWFsaXplciA9IHNlcmlhbGl6ZXJzXzEuZXh0ZW5kU2VyaWFsaXplcihyZWdpc3RlcmVkU2VyaWFsaXplciwgc2VyaWFsaXplcik7XG59XG5leHBvcnRzLnJlZ2lzdGVyU2VyaWFsaXplciA9IHJlZ2lzdGVyU2VyaWFsaXplcjtcbmZ1bmN0aW9uIGRlc2VyaWFsaXplKG1lc3NhZ2UpIHtcbiAgICByZXR1cm4gcmVnaXN0ZXJlZFNlcmlhbGl6ZXIuZGVzZXJpYWxpemUobWVzc2FnZSk7XG59XG5leHBvcnRzLmRlc2VyaWFsaXplID0gZGVzZXJpYWxpemU7XG5mdW5jdGlvbiBzZXJpYWxpemUoaW5wdXQpIHtcbiAgICByZXR1cm4gcmVnaXN0ZXJlZFNlcmlhbGl6ZXIuc2VyaWFsaXplKGlucHV0KTtcbn1cbmV4cG9ydHMuc2VyaWFsaXplID0gc2VyaWFsaXplO1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL0BmbHVlbmNlbGFicy9tYXJpbmUud29ya2VyLXNjcmlwdC8uLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vdGhyZWFkc0AxLjcuMC9ub2RlX21vZHVsZXMvdGhyZWFkcy9kaXN0L2NvbW1vbi5qcz8iKTsKCi8qKiovIH0pLAoKLyoqKi8gIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS90aHJlYWRzQDEuNy4wL25vZGVfbW9kdWxlcy90aHJlYWRzL2Rpc3QvaW5kZXguanMiOgovKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAhKioqIC4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS90aHJlYWRzQDEuNy4wL25vZGVfbW9kdWxlcy90aHJlYWRzL2Rpc3QvaW5kZXguanMgKioqIQogIFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKiovIChmdW5jdGlvbihfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKZXZhbCgiXG52YXIgX19jcmVhdGVCaW5kaW5nID0gKHRoaXMgJiYgdGhpcy5fX2NyZWF0ZUJpbmRpbmcpIHx8IChPYmplY3QuY3JlYXRlID8gKGZ1bmN0aW9uIChvLCBtLCBrLCBrMikge1xuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKVxuICAgICAgICBrMiA9IGs7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gbVtrXTsgfSB9KTtcbn0pIDogKGZ1bmN0aW9uIChvLCBtLCBrLCBrMikge1xuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKVxuICAgICAgICBrMiA9IGs7XG4gICAgb1trMl0gPSBtW2tdO1xufSkpO1xudmFyIF9fZXhwb3J0U3RhciA9ICh0aGlzICYmIHRoaXMuX19leHBvcnRTdGFyKSB8fCBmdW5jdGlvbiAobSwgZXhwb3J0cykge1xuICAgIGZvciAodmFyIHAgaW4gbSlcbiAgICAgICAgaWYgKHAgIT09IFwiZGVmYXVsdFwiICYmICFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZXhwb3J0cywgcCkpXG4gICAgICAgICAgICBfX2NyZWF0ZUJpbmRpbmcoZXhwb3J0cywgbSwgcCk7XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoeyB2YWx1ZTogdHJ1ZSB9KSk7XG5leHBvcnRzLlRyYW5zZmVyID0gZXhwb3J0cy5EZWZhdWx0U2VyaWFsaXplciA9IGV4cG9ydHMuZXhwb3NlID0gZXhwb3J0cy5yZWdpc3RlclNlcmlhbGl6ZXIgPSB2b2lkIDA7XG52YXIgY29tbW9uXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL2NvbW1vbiAqLyBcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS90aHJlYWRzQDEuNy4wL25vZGVfbW9kdWxlcy90aHJlYWRzL2Rpc3QvY29tbW9uLmpzXCIpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwicmVnaXN0ZXJTZXJpYWxpemVyXCIsICh7IGVudW1lcmFibGU6IHRydWUsIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gY29tbW9uXzEucmVnaXN0ZXJTZXJpYWxpemVyOyB9IH0pKTtcbl9fZXhwb3J0U3RhcihfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL21hc3Rlci9pbmRleCAqLyBcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS90aHJlYWRzQDEuNy4wL25vZGVfbW9kdWxlcy90aHJlYWRzL2Rpc3QvbWFzdGVyL2luZGV4LmpzXCIpLCBleHBvcnRzKTtcbnZhciBpbmRleF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi93b3JrZXIvaW5kZXggKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vdGhyZWFkc0AxLjcuMC9ub2RlX21vZHVsZXMvdGhyZWFkcy9kaXN0L3dvcmtlci9pbmRleC5qc1wiKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcImV4cG9zZVwiLCAoeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGluZGV4XzEuZXhwb3NlOyB9IH0pKTtcbnZhciBzZXJpYWxpemVyc18xID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9zZXJpYWxpemVycyAqLyBcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS90aHJlYWRzQDEuNy4wL25vZGVfbW9kdWxlcy90aHJlYWRzL2Rpc3Qvc2VyaWFsaXplcnMuanNcIik7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJEZWZhdWx0U2VyaWFsaXplclwiLCAoeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHNlcmlhbGl6ZXJzXzEuRGVmYXVsdFNlcmlhbGl6ZXI7IH0gfSkpO1xudmFyIHRyYW5zZmVyYWJsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi90cmFuc2ZlcmFibGUgKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vdGhyZWFkc0AxLjcuMC9ub2RlX21vZHVsZXMvdGhyZWFkcy9kaXN0L3RyYW5zZmVyYWJsZS5qc1wiKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIlRyYW5zZmVyXCIsICh7IGVudW1lcmFibGU6IHRydWUsIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdHJhbnNmZXJhYmxlXzEuVHJhbnNmZXI7IH0gfSkpO1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL0BmbHVlbmNlbGFicy9tYXJpbmUud29ya2VyLXNjcmlwdC8uLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vdGhyZWFkc0AxLjcuMC9ub2RlX21vZHVsZXMvdGhyZWFkcy9kaXN0L2luZGV4LmpzPyIpOwoKLyoqKi8gfSksCgovKioqLyAiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC9tYXN0ZXIvZ2V0LWJ1bmRsZS11cmwuYnJvd3Nlci5qcyI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC9tYXN0ZXIvZ2V0LWJ1bmRsZS11cmwuYnJvd3Nlci5qcyAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykgPT4gewoKZXZhbCgiXG4vLyBTb3VyY2U6IDxodHRwczovL2dpdGh1Yi5jb20vcGFyY2VsLWJ1bmRsZXIvcGFyY2VsL2Jsb2IvbWFzdGVyL3BhY2thZ2VzL2NvcmUvcGFyY2VsLWJ1bmRsZXIvc3JjL2J1aWx0aW5zL2J1bmRsZS11cmwuanM+XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7IHZhbHVlOiB0cnVlIH0pKTtcbmV4cG9ydHMuZ2V0QnVuZGxlVVJMID0gZXhwb3J0cy5nZXRCYXNlVVJMID0gdm9pZCAwO1xudmFyIGJ1bmRsZVVSTDtcbmZ1bmN0aW9uIGdldEJ1bmRsZVVSTENhY2hlZCgpIHtcbiAgICBpZiAoIWJ1bmRsZVVSTCkge1xuICAgICAgICBidW5kbGVVUkwgPSBnZXRCdW5kbGVVUkwoKTtcbiAgICB9XG4gICAgcmV0dXJuIGJ1bmRsZVVSTDtcbn1cbmV4cG9ydHMuZ2V0QnVuZGxlVVJMID0gZ2V0QnVuZGxlVVJMQ2FjaGVkO1xuZnVuY3Rpb24gZ2V0QnVuZGxlVVJMKCkge1xuICAgIC8vIEF0dGVtcHQgdG8gZmluZCB0aGUgVVJMIG9mIHRoZSBjdXJyZW50IHNjcmlwdCBhbmQgdXNlIHRoYXQgYXMgdGhlIGJhc2UgVVJMXG4gICAgdHJ5IHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yO1xuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHZhciBtYXRjaGVzID0gKFwiXCIgKyBlcnIuc3RhY2spLm1hdGNoKC8oaHR0cHM/fGZpbGV8ZnRwfGNocm9tZS1leHRlbnNpb258bW96LWV4dGVuc2lvbik6XFwvXFwvW14pXFxuXSsvZyk7XG4gICAgICAgIGlmIChtYXRjaGVzKSB7XG4gICAgICAgICAgICByZXR1cm4gZ2V0QmFzZVVSTChtYXRjaGVzWzBdKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gXCIvXCI7XG59XG5mdW5jdGlvbiBnZXRCYXNlVVJMKHVybCkge1xuICAgIHJldHVybiAoXCJcIiArIHVybCkucmVwbGFjZSgvXigoPzpodHRwcz98ZmlsZXxmdHB8Y2hyb21lLWV4dGVuc2lvbnxtb3otZXh0ZW5zaW9uKTpcXC9cXC8uKyk/XFwvW14vXSsoPzpcXD8uKik/JC8sICckMScpICsgJy8nO1xufVxuZXhwb3J0cy5nZXRCYXNlVVJMID0gZ2V0QmFzZVVSTDtcblxuXG4vLyMgc291cmNlVVJMPXdlYnBhY2s6Ly9AZmx1ZW5jZWxhYnMvbWFyaW5lLndvcmtlci1zY3JpcHQvLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC9tYXN0ZXIvZ2V0LWJ1bmRsZS11cmwuYnJvd3Nlci5qcz8iKTsKCi8qKiovIH0pLAoKLyoqKi8gIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS90aHJlYWRzQDEuNy4wL25vZGVfbW9kdWxlcy90aHJlYWRzL2Rpc3QvbWFzdGVyL2ltcGxlbWVudGF0aW9uLmJyb3dzZXIuanMiOgovKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAhKioqIC4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS90aHJlYWRzQDEuNy4wL25vZGVfbW9kdWxlcy90aHJlYWRzL2Rpc3QvbWFzdGVyL2ltcGxlbWVudGF0aW9uLmJyb3dzZXIuanMgKioqIQogIFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKiovIChmdW5jdGlvbihfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKZXZhbCgiXG52YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuLy8gdHNsaW50OmRpc2FibGUgbWF4LWNsYXNzZXMtcGVyLWZpbGVcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHsgdmFsdWU6IHRydWUgfSkpO1xuZXhwb3J0cy5pc1dvcmtlclJ1bnRpbWUgPSBleHBvcnRzLmdldFdvcmtlckltcGxlbWVudGF0aW9uID0gZXhwb3J0cy5kZWZhdWx0UG9vbFNpemUgPSB2b2lkIDA7XG52YXIgZ2V0X2J1bmRsZV91cmxfYnJvd3Nlcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9nZXQtYnVuZGxlLXVybC5icm93c2VyICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC9tYXN0ZXIvZ2V0LWJ1bmRsZS11cmwuYnJvd3Nlci5qc1wiKTtcbmV4cG9ydHMuZGVmYXVsdFBvb2xTaXplID0gdHlwZW9mIG5hdmlnYXRvciAhPT0gXCJ1bmRlZmluZWRcIiAmJiBuYXZpZ2F0b3IuaGFyZHdhcmVDb25jdXJyZW5jeVxuICAgID8gbmF2aWdhdG9yLmhhcmR3YXJlQ29uY3VycmVuY3lcbiAgICA6IDQ7XG52YXIgaXNBYnNvbHV0ZVVSTCA9IGZ1bmN0aW9uICh2YWx1ZSkgeyByZXR1cm4gL15bYS16QS1aXVthLXpBLVpcXGQrXFwtLl0qOi8udGVzdCh2YWx1ZSk7IH07XG5mdW5jdGlvbiBjcmVhdGVTb3VyY2VCbG9iVVJMKGNvZGUpIHtcbiAgICB2YXIgYmxvYiA9IG5ldyBCbG9iKFtjb2RlXSwgeyB0eXBlOiBcImFwcGxpY2F0aW9uL2phdmFzY3JpcHRcIiB9KTtcbiAgICByZXR1cm4gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTtcbn1cbmZ1bmN0aW9uIHNlbGVjdFdvcmtlckltcGxlbWVudGF0aW9uKCkge1xuICAgIGlmICh0eXBlb2YgV29ya2VyID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgIC8vIE1pZ2h0IGhhcHBlbiBvbiBTYWZhcmksIGZvciBpbnN0YW5jZVxuICAgICAgICAvLyBUaGUgaWRlYSBpcyB0byBvbmx5IGZhaWwgaWYgdGhlIGNvbnN0cnVjdG9yIGlzIGFjdHVhbGx5IHVzZWRcbiAgICAgICAgcmV0dXJuIC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIE5vV2ViV29ya2VyKCkge1xuICAgICAgICAgICAgICAgIHRocm93IEVycm9yKFwiTm8gd2ViIHdvcmtlciBpbXBsZW1lbnRhdGlvbiBhdmFpbGFibGUuIFlvdSBtaWdodCBoYXZlIHRyaWVkIHRvIHNwYXduIGEgd29ya2VyIHdpdGhpbiBhIHdvcmtlciBpbiBhIGJyb3dzZXIgdGhhdCBkb2Vzbid0IHN1cHBvcnQgd29ya2VycyBpbiB3b3JrZXJzLlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBOb1dlYldvcmtlcjtcbiAgICAgICAgfSgpKTtcbiAgICB9XG4gICAgdmFyIFdlYldvcmtlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKFdlYldvcmtlciwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gV2ViV29ya2VyKHVybCwgb3B0aW9ucykge1xuICAgICAgICAgICAgdmFyIF9hLCBfYjtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdXJsID09PSBcInN0cmluZ1wiICYmIG9wdGlvbnMgJiYgb3B0aW9ucy5fYmFzZVVSTCkge1xuICAgICAgICAgICAgICAgIHVybCA9IG5ldyBVUkwodXJsLCBvcHRpb25zLl9iYXNlVVJMKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiB1cmwgPT09IFwic3RyaW5nXCIgJiYgIWlzQWJzb2x1dGVVUkwodXJsKSAmJiBnZXRfYnVuZGxlX3VybF9icm93c2VyXzEuZ2V0QnVuZGxlVVJMKCkubWF0Y2goL15maWxlOlxcL1xcLy9pKSkge1xuICAgICAgICAgICAgICAgIHVybCA9IG5ldyBVUkwodXJsLCBnZXRfYnVuZGxlX3VybF9icm93c2VyXzEuZ2V0QnVuZGxlVVJMKCkucmVwbGFjZSgvXFwvW15cXC9dKyQvLCBcIi9cIikpO1xuICAgICAgICAgICAgICAgIGlmICgoX2EgPSBvcHRpb25zID09PSBudWxsIHx8IG9wdGlvbnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG9wdGlvbnMuQ09SU1dvcmthcm91bmQpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdXJsID0gY3JlYXRlU291cmNlQmxvYlVSTChcImltcG9ydFNjcmlwdHMoXCIuY29uY2F0KEpTT04uc3RyaW5naWZ5KHVybCksIFwiKTtcIikpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0eXBlb2YgdXJsID09PSBcInN0cmluZ1wiICYmIGlzQWJzb2x1dGVVUkwodXJsKSkge1xuICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBzb3VyY2UgY29kZSBibG9iIGxvYWRpbmcgSlMgZmlsZSB2aWEgYGltcG9ydFNjcmlwdHMoKWBcbiAgICAgICAgICAgICAgICAvLyB0byBjaXJjdW12ZW50IHdvcmtlciBDT1JTIHJlc3RyaWN0aW9uc1xuICAgICAgICAgICAgICAgIGlmICgoX2IgPSBvcHRpb25zID09PSBudWxsIHx8IG9wdGlvbnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG9wdGlvbnMuQ09SU1dvcmthcm91bmQpICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdXJsID0gY3JlYXRlU291cmNlQmxvYlVSTChcImltcG9ydFNjcmlwdHMoXCIuY29uY2F0KEpTT04uc3RyaW5naWZ5KHVybCksIFwiKTtcIikpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCB1cmwsIG9wdGlvbnMpIHx8IHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFdlYldvcmtlcjtcbiAgICB9KFdvcmtlcikpO1xuICAgIHZhciBCbG9iV29ya2VyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoQmxvYldvcmtlciwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gQmxvYldvcmtlcihibG9iLCBvcHRpb25zKSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7XG4gICAgICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgdXJsLCBvcHRpb25zKSB8fCB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIEJsb2JXb3JrZXIuZnJvbVRleHQgPSBmdW5jdGlvbiAoc291cmNlLCBvcHRpb25zKSB7XG4gICAgICAgICAgICB2YXIgYmxvYiA9IG5ldyB3aW5kb3cuQmxvYihbc291cmNlXSwgeyB0eXBlOiBcInRleHQvamF2YXNjcmlwdFwiIH0pO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBCbG9iV29ya2VyKGJsb2IsIG9wdGlvbnMpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gQmxvYldvcmtlcjtcbiAgICB9KFdlYldvcmtlcikpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGJsb2I6IEJsb2JXb3JrZXIsXG4gICAgICAgIGRlZmF1bHQ6IFdlYldvcmtlclxuICAgIH07XG59XG52YXIgaW1wbGVtZW50YXRpb247XG5mdW5jdGlvbiBnZXRXb3JrZXJJbXBsZW1lbnRhdGlvbigpIHtcbiAgICBpZiAoIWltcGxlbWVudGF0aW9uKSB7XG4gICAgICAgIGltcGxlbWVudGF0aW9uID0gc2VsZWN0V29ya2VySW1wbGVtZW50YXRpb24oKTtcbiAgICB9XG4gICAgcmV0dXJuIGltcGxlbWVudGF0aW9uO1xufVxuZXhwb3J0cy5nZXRXb3JrZXJJbXBsZW1lbnRhdGlvbiA9IGdldFdvcmtlckltcGxlbWVudGF0aW9uO1xuZnVuY3Rpb24gaXNXb3JrZXJSdW50aW1lKCkge1xuICAgIHZhciBpc1dpbmRvd0NvbnRleHQgPSB0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIiAmJiB0eXBlb2YgV2luZG93ICE9PSBcInVuZGVmaW5lZFwiICYmIHNlbGYgaW5zdGFuY2VvZiBXaW5kb3c7XG4gICAgcmV0dXJuIHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiICYmIHNlbGYucG9zdE1lc3NhZ2UgJiYgIWlzV2luZG93Q29udGV4dCA/IHRydWUgOiBmYWxzZTtcbn1cbmV4cG9ydHMuaXNXb3JrZXJSdW50aW1lID0gaXNXb3JrZXJSdW50aW1lO1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL0BmbHVlbmNlbGFicy9tYXJpbmUud29ya2VyLXNjcmlwdC8uLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vdGhyZWFkc0AxLjcuMC9ub2RlX21vZHVsZXMvdGhyZWFkcy9kaXN0L21hc3Rlci9pbXBsZW1lbnRhdGlvbi5icm93c2VyLmpzPyIpOwoKLyoqKi8gfSksCgovKioqLyAiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC9tYXN0ZXIvaW5kZXguanMiOgovKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiAuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vdGhyZWFkc0AxLjcuMC9ub2RlX21vZHVsZXMvdGhyZWFkcy9kaXN0L21hc3Rlci9pbmRleC5qcyAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pID0+IHsKCmV2YWwoIlxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoeyB2YWx1ZTogdHJ1ZSB9KSk7XG5leHBvcnRzLldvcmtlciA9IGV4cG9ydHMuQmxvYldvcmtlciA9IGV4cG9ydHMuaXNXb3JrZXJSdW50aW1lID0gZXhwb3J0cy5UaHJlYWQgPSBleHBvcnRzLnNwYXduID0gZXhwb3J0cy5Qb29sID0gdm9pZCAwO1xudmFyIGltcGxlbWVudGF0aW9uXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL2ltcGxlbWVudGF0aW9uICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC9tYXN0ZXIvaW1wbGVtZW50YXRpb24uYnJvd3Nlci5qc1wiKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcImlzV29ya2VyUnVudGltZVwiLCAoeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGltcGxlbWVudGF0aW9uXzEuaXNXb3JrZXJSdW50aW1lOyB9IH0pKTtcbnZhciBwb29sXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL3Bvb2wgKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vdGhyZWFkc0AxLjcuMC9ub2RlX21vZHVsZXMvdGhyZWFkcy9kaXN0L21hc3Rlci9wb29sLmpzXCIpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiUG9vbFwiLCAoeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHBvb2xfMS5Qb29sOyB9IH0pKTtcbnZhciBzcGF3bl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9zcGF3biAqLyBcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS90aHJlYWRzQDEuNy4wL25vZGVfbW9kdWxlcy90aHJlYWRzL2Rpc3QvbWFzdGVyL3NwYXduLmpzXCIpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwic3Bhd25cIiwgKHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBzcGF3bl8xLnNwYXduOyB9IH0pKTtcbnZhciB0aHJlYWRfMSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vdGhyZWFkICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC9tYXN0ZXIvdGhyZWFkLmpzXCIpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiVGhyZWFkXCIsICh7IGVudW1lcmFibGU6IHRydWUsIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhyZWFkXzEuVGhyZWFkOyB9IH0pKTtcbi8qKiBTZXBhcmF0ZSBjbGFzcyB0byBzcGF3biB3b3JrZXJzIGZyb20gc291cmNlIGNvZGUgYmxvYnMgb3Igc3RyaW5ncy4gKi9cbmV4cG9ydHMuQmxvYldvcmtlciA9IGltcGxlbWVudGF0aW9uXzEuZ2V0V29ya2VySW1wbGVtZW50YXRpb24oKS5ibG9iO1xuLyoqIFdvcmtlciBpbXBsZW1lbnRhdGlvbi4gRWl0aGVyIHdlYiB3b3JrZXIgb3IgYSBub2RlLmpzIFdvcmtlciBjbGFzcy4gKi9cbmV4cG9ydHMuV29ya2VyID0gaW1wbGVtZW50YXRpb25fMS5nZXRXb3JrZXJJbXBsZW1lbnRhdGlvbigpLmRlZmF1bHQ7XG5cblxuLy8jIHNvdXJjZVVSTD13ZWJwYWNrOi8vQGZsdWVuY2VsYWJzL21hcmluZS53b3JrZXItc2NyaXB0Ly4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS90aHJlYWRzQDEuNy4wL25vZGVfbW9kdWxlcy90aHJlYWRzL2Rpc3QvbWFzdGVyL2luZGV4LmpzPyIpOwoKLyoqKi8gfSksCgovKioqLyAiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC9tYXN0ZXIvaW52b2NhdGlvbi1wcm94eS5qcyI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC9tYXN0ZXIvaW52b2NhdGlvbi1wcm94eS5qcyAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKGZ1bmN0aW9uKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpldmFsKCJcbi8qXG4gKiBUaGlzIHNvdXJjZSBmaWxlIGNvbnRhaW5zIHRoZSBjb2RlIGZvciBwcm94eWluZyBjYWxscyBpbiB0aGUgbWFzdGVyIHRocmVhZCB0byBjYWxscyBpbiB0aGUgd29ya2Vyc1xuICogYnkgYC5wb3N0TWVzc2FnZSgpYC1pbmcuXG4gKlxuICogS2VlcCBpbiBtaW5kIHRoYXQgdGhpcyBjb2RlIGNhbiBtYWtlIG9yIGJyZWFrIHRoZSBwcm9ncmFtJ3MgcGVyZm9ybWFuY2UhIE5lZWQgdG8gb3B0aW1pemUgbW9yZeKAplxuICovXG52YXIgX19pbXBvcnREZWZhdWx0ID0gKHRoaXMgJiYgdGhpcy5fX2ltcG9ydERlZmF1bHQpIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IFwiZGVmYXVsdFwiOiBtb2QgfTtcbn07XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7IHZhbHVlOiB0cnVlIH0pKTtcbmV4cG9ydHMuY3JlYXRlUHJveHlNb2R1bGUgPSBleHBvcnRzLmNyZWF0ZVByb3h5RnVuY3Rpb24gPSB2b2lkIDA7XG52YXIgZGVidWdfMSA9IF9faW1wb3J0RGVmYXVsdChfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBkZWJ1ZyAqLyBcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9kZWJ1Z0A0LjMuNC9ub2RlX21vZHVsZXMvZGVidWcvc3JjL2Jyb3dzZXIuanNcIikpO1xudmFyIG9ic2VydmFibGVfZm5zXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBvYnNlcnZhYmxlLWZucyAqLyBcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9vYnNlcnZhYmxlLWZuc0AwLjYuMS9ub2RlX21vZHVsZXMvb2JzZXJ2YWJsZS1mbnMvZGlzdC5lc20vaW5kZXguanNcIik7XG52YXIgY29tbW9uXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuLi9jb21tb24gKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vdGhyZWFkc0AxLjcuMC9ub2RlX21vZHVsZXMvdGhyZWFkcy9kaXN0L2NvbW1vbi5qc1wiKTtcbnZhciBvYnNlcnZhYmxlX3Byb21pc2VfMSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4uL29ic2VydmFibGUtcHJvbWlzZSAqLyBcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS90aHJlYWRzQDEuNy4wL25vZGVfbW9kdWxlcy90aHJlYWRzL2Rpc3Qvb2JzZXJ2YWJsZS1wcm9taXNlLmpzXCIpO1xudmFyIHRyYW5zZmVyYWJsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi4vdHJhbnNmZXJhYmxlICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC90cmFuc2ZlcmFibGUuanNcIik7XG52YXIgbWVzc2FnZXNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4uL3R5cGVzL21lc3NhZ2VzICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC90eXBlcy9tZXNzYWdlcy5qc1wiKTtcbnZhciBkZWJ1Z01lc3NhZ2VzID0gZGVidWdfMS5kZWZhdWx0KFwidGhyZWFkczptYXN0ZXI6bWVzc2FnZXNcIik7XG52YXIgbmV4dEpvYlVJRCA9IDE7XG52YXIgZGVkdXBlID0gZnVuY3Rpb24gKGFycmF5KSB7IHJldHVybiBBcnJheS5mcm9tKG5ldyBTZXQoYXJyYXkpKTsgfTtcbnZhciBpc0pvYkVycm9yTWVzc2FnZSA9IGZ1bmN0aW9uIChkYXRhKSB7IHJldHVybiBkYXRhICYmIGRhdGEudHlwZSA9PT0gbWVzc2FnZXNfMS5Xb3JrZXJNZXNzYWdlVHlwZS5lcnJvcjsgfTtcbnZhciBpc0pvYlJlc3VsdE1lc3NhZ2UgPSBmdW5jdGlvbiAoZGF0YSkgeyByZXR1cm4gZGF0YSAmJiBkYXRhLnR5cGUgPT09IG1lc3NhZ2VzXzEuV29ya2VyTWVzc2FnZVR5cGUucmVzdWx0OyB9O1xudmFyIGlzSm9iU3RhcnRNZXNzYWdlID0gZnVuY3Rpb24gKGRhdGEpIHsgcmV0dXJuIGRhdGEgJiYgZGF0YS50eXBlID09PSBtZXNzYWdlc18xLldvcmtlck1lc3NhZ2VUeXBlLnJ1bm5pbmc7IH07XG5mdW5jdGlvbiBjcmVhdGVPYnNlcnZhYmxlRm9ySm9iKHdvcmtlciwgam9iVUlEKSB7XG4gICAgcmV0dXJuIG5ldyBvYnNlcnZhYmxlX2Zuc18xLk9ic2VydmFibGUoZnVuY3Rpb24gKG9ic2VydmVyKSB7XG4gICAgICAgIHZhciBhc3luY1R5cGU7XG4gICAgICAgIHZhciBtZXNzYWdlSGFuZGxlciA9IChmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgIGRlYnVnTWVzc2FnZXMoXCJNZXNzYWdlIGZyb20gd29ya2VyOlwiLCBldmVudC5kYXRhKTtcbiAgICAgICAgICAgIGlmICghZXZlbnQuZGF0YSB8fCBldmVudC5kYXRhLnVpZCAhPT0gam9iVUlEKVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIGlmIChpc0pvYlN0YXJ0TWVzc2FnZShldmVudC5kYXRhKSkge1xuICAgICAgICAgICAgICAgIGFzeW5jVHlwZSA9IGV2ZW50LmRhdGEucmVzdWx0VHlwZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGlzSm9iUmVzdWx0TWVzc2FnZShldmVudC5kYXRhKSkge1xuICAgICAgICAgICAgICAgIGlmIChhc3luY1R5cGUgPT09IFwicHJvbWlzZVwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZXZlbnQuZGF0YS5wYXlsb2FkICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvYnNlcnZlci5uZXh0KGNvbW1vbl8xLmRlc2VyaWFsaXplKGV2ZW50LmRhdGEucGF5bG9hZCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLmNvbXBsZXRlKCk7XG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5yZW1vdmVFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCBtZXNzYWdlSGFuZGxlcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQuZGF0YS5wYXlsb2FkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvYnNlcnZlci5uZXh0KGNvbW1vbl8xLmRlc2VyaWFsaXplKGV2ZW50LmRhdGEucGF5bG9hZCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChldmVudC5kYXRhLmNvbXBsZXRlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvYnNlcnZlci5jb21wbGV0ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIG1lc3NhZ2VIYW5kbGVyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGlzSm9iRXJyb3JNZXNzYWdlKGV2ZW50LmRhdGEpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGVycm9yID0gY29tbW9uXzEuZGVzZXJpYWxpemUoZXZlbnQuZGF0YS5lcnJvcik7XG4gICAgICAgICAgICAgICAgaWYgKGFzeW5jVHlwZSA9PT0gXCJwcm9taXNlXCIgfHwgIWFzeW5jVHlwZSkge1xuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlci5lcnJvcihlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlci5lcnJvcihlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHdvcmtlci5yZW1vdmVFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCBtZXNzYWdlSGFuZGxlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB3b3JrZXIuYWRkRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgbWVzc2FnZUhhbmRsZXIpO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKGFzeW5jVHlwZSA9PT0gXCJvYnNlcnZhYmxlXCIgfHwgIWFzeW5jVHlwZSkge1xuICAgICAgICAgICAgICAgIHZhciBjYW5jZWxNZXNzYWdlID0ge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBtZXNzYWdlc18xLk1hc3Rlck1lc3NhZ2VUeXBlLmNhbmNlbCxcbiAgICAgICAgICAgICAgICAgICAgdWlkOiBqb2JVSURcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHdvcmtlci5wb3N0TWVzc2FnZShjYW5jZWxNZXNzYWdlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHdvcmtlci5yZW1vdmVFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCBtZXNzYWdlSGFuZGxlcik7XG4gICAgICAgIH07XG4gICAgfSk7XG59XG5mdW5jdGlvbiBwcmVwYXJlQXJndW1lbnRzKHJhd0FyZ3MpIHtcbiAgICBpZiAocmF3QXJncy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgLy8gRXhpdCBlYXJseSBpZiBwb3NzaWJsZVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYXJnczogW10sXG4gICAgICAgICAgICB0cmFuc2ZlcmFibGVzOiBbXVxuICAgICAgICB9O1xuICAgIH1cbiAgICB2YXIgYXJncyA9IFtdO1xuICAgIHZhciB0cmFuc2ZlcmFibGVzID0gW107XG4gICAgZm9yICh2YXIgX2kgPSAwLCByYXdBcmdzXzEgPSByYXdBcmdzOyBfaSA8IHJhd0FyZ3NfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIGFyZyA9IHJhd0FyZ3NfMVtfaV07XG4gICAgICAgIGlmICh0cmFuc2ZlcmFibGVfMS5pc1RyYW5zZmVyRGVzY3JpcHRvcihhcmcpKSB7XG4gICAgICAgICAgICBhcmdzLnB1c2goY29tbW9uXzEuc2VyaWFsaXplKGFyZy5zZW5kKSk7XG4gICAgICAgICAgICB0cmFuc2ZlcmFibGVzLnB1c2guYXBwbHkodHJhbnNmZXJhYmxlcywgYXJnLnRyYW5zZmVyYWJsZXMpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgYXJncy5wdXNoKGNvbW1vbl8xLnNlcmlhbGl6ZShhcmcpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBhcmdzOiBhcmdzLFxuICAgICAgICB0cmFuc2ZlcmFibGVzOiB0cmFuc2ZlcmFibGVzLmxlbmd0aCA9PT0gMCA/IHRyYW5zZmVyYWJsZXMgOiBkZWR1cGUodHJhbnNmZXJhYmxlcylcbiAgICB9O1xufVxuZnVuY3Rpb24gY3JlYXRlUHJveHlGdW5jdGlvbih3b3JrZXIsIG1ldGhvZCkge1xuICAgIHJldHVybiAoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcmF3QXJncyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgcmF3QXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHZhciB1aWQgPSBuZXh0Sm9iVUlEKys7XG4gICAgICAgIHZhciBfYSA9IHByZXBhcmVBcmd1bWVudHMocmF3QXJncyksIGFyZ3MgPSBfYS5hcmdzLCB0cmFuc2ZlcmFibGVzID0gX2EudHJhbnNmZXJhYmxlcztcbiAgICAgICAgdmFyIHJ1bk1lc3NhZ2UgPSB7XG4gICAgICAgICAgICB0eXBlOiBtZXNzYWdlc18xLk1hc3Rlck1lc3NhZ2VUeXBlLnJ1bixcbiAgICAgICAgICAgIHVpZDogdWlkLFxuICAgICAgICAgICAgbWV0aG9kOiBtZXRob2QsXG4gICAgICAgICAgICBhcmdzOiBhcmdzXG4gICAgICAgIH07XG4gICAgICAgIGRlYnVnTWVzc2FnZXMoXCJTZW5kaW5nIGNvbW1hbmQgdG8gcnVuIGZ1bmN0aW9uIHRvIHdvcmtlcjpcIiwgcnVuTWVzc2FnZSk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB3b3JrZXIucG9zdE1lc3NhZ2UocnVuTWVzc2FnZSwgdHJhbnNmZXJhYmxlcyk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4gb2JzZXJ2YWJsZV9wcm9taXNlXzEuT2JzZXJ2YWJsZVByb21pc2UuZnJvbShQcm9taXNlLnJlamVjdChlcnJvcikpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvYnNlcnZhYmxlX3Byb21pc2VfMS5PYnNlcnZhYmxlUHJvbWlzZS5mcm9tKG9ic2VydmFibGVfZm5zXzEubXVsdGljYXN0KGNyZWF0ZU9ic2VydmFibGVGb3JKb2Iod29ya2VyLCB1aWQpKSk7XG4gICAgfSk7XG59XG5leHBvcnRzLmNyZWF0ZVByb3h5RnVuY3Rpb24gPSBjcmVhdGVQcm94eUZ1bmN0aW9uO1xuZnVuY3Rpb24gY3JlYXRlUHJveHlNb2R1bGUod29ya2VyLCBtZXRob2ROYW1lcykge1xuICAgIHZhciBwcm94eSA9IHt9O1xuICAgIGZvciAodmFyIF9pID0gMCwgbWV0aG9kTmFtZXNfMSA9IG1ldGhvZE5hbWVzOyBfaSA8IG1ldGhvZE5hbWVzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHZhciBtZXRob2ROYW1lID0gbWV0aG9kTmFtZXNfMVtfaV07XG4gICAgICAgIHByb3h5W21ldGhvZE5hbWVdID0gY3JlYXRlUHJveHlGdW5jdGlvbih3b3JrZXIsIG1ldGhvZE5hbWUpO1xuICAgIH1cbiAgICByZXR1cm4gcHJveHk7XG59XG5leHBvcnRzLmNyZWF0ZVByb3h5TW9kdWxlID0gY3JlYXRlUHJveHlNb2R1bGU7XG5cblxuLy8jIHNvdXJjZVVSTD13ZWJwYWNrOi8vQGZsdWVuY2VsYWJzL21hcmluZS53b3JrZXItc2NyaXB0Ly4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS90aHJlYWRzQDEuNy4wL25vZGVfbW9kdWxlcy90aHJlYWRzL2Rpc3QvbWFzdGVyL2ludm9jYXRpb24tcHJveHkuanM/Iik7CgovKioqLyB9KSwKCi8qKiovICIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vdGhyZWFkc0AxLjcuMC9ub2RlX21vZHVsZXMvdGhyZWFkcy9kaXN0L21hc3Rlci9wb29sLXR5cGVzLmpzIjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiAuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vdGhyZWFkc0AxLjcuMC9ub2RlX21vZHVsZXMvdGhyZWFkcy9kaXN0L21hc3Rlci9wb29sLXR5cGVzLmpzICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSA9PiB7CgpldmFsKCJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHsgdmFsdWU6IHRydWUgfSkpO1xuZXhwb3J0cy5Qb29sRXZlbnRUeXBlID0gdm9pZCAwO1xuLyoqIFBvb2wgZXZlbnQgdHlwZS4gU3BlY2lmaWVzIHRoZSB0eXBlIG9mIGVhY2ggYFBvb2xFdmVudGAuICovXG52YXIgUG9vbEV2ZW50VHlwZTtcbihmdW5jdGlvbiAoUG9vbEV2ZW50VHlwZSkge1xuICAgIFBvb2xFdmVudFR5cGVbXCJpbml0aWFsaXplZFwiXSA9IFwiaW5pdGlhbGl6ZWRcIjtcbiAgICBQb29sRXZlbnRUeXBlW1widGFza0NhbmNlbGVkXCJdID0gXCJ0YXNrQ2FuY2VsZWRcIjtcbiAgICBQb29sRXZlbnRUeXBlW1widGFza0NvbXBsZXRlZFwiXSA9IFwidGFza0NvbXBsZXRlZFwiO1xuICAgIFBvb2xFdmVudFR5cGVbXCJ0YXNrRmFpbGVkXCJdID0gXCJ0YXNrRmFpbGVkXCI7XG4gICAgUG9vbEV2ZW50VHlwZVtcInRhc2tRdWV1ZWRcIl0gPSBcInRhc2tRdWV1ZWRcIjtcbiAgICBQb29sRXZlbnRUeXBlW1widGFza1F1ZXVlRHJhaW5lZFwiXSA9IFwidGFza1F1ZXVlRHJhaW5lZFwiO1xuICAgIFBvb2xFdmVudFR5cGVbXCJ0YXNrU3RhcnRcIl0gPSBcInRhc2tTdGFydFwiO1xuICAgIFBvb2xFdmVudFR5cGVbXCJ0ZXJtaW5hdGVkXCJdID0gXCJ0ZXJtaW5hdGVkXCI7XG59KShQb29sRXZlbnRUeXBlID0gZXhwb3J0cy5Qb29sRXZlbnRUeXBlIHx8IChleHBvcnRzLlBvb2xFdmVudFR5cGUgPSB7fSkpO1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL0BmbHVlbmNlbGFicy9tYXJpbmUud29ya2VyLXNjcmlwdC8uLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vdGhyZWFkc0AxLjcuMC9ub2RlX21vZHVsZXMvdGhyZWFkcy9kaXN0L21hc3Rlci9wb29sLXR5cGVzLmpzPyIpOwoKLyoqKi8gfSksCgovKioqLyAiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC9tYXN0ZXIvcG9vbC5qcyI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC9tYXN0ZXIvcG9vbC5qcyAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKGZ1bmN0aW9uKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpldmFsKCJcbnZhciBfX2dlbmVyYXRvciA9ICh0aGlzICYmIHRoaXMuX19nZW5lcmF0b3IpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBib2R5KSB7XG4gICAgdmFyIF8gPSB7IGxhYmVsOiAwLCBzZW50OiBmdW5jdGlvbigpIHsgaWYgKHRbMF0gJiAxKSB0aHJvdyB0WzFdOyByZXR1cm4gdFsxXTsgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZztcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cbiAgICBmdW5jdGlvbiBzdGVwKG9wKSB7XG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcbiAgICAgICAgd2hpbGUgKF8pIHRyeSB7XG4gICAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5W1wicmV0dXJuXCJdIDogb3BbMF0gPyB5W1widGhyb3dcIl0gfHwgKCh0ID0geVtcInJldHVyblwiXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7XG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XG4gICAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7XG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcbiAgICB9XG59O1xudmFyIF9fc3ByZWFkQXJyYXkgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXkpIHx8IGZ1bmN0aW9uICh0bywgZnJvbSwgcGFjaykge1xuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XG59O1xudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkge1xuICAgICAgICAgICAgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgIH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkge1xuICAgICAgICAgICAgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgIH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xudmFyIF9faW1wb3J0RGVmYXVsdCA9ICh0aGlzICYmIHRoaXMuX19pbXBvcnREZWZhdWx0KSB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBcImRlZmF1bHRcIjogbW9kIH07XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoeyB2YWx1ZTogdHJ1ZSB9KSk7XG5leHBvcnRzLlBvb2wgPSBleHBvcnRzLlRocmVhZCA9IGV4cG9ydHMuUG9vbEV2ZW50VHlwZSA9IHZvaWQgMDtcbnZhciBkZWJ1Z18xID0gX19pbXBvcnREZWZhdWx0KF9fd2VicGFja19yZXF1aXJlX18oLyohIGRlYnVnICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL2RlYnVnQDQuMy40L25vZGVfbW9kdWxlcy9kZWJ1Zy9zcmMvYnJvd3Nlci5qc1wiKSk7XG52YXIgb2JzZXJ2YWJsZV9mbnNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIG9ic2VydmFibGUtZm5zICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL29ic2VydmFibGUtZm5zQDAuNi4xL25vZGVfbW9kdWxlcy9vYnNlcnZhYmxlLWZucy9kaXN0LmVzbS9pbmRleC5qc1wiKTtcbnZhciBwb255ZmlsbHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4uL3BvbnlmaWxscyAqLyBcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS90aHJlYWRzQDEuNy4wL25vZGVfbW9kdWxlcy90aHJlYWRzL2Rpc3QvcG9ueWZpbGxzLmpzXCIpO1xudmFyIGltcGxlbWVudGF0aW9uXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL2ltcGxlbWVudGF0aW9uICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC9tYXN0ZXIvaW1wbGVtZW50YXRpb24uYnJvd3Nlci5qc1wiKTtcbnZhciBwb29sX3R5cGVzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL3Bvb2wtdHlwZXMgKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vdGhyZWFkc0AxLjcuMC9ub2RlX21vZHVsZXMvdGhyZWFkcy9kaXN0L21hc3Rlci9wb29sLXR5cGVzLmpzXCIpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiUG9vbEV2ZW50VHlwZVwiLCAoeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHBvb2xfdHlwZXNfMS5Qb29sRXZlbnRUeXBlOyB9IH0pKTtcbnZhciB0aHJlYWRfMSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vdGhyZWFkICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC9tYXN0ZXIvdGhyZWFkLmpzXCIpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiVGhyZWFkXCIsICh7IGVudW1lcmFibGU6IHRydWUsIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhyZWFkXzEuVGhyZWFkOyB9IH0pKTtcbnZhciBuZXh0UG9vbElEID0gMTtcbmZ1bmN0aW9uIGNyZWF0ZUFycmF5KHNpemUpIHtcbiAgICB2YXIgYXJyYXkgPSBbXTtcbiAgICBmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgc2l6ZTsgaW5kZXgrKykge1xuICAgICAgICBhcnJheS5wdXNoKGluZGV4KTtcbiAgICB9XG4gICAgcmV0dXJuIGFycmF5O1xufVxuZnVuY3Rpb24gZGVsYXkobXMpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmV0dXJuIHNldFRpbWVvdXQocmVzb2x2ZSwgbXMpOyB9KTtcbn1cbmZ1bmN0aW9uIGZsYXRNYXAoYXJyYXksIG1hcHBlcikge1xuICAgIHJldHVybiBhcnJheS5yZWR1Y2UoZnVuY3Rpb24gKGZsYXR0ZW5lZCwgZWxlbWVudCkgeyByZXR1cm4gX19zcHJlYWRBcnJheShfX3NwcmVhZEFycmF5KFtdLCBmbGF0dGVuZWQsIHRydWUpLCBtYXBwZXIoZWxlbWVudCksIHRydWUpOyB9LCBbXSk7XG59XG5mdW5jdGlvbiBzbHVnaWZ5KHRleHQpIHtcbiAgICByZXR1cm4gdGV4dC5yZXBsYWNlKC9cXFcvZywgXCIgXCIpLnRyaW0oKS5yZXBsYWNlKC9cXHMrL2csIFwiLVwiKTtcbn1cbmZ1bmN0aW9uIHNwYXduV29ya2VycyhzcGF3bldvcmtlciwgY291bnQpIHtcbiAgICByZXR1cm4gY3JlYXRlQXJyYXkoY291bnQpLm1hcChmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgICAgICBpbml0OiBzcGF3bldvcmtlcigpLFxuICAgICAgICBydW5uaW5nVGFza3M6IFtdXG4gICAgfSk7IH0pO1xufVxudmFyIFdvcmtlclBvb2wgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gV29ya2VyUG9vbChzcGF3bldvcmtlciwgb3B0aW9uc09yU2l6ZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLmV2ZW50U3ViamVjdCA9IG5ldyBvYnNlcnZhYmxlX2Zuc18xLlN1YmplY3QoKTtcbiAgICAgICAgdGhpcy5pbml0RXJyb3JzID0gW107XG4gICAgICAgIHRoaXMuaXNDbG9zaW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMubmV4dFRhc2tJRCA9IDE7XG4gICAgICAgIHRoaXMudGFza1F1ZXVlID0gW107XG4gICAgICAgIHZhciBvcHRpb25zID0gdHlwZW9mIG9wdGlvbnNPclNpemUgPT09IFwibnVtYmVyXCJcbiAgICAgICAgICAgID8geyBzaXplOiBvcHRpb25zT3JTaXplIH1cbiAgICAgICAgICAgIDogb3B0aW9uc09yU2l6ZSB8fCB7fTtcbiAgICAgICAgdmFyIF9hID0gb3B0aW9ucy5zaXplLCBzaXplID0gX2EgPT09IHZvaWQgMCA/IGltcGxlbWVudGF0aW9uXzEuZGVmYXVsdFBvb2xTaXplIDogX2E7XG4gICAgICAgIHRoaXMuZGVidWcgPSBkZWJ1Z18xLmRlZmF1bHQoXCJ0aHJlYWRzOnBvb2w6XCIuY29uY2F0KHNsdWdpZnkob3B0aW9ucy5uYW1lIHx8IFN0cmluZyhuZXh0UG9vbElEKyspKSkpO1xuICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgICB0aGlzLndvcmtlcnMgPSBzcGF3bldvcmtlcnMoc3Bhd25Xb3JrZXIsIHNpemUpO1xuICAgICAgICB0aGlzLmV2ZW50T2JzZXJ2YWJsZSA9IG9ic2VydmFibGVfZm5zXzEubXVsdGljYXN0KG9ic2VydmFibGVfZm5zXzEuT2JzZXJ2YWJsZS5mcm9tKHRoaXMuZXZlbnRTdWJqZWN0KSk7XG4gICAgICAgIFByb21pc2UuYWxsKHRoaXMud29ya2Vycy5tYXAoZnVuY3Rpb24gKHdvcmtlcikgeyByZXR1cm4gd29ya2VyLmluaXQ7IH0pKS50aGVuKGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLmV2ZW50U3ViamVjdC5uZXh0KHtcbiAgICAgICAgICAgIHR5cGU6IHBvb2xfdHlwZXNfMS5Qb29sRXZlbnRUeXBlLmluaXRpYWxpemVkLFxuICAgICAgICAgICAgc2l6ZTogX3RoaXMud29ya2Vycy5sZW5ndGhcbiAgICAgICAgfSk7IH0sIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgX3RoaXMuZGVidWcoXCJFcnJvciB3aGlsZSBpbml0aWFsaXppbmcgcG9vbCB3b3JrZXI6XCIsIGVycm9yKTtcbiAgICAgICAgICAgIF90aGlzLmV2ZW50U3ViamVjdC5lcnJvcihlcnJvcik7XG4gICAgICAgICAgICBfdGhpcy5pbml0RXJyb3JzLnB1c2goZXJyb3IpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgV29ya2VyUG9vbC5wcm90b3R5cGUuZmluZElkbGluZ1dvcmtlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF9hID0gdGhpcy5vcHRpb25zLmNvbmN1cnJlbmN5LCBjb25jdXJyZW5jeSA9IF9hID09PSB2b2lkIDAgPyAxIDogX2E7XG4gICAgICAgIHJldHVybiB0aGlzLndvcmtlcnMuZmluZChmdW5jdGlvbiAod29ya2VyKSB7IHJldHVybiB3b3JrZXIucnVubmluZ1Rhc2tzLmxlbmd0aCA8IGNvbmN1cnJlbmN5OyB9KTtcbiAgICB9O1xuICAgIFdvcmtlclBvb2wucHJvdG90eXBlLnJ1blBvb2xUYXNrID0gZnVuY3Rpb24gKHdvcmtlciwgdGFzaykge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgd29ya2VySUQsIHJldHVyblZhbHVlLCBfYSwgX2IsIGVycm9yXzE7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9jKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYy5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJJRCA9IHRoaXMud29ya2Vycy5pbmRleE9mKHdvcmtlcikgKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZWJ1ZyhcIlJ1bm5pbmcgdGFzayAjXCIuY29uY2F0KHRhc2suaWQsIFwiIG9uIHdvcmtlciAjXCIpLmNvbmNhdCh3b3JrZXJJRCwgXCIuLi5cIikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ldmVudFN1YmplY3QubmV4dCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogcG9vbF90eXBlc18xLlBvb2xFdmVudFR5cGUudGFza1N0YXJ0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tJRDogdGFzay5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJJRDogd29ya2VySURcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2MubGFiZWwgPSAxO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYy50cnlzLnB1c2goWzEsIDQsICwgNV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2IgPSAoX2EgPSB0YXNrKS5ydW47XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB3b3JrZXIuaW5pdF07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjogcmV0dXJuIFs0IC8qeWllbGQqLywgX2IuYXBwbHkoX2EsIFtfYy5zZW50KCldKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblZhbHVlID0gX2Muc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZWJ1ZyhcIlRhc2sgI1wiLmNvbmNhdCh0YXNrLmlkLCBcIiBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5XCIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZXZlbnRTdWJqZWN0Lm5leHQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IHBvb2xfdHlwZXNfMS5Qb29sRXZlbnRUeXBlLnRhc2tDb21wbGV0ZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuVmFsdWU6IHJldHVyblZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tJRDogdGFzay5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJJRDogd29ya2VySURcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yXzEgPSBfYy5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRlYnVnKFwiVGFzayAjXCIuY29uY2F0KHRhc2suaWQsIFwiIGZhaWxlZFwiKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmV2ZW50U3ViamVjdC5uZXh0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBwb29sX3R5cGVzXzEuUG9vbEV2ZW50VHlwZS50YXNrRmFpbGVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tJRDogdGFzay5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3JfMSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJJRDogd29ya2VySURcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFdvcmtlclBvb2wucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICh3b3JrZXIsIHRhc2spIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHJ1blByb21pc2U7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHJ1blByb21pc2UgPSAoZnVuY3Rpb24gKCkgeyByZXR1cm4gX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVtb3ZlVGFza0Zyb21Xb3JrZXJzUnVubmluZ1Rhc2tzO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVUYXNrRnJvbVdvcmtlcnNSdW5uaW5nVGFza3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXIucnVubmluZ1Rhc2tzID0gd29ya2VyLnJ1bm5pbmdUYXNrcy5maWx0ZXIoZnVuY3Rpb24gKHNvbWVSdW5Qcm9taXNlKSB7IHJldHVybiBzb21lUnVuUHJvbWlzZSAhPT0gcnVuUHJvbWlzZTsgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIERlZmVyIHRhc2sgZXhlY3V0aW9uIGJ5IG9uZSB0aWNrIHRvIGdpdmUgaGFuZGxlcnMgdGltZSB0byBzdWJzY3JpYmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgZGVsYXkoMCldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRGVmZXIgdGFzayBleGVjdXRpb24gYnkgb25lIHRpY2sgdG8gZ2l2ZSBoYW5kbGVycyB0aW1lIHRvIHN1YnNjcmliZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLnRyeXMucHVzaChbMiwgLCA0LCA1XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucnVuUG9vbFRhc2sod29ya2VyLCB0YXNrKV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlVGFza0Zyb21Xb3JrZXJzUnVubmluZ1Rhc2tzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5pc0Nsb3NpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVXb3JrKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs3IC8qZW5kZmluYWxseSovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDU6IHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7IH0pKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyLnJ1bm5pbmdUYXNrcy5wdXNoKHJ1blByb21pc2UpO1xuICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFdvcmtlclBvb2wucHJvdG90eXBlLnNjaGVkdWxlV29yayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5kZWJ1ZyhcIkF0dGVtcHQgZGUtcXVldWVpbmcgYSB0YXNrIGluIG9yZGVyIHRvIHJ1biBpdC4uLlwiKTtcbiAgICAgICAgdmFyIGF2YWlsYWJsZVdvcmtlciA9IHRoaXMuZmluZElkbGluZ1dvcmtlcigpO1xuICAgICAgICBpZiAoIWF2YWlsYWJsZVdvcmtlcilcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdmFyIG5leHRUYXNrID0gdGhpcy50YXNrUXVldWUuc2hpZnQoKTtcbiAgICAgICAgaWYgKCFuZXh0VGFzaykge1xuICAgICAgICAgICAgdGhpcy5kZWJ1ZyhcIlRhc2sgcXVldWUgaXMgZW1wdHlcIik7XG4gICAgICAgICAgICB0aGlzLmV2ZW50U3ViamVjdC5uZXh0KHsgdHlwZTogcG9vbF90eXBlc18xLlBvb2xFdmVudFR5cGUudGFza1F1ZXVlRHJhaW5lZCB9KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJ1bihhdmFpbGFibGVXb3JrZXIsIG5leHRUYXNrKTtcbiAgICB9O1xuICAgIFdvcmtlclBvb2wucHJvdG90eXBlLnRhc2tDb21wbGV0aW9uID0gZnVuY3Rpb24gKHRhc2tJRCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgdmFyIGV2ZW50U3Vic2NyaXB0aW9uID0gX3RoaXMuZXZlbnRzKCkuc3Vic2NyaWJlKGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgIGlmIChldmVudC50eXBlID09PSBwb29sX3R5cGVzXzEuUG9vbEV2ZW50VHlwZS50YXNrQ29tcGxldGVkICYmIGV2ZW50LnRhc2tJRCA9PT0gdGFza0lEKSB7XG4gICAgICAgICAgICAgICAgICAgIGV2ZW50U3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZXZlbnQucmV0dXJuVmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChldmVudC50eXBlID09PSBwb29sX3R5cGVzXzEuUG9vbEV2ZW50VHlwZS50YXNrRmFpbGVkICYmIGV2ZW50LnRhc2tJRCA9PT0gdGFza0lEKSB7XG4gICAgICAgICAgICAgICAgICAgIGV2ZW50U3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChldmVudC5lcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGV2ZW50LnR5cGUgPT09IHBvb2xfdHlwZXNfMS5Qb29sRXZlbnRUeXBlLnRlcm1pbmF0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgZXZlbnRTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KEVycm9yKFwiUG9vbCBoYXMgYmVlbiB0ZXJtaW5hdGVkIGJlZm9yZSB0YXNrIHdhcyBydW4uXCIpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBXb3JrZXJQb29sLnByb3RvdHlwZS5zZXR0bGVkID0gZnVuY3Rpb24gKGFsbG93UmVzb2x2aW5nSW1tZWRpYXRlbHkpIHtcbiAgICAgICAgaWYgKGFsbG93UmVzb2x2aW5nSW1tZWRpYXRlbHkgPT09IHZvaWQgMCkgeyBhbGxvd1Jlc29sdmluZ0ltbWVkaWF0ZWx5ID0gZmFsc2U7IH1cbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGdldEN1cnJlbnRseVJ1bm5pbmdUYXNrcywgdGFza0ZhaWx1cmVzLCBmYWlsdXJlU3Vic2NyaXB0aW9uO1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGdldEN1cnJlbnRseVJ1bm5pbmdUYXNrcyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGZsYXRNYXAoX3RoaXMud29ya2VycywgZnVuY3Rpb24gKHdvcmtlcikgeyByZXR1cm4gd29ya2VyLnJ1bm5pbmdUYXNrczsgfSk7IH07XG4gICAgICAgICAgICAgICAgICAgICAgICB0YXNrRmFpbHVyZXMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhaWx1cmVTdWJzY3JpcHRpb24gPSB0aGlzLmV2ZW50T2JzZXJ2YWJsZS5zdWJzY3JpYmUoZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LnR5cGUgPT09IHBvb2xfdHlwZXNfMS5Qb29sRXZlbnRUeXBlLnRhc2tGYWlsZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFza0ZhaWx1cmVzLnB1c2goZXZlbnQuZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdEVycm9ycy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIFByb21pc2UucmVqZWN0KHRoaXMuaW5pdEVycm9yc1swXSldO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoYWxsb3dSZXNvbHZpbmdJbW1lZGlhdGVseSAmJiB0aGlzLnRhc2tRdWV1ZS5sZW5ndGggPT09IDApKSByZXR1cm4gWzMgLypicmVhayovLCAyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHBvbnlmaWxsc18xLmFsbFNldHRsZWQoZ2V0Q3VycmVudGx5UnVubmluZ1Rhc2tzKCkpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRhc2tGYWlsdXJlc107XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjogcmV0dXJuIFs0IC8qeWllbGQqLywgbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJzY3JpcHRpb24gPSBfdGhpcy5ldmVudE9ic2VydmFibGUuc3Vic2NyaWJlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV4dDogZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQudHlwZSA9PT0gcG9vbF90eXBlc18xLlBvb2xFdmVudFR5cGUudGFza1F1ZXVlRHJhaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUodm9pZCAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IHJlamVjdCAvLyBtYWtlIGEgcG9vbC13aWRlIGVycm9yIHJlamVjdCB0aGUgY29tcGxldGVkKCkgcmVzdWx0IHByb21pc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcG9ueWZpbGxzXzEuYWxsU2V0dGxlZChnZXRDdXJyZW50bHlSdW5uaW5nVGFza3MoKSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmYWlsdXJlU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGFza0ZhaWx1cmVzXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBXb3JrZXJQb29sLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoYWxsb3dSZXNvbHZpbmdJbW1lZGlhdGVseSkge1xuICAgICAgICBpZiAoYWxsb3dSZXNvbHZpbmdJbW1lZGlhdGVseSA9PT0gdm9pZCAwKSB7IGFsbG93UmVzb2x2aW5nSW1tZWRpYXRlbHkgPSBmYWxzZTsgfVxuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgc2V0dGxlbWVudFByb21pc2UsIGVhcmx5RXhpdFByb21pc2UsIGVycm9ycztcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXR0bGVtZW50UHJvbWlzZSA9IHRoaXMuc2V0dGxlZChhbGxvd1Jlc29sdmluZ0ltbWVkaWF0ZWx5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVhcmx5RXhpdFByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YnNjcmlwdGlvbiA9IF90aGlzLmV2ZW50T2JzZXJ2YWJsZS5zdWJzY3JpYmUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXh0OiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldmVudC50eXBlID09PSBwb29sX3R5cGVzXzEuUG9vbEV2ZW50VHlwZS50YXNrUXVldWVEcmFpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzZXR0bGVtZW50UHJvbWlzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChldmVudC50eXBlID09PSBwb29sX3R5cGVzXzEuUG9vbEV2ZW50VHlwZS50YXNrRmFpbGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGV2ZW50LmVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IHJlamVjdCAvLyBtYWtlIGEgcG9vbC13aWRlIGVycm9yIHJlamVjdCB0aGUgY29tcGxldGVkKCkgcmVzdWx0IHByb21pc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgUHJvbWlzZS5yYWNlKFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0dGxlbWVudFByb21pc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVhcmx5RXhpdFByb21pc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9ycyA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlcnJvcnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IGVycm9yc1swXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBXb3JrZXJQb29sLnByb3RvdHlwZS5ldmVudHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmV2ZW50T2JzZXJ2YWJsZTtcbiAgICB9O1xuICAgIFdvcmtlclBvb2wucHJvdG90eXBlLnF1ZXVlID0gZnVuY3Rpb24gKHRhc2tGdW5jdGlvbikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgX2EgPSB0aGlzLm9wdGlvbnMubWF4UXVldWVkSm9icywgbWF4UXVldWVkSm9icyA9IF9hID09PSB2b2lkIDAgPyBJbmZpbml0eSA6IF9hO1xuICAgICAgICBpZiAodGhpcy5pc0Nsb3NpbmcpIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKFwiQ2Fubm90IHNjaGVkdWxlIHBvb2wgdGFza3MgYWZ0ZXIgdGVybWluYXRlKCkgaGFzIGJlZW4gY2FsbGVkLlwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5pbml0RXJyb3JzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRocm93IHRoaXMuaW5pdEVycm9yc1swXTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdGFza0lEID0gdGhpcy5uZXh0VGFza0lEKys7XG4gICAgICAgIHZhciB0YXNrQ29tcGxldGlvbiA9IHRoaXMudGFza0NvbXBsZXRpb24odGFza0lEKTtcbiAgICAgICAgdGFza0NvbXBsZXRpb24uY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAvLyBQcmV2ZW50IHVuaGFuZGxlZCByZWplY3Rpb25zIGhlcmUgYXMgd2UgYXNzdW1lIHRoZSB1c2VyIHdpbGwgdXNlXG4gICAgICAgICAgICAvLyBgcG9vbC5jb21wbGV0ZWQoKWAsIGBwb29sLnNldHRsZWQoKWAgb3IgYHRhc2suY2F0Y2goKWAgdG8gaGFuZGxlIGVycm9yc1xuICAgICAgICAgICAgX3RoaXMuZGVidWcoXCJUYXNrICNcIi5jb25jYXQodGFza0lELCBcIiBlcnJvcmVkOlwiKSwgZXJyb3IpO1xuICAgICAgICB9KTtcbiAgICAgICAgdmFyIHRhc2sgPSB7XG4gICAgICAgICAgICBpZDogdGFza0lELFxuICAgICAgICAgICAgcnVuOiB0YXNrRnVuY3Rpb24sXG4gICAgICAgICAgICBjYW5jZWw6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMudGFza1F1ZXVlLmluZGV4T2YodGFzaykgPT09IC0xKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgX3RoaXMudGFza1F1ZXVlID0gX3RoaXMudGFza1F1ZXVlLmZpbHRlcihmdW5jdGlvbiAoc29tZVRhc2spIHsgcmV0dXJuIHNvbWVUYXNrICE9PSB0YXNrOyB9KTtcbiAgICAgICAgICAgICAgICBfdGhpcy5ldmVudFN1YmplY3QubmV4dCh7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IHBvb2xfdHlwZXNfMS5Qb29sRXZlbnRUeXBlLnRhc2tDYW5jZWxlZCxcbiAgICAgICAgICAgICAgICAgICAgdGFza0lEOiB0YXNrLmlkXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdGhlbjogdGFza0NvbXBsZXRpb24udGhlbi5iaW5kKHRhc2tDb21wbGV0aW9uKVxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy50YXNrUXVldWUubGVuZ3RoID49IG1heFF1ZXVlZEpvYnMpIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKFwiTWF4aW11bSBudW1iZXIgb2YgcG9vbCB0YXNrcyBxdWV1ZWQuIFJlZnVzaW5nIHRvIHF1ZXVlIGFub3RoZXIgb25lLlxcblwiICtcbiAgICAgICAgICAgICAgICBcIlRoaXMgdXN1YWxseSBoYXBwZW5zIGZvciBvbmUgb2YgdHdvIHJlYXNvbnM6IFdlIGFyZSBlaXRoZXIgYXQgcGVhayBcIiArXG4gICAgICAgICAgICAgICAgXCJ3b3JrbG9hZCByaWdodCBub3cgb3Igc29tZSB0YXNrcyBqdXN0IHdvbid0IGZpbmlzaCwgdGh1cyBibG9ja2luZyB0aGUgcG9vbC5cIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5kZWJ1ZyhcIlF1ZXVlaW5nIHRhc2sgI1wiLmNvbmNhdCh0YXNrLmlkLCBcIi4uLlwiKSk7XG4gICAgICAgIHRoaXMudGFza1F1ZXVlLnB1c2godGFzayk7XG4gICAgICAgIHRoaXMuZXZlbnRTdWJqZWN0Lm5leHQoe1xuICAgICAgICAgICAgdHlwZTogcG9vbF90eXBlc18xLlBvb2xFdmVudFR5cGUudGFza1F1ZXVlZCxcbiAgICAgICAgICAgIHRhc2tJRDogdGFzay5pZFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zY2hlZHVsZVdvcmsoKTtcbiAgICAgICAgcmV0dXJuIHRhc2s7XG4gICAgfTtcbiAgICBXb3JrZXJQb29sLnByb3RvdHlwZS50ZXJtaW5hdGUgPSBmdW5jdGlvbiAoZm9yY2UpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaXNDbG9zaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIWZvcmNlKSByZXR1cm4gWzMgLypicmVhayovLCAyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuY29tcGxldGVkKHRydWUpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAyO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmV2ZW50U3ViamVjdC5uZXh0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBwb29sX3R5cGVzXzEuUG9vbEV2ZW50VHlwZS50ZXJtaW5hdGVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbWFpbmluZ1F1ZXVlOiBfX3NwcmVhZEFycmF5KFtdLCB0aGlzLnRhc2tRdWV1ZSwgdHJ1ZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ldmVudFN1YmplY3QuY29tcGxldGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIFByb21pc2UuYWxsKHRoaXMud29ya2Vycy5tYXAoZnVuY3Rpb24gKHdvcmtlcikgeyByZXR1cm4gX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkgeyB2YXIgX2EsIF9iOyByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9jKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2MubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYiA9IChfYSA9IHRocmVhZF8xLlRocmVhZCkudGVybWluYXRlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHdvcmtlci5pbml0XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTogcmV0dXJuIFsyIC8qcmV0dXJuKi8sIF9iLmFwcGx5KF9hLCBbX2Muc2VudCgpXSldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7IH0pOyB9KSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIFdvcmtlclBvb2w7XG59KCkpO1xuV29ya2VyUG9vbC5FdmVudFR5cGUgPSBwb29sX3R5cGVzXzEuUG9vbEV2ZW50VHlwZTtcbi8qKlxuICogVGhyZWFkIHBvb2wgY29uc3RydWN0b3IuIENyZWF0ZXMgYSBuZXcgcG9vbCBhbmQgc3Bhd25zIGl0cyB3b3JrZXIgdGhyZWFkcy5cbiAqL1xuZnVuY3Rpb24gUG9vbENvbnN0cnVjdG9yKHNwYXduV29ya2VyLCBvcHRpb25zT3JTaXplKSB7XG4gICAgLy8gVGhlIGZ1bmN0aW9uIGV4aXN0cyBvbmx5IHNvIHdlIGRvbid0IG5lZWQgdG8gdXNlIGBuZXdgIHRvIGNyZWF0ZSBhIHBvb2wgKHdlIHN0aWxsIGNhbiwgdGhvdWdoKS5cbiAgICAvLyBJZiB0aGUgUG9vbCBpcyBhIGNsYXNzIG9yIG5vdCBpcyBhbiBpbXBsZW1lbnRhdGlvbiBkZXRhaWwgdGhhdCBzaG91bGQgbm90IGNvbmNlcm4gdGhlIHVzZXIuXG4gICAgcmV0dXJuIG5ldyBXb3JrZXJQb29sKHNwYXduV29ya2VyLCBvcHRpb25zT3JTaXplKTtcbn1cblBvb2xDb25zdHJ1Y3Rvci5FdmVudFR5cGUgPSBwb29sX3R5cGVzXzEuUG9vbEV2ZW50VHlwZTtcbi8qKlxuICogVGhyZWFkIHBvb2wgY29uc3RydWN0b3IuIENyZWF0ZXMgYSBuZXcgcG9vbCBhbmQgc3Bhd25zIGl0cyB3b3JrZXIgdGhyZWFkcy5cbiAqL1xuZXhwb3J0cy5Qb29sID0gUG9vbENvbnN0cnVjdG9yO1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL0BmbHVlbmNlbGFicy9tYXJpbmUud29ya2VyLXNjcmlwdC8uLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vdGhyZWFkc0AxLjcuMC9ub2RlX21vZHVsZXMvdGhyZWFkcy9kaXN0L21hc3Rlci9wb29sLmpzPyIpOwoKLyoqKi8gfSksCgovKioqLyAiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC9tYXN0ZXIvc3Bhd24uanMiOgovKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiAuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vdGhyZWFkc0AxLjcuMC9ub2RlX21vZHVsZXMvdGhyZWFkcy9kaXN0L21hc3Rlci9zcGF3bi5qcyAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKiovIChmdW5jdGlvbihfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKZXZhbCgiXG52YXIgX19nZW5lcmF0b3IgPSAodGhpcyAmJiB0aGlzLl9fZ2VuZXJhdG9yKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgYm9keSkge1xuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XG4gICAgcmV0dXJuIGcgPSB7IG5leHQ6IHZlcmIoMCksIFwidGhyb3dcIjogdmVyYigxKSwgXCJyZXR1cm5cIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IHJldHVybiBmdW5jdGlvbiAodikgeyByZXR1cm4gc3RlcChbbiwgdl0pOyB9OyB9XG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xuICAgICAgICBpZiAoZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XG4gICAgICAgIHdoaWxlIChfKSB0cnkge1xuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xuICAgICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFtvcFswXSAmIDIsIHQudmFsdWVdO1xuICAgICAgICAgICAgc3dpdGNoIChvcFswXSkge1xuICAgICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XG4gICAgICAgICAgICAgICAgY2FzZSA1OiBfLmxhYmVsKys7IHkgPSBvcFsxXTsgb3AgPSBbMF07IGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBpZiAoISh0ID0gXy50cnlzLCB0ID0gdC5sZW5ndGggPiAwICYmIHRbdC5sZW5ndGggLSAxXSkgJiYgKG9wWzBdID09PSA2IHx8IG9wWzBdID09PSAyKSkgeyBfID0gMDsgY29udGludWU7IH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0ICYmIF8ubGFiZWwgPCB0WzJdKSB7IF8ubGFiZWwgPSB0WzJdOyBfLm9wcy5wdXNoKG9wKTsgYnJlYWs7IH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xuICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cbiAgICAgICAgaWYgKG9wWzBdICYgNSkgdGhyb3cgb3BbMV07IHJldHVybiB7IHZhbHVlOiBvcFswXSA/IG9wWzFdIDogdm9pZCAwLCBkb25lOiB0cnVlIH07XG4gICAgfVxufTtcbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHtcbiAgICAgICAgICAgIHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHtcbiAgICAgICAgICAgIHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbnZhciBfX2ltcG9ydERlZmF1bHQgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0RGVmYXVsdCkgfHwgZnVuY3Rpb24gKG1vZCkge1xuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgXCJkZWZhdWx0XCI6IG1vZCB9O1xufTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHsgdmFsdWU6IHRydWUgfSkpO1xuZXhwb3J0cy5zcGF3biA9IHZvaWQgMDtcbnZhciBkZWJ1Z18xID0gX19pbXBvcnREZWZhdWx0KF9fd2VicGFja19yZXF1aXJlX18oLyohIGRlYnVnICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL2RlYnVnQDQuMy40L25vZGVfbW9kdWxlcy9kZWJ1Zy9zcmMvYnJvd3Nlci5qc1wiKSk7XG52YXIgb2JzZXJ2YWJsZV9mbnNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIG9ic2VydmFibGUtZm5zICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL29ic2VydmFibGUtZm5zQDAuNi4xL25vZGVfbW9kdWxlcy9vYnNlcnZhYmxlLWZucy9kaXN0LmVzbS9pbmRleC5qc1wiKTtcbnZhciBjb21tb25fMSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4uL2NvbW1vbiAqLyBcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS90aHJlYWRzQDEuNy4wL25vZGVfbW9kdWxlcy90aHJlYWRzL2Rpc3QvY29tbW9uLmpzXCIpO1xudmFyIHByb21pc2VfMSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4uL3Byb21pc2UgKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vdGhyZWFkc0AxLjcuMC9ub2RlX21vZHVsZXMvdGhyZWFkcy9kaXN0L3Byb21pc2UuanNcIik7XG52YXIgc3ltYm9sc18xID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi4vc3ltYm9scyAqLyBcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS90aHJlYWRzQDEuNy4wL25vZGVfbW9kdWxlcy90aHJlYWRzL2Rpc3Qvc3ltYm9scy5qc1wiKTtcbnZhciBtYXN0ZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4uL3R5cGVzL21hc3RlciAqLyBcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS90aHJlYWRzQDEuNy4wL25vZGVfbW9kdWxlcy90aHJlYWRzL2Rpc3QvdHlwZXMvbWFzdGVyLmpzXCIpO1xudmFyIGludm9jYXRpb25fcHJveHlfMSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vaW52b2NhdGlvbi1wcm94eSAqLyBcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS90aHJlYWRzQDEuNy4wL25vZGVfbW9kdWxlcy90aHJlYWRzL2Rpc3QvbWFzdGVyL2ludm9jYXRpb24tcHJveHkuanNcIik7XG52YXIgZGVidWdNZXNzYWdlcyA9IGRlYnVnXzEuZGVmYXVsdChcInRocmVhZHM6bWFzdGVyOm1lc3NhZ2VzXCIpO1xudmFyIGRlYnVnU3Bhd24gPSBkZWJ1Z18xLmRlZmF1bHQoXCJ0aHJlYWRzOm1hc3RlcjpzcGF3blwiKTtcbnZhciBkZWJ1Z1RocmVhZFV0aWxzID0gZGVidWdfMS5kZWZhdWx0KFwidGhyZWFkczptYXN0ZXI6dGhyZWFkLXV0aWxzXCIpO1xudmFyIGlzSW5pdE1lc3NhZ2UgPSBmdW5jdGlvbiAoZGF0YSkgeyByZXR1cm4gZGF0YSAmJiBkYXRhLnR5cGUgPT09IFwiaW5pdFwiOyB9O1xudmFyIGlzVW5jYXVnaHRFcnJvck1lc3NhZ2UgPSBmdW5jdGlvbiAoZGF0YSkgeyByZXR1cm4gZGF0YSAmJiBkYXRhLnR5cGUgPT09IFwidW5jYXVnaHRFcnJvclwiOyB9O1xudmFyIGluaXRNZXNzYWdlVGltZW91dCA9IHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiICYmIHByb2Nlc3MuZW52LlRIUkVBRFNfV09SS0VSX0lOSVRfVElNRU9VVFxuICAgID8gTnVtYmVyLnBhcnNlSW50KHByb2Nlc3MuZW52LlRIUkVBRFNfV09SS0VSX0lOSVRfVElNRU9VVCwgMTApXG4gICAgOiAxMDAwMDtcbmZ1bmN0aW9uIHdpdGhUaW1lb3V0KHByb21pc2UsIHRpbWVvdXRJbk1zLCBlcnJvck1lc3NhZ2UpIHtcbiAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0aW1lb3V0SGFuZGxlLCB0aW1lb3V0LCByZXN1bHQ7XG4gICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgIHRpbWVvdXQgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aW1lb3V0SGFuZGxlID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IHJldHVybiByZWplY3QoRXJyb3IoZXJyb3JNZXNzYWdlKSk7IH0sIHRpbWVvdXRJbk1zKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIFByb21pc2UucmFjZShbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvbWlzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lb3V0XG4gICAgICAgICAgICAgICAgICAgICAgICBdKV07XG4gICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SGFuZGxlKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHJlc3VsdF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gcmVjZWl2ZUluaXRNZXNzYWdlKHdvcmtlcikge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHZhciBtZXNzYWdlSGFuZGxlciA9IChmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgIGRlYnVnTWVzc2FnZXMoXCJNZXNzYWdlIGZyb20gd29ya2VyIGJlZm9yZSBmaW5pc2hpbmcgaW5pdGlhbGl6YXRpb246XCIsIGV2ZW50LmRhdGEpO1xuICAgICAgICAgICAgaWYgKGlzSW5pdE1lc3NhZ2UoZXZlbnQuZGF0YSkpIHtcbiAgICAgICAgICAgICAgICB3b3JrZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgbWVzc2FnZUhhbmRsZXIpO1xuICAgICAgICAgICAgICAgIHJlc29sdmUoZXZlbnQuZGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChpc1VuY2F1Z2h0RXJyb3JNZXNzYWdlKGV2ZW50LmRhdGEpKSB7XG4gICAgICAgICAgICAgICAgd29ya2VyLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIG1lc3NhZ2VIYW5kbGVyKTtcbiAgICAgICAgICAgICAgICByZWplY3QoY29tbW9uXzEuZGVzZXJpYWxpemUoZXZlbnQuZGF0YS5lcnJvcikpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgd29ya2VyLmFkZEV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIG1lc3NhZ2VIYW5kbGVyKTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZUV2ZW50T2JzZXJ2YWJsZSh3b3JrZXIsIHdvcmtlclRlcm1pbmF0aW9uKSB7XG4gICAgcmV0dXJuIG5ldyBvYnNlcnZhYmxlX2Zuc18xLk9ic2VydmFibGUoZnVuY3Rpb24gKG9ic2VydmVyKSB7XG4gICAgICAgIHZhciBtZXNzYWdlSGFuZGxlciA9IChmdW5jdGlvbiAobWVzc2FnZUV2ZW50KSB7XG4gICAgICAgICAgICB2YXIgd29ya2VyRXZlbnQgPSB7XG4gICAgICAgICAgICAgICAgdHlwZTogbWFzdGVyXzEuV29ya2VyRXZlbnRUeXBlLm1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgZGF0YTogbWVzc2FnZUV2ZW50LmRhdGFcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBvYnNlcnZlci5uZXh0KHdvcmtlckV2ZW50KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHZhciByZWplY3Rpb25IYW5kbGVyID0gKGZ1bmN0aW9uIChlcnJvckV2ZW50KSB7XG4gICAgICAgICAgICBkZWJ1Z1RocmVhZFV0aWxzKFwiVW5oYW5kbGVkIHByb21pc2UgcmVqZWN0aW9uIGV2ZW50IGluIHRocmVhZDpcIiwgZXJyb3JFdmVudCk7XG4gICAgICAgICAgICB2YXIgd29ya2VyRXZlbnQgPSB7XG4gICAgICAgICAgICAgICAgdHlwZTogbWFzdGVyXzEuV29ya2VyRXZlbnRUeXBlLmludGVybmFsRXJyb3IsXG4gICAgICAgICAgICAgICAgZXJyb3I6IEVycm9yKGVycm9yRXZlbnQucmVhc29uKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIG9ic2VydmVyLm5leHQod29ya2VyRXZlbnQpO1xuICAgICAgICB9KTtcbiAgICAgICAgd29ya2VyLmFkZEV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIG1lc3NhZ2VIYW5kbGVyKTtcbiAgICAgICAgd29ya2VyLmFkZEV2ZW50TGlzdGVuZXIoXCJ1bmhhbmRsZWRyZWplY3Rpb25cIiwgcmVqZWN0aW9uSGFuZGxlcik7XG4gICAgICAgIHdvcmtlclRlcm1pbmF0aW9uLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHRlcm1pbmF0aW9uRXZlbnQgPSB7XG4gICAgICAgICAgICAgICAgdHlwZTogbWFzdGVyXzEuV29ya2VyRXZlbnRUeXBlLnRlcm1pbmF0aW9uXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgd29ya2VyLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIG1lc3NhZ2VIYW5kbGVyKTtcbiAgICAgICAgICAgIHdvcmtlci5yZW1vdmVFdmVudExpc3RlbmVyKFwidW5oYW5kbGVkcmVqZWN0aW9uXCIsIHJlamVjdGlvbkhhbmRsZXIpO1xuICAgICAgICAgICAgb2JzZXJ2ZXIubmV4dCh0ZXJtaW5hdGlvbkV2ZW50KTtcbiAgICAgICAgICAgIG9ic2VydmVyLmNvbXBsZXRlKCk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gY3JlYXRlVGVybWluYXRvcih3b3JrZXIpIHtcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgIHZhciBfYSA9IHByb21pc2VfMS5jcmVhdGVQcm9taXNlV2l0aFJlc29sdmVyKCksIHRlcm1pbmF0aW9uID0gX2FbMF0sIHJlc29sdmVyID0gX2FbMV07XG4gICAgdmFyIHRlcm1pbmF0ZSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgZGVidWdUaHJlYWRVdGlscyhcIlRlcm1pbmF0aW5nIHdvcmtlclwiKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gTmV3ZXIgdmVyc2lvbnMgb2Ygd29ya2VyX3RocmVhZHMgd29ya2VycyByZXR1cm4gYSBwcm9taXNlXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHdvcmtlci50ZXJtaW5hdGUoKV07XG4gICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAvLyBOZXdlciB2ZXJzaW9ucyBvZiB3b3JrZXJfdGhyZWFkcyB3b3JrZXJzIHJldHVybiBhIHByb21pc2VcbiAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlcigpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pOyB9O1xuICAgIHJldHVybiB7IHRlcm1pbmF0ZTogdGVybWluYXRlLCB0ZXJtaW5hdGlvbjogdGVybWluYXRpb24gfTtcbn1cbmZ1bmN0aW9uIHNldFByaXZhdGVUaHJlYWRQcm9wcyhyYXcsIHdvcmtlciwgd29ya2VyRXZlbnRzLCB0ZXJtaW5hdGUpIHtcbiAgICB2YXIgX2E7XG4gICAgdmFyIHdvcmtlckVycm9ycyA9IHdvcmtlckV2ZW50c1xuICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChldmVudCkgeyByZXR1cm4gZXZlbnQudHlwZSA9PT0gbWFzdGVyXzEuV29ya2VyRXZlbnRUeXBlLmludGVybmFsRXJyb3I7IH0pXG4gICAgICAgIC5tYXAoZnVuY3Rpb24gKGVycm9yRXZlbnQpIHsgcmV0dXJuIGVycm9yRXZlbnQuZXJyb3I7IH0pO1xuICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZSBwcmVmZXItb2JqZWN0LXNwcmVhZFxuICAgIHJldHVybiBPYmplY3QuYXNzaWduKHJhdywgKF9hID0ge30sXG4gICAgICAgIF9hW3N5bWJvbHNfMS4kZXJyb3JzXSA9IHdvcmtlckVycm9ycyxcbiAgICAgICAgX2Fbc3ltYm9sc18xLiRldmVudHNdID0gd29ya2VyRXZlbnRzLFxuICAgICAgICBfYVtzeW1ib2xzXzEuJHRlcm1pbmF0ZV0gPSB0ZXJtaW5hdGUsXG4gICAgICAgIF9hW3N5bWJvbHNfMS4kd29ya2VyXSA9IHdvcmtlcixcbiAgICAgICAgX2EpKTtcbn1cbi8qKlxuICogU3Bhd24gYSBuZXcgdGhyZWFkLiBUYWtlcyBhIGZyZXNoIHdvcmtlciBpbnN0YW5jZSwgd3JhcHMgaXQgaW4gYSB0aGluXG4gKiBhYnN0cmFjdGlvbiBsYXllciB0byBwcm92aWRlIHRoZSB0cmFuc3BhcmVudCBBUEkgYW5kIHZlcmlmaWVzIHRoYXRcbiAqIHRoZSB3b3JrZXIgaGFzIGluaXRpYWxpemVkIHN1Y2Nlc3NmdWxseS5cbiAqXG4gKiBAcGFyYW0gd29ya2VyIEluc3RhbmNlIG9mIGBXb3JrZXJgLiBFaXRoZXIgYSB3ZWIgd29ya2VyLCBgd29ya2VyX3RocmVhZHNgIHdvcmtlciBvciBgdGlueS13b3JrZXJgIHdvcmtlci5cbiAqIEBwYXJhbSBbb3B0aW9uc11cbiAqIEBwYXJhbSBbb3B0aW9ucy50aW1lb3V0XSBJbml0IG1lc3NhZ2UgdGltZW91dC4gRGVmYXVsdDogMTAwMDAgb3Igc2V0IGJ5IGVudmlyb25tZW50IHZhcmlhYmxlLlxuICovXG5mdW5jdGlvbiBzcGF3bih3b3JrZXIsIG9wdGlvbnMpIHtcbiAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0aW1lb3V0LCBpbml0TWVzc2FnZSwgZXhwb3NlZCwgX2EsIHRlcm1pbmF0aW9uLCB0ZXJtaW5hdGUsIGV2ZW50cywgcHJveHksIHByb3h5LCB0eXBlO1xuICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKF9iLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICBkZWJ1Z1NwYXduKFwiSW5pdGlhbGl6aW5nIG5ldyB0aHJlYWRcIik7XG4gICAgICAgICAgICAgICAgICAgIHRpbWVvdXQgPSBvcHRpb25zICYmIG9wdGlvbnMudGltZW91dCA/IG9wdGlvbnMudGltZW91dCA6IGluaXRNZXNzYWdlVGltZW91dDtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgd2l0aFRpbWVvdXQocmVjZWl2ZUluaXRNZXNzYWdlKHdvcmtlciksIHRpbWVvdXQsIFwiVGltZW91dDogRGlkIG5vdCByZWNlaXZlIGFuIGluaXQgbWVzc2FnZSBmcm9tIHdvcmtlciBhZnRlciBcIi5jb25jYXQodGltZW91dCwgXCJtcy4gTWFrZSBzdXJlIHRoZSB3b3JrZXIgY2FsbHMgZXhwb3NlKCkuXCIpKV07XG4gICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICBpbml0TWVzc2FnZSA9IF9iLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgZXhwb3NlZCA9IGluaXRNZXNzYWdlLmV4cG9zZWQ7XG4gICAgICAgICAgICAgICAgICAgIF9hID0gY3JlYXRlVGVybWluYXRvcih3b3JrZXIpLCB0ZXJtaW5hdGlvbiA9IF9hLnRlcm1pbmF0aW9uLCB0ZXJtaW5hdGUgPSBfYS50ZXJtaW5hdGU7XG4gICAgICAgICAgICAgICAgICAgIGV2ZW50cyA9IGNyZWF0ZUV2ZW50T2JzZXJ2YWJsZSh3b3JrZXIsIHRlcm1pbmF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV4cG9zZWQudHlwZSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm94eSA9IGludm9jYXRpb25fcHJveHlfMS5jcmVhdGVQcm94eUZ1bmN0aW9uKHdvcmtlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgc2V0UHJpdmF0ZVRocmVhZFByb3BzKHByb3h5LCB3b3JrZXIsIGV2ZW50cywgdGVybWluYXRlKV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoZXhwb3NlZC50eXBlID09PSBcIm1vZHVsZVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm94eSA9IGludm9jYXRpb25fcHJveHlfMS5jcmVhdGVQcm94eU1vZHVsZSh3b3JrZXIsIGV4cG9zZWQubWV0aG9kcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgc2V0UHJpdmF0ZVRocmVhZFByb3BzKHByb3h5LCB3b3JrZXIsIGV2ZW50cywgdGVybWluYXRlKV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlID0gZXhwb3NlZC50eXBlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJXb3JrZXIgaW5pdCBtZXNzYWdlIHN0YXRlcyB1bmV4cGVjdGVkIHR5cGUgb2YgZXhwb3NlKCk6IFwiLmNvbmNhdCh0eXBlKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbmV4cG9ydHMuc3Bhd24gPSBzcGF3bjtcblxuXG4vLyMgc291cmNlVVJMPXdlYnBhY2s6Ly9AZmx1ZW5jZWxhYnMvbWFyaW5lLndvcmtlci1zY3JpcHQvLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC9tYXN0ZXIvc3Bhd24uanM/Iik7CgovKioqLyB9KSwKCi8qKiovICIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vdGhyZWFkc0AxLjcuMC9ub2RlX21vZHVsZXMvdGhyZWFkcy9kaXN0L21hc3Rlci90aHJlYWQuanMiOgovKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC9tYXN0ZXIvdGhyZWFkLmpzICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pID0+IHsKCmV2YWwoIlxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoeyB2YWx1ZTogdHJ1ZSB9KSk7XG5leHBvcnRzLlRocmVhZCA9IHZvaWQgMDtcbnZhciBzeW1ib2xzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuLi9zeW1ib2xzICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC9zeW1ib2xzLmpzXCIpO1xuZnVuY3Rpb24gZmFpbChtZXNzYWdlKSB7XG4gICAgdGhyb3cgRXJyb3IobWVzc2FnZSk7XG59XG4vKiogVGhyZWFkIHV0aWxpdHkgZnVuY3Rpb25zLiBVc2UgdGhlbSB0byBtYW5hZ2Ugb3IgaW5zcGVjdCBhIGBzcGF3bigpYC1lZCB0aHJlYWQuICovXG5leHBvcnRzLlRocmVhZCA9IHtcbiAgICAvKiogUmV0dXJuIGFuIG9ic2VydmFibGUgdGhhdCBjYW4gYmUgdXNlZCB0byBzdWJzY3JpYmUgdG8gYWxsIGVycm9ycyBoYXBwZW5pbmcgaW4gdGhlIHRocmVhZC4gKi9cbiAgICBlcnJvcnM6IGZ1bmN0aW9uICh0aHJlYWQpIHtcbiAgICAgICAgcmV0dXJuIHRocmVhZFtzeW1ib2xzXzEuJGVycm9yc10gfHwgZmFpbChcIkVycm9yIG9ic2VydmFibGUgbm90IGZvdW5kLiBNYWtlIHN1cmUgdG8gcGFzcyBhIHRocmVhZCBpbnN0YW5jZSBhcyByZXR1cm5lZCBieSB0aGUgc3Bhd24oKSBwcm9taXNlLlwiKTtcbiAgICB9LFxuICAgIC8qKiBSZXR1cm4gYW4gb2JzZXJ2YWJsZSB0aGF0IGNhbiBiZSB1c2VkIHRvIHN1YnNjcmliZSB0byBpbnRlcm5hbCBldmVudHMgaGFwcGVuaW5nIGluIHRoZSB0aHJlYWQuIFVzZWZ1bCBmb3IgZGVidWdnaW5nLiAqL1xuICAgIGV2ZW50czogZnVuY3Rpb24gKHRocmVhZCkge1xuICAgICAgICByZXR1cm4gdGhyZWFkW3N5bWJvbHNfMS4kZXZlbnRzXSB8fCBmYWlsKFwiRXZlbnRzIG9ic2VydmFibGUgbm90IGZvdW5kLiBNYWtlIHN1cmUgdG8gcGFzcyBhIHRocmVhZCBpbnN0YW5jZSBhcyByZXR1cm5lZCBieSB0aGUgc3Bhd24oKSBwcm9taXNlLlwiKTtcbiAgICB9LFxuICAgIC8qKiBUZXJtaW5hdGUgYSB0aHJlYWQuIFJlbWVtYmVyIHRvIHRlcm1pbmF0ZSBldmVyeSB0aHJlYWQgd2hlbiB5b3UgYXJlIGRvbmUgdXNpbmcgaXQuICovXG4gICAgdGVybWluYXRlOiBmdW5jdGlvbiAodGhyZWFkKSB7XG4gICAgICAgIHJldHVybiB0aHJlYWRbc3ltYm9sc18xLiR0ZXJtaW5hdGVdKCk7XG4gICAgfVxufTtcblxuXG4vLyMgc291cmNlVVJMPXdlYnBhY2s6Ly9AZmx1ZW5jZWxhYnMvbWFyaW5lLndvcmtlci1zY3JpcHQvLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC9tYXN0ZXIvdGhyZWFkLmpzPyIpOwoKLyoqKi8gfSksCgovKioqLyAiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC9vYnNlcnZhYmxlLXByb21pc2UuanMiOgovKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiAuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vdGhyZWFkc0AxLjcuMC9ub2RlX21vZHVsZXMvdGhyZWFkcy9kaXN0L29ic2VydmFibGUtcHJvbWlzZS5qcyAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKiovIChmdW5jdGlvbihfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKZXZhbCgiXG52YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoeyB2YWx1ZTogdHJ1ZSB9KSk7XG5leHBvcnRzLk9ic2VydmFibGVQcm9taXNlID0gdm9pZCAwO1xudmFyIG9ic2VydmFibGVfZm5zXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBvYnNlcnZhYmxlLWZucyAqLyBcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9vYnNlcnZhYmxlLWZuc0AwLjYuMS9ub2RlX21vZHVsZXMvb2JzZXJ2YWJsZS1mbnMvZGlzdC5lc20vaW5kZXguanNcIik7XG52YXIgZG9Ob3RoaW5nID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9O1xudmFyIHJldHVybklucHV0ID0gZnVuY3Rpb24gKGlucHV0KSB7IHJldHVybiBpbnB1dDsgfTtcbnZhciBydW5EZWZlcnJlZCA9IGZ1bmN0aW9uIChmbikgeyByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmbik7IH07XG5mdW5jdGlvbiBmYWlsKGVycm9yKSB7XG4gICAgdGhyb3cgZXJyb3I7XG59XG5mdW5jdGlvbiBpc1RoZW5hYmxlKHRoaW5nKSB7XG4gICAgcmV0dXJuIHRoaW5nICYmIHR5cGVvZiB0aGluZy50aGVuID09PSBcImZ1bmN0aW9uXCI7XG59XG4vKipcbiAqIENyZWF0ZXMgYSBoeWJyaWQsIGNvbWJpbmluZyB0aGUgQVBJcyBvZiBhbiBPYnNlcnZhYmxlIGFuZCBhIFByb21pc2UuXG4gKlxuICogSXQgaXMgdXNlZCB0byBwcm94eSBhc3luYyBwcm9jZXNzIHN0YXRlcyB3aGVuIHdlIGFyZSBpbml0aWFsbHkgbm90IHN1cmVcbiAqIGlmIHRoYXQgYXN5bmMgcHJvY2VzcyB3aWxsIHlpZWxkIHZhbHVlcyBvbmNlICgtPiBQcm9taXNlKSBvciBtdWx0aXBsZVxuICogdGltZXMgKC0+IE9ic2VydmFibGUpLlxuICpcbiAqIE5vdGUgdGhhdCB0aGUgb2JzZXJ2YWJsZSBwcm9taXNlIGluaGVyaXRzIHNvbWUgb2YgdGhlIG9ic2VydmFibGUncyBjaGFyYWN0ZXJpc3RpY3M6XG4gKiBUaGUgYGluaXRgIGZ1bmN0aW9uIHdpbGwgYmUgY2FsbGVkICpvbmNlIGZvciBldmVyeSB0aW1lIGFueW9uZSBzdWJzY3JpYmVzIHRvIGl0Ki5cbiAqXG4gKiBJZiB0aGlzIGlzIHVuZGVzaXJlZCwgZGVyaXZlIGEgaG90IG9ic2VydmFibGUgZnJvbSBpdCB1c2luZyBgbWFrZUhvdCgpYCBhbmRcbiAqIHN1YnNjcmliZSB0byB0aGF0LlxuICovXG52YXIgT2JzZXJ2YWJsZVByb21pc2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKE9ic2VydmFibGVQcm9taXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIE9ic2VydmFibGVQcm9taXNlKGluaXQpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZnVuY3Rpb24gKG9yaWdpbmFsT2JzZXJ2ZXIpIHtcbiAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZSBuby10aGlzLWFzc2lnbm1lbnRcbiAgICAgICAgICAgIHZhciBzZWxmID0gX3RoaXM7XG4gICAgICAgICAgICB2YXIgb2JzZXJ2ZXIgPSBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIG9yaWdpbmFsT2JzZXJ2ZXIpLCB7IGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIG9yaWdpbmFsT2JzZXJ2ZXIuY29tcGxldGUoKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5vbkNvbXBsZXRpb24oKTtcbiAgICAgICAgICAgICAgICB9LCBlcnJvcjogZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIG9yaWdpbmFsT2JzZXJ2ZXIuZXJyb3IoZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLm9uRXJyb3IoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH0sIG5leHQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbE9ic2VydmVyLm5leHQodmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLm9uTmV4dCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfSB9KTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuaW5pdEhhc1J1biA9IHRydWU7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGluaXQob2JzZXJ2ZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXIuZXJyb3IoZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5pbml0SGFzUnVuID0gZmFsc2U7XG4gICAgICAgIF90aGlzLmZ1bGZpbGxtZW50Q2FsbGJhY2tzID0gW107XG4gICAgICAgIF90aGlzLnJlamVjdGlvbkNhbGxiYWNrcyA9IFtdO1xuICAgICAgICBfdGhpcy5maXJzdFZhbHVlU2V0ID0gZmFsc2U7XG4gICAgICAgIF90aGlzLnN0YXRlID0gXCJwZW5kaW5nXCI7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgT2JzZXJ2YWJsZVByb21pc2UucHJvdG90eXBlLm9uTmV4dCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAoIXRoaXMuZmlyc3RWYWx1ZVNldCkge1xuICAgICAgICAgICAgdGhpcy5maXJzdFZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLmZpcnN0VmFsdWVTZXQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlUHJvbWlzZS5wcm90b3R5cGUub25FcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICB0aGlzLnN0YXRlID0gXCJyZWplY3RlZFwiO1xuICAgICAgICB0aGlzLnJlamVjdGlvbiA9IGVycm9yO1xuICAgICAgICB2YXIgX2xvb3BfMSA9IGZ1bmN0aW9uIChvblJlamVjdGVkKSB7XG4gICAgICAgICAgICAvLyBQcm9taXNpZnlpbmcgdGhlIGNhbGwgdG8gdHVybiBlcnJvcnMgaW50byB1bmhhbmRsZWQgcHJvbWlzZSByZWplY3Rpb25zXG4gICAgICAgICAgICAvLyBpbnN0ZWFkIG9mIHRoZW0gZmFpbGluZyBzeW5jIGFuZCBjYW5jZWxsaW5nIHRoZSBpdGVyYXRpb25cbiAgICAgICAgICAgIHJ1bkRlZmVycmVkKGZ1bmN0aW9uICgpIHsgcmV0dXJuIG9uUmVqZWN0ZWQoZXJyb3IpOyB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHRoaXMucmVqZWN0aW9uQ2FsbGJhY2tzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIG9uUmVqZWN0ZWQgPSBfYVtfaV07XG4gICAgICAgICAgICBfbG9vcF8xKG9uUmVqZWN0ZWQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlUHJvbWlzZS5wcm90b3R5cGUub25Db21wbGV0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnN0YXRlID0gXCJmdWxmaWxsZWRcIjtcbiAgICAgICAgdmFyIF9sb29wXzIgPSBmdW5jdGlvbiAob25GdWxmaWxsZWQpIHtcbiAgICAgICAgICAgIC8vIFByb21pc2lmeWluZyB0aGUgY2FsbCB0byB0dXJuIGVycm9ycyBpbnRvIHVuaGFuZGxlZCBwcm9taXNlIHJlamVjdGlvbnNcbiAgICAgICAgICAgIC8vIGluc3RlYWQgb2YgdGhlbSBmYWlsaW5nIHN5bmMgYW5kIGNhbmNlbGxpbmcgdGhlIGl0ZXJhdGlvblxuICAgICAgICAgICAgcnVuRGVmZXJyZWQoZnVuY3Rpb24gKCkgeyByZXR1cm4gb25GdWxmaWxsZWQoX3RoaXMuZmlyc3RWYWx1ZSk7IH0pO1xuICAgICAgICB9O1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5mdWxmaWxsbWVudENhbGxiYWNrczsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBvbkZ1bGZpbGxlZCA9IF9hW19pXTtcbiAgICAgICAgICAgIF9sb29wXzIob25GdWxmaWxsZWQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlUHJvbWlzZS5wcm90b3R5cGUudGhlbiA9IGZ1bmN0aW9uIChvbkZ1bGZpbGxlZFJhdywgb25SZWplY3RlZFJhdykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgb25GdWxmaWxsZWQgPSBvbkZ1bGZpbGxlZFJhdyB8fCByZXR1cm5JbnB1dDtcbiAgICAgICAgdmFyIG9uUmVqZWN0ZWQgPSBvblJlamVjdGVkUmF3IHx8IGZhaWw7XG4gICAgICAgIHZhciBvblJlamVjdGVkQ2FsbGVkID0gZmFsc2U7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICB2YXIgcmVqZWN0aW9uQ2FsbGJhY2sgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBpZiAob25SZWplY3RlZENhbGxlZClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIG9uUmVqZWN0ZWRDYWxsZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUob25SZWplY3RlZChlcnJvcikpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoYW5vdGhlckVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChhbm90aGVyRXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgZnVsZmlsbG1lbnRDYWxsYmFjayA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUob25GdWxmaWxsZWQodmFsdWUpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdGlvbkNhbGxiYWNrKGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaWYgKCFfdGhpcy5pbml0SGFzUnVuKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuc3Vic2NyaWJlKHsgZXJyb3I6IHJlamVjdGlvbkNhbGxiYWNrIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKF90aGlzLnN0YXRlID09PSBcImZ1bGZpbGxlZFwiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUob25GdWxmaWxsZWQoX3RoaXMuZmlyc3RWYWx1ZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKF90aGlzLnN0YXRlID09PSBcInJlamVjdGVkXCIpIHtcbiAgICAgICAgICAgICAgICBvblJlamVjdGVkQ2FsbGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZShvblJlamVjdGVkKF90aGlzLnJlamVjdGlvbikpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX3RoaXMuZnVsZmlsbG1lbnRDYWxsYmFja3MucHVzaChmdWxmaWxsbWVudENhbGxiYWNrKTtcbiAgICAgICAgICAgIF90aGlzLnJlamVjdGlvbkNhbGxiYWNrcy5wdXNoKHJlamVjdGlvbkNhbGxiYWNrKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlUHJvbWlzZS5wcm90b3R5cGUuY2F0Y2ggPSBmdW5jdGlvbiAob25SZWplY3RlZCkge1xuICAgICAgICByZXR1cm4gdGhpcy50aGVuKHVuZGVmaW5lZCwgb25SZWplY3RlZCk7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlUHJvbWlzZS5wcm90b3R5cGUuZmluYWxseSA9IGZ1bmN0aW9uIChvbkNvbXBsZXRlZCkge1xuICAgICAgICB2YXIgaGFuZGxlciA9IG9uQ29tcGxldGVkIHx8IGRvTm90aGluZztcbiAgICAgICAgcmV0dXJuIHRoaXMudGhlbihmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGhhbmRsZXIoKTtcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgfSwgZnVuY3Rpb24gKCkgeyByZXR1cm4gaGFuZGxlcigpOyB9KTtcbiAgICB9O1xuICAgIE9ic2VydmFibGVQcm9taXNlLmZyb20gPSBmdW5jdGlvbiAodGhpbmcpIHtcbiAgICAgICAgaWYgKGlzVGhlbmFibGUodGhpbmcpKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IE9ic2VydmFibGVQcm9taXNlKGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgICAgICAgICAgIHZhciBvbkZ1bGZpbGxlZCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlci5uZXh0KHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIuY29tcGxldGUoKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciBvblJlamVjdGVkID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLmVycm9yKGVycm9yKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHRoaW5nLnRoZW4ob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gX3N1cGVyLmZyb20uY2FsbCh0aGlzLCB0aGluZyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBPYnNlcnZhYmxlUHJvbWlzZTtcbn0ob2JzZXJ2YWJsZV9mbnNfMS5PYnNlcnZhYmxlKSk7XG5leHBvcnRzLk9ic2VydmFibGVQcm9taXNlID0gT2JzZXJ2YWJsZVByb21pc2U7XG5cblxuLy8jIHNvdXJjZVVSTD13ZWJwYWNrOi8vQGZsdWVuY2VsYWJzL21hcmluZS53b3JrZXItc2NyaXB0Ly4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS90aHJlYWRzQDEuNy4wL25vZGVfbW9kdWxlcy90aHJlYWRzL2Rpc3Qvb2JzZXJ2YWJsZS1wcm9taXNlLmpzPyIpOwoKLyoqKi8gfSksCgovKioqLyAiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC9vYnNlcnZhYmxlLmpzIjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAhKioqIC4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS90aHJlYWRzQDEuNy4wL25vZGVfbW9kdWxlcy90aHJlYWRzL2Rpc3Qvb2JzZXJ2YWJsZS5qcyAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoZnVuY3Rpb24oX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCmV2YWwoIlxudmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcbnZhciBfX3NwcmVhZEFycmF5ID0gKHRoaXMgJiYgdGhpcy5fX3NwcmVhZEFycmF5KSB8fCBmdW5jdGlvbiAodG8sIGZyb20sIHBhY2spIHtcbiAgICBpZiAocGFjayB8fCBhcmd1bWVudHMubGVuZ3RoID09PSAyKSBmb3IgKHZhciBpID0gMCwgbCA9IGZyb20ubGVuZ3RoLCBhcjsgaSA8IGw7IGkrKykge1xuICAgICAgICBpZiAoYXIgfHwgIShpIGluIGZyb20pKSB7XG4gICAgICAgICAgICBpZiAoIWFyKSBhciA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20sIDAsIGkpO1xuICAgICAgICAgICAgYXJbaV0gPSBmcm9tW2ldO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0by5jb25jYXQoYXIgfHwgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSkpO1xufTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHsgdmFsdWU6IHRydWUgfSkpO1xuZXhwb3J0cy5TdWJqZWN0ID0gZXhwb3J0cy5PYnNlcnZhYmxlID0gdm9pZCAwO1xudmFyIG9ic2VydmFibGVfZm5zXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBvYnNlcnZhYmxlLWZucyAqLyBcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9vYnNlcnZhYmxlLWZuc0AwLjYuMS9ub2RlX21vZHVsZXMvb2JzZXJ2YWJsZS1mbnMvZGlzdC5lc20vaW5kZXguanNcIik7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJPYnNlcnZhYmxlXCIsICh7IGVudW1lcmFibGU6IHRydWUsIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gb2JzZXJ2YWJsZV9mbnNfMS5PYnNlcnZhYmxlOyB9IH0pKTtcbnZhciAkb2JzZXJ2ZXJzID0gU3ltYm9sKFwib2JzZXJ2ZXJzXCIpO1xuLyoqXG4gKiBPYnNlcnZhYmxlIHN1YmplY3QuIEltcGxlbWVudHMgdGhlIE9ic2VydmFibGUgaW50ZXJmYWNlLCBidXQgYWxzbyBleHBvc2VzXG4gKiB0aGUgYG5leHQoKWAsIGBlcnJvcigpYCwgYGNvbXBsZXRlKClgIG1ldGhvZHMgdG8gaW5pdGlhdGUgb2JzZXJ2YWJsZVxuICogdXBkYXRlcyBcImZyb20gdGhlIG91dHNpZGVcIi5cbiAqXG4gKiBVc2UgYE9ic2VydmFibGUuZnJvbShzdWJqZWN0KWAgdG8gZGVyaXZlIGFuIG9ic2VydmFibGUgdGhhdCBwcm94aWVzIGFsbFxuICogdmFsdWVzLCBlcnJvcnMgYW5kIHRoZSBjb21wbGV0aW9uIHJhaXNlZCBvbiB0aGlzIHN1YmplY3QsIGJ1dCBkb2VzIG5vdFxuICogZXhwb3NlIHRoZSBgbmV4dCgpYCwgYGVycm9yKClgLCBgY29tcGxldGUoKWAgbWV0aG9kcy5cbiAqL1xudmFyIFN1YmplY3QgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFN1YmplY3QsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3ViamVjdCgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZnVuY3Rpb24gKG9ic2VydmVyKSB7XG4gICAgICAgICAgICBfdGhpc1skb2JzZXJ2ZXJzXSA9IF9fc3ByZWFkQXJyYXkoX19zcHJlYWRBcnJheShbXSwgKF90aGlzWyRvYnNlcnZlcnNdIHx8IFtdKSwgdHJ1ZSksIFtcbiAgICAgICAgICAgICAgICBvYnNlcnZlclxuICAgICAgICAgICAgXSwgZmFsc2UpO1xuICAgICAgICAgICAgdmFyIHVuc3Vic2NyaWJlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzWyRvYnNlcnZlcnNdID0gX3RoaXNbJG9ic2VydmVyc10uZmlsdGVyKGZ1bmN0aW9uIChzb21lT2JzZXJ2ZXIpIHsgcmV0dXJuIHNvbWVPYnNlcnZlciAhPT0gb2JzZXJ2ZXI7IH0pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiB1bnN1YnNjcmliZTtcbiAgICAgICAgfSkgfHwgdGhpcztcbiAgICAgICAgX3RoaXNbJG9ic2VydmVyc10gPSBbXTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBTdWJqZWN0LnByb3RvdHlwZS5jb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpc1skb2JzZXJ2ZXJzXS5mb3JFYWNoKGZ1bmN0aW9uIChvYnNlcnZlcikgeyByZXR1cm4gb2JzZXJ2ZXIuY29tcGxldGUoKTsgfSk7XG4gICAgfTtcbiAgICBTdWJqZWN0LnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICB0aGlzWyRvYnNlcnZlcnNdLmZvckVhY2goZnVuY3Rpb24gKG9ic2VydmVyKSB7IHJldHVybiBvYnNlcnZlci5lcnJvcihlcnJvcik7IH0pO1xuICAgIH07XG4gICAgU3ViamVjdC5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzWyRvYnNlcnZlcnNdLmZvckVhY2goZnVuY3Rpb24gKG9ic2VydmVyKSB7IHJldHVybiBvYnNlcnZlci5uZXh0KHZhbHVlKTsgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gU3ViamVjdDtcbn0ob2JzZXJ2YWJsZV9mbnNfMS5PYnNlcnZhYmxlKSk7XG5leHBvcnRzLlN1YmplY3QgPSBTdWJqZWN0O1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL0BmbHVlbmNlbGFicy9tYXJpbmUud29ya2VyLXNjcmlwdC8uLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vdGhyZWFkc0AxLjcuMC9ub2RlX21vZHVsZXMvdGhyZWFkcy9kaXN0L29ic2VydmFibGUuanM/Iik7CgovKioqLyB9KSwKCi8qKiovICIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vdGhyZWFkc0AxLjcuMC9ub2RlX21vZHVsZXMvdGhyZWFkcy9kaXN0L3BvbnlmaWxscy5qcyI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAhKioqIC4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS90aHJlYWRzQDEuNy4wL25vZGVfbW9kdWxlcy90aHJlYWRzL2Rpc3QvcG9ueWZpbGxzLmpzICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykgPT4gewoKZXZhbCgiXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7IHZhbHVlOiB0cnVlIH0pKTtcbmV4cG9ydHMuYWxsU2V0dGxlZCA9IHZvaWQgMDtcbi8vIEJhc2VkIG9uIDxodHRwczovL2dpdGh1Yi5jb20vZXMtc2hpbXMvUHJvbWlzZS5hbGxTZXR0bGVkL2Jsb2IvbWFzdGVyL2ltcGxlbWVudGF0aW9uLmpzPlxuZnVuY3Rpb24gYWxsU2V0dGxlZCh2YWx1ZXMpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwodmFsdWVzLm1hcChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICB2YXIgb25GdWxmaWxsID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm4geyBzdGF0dXM6ICdmdWxmaWxsZWQnLCB2YWx1ZTogdmFsdWUgfTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIG9uUmVqZWN0ID0gZnVuY3Rpb24gKHJlYXNvbikge1xuICAgICAgICAgICAgcmV0dXJuIHsgc3RhdHVzOiAncmVqZWN0ZWQnLCByZWFzb246IHJlYXNvbiB9O1xuICAgICAgICB9O1xuICAgICAgICB2YXIgaXRlbVByb21pc2UgPSBQcm9taXNlLnJlc29sdmUoaXRlbSk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gaXRlbVByb21pc2UudGhlbihvbkZ1bGZpbGwsIG9uUmVqZWN0KTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7XG4gICAgICAgIH1cbiAgICB9KSk7XG59XG5leHBvcnRzLmFsbFNldHRsZWQgPSBhbGxTZXR0bGVkO1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL0BmbHVlbmNlbGFicy9tYXJpbmUud29ya2VyLXNjcmlwdC8uLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vdGhyZWFkc0AxLjcuMC9ub2RlX21vZHVsZXMvdGhyZWFkcy9kaXN0L3BvbnlmaWxscy5qcz8iKTsKCi8qKiovIH0pLAoKLyoqKi8gIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS90aHJlYWRzQDEuNy4wL25vZGVfbW9kdWxlcy90aHJlYWRzL2Rpc3QvcHJvbWlzZS5qcyI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiAuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vdGhyZWFkc0AxLjcuMC9ub2RlX21vZHVsZXMvdGhyZWFkcy9kaXN0L3Byb21pc2UuanMgKioqIQogIFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykgPT4gewoKZXZhbCgiXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7IHZhbHVlOiB0cnVlIH0pKTtcbmV4cG9ydHMuY3JlYXRlUHJvbWlzZVdpdGhSZXNvbHZlciA9IHZvaWQgMDtcbnZhciBkb05vdGhpbmcgPSBmdW5jdGlvbiAoKSB7IHJldHVybiB1bmRlZmluZWQ7IH07XG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgcHJvbWlzZSBhbmQgZXhwb3NlcyBpdHMgcmVzb2x2ZXIgZnVuY3Rpb24uXG4gKiBVc2Ugd2l0aCBjYXJlIVxuICovXG5mdW5jdGlvbiBjcmVhdGVQcm9taXNlV2l0aFJlc29sdmVyKCkge1xuICAgIHZhciBhbHJlYWR5UmVzb2x2ZWQgPSBmYWxzZTtcbiAgICB2YXIgcmVzb2x2ZWRUbztcbiAgICB2YXIgcmVzb2x2ZXIgPSBkb05vdGhpbmc7XG4gICAgdmFyIHByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xuICAgICAgICBpZiAoYWxyZWFkeVJlc29sdmVkKSB7XG4gICAgICAgICAgICByZXNvbHZlKHJlc29sdmVkVG8pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmVzb2x2ZXIgPSByZXNvbHZlO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgdmFyIGV4cG9zZWRSZXNvbHZlciA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBhbHJlYWR5UmVzb2x2ZWQgPSB0cnVlO1xuICAgICAgICByZXNvbHZlZFRvID0gdmFsdWU7XG4gICAgICAgIHJlc29sdmVyKHJlc29sdmVkVG8pO1xuICAgIH07XG4gICAgcmV0dXJuIFtwcm9taXNlLCBleHBvc2VkUmVzb2x2ZXJdO1xufVxuZXhwb3J0cy5jcmVhdGVQcm9taXNlV2l0aFJlc29sdmVyID0gY3JlYXRlUHJvbWlzZVdpdGhSZXNvbHZlcjtcblxuXG4vLyMgc291cmNlVVJMPXdlYnBhY2s6Ly9AZmx1ZW5jZWxhYnMvbWFyaW5lLndvcmtlci1zY3JpcHQvLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC9wcm9taXNlLmpzPyIpOwoKLyoqKi8gfSksCgovKioqLyAiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC9zZXJpYWxpemVycy5qcyI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC9zZXJpYWxpemVycy5qcyAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykgPT4gewoKZXZhbCgiXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7IHZhbHVlOiB0cnVlIH0pKTtcbmV4cG9ydHMuRGVmYXVsdFNlcmlhbGl6ZXIgPSBleHBvcnRzLmV4dGVuZFNlcmlhbGl6ZXIgPSB2b2lkIDA7XG5mdW5jdGlvbiBleHRlbmRTZXJpYWxpemVyKGV4dGVuZCwgaW1wbGVtZW50YXRpb24pIHtcbiAgICB2YXIgZmFsbGJhY2tEZXNlcmlhbGl6ZXIgPSBleHRlbmQuZGVzZXJpYWxpemUuYmluZChleHRlbmQpO1xuICAgIHZhciBmYWxsYmFja1NlcmlhbGl6ZXIgPSBleHRlbmQuc2VyaWFsaXplLmJpbmQoZXh0ZW5kKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBkZXNlcmlhbGl6ZTogZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgIHJldHVybiBpbXBsZW1lbnRhdGlvbi5kZXNlcmlhbGl6ZShtZXNzYWdlLCBmYWxsYmFja0Rlc2VyaWFsaXplcik7XG4gICAgICAgIH0sXG4gICAgICAgIHNlcmlhbGl6ZTogZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgICAgICAgICByZXR1cm4gaW1wbGVtZW50YXRpb24uc2VyaWFsaXplKGlucHV0LCBmYWxsYmFja1NlcmlhbGl6ZXIpO1xuICAgICAgICB9XG4gICAgfTtcbn1cbmV4cG9ydHMuZXh0ZW5kU2VyaWFsaXplciA9IGV4dGVuZFNlcmlhbGl6ZXI7XG52YXIgRGVmYXVsdEVycm9yU2VyaWFsaXplciA9IHtcbiAgICBkZXNlcmlhbGl6ZTogZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oRXJyb3IobWVzc2FnZS5tZXNzYWdlKSwge1xuICAgICAgICAgICAgbmFtZTogbWVzc2FnZS5uYW1lLFxuICAgICAgICAgICAgc3RhY2s6IG1lc3NhZ2Uuc3RhY2tcbiAgICAgICAgfSk7XG4gICAgfSxcbiAgICBzZXJpYWxpemU6IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgX19lcnJvcl9tYXJrZXI6IFwiJCRlcnJvclwiLFxuICAgICAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgICAgIG5hbWU6IGVycm9yLm5hbWUsXG4gICAgICAgICAgICBzdGFjazogZXJyb3Iuc3RhY2tcbiAgICAgICAgfTtcbiAgICB9XG59O1xudmFyIGlzU2VyaWFsaXplZEVycm9yID0gZnVuY3Rpb24gKHRoaW5nKSB7IHJldHVybiB0aGluZyAmJiB0eXBlb2YgdGhpbmcgPT09IFwib2JqZWN0XCIgJiYgXCJfX2Vycm9yX21hcmtlclwiIGluIHRoaW5nICYmIHRoaW5nLl9fZXJyb3JfbWFya2VyID09PSBcIiQkZXJyb3JcIjsgfTtcbmV4cG9ydHMuRGVmYXVsdFNlcmlhbGl6ZXIgPSB7XG4gICAgZGVzZXJpYWxpemU6IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICAgIGlmIChpc1NlcmlhbGl6ZWRFcnJvcihtZXNzYWdlKSkge1xuICAgICAgICAgICAgcmV0dXJuIERlZmF1bHRFcnJvclNlcmlhbGl6ZXIuZGVzZXJpYWxpemUobWVzc2FnZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gbWVzc2FnZTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgc2VyaWFsaXplOiBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICAgICAgaWYgKGlucHV0IGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiBEZWZhdWx0RXJyb3JTZXJpYWxpemVyLnNlcmlhbGl6ZShpbnB1dCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gaW5wdXQ7XG4gICAgICAgIH1cbiAgICB9XG59O1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL0BmbHVlbmNlbGFicy9tYXJpbmUud29ya2VyLXNjcmlwdC8uLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vdGhyZWFkc0AxLjcuMC9ub2RlX21vZHVsZXMvdGhyZWFkcy9kaXN0L3NlcmlhbGl6ZXJzLmpzPyIpOwoKLyoqKi8gfSksCgovKioqLyAiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC9zeW1ib2xzLmpzIjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAhKioqIC4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS90aHJlYWRzQDEuNy4wL25vZGVfbW9kdWxlcy90aHJlYWRzL2Rpc3Qvc3ltYm9scy5qcyAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSA9PiB7CgpldmFsKCJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHsgdmFsdWU6IHRydWUgfSkpO1xuZXhwb3J0cy4kd29ya2VyID0gZXhwb3J0cy4kdHJhbnNmZXJhYmxlID0gZXhwb3J0cy4kdGVybWluYXRlID0gZXhwb3J0cy4kZXZlbnRzID0gZXhwb3J0cy4kZXJyb3JzID0gdm9pZCAwO1xuZXhwb3J0cy4kZXJyb3JzID0gU3ltYm9sKFwidGhyZWFkLmVycm9yc1wiKTtcbmV4cG9ydHMuJGV2ZW50cyA9IFN5bWJvbChcInRocmVhZC5ldmVudHNcIik7XG5leHBvcnRzLiR0ZXJtaW5hdGUgPSBTeW1ib2woXCJ0aHJlYWQudGVybWluYXRlXCIpO1xuZXhwb3J0cy4kdHJhbnNmZXJhYmxlID0gU3ltYm9sKFwidGhyZWFkLnRyYW5zZmVyYWJsZVwiKTtcbmV4cG9ydHMuJHdvcmtlciA9IFN5bWJvbChcInRocmVhZC53b3JrZXJcIik7XG5cblxuLy8jIHNvdXJjZVVSTD13ZWJwYWNrOi8vQGZsdWVuY2VsYWJzL21hcmluZS53b3JrZXItc2NyaXB0Ly4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS90aHJlYWRzQDEuNy4wL25vZGVfbW9kdWxlcy90aHJlYWRzL2Rpc3Qvc3ltYm9scy5qcz8iKTsKCi8qKiovIH0pLAoKLyoqKi8gIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS90aHJlYWRzQDEuNy4wL25vZGVfbW9kdWxlcy90aHJlYWRzL2Rpc3QvdHJhbnNmZXJhYmxlLmpzIjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC90cmFuc2ZlcmFibGUuanMgKioqIQogIFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSA9PiB7CgpldmFsKCJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHsgdmFsdWU6IHRydWUgfSkpO1xuZXhwb3J0cy5UcmFuc2ZlciA9IGV4cG9ydHMuaXNUcmFuc2ZlckRlc2NyaXB0b3IgPSB2b2lkIDA7XG52YXIgc3ltYm9sc18xID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9zeW1ib2xzICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC9zeW1ib2xzLmpzXCIpO1xuZnVuY3Rpb24gaXNUcmFuc2ZlcmFibGUodGhpbmcpIHtcbiAgICBpZiAoIXRoaW5nIHx8IHR5cGVvZiB0aGluZyAhPT0gXCJvYmplY3RcIilcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIC8vIERvbid0IGNoZWNrIHRvbyB0aG9yb3VnaGx5LCBzaW5jZSB0aGUgbGlzdCBvZiB0cmFuc2ZlcmFibGUgdGhpbmdzIGluIEpTIG1pZ2h0IGdyb3cgb3ZlciB0aW1lXG4gICAgcmV0dXJuIHRydWU7XG59XG5mdW5jdGlvbiBpc1RyYW5zZmVyRGVzY3JpcHRvcih0aGluZykge1xuICAgIHJldHVybiB0aGluZyAmJiB0eXBlb2YgdGhpbmcgPT09IFwib2JqZWN0XCIgJiYgdGhpbmdbc3ltYm9sc18xLiR0cmFuc2ZlcmFibGVdO1xufVxuZXhwb3J0cy5pc1RyYW5zZmVyRGVzY3JpcHRvciA9IGlzVHJhbnNmZXJEZXNjcmlwdG9yO1xuZnVuY3Rpb24gVHJhbnNmZXIocGF5bG9hZCwgdHJhbnNmZXJhYmxlcykge1xuICAgIHZhciBfYTtcbiAgICBpZiAoIXRyYW5zZmVyYWJsZXMpIHtcbiAgICAgICAgaWYgKCFpc1RyYW5zZmVyYWJsZShwYXlsb2FkKSlcbiAgICAgICAgICAgIHRocm93IEVycm9yKCk7XG4gICAgICAgIHRyYW5zZmVyYWJsZXMgPSBbcGF5bG9hZF07XG4gICAgfVxuICAgIHJldHVybiBfYSA9IHt9LFxuICAgICAgICBfYVtzeW1ib2xzXzEuJHRyYW5zZmVyYWJsZV0gPSB0cnVlLFxuICAgICAgICBfYS5zZW5kID0gcGF5bG9hZCxcbiAgICAgICAgX2EudHJhbnNmZXJhYmxlcyA9IHRyYW5zZmVyYWJsZXMsXG4gICAgICAgIF9hO1xufVxuZXhwb3J0cy5UcmFuc2ZlciA9IFRyYW5zZmVyO1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL0BmbHVlbmNlbGFicy9tYXJpbmUud29ya2VyLXNjcmlwdC8uLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vdGhyZWFkc0AxLjcuMC9ub2RlX21vZHVsZXMvdGhyZWFkcy9kaXN0L3RyYW5zZmVyYWJsZS5qcz8iKTsKCi8qKiovIH0pLAoKLyoqKi8gIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS90aHJlYWRzQDEuNy4wL25vZGVfbW9kdWxlcy90aHJlYWRzL2Rpc3QvdHlwZXMvbWFzdGVyLmpzIjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC90eXBlcy9tYXN0ZXIuanMgKioqIQogIFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSA9PiB7CgpldmFsKCJcbi8vLyA8cmVmZXJlbmNlIGxpYj1cImRvbVwiIC8+XG4vLyB0c2xpbnQ6ZGlzYWJsZSBtYXgtY2xhc3Nlcy1wZXItZmlsZVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoeyB2YWx1ZTogdHJ1ZSB9KSk7XG5leHBvcnRzLldvcmtlckV2ZW50VHlwZSA9IHZvaWQgMDtcbnZhciBzeW1ib2xzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuLi9zeW1ib2xzICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC9zeW1ib2xzLmpzXCIpO1xuLyoqIEV2ZW50IGFzIGVtaXR0ZWQgYnkgd29ya2VyIHRocmVhZC4gU3Vic2NyaWJlIHRvIHVzaW5nIGBUaHJlYWQuZXZlbnRzKHRocmVhZClgLiAqL1xudmFyIFdvcmtlckV2ZW50VHlwZTtcbihmdW5jdGlvbiAoV29ya2VyRXZlbnRUeXBlKSB7XG4gICAgV29ya2VyRXZlbnRUeXBlW1wiaW50ZXJuYWxFcnJvclwiXSA9IFwiaW50ZXJuYWxFcnJvclwiO1xuICAgIFdvcmtlckV2ZW50VHlwZVtcIm1lc3NhZ2VcIl0gPSBcIm1lc3NhZ2VcIjtcbiAgICBXb3JrZXJFdmVudFR5cGVbXCJ0ZXJtaW5hdGlvblwiXSA9IFwidGVybWluYXRpb25cIjtcbn0pKFdvcmtlckV2ZW50VHlwZSA9IGV4cG9ydHMuV29ya2VyRXZlbnRUeXBlIHx8IChleHBvcnRzLldvcmtlckV2ZW50VHlwZSA9IHt9KSk7XG5cblxuLy8jIHNvdXJjZVVSTD13ZWJwYWNrOi8vQGZsdWVuY2VsYWJzL21hcmluZS53b3JrZXItc2NyaXB0Ly4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS90aHJlYWRzQDEuNy4wL25vZGVfbW9kdWxlcy90aHJlYWRzL2Rpc3QvdHlwZXMvbWFzdGVyLmpzPyIpOwoKLyoqKi8gfSksCgovKioqLyAiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC90eXBlcy9tZXNzYWdlcy5qcyI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC90eXBlcy9tZXNzYWdlcy5qcyAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykgPT4gewoKZXZhbCgiXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7IHZhbHVlOiB0cnVlIH0pKTtcbmV4cG9ydHMuV29ya2VyTWVzc2FnZVR5cGUgPSBleHBvcnRzLk1hc3Rlck1lc3NhZ2VUeXBlID0gdm9pZCAwO1xuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIE1lc3NhZ2VzIHNlbnQgYnkgbWFzdGVyOlxudmFyIE1hc3Rlck1lc3NhZ2VUeXBlO1xuKGZ1bmN0aW9uIChNYXN0ZXJNZXNzYWdlVHlwZSkge1xuICAgIE1hc3Rlck1lc3NhZ2VUeXBlW1wiY2FuY2VsXCJdID0gXCJjYW5jZWxcIjtcbiAgICBNYXN0ZXJNZXNzYWdlVHlwZVtcInJ1blwiXSA9IFwicnVuXCI7XG59KShNYXN0ZXJNZXNzYWdlVHlwZSA9IGV4cG9ydHMuTWFzdGVyTWVzc2FnZVR5cGUgfHwgKGV4cG9ydHMuTWFzdGVyTWVzc2FnZVR5cGUgPSB7fSkpO1xuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gTWVzc2FnZXMgc2VudCBieSB3b3JrZXI6XG52YXIgV29ya2VyTWVzc2FnZVR5cGU7XG4oZnVuY3Rpb24gKFdvcmtlck1lc3NhZ2VUeXBlKSB7XG4gICAgV29ya2VyTWVzc2FnZVR5cGVbXCJlcnJvclwiXSA9IFwiZXJyb3JcIjtcbiAgICBXb3JrZXJNZXNzYWdlVHlwZVtcImluaXRcIl0gPSBcImluaXRcIjtcbiAgICBXb3JrZXJNZXNzYWdlVHlwZVtcInJlc3VsdFwiXSA9IFwicmVzdWx0XCI7XG4gICAgV29ya2VyTWVzc2FnZVR5cGVbXCJydW5uaW5nXCJdID0gXCJydW5uaW5nXCI7XG4gICAgV29ya2VyTWVzc2FnZVR5cGVbXCJ1bmNhdWdodEVycm9yXCJdID0gXCJ1bmNhdWdodEVycm9yXCI7XG59KShXb3JrZXJNZXNzYWdlVHlwZSA9IGV4cG9ydHMuV29ya2VyTWVzc2FnZVR5cGUgfHwgKGV4cG9ydHMuV29ya2VyTWVzc2FnZVR5cGUgPSB7fSkpO1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL0BmbHVlbmNlbGFicy9tYXJpbmUud29ya2VyLXNjcmlwdC8uLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vdGhyZWFkc0AxLjcuMC9ub2RlX21vZHVsZXMvdGhyZWFkcy9kaXN0L3R5cGVzL21lc3NhZ2VzLmpzPyIpOwoKLyoqKi8gfSksCgovKioqLyAiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC93b3JrZXIvaW1wbGVtZW50YXRpb24uYnJvd3Nlci5qcyI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC93b3JrZXIvaW1wbGVtZW50YXRpb24uYnJvd3Nlci5qcyAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykgPT4gewoKZXZhbCgiXG4vLy8gPHJlZmVyZW5jZSBsaWI9XCJkb21cIiAvPlxuLy8gdHNsaW50OmRpc2FibGUgbm8tc2hhZG93ZWQtdmFyaWFibGVcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHsgdmFsdWU6IHRydWUgfSkpO1xudmFyIGlzV29ya2VyUnVudGltZSA9IGZ1bmN0aW9uIGlzV29ya2VyUnVudGltZSgpIHtcbiAgICB2YXIgaXNXaW5kb3dDb250ZXh0ID0gdHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgJiYgdHlwZW9mIFdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiAmJiBzZWxmIGluc3RhbmNlb2YgV2luZG93O1xuICAgIHJldHVybiB0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIiAmJiBzZWxmLnBvc3RNZXNzYWdlICYmICFpc1dpbmRvd0NvbnRleHQgPyB0cnVlIDogZmFsc2U7XG59O1xudmFyIHBvc3RNZXNzYWdlVG9NYXN0ZXIgPSBmdW5jdGlvbiBwb3N0TWVzc2FnZVRvTWFzdGVyKGRhdGEsIHRyYW5zZmVyTGlzdCkge1xuICAgIHNlbGYucG9zdE1lc3NhZ2UoZGF0YSwgdHJhbnNmZXJMaXN0KTtcbn07XG52YXIgc3Vic2NyaWJlVG9NYXN0ZXJNZXNzYWdlcyA9IGZ1bmN0aW9uIHN1YnNjcmliZVRvTWFzdGVyTWVzc2FnZXMob25NZXNzYWdlKSB7XG4gICAgdmFyIG1lc3NhZ2VIYW5kbGVyID0gZnVuY3Rpb24gKG1lc3NhZ2VFdmVudCkge1xuICAgICAgICBvbk1lc3NhZ2UobWVzc2FnZUV2ZW50LmRhdGEpO1xuICAgIH07XG4gICAgdmFyIHVuc3Vic2NyaWJlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBzZWxmLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIG1lc3NhZ2VIYW5kbGVyKTtcbiAgICB9O1xuICAgIHNlbGYuYWRkRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgbWVzc2FnZUhhbmRsZXIpO1xuICAgIHJldHVybiB1bnN1YnNjcmliZTtcbn07XG5leHBvcnRzW1wiZGVmYXVsdFwiXSA9IHtcbiAgICBpc1dvcmtlclJ1bnRpbWU6IGlzV29ya2VyUnVudGltZSxcbiAgICBwb3N0TWVzc2FnZVRvTWFzdGVyOiBwb3N0TWVzc2FnZVRvTWFzdGVyLFxuICAgIHN1YnNjcmliZVRvTWFzdGVyTWVzc2FnZXM6IHN1YnNjcmliZVRvTWFzdGVyTWVzc2FnZXNcbn07XG5cblxuLy8jIHNvdXJjZVVSTD13ZWJwYWNrOi8vQGZsdWVuY2VsYWJzL21hcmluZS53b3JrZXItc2NyaXB0Ly4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS90aHJlYWRzQDEuNy4wL25vZGVfbW9kdWxlcy90aHJlYWRzL2Rpc3Qvd29ya2VyL2ltcGxlbWVudGF0aW9uLmJyb3dzZXIuanM/Iik7CgovKioqLyB9KSwKCi8qKiovICIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vdGhyZWFkc0AxLjcuMC9ub2RlX21vZHVsZXMvdGhyZWFkcy9kaXN0L3dvcmtlci9pbmRleC5qcyI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAhKioqIC4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS90aHJlYWRzQDEuNy4wL25vZGVfbW9kdWxlcy90aHJlYWRzL2Rpc3Qvd29ya2VyL2luZGV4LmpzICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKGZ1bmN0aW9uKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpldmFsKCJcbnZhciBfX2dlbmVyYXRvciA9ICh0aGlzICYmIHRoaXMuX19nZW5lcmF0b3IpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBib2R5KSB7XG4gICAgdmFyIF8gPSB7IGxhYmVsOiAwLCBzZW50OiBmdW5jdGlvbigpIHsgaWYgKHRbMF0gJiAxKSB0aHJvdyB0WzFdOyByZXR1cm4gdFsxXTsgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZztcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cbiAgICBmdW5jdGlvbiBzdGVwKG9wKSB7XG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcbiAgICAgICAgd2hpbGUgKF8pIHRyeSB7XG4gICAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5W1wicmV0dXJuXCJdIDogb3BbMF0gPyB5W1widGhyb3dcIl0gfHwgKCh0ID0geVtcInJldHVyblwiXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7XG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XG4gICAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7XG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcbiAgICB9XG59O1xudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkge1xuICAgICAgICAgICAgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgIH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkge1xuICAgICAgICAgICAgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgIH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xudmFyIF9faW1wb3J0RGVmYXVsdCA9ICh0aGlzICYmIHRoaXMuX19pbXBvcnREZWZhdWx0KSB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBcImRlZmF1bHRcIjogbW9kIH07XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoeyB2YWx1ZTogdHJ1ZSB9KSk7XG5leHBvcnRzLmV4cG9zZSA9IGV4cG9ydHMuaXNXb3JrZXJSdW50aW1lID0gZXhwb3J0cy5UcmFuc2ZlciA9IGV4cG9ydHMucmVnaXN0ZXJTZXJpYWxpemVyID0gdm9pZCAwO1xudmFyIGlzX29ic2VydmFibGVfMSA9IF9faW1wb3J0RGVmYXVsdChfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBpcy1vYnNlcnZhYmxlICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL2lzLW9ic2VydmFibGVAMi4xLjAvbm9kZV9tb2R1bGVzL2lzLW9ic2VydmFibGUvaW5kZXguanNcIikpO1xudmFyIGNvbW1vbl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi4vY29tbW9uICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC9jb21tb24uanNcIik7XG52YXIgdHJhbnNmZXJhYmxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuLi90cmFuc2ZlcmFibGUgKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vdGhyZWFkc0AxLjcuMC9ub2RlX21vZHVsZXMvdGhyZWFkcy9kaXN0L3RyYW5zZmVyYWJsZS5qc1wiKTtcbnZhciBtZXNzYWdlc18xID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi4vdHlwZXMvbWVzc2FnZXMgKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vdGhyZWFkc0AxLjcuMC9ub2RlX21vZHVsZXMvdGhyZWFkcy9kaXN0L3R5cGVzL21lc3NhZ2VzLmpzXCIpO1xudmFyIGltcGxlbWVudGF0aW9uXzEgPSBfX2ltcG9ydERlZmF1bHQoX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9pbXBsZW1lbnRhdGlvbiAqLyBcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS90aHJlYWRzQDEuNy4wL25vZGVfbW9kdWxlcy90aHJlYWRzL2Rpc3Qvd29ya2VyL2ltcGxlbWVudGF0aW9uLmJyb3dzZXIuanNcIikpO1xudmFyIGNvbW1vbl8yID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi4vY29tbW9uICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC9jb21tb24uanNcIik7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJyZWdpc3RlclNlcmlhbGl6ZXJcIiwgKHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBjb21tb25fMi5yZWdpc3RlclNlcmlhbGl6ZXI7IH0gfSkpO1xudmFyIHRyYW5zZmVyYWJsZV8yID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi4vdHJhbnNmZXJhYmxlICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC90cmFuc2ZlcmFibGUuanNcIik7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJUcmFuc2ZlclwiLCAoeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRyYW5zZmVyYWJsZV8yLlRyYW5zZmVyOyB9IH0pKTtcbi8qKiBSZXR1cm5zIGB0cnVlYCBpZiB0aGlzIGNvZGUgaXMgY3VycmVudGx5IHJ1bm5pbmcgaW4gYSB3b3JrZXIuICovXG5leHBvcnRzLmlzV29ya2VyUnVudGltZSA9IGltcGxlbWVudGF0aW9uXzEuZGVmYXVsdC5pc1dvcmtlclJ1bnRpbWU7XG52YXIgZXhwb3NlQ2FsbGVkID0gZmFsc2U7XG52YXIgYWN0aXZlU3Vic2NyaXB0aW9ucyA9IG5ldyBNYXAoKTtcbnZhciBpc01hc3RlckpvYkNhbmNlbE1lc3NhZ2UgPSBmdW5jdGlvbiAodGhpbmcpIHsgcmV0dXJuIHRoaW5nICYmIHRoaW5nLnR5cGUgPT09IG1lc3NhZ2VzXzEuTWFzdGVyTWVzc2FnZVR5cGUuY2FuY2VsOyB9O1xudmFyIGlzTWFzdGVySm9iUnVuTWVzc2FnZSA9IGZ1bmN0aW9uICh0aGluZykgeyByZXR1cm4gdGhpbmcgJiYgdGhpbmcudHlwZSA9PT0gbWVzc2FnZXNfMS5NYXN0ZXJNZXNzYWdlVHlwZS5ydW47IH07XG4vKipcbiAqIFRoZXJlIGFyZSBpc3N1ZXMgd2l0aCBgaXMtb2JzZXJ2YWJsZWAgbm90IHJlY29nbml6aW5nIHplbi1vYnNlcnZhYmxlJ3MgaW5zdGFuY2VzLlxuICogV2UgYXJlIHVzaW5nIGBvYnNlcnZhYmxlLWZuc2AsIGJ1dCBpdCdzIGJhc2VkIG9uIHplbi1vYnNlcnZhYmxlLCB0b28uXG4gKi9cbnZhciBpc09ic2VydmFibGUgPSBmdW5jdGlvbiAodGhpbmcpIHsgcmV0dXJuIGlzX29ic2VydmFibGVfMS5kZWZhdWx0KHRoaW5nKSB8fCBpc1plbk9ic2VydmFibGUodGhpbmcpOyB9O1xuZnVuY3Rpb24gaXNaZW5PYnNlcnZhYmxlKHRoaW5nKSB7XG4gICAgcmV0dXJuIHRoaW5nICYmIHR5cGVvZiB0aGluZyA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgdGhpbmcuc3Vic2NyaWJlID09PSBcImZ1bmN0aW9uXCI7XG59XG5mdW5jdGlvbiBkZWNvbnN0cnVjdFRyYW5zZmVyKHRoaW5nKSB7XG4gICAgcmV0dXJuIHRyYW5zZmVyYWJsZV8xLmlzVHJhbnNmZXJEZXNjcmlwdG9yKHRoaW5nKVxuICAgICAgICA/IHsgcGF5bG9hZDogdGhpbmcuc2VuZCwgdHJhbnNmZXJhYmxlczogdGhpbmcudHJhbnNmZXJhYmxlcyB9XG4gICAgICAgIDogeyBwYXlsb2FkOiB0aGluZywgdHJhbnNmZXJhYmxlczogdW5kZWZpbmVkIH07XG59XG5mdW5jdGlvbiBwb3N0RnVuY3Rpb25Jbml0TWVzc2FnZSgpIHtcbiAgICB2YXIgaW5pdE1lc3NhZ2UgPSB7XG4gICAgICAgIHR5cGU6IG1lc3NhZ2VzXzEuV29ya2VyTWVzc2FnZVR5cGUuaW5pdCxcbiAgICAgICAgZXhwb3NlZDoge1xuICAgICAgICAgICAgdHlwZTogXCJmdW5jdGlvblwiXG4gICAgICAgIH1cbiAgICB9O1xuICAgIGltcGxlbWVudGF0aW9uXzEuZGVmYXVsdC5wb3N0TWVzc2FnZVRvTWFzdGVyKGluaXRNZXNzYWdlKTtcbn1cbmZ1bmN0aW9uIHBvc3RNb2R1bGVJbml0TWVzc2FnZShtZXRob2ROYW1lcykge1xuICAgIHZhciBpbml0TWVzc2FnZSA9IHtcbiAgICAgICAgdHlwZTogbWVzc2FnZXNfMS5Xb3JrZXJNZXNzYWdlVHlwZS5pbml0LFxuICAgICAgICBleHBvc2VkOiB7XG4gICAgICAgICAgICB0eXBlOiBcIm1vZHVsZVwiLFxuICAgICAgICAgICAgbWV0aG9kczogbWV0aG9kTmFtZXNcbiAgICAgICAgfVxuICAgIH07XG4gICAgaW1wbGVtZW50YXRpb25fMS5kZWZhdWx0LnBvc3RNZXNzYWdlVG9NYXN0ZXIoaW5pdE1lc3NhZ2UpO1xufVxuZnVuY3Rpb24gcG9zdEpvYkVycm9yTWVzc2FnZSh1aWQsIHJhd0Vycm9yKSB7XG4gICAgdmFyIF9hID0gZGVjb25zdHJ1Y3RUcmFuc2ZlcihyYXdFcnJvciksIGVycm9yID0gX2EucGF5bG9hZCwgdHJhbnNmZXJhYmxlcyA9IF9hLnRyYW5zZmVyYWJsZXM7XG4gICAgdmFyIGVycm9yTWVzc2FnZSA9IHtcbiAgICAgICAgdHlwZTogbWVzc2FnZXNfMS5Xb3JrZXJNZXNzYWdlVHlwZS5lcnJvcixcbiAgICAgICAgdWlkOiB1aWQsXG4gICAgICAgIGVycm9yOiBjb21tb25fMS5zZXJpYWxpemUoZXJyb3IpXG4gICAgfTtcbiAgICBpbXBsZW1lbnRhdGlvbl8xLmRlZmF1bHQucG9zdE1lc3NhZ2VUb01hc3RlcihlcnJvck1lc3NhZ2UsIHRyYW5zZmVyYWJsZXMpO1xufVxuZnVuY3Rpb24gcG9zdEpvYlJlc3VsdE1lc3NhZ2UodWlkLCBjb21wbGV0ZWQsIHJlc3VsdFZhbHVlKSB7XG4gICAgdmFyIF9hID0gZGVjb25zdHJ1Y3RUcmFuc2ZlcihyZXN1bHRWYWx1ZSksIHBheWxvYWQgPSBfYS5wYXlsb2FkLCB0cmFuc2ZlcmFibGVzID0gX2EudHJhbnNmZXJhYmxlcztcbiAgICB2YXIgcmVzdWx0TWVzc2FnZSA9IHtcbiAgICAgICAgdHlwZTogbWVzc2FnZXNfMS5Xb3JrZXJNZXNzYWdlVHlwZS5yZXN1bHQsXG4gICAgICAgIHVpZDogdWlkLFxuICAgICAgICBjb21wbGV0ZTogY29tcGxldGVkID8gdHJ1ZSA6IHVuZGVmaW5lZCxcbiAgICAgICAgcGF5bG9hZDogcGF5bG9hZFxuICAgIH07XG4gICAgaW1wbGVtZW50YXRpb25fMS5kZWZhdWx0LnBvc3RNZXNzYWdlVG9NYXN0ZXIocmVzdWx0TWVzc2FnZSwgdHJhbnNmZXJhYmxlcyk7XG59XG5mdW5jdGlvbiBwb3N0Sm9iU3RhcnRNZXNzYWdlKHVpZCwgcmVzdWx0VHlwZSkge1xuICAgIHZhciBzdGFydE1lc3NhZ2UgPSB7XG4gICAgICAgIHR5cGU6IG1lc3NhZ2VzXzEuV29ya2VyTWVzc2FnZVR5cGUucnVubmluZyxcbiAgICAgICAgdWlkOiB1aWQsXG4gICAgICAgIHJlc3VsdFR5cGU6IHJlc3VsdFR5cGVcbiAgICB9O1xuICAgIGltcGxlbWVudGF0aW9uXzEuZGVmYXVsdC5wb3N0TWVzc2FnZVRvTWFzdGVyKHN0YXJ0TWVzc2FnZSk7XG59XG5mdW5jdGlvbiBwb3N0VW5jYXVnaHRFcnJvck1lc3NhZ2UoZXJyb3IpIHtcbiAgICB0cnkge1xuICAgICAgICB2YXIgZXJyb3JNZXNzYWdlID0ge1xuICAgICAgICAgICAgdHlwZTogbWVzc2FnZXNfMS5Xb3JrZXJNZXNzYWdlVHlwZS51bmNhdWdodEVycm9yLFxuICAgICAgICAgICAgZXJyb3I6IGNvbW1vbl8xLnNlcmlhbGl6ZShlcnJvcilcbiAgICAgICAgfTtcbiAgICAgICAgaW1wbGVtZW50YXRpb25fMS5kZWZhdWx0LnBvc3RNZXNzYWdlVG9NYXN0ZXIoZXJyb3JNZXNzYWdlKTtcbiAgICB9XG4gICAgY2F0Y2ggKHN1YkVycm9yKSB7XG4gICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJOb3QgcmVwb3J0aW5nIHVuY2F1Z2h0IGVycm9yIGJhY2sgdG8gbWFzdGVyIHRocmVhZCBhcyBpdCBcIiArXG4gICAgICAgICAgICBcIm9jY3VyZWQgd2hpbGUgcmVwb3J0aW5nIGFuIHVuY2F1Z2h0IGVycm9yIGFscmVhZHkuXCIgK1xuICAgICAgICAgICAgXCJcXG5MYXRlc3QgZXJyb3I6XCIsIHN1YkVycm9yLCBcIlxcbk9yaWdpbmFsIGVycm9yOlwiLCBlcnJvcik7XG4gICAgfVxufVxuZnVuY3Rpb24gcnVuRnVuY3Rpb24oam9iVUlELCBmbiwgYXJncykge1xuICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHN5bmNSZXN1bHQsIHJlc3VsdFR5cGUsIHN1YnNjcmlwdGlvbiwgcmVzdWx0LCBlcnJvcl8xO1xuICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3luY1Jlc3VsdCA9IGZuLmFwcGx5KHZvaWQgMCwgYXJncyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgcG9zdEpvYkVycm9yTWVzc2FnZShqb2JVSUQsIGVycm9yKV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0VHlwZSA9IGlzT2JzZXJ2YWJsZShzeW5jUmVzdWx0KSA/IFwib2JzZXJ2YWJsZVwiIDogXCJwcm9taXNlXCI7XG4gICAgICAgICAgICAgICAgICAgIHBvc3RKb2JTdGFydE1lc3NhZ2Uoam9iVUlELCByZXN1bHRUeXBlKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc09ic2VydmFibGUoc3luY1Jlc3VsdCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDFdO1xuICAgICAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb24gPSBzeW5jUmVzdWx0LnN1YnNjcmliZShmdW5jdGlvbiAodmFsdWUpIHsgcmV0dXJuIHBvc3RKb2JSZXN1bHRNZXNzYWdlKGpvYlVJRCwgZmFsc2UsIGNvbW1vbl8xLnNlcmlhbGl6ZSh2YWx1ZSkpOyB9LCBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc3RKb2JFcnJvck1lc3NhZ2Uoam9iVUlELCBjb21tb25fMS5zZXJpYWxpemUoZXJyb3IpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZVN1YnNjcmlwdGlvbnMuZGVsZXRlKGpvYlVJRCk7XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc3RKb2JSZXN1bHRNZXNzYWdlKGpvYlVJRCwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVTdWJzY3JpcHRpb25zLmRlbGV0ZShqb2JVSUQpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZlU3Vic2NyaXB0aW9ucy5zZXQoam9iVUlELCBzdWJzY3JpcHRpb24pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgIF9hLnRyeXMucHVzaChbMSwgMywgLCA0XSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHN5bmNSZXN1bHRdO1xuICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICBwb3N0Sm9iUmVzdWx0TWVzc2FnZShqb2JVSUQsIHRydWUsIGNvbW1vbl8xLnNlcmlhbGl6ZShyZXN1bHQpKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICBlcnJvcl8xID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICBwb3N0Sm9iRXJyb3JNZXNzYWdlKGpvYlVJRCwgY29tbW9uXzEuc2VyaWFsaXplKGVycm9yXzEpKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuLyoqXG4gKiBFeHBvc2UgYSBmdW5jdGlvbiBvciBhIG1vZHVsZSAoYW4gb2JqZWN0IHdob3NlIHZhbHVlcyBhcmUgZnVuY3Rpb25zKVxuICogdG8gdGhlIG1haW4gdGhyZWFkLiBNdXN0IGJlIGNhbGxlZCBleGFjdGx5IG9uY2UgaW4gZXZlcnkgd29ya2VyIHRocmVhZFxuICogdG8gc2lnbmFsIGl0cyBBUEkgdG8gdGhlIG1haW4gdGhyZWFkLlxuICpcbiAqIEBwYXJhbSBleHBvc2VkIEZ1bmN0aW9uIG9yIG9iamVjdCB3aG9zZSB2YWx1ZXMgYXJlIGZ1bmN0aW9uc1xuICovXG5mdW5jdGlvbiBleHBvc2UoZXhwb3NlZCkge1xuICAgIGlmICghaW1wbGVtZW50YXRpb25fMS5kZWZhdWx0LmlzV29ya2VyUnVudGltZSgpKSB7XG4gICAgICAgIHRocm93IEVycm9yKFwiZXhwb3NlKCkgY2FsbGVkIGluIHRoZSBtYXN0ZXIgdGhyZWFkLlwiKTtcbiAgICB9XG4gICAgaWYgKGV4cG9zZUNhbGxlZCkge1xuICAgICAgICB0aHJvdyBFcnJvcihcImV4cG9zZSgpIGNhbGxlZCBtb3JlIHRoYW4gb25jZS4gVGhpcyBpcyBub3QgcG9zc2libGUuIFBhc3MgYW4gb2JqZWN0IHRvIGV4cG9zZSgpIGlmIHlvdSB3YW50IHRvIGV4cG9zZSBtdWx0aXBsZSBmdW5jdGlvbnMuXCIpO1xuICAgIH1cbiAgICBleHBvc2VDYWxsZWQgPSB0cnVlO1xuICAgIGlmICh0eXBlb2YgZXhwb3NlZCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIGltcGxlbWVudGF0aW9uXzEuZGVmYXVsdC5zdWJzY3JpYmVUb01hc3Rlck1lc3NhZ2VzKGZ1bmN0aW9uIChtZXNzYWdlRGF0YSkge1xuICAgICAgICAgICAgaWYgKGlzTWFzdGVySm9iUnVuTWVzc2FnZShtZXNzYWdlRGF0YSkgJiYgIW1lc3NhZ2VEYXRhLm1ldGhvZCkge1xuICAgICAgICAgICAgICAgIHJ1bkZ1bmN0aW9uKG1lc3NhZ2VEYXRhLnVpZCwgZXhwb3NlZCwgbWVzc2FnZURhdGEuYXJncy5tYXAoY29tbW9uXzEuZGVzZXJpYWxpemUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHBvc3RGdW5jdGlvbkluaXRNZXNzYWdlKCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKHR5cGVvZiBleHBvc2VkID09PSBcIm9iamVjdFwiICYmIGV4cG9zZWQpIHtcbiAgICAgICAgaW1wbGVtZW50YXRpb25fMS5kZWZhdWx0LnN1YnNjcmliZVRvTWFzdGVyTWVzc2FnZXMoZnVuY3Rpb24gKG1lc3NhZ2VEYXRhKSB7XG4gICAgICAgICAgICBpZiAoaXNNYXN0ZXJKb2JSdW5NZXNzYWdlKG1lc3NhZ2VEYXRhKSAmJiBtZXNzYWdlRGF0YS5tZXRob2QpIHtcbiAgICAgICAgICAgICAgICBydW5GdW5jdGlvbihtZXNzYWdlRGF0YS51aWQsIGV4cG9zZWRbbWVzc2FnZURhdGEubWV0aG9kXSwgbWVzc2FnZURhdGEuYXJncy5tYXAoY29tbW9uXzEuZGVzZXJpYWxpemUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHZhciBtZXRob2ROYW1lcyA9IE9iamVjdC5rZXlzKGV4cG9zZWQpLmZpbHRlcihmdW5jdGlvbiAoa2V5KSB7IHJldHVybiB0eXBlb2YgZXhwb3NlZFtrZXldID09PSBcImZ1bmN0aW9uXCI7IH0pO1xuICAgICAgICBwb3N0TW9kdWxlSW5pdE1lc3NhZ2UobWV0aG9kTmFtZXMpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyZ3VtZW50IHBhc3NlZCB0byBleHBvc2UoKS4gRXhwZWN0ZWQgYSBmdW5jdGlvbiBvciBhbiBvYmplY3QsIGdvdDogXCIuY29uY2F0KGV4cG9zZWQpKTtcbiAgICB9XG4gICAgaW1wbGVtZW50YXRpb25fMS5kZWZhdWx0LnN1YnNjcmliZVRvTWFzdGVyTWVzc2FnZXMoZnVuY3Rpb24gKG1lc3NhZ2VEYXRhKSB7XG4gICAgICAgIGlmIChpc01hc3RlckpvYkNhbmNlbE1lc3NhZ2UobWVzc2FnZURhdGEpKSB7XG4gICAgICAgICAgICB2YXIgam9iVUlEID0gbWVzc2FnZURhdGEudWlkO1xuICAgICAgICAgICAgdmFyIHN1YnNjcmlwdGlvbiA9IGFjdGl2ZVN1YnNjcmlwdGlvbnMuZ2V0KGpvYlVJRCk7XG4gICAgICAgICAgICBpZiAoc3Vic2NyaXB0aW9uKSB7XG4gICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICAgICAgYWN0aXZlU3Vic2NyaXB0aW9ucy5kZWxldGUoam9iVUlEKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xufVxuZXhwb3J0cy5leHBvc2UgPSBleHBvc2U7XG5pZiAodHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgJiYgdHlwZW9mIHNlbGYuYWRkRXZlbnRMaXN0ZW5lciA9PT0gXCJmdW5jdGlvblwiICYmIGltcGxlbWVudGF0aW9uXzEuZGVmYXVsdC5pc1dvcmtlclJ1bnRpbWUoKSkge1xuICAgIHNlbGYuYWRkRXZlbnRMaXN0ZW5lcihcImVycm9yXCIsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAvLyBQb3N0IHdpdGggc29tZSBkZWxheSwgc28gdGhlIG1hc3RlciBoYWQgc29tZSB0aW1lIHRvIHN1YnNjcmliZSB0byBtZXNzYWdlc1xuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIHBvc3RVbmNhdWdodEVycm9yTWVzc2FnZShldmVudC5lcnJvciB8fCBldmVudCk7IH0sIDI1MCk7XG4gICAgfSk7XG4gICAgc2VsZi5hZGRFdmVudExpc3RlbmVyKFwidW5oYW5kbGVkcmVqZWN0aW9uXCIsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICB2YXIgZXJyb3IgPSBldmVudC5yZWFzb247XG4gICAgICAgIGlmIChlcnJvciAmJiB0eXBlb2YgZXJyb3IubWVzc2FnZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgLy8gUG9zdCB3aXRoIHNvbWUgZGVsYXksIHNvIHRoZSBtYXN0ZXIgaGFkIHNvbWUgdGltZSB0byBzdWJzY3JpYmUgdG8gbWVzc2FnZXNcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyByZXR1cm4gcG9zdFVuY2F1Z2h0RXJyb3JNZXNzYWdlKGVycm9yKTsgfSwgMjUwKTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuaWYgKHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiICYmIHR5cGVvZiBwcm9jZXNzLm9uID09PSBcImZ1bmN0aW9uXCIgJiYgaW1wbGVtZW50YXRpb25fMS5kZWZhdWx0LmlzV29ya2VyUnVudGltZSgpKSB7XG4gICAgcHJvY2Vzcy5vbihcInVuY2F1Z2h0RXhjZXB0aW9uXCIsIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAvLyBQb3N0IHdpdGggc29tZSBkZWxheSwgc28gdGhlIG1hc3RlciBoYWQgc29tZSB0aW1lIHRvIHN1YnNjcmliZSB0byBtZXNzYWdlc1xuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIHBvc3RVbmNhdWdodEVycm9yTWVzc2FnZShlcnJvcik7IH0sIDI1MCk7XG4gICAgfSk7XG4gICAgcHJvY2Vzcy5vbihcInVuaGFuZGxlZFJlamVjdGlvblwiLCBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgaWYgKGVycm9yICYmIHR5cGVvZiBlcnJvci5tZXNzYWdlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAvLyBQb3N0IHdpdGggc29tZSBkZWxheSwgc28gdGhlIG1hc3RlciBoYWQgc29tZSB0aW1lIHRvIHN1YnNjcmliZSB0byBtZXNzYWdlc1xuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IHJldHVybiBwb3N0VW5jYXVnaHRFcnJvck1lc3NhZ2UoZXJyb3IpOyB9LCAyNTApO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5cblxuLy8jIHNvdXJjZVVSTD13ZWJwYWNrOi8vQGZsdWVuY2VsYWJzL21hcmluZS53b3JrZXItc2NyaXB0Ly4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS90aHJlYWRzQDEuNy4wL25vZGVfbW9kdWxlcy90aHJlYWRzL2Rpc3Qvd29ya2VyL2luZGV4LmpzPyIpOwoKLyoqKi8gfSksCgovKioqLyAiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvb2JzZXJ2YWJsZS5qcyI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvb2JzZXJ2YWJsZS5qcyAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgPT4gewoKZXZhbCgiXG5tb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vZGlzdC9vYnNlcnZhYmxlICovIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3RocmVhZHNAMS43LjAvbm9kZV9tb2R1bGVzL3RocmVhZHMvZGlzdC9vYnNlcnZhYmxlLmpzXCIpO1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL0BmbHVlbmNlbGFicy9tYXJpbmUud29ya2VyLXNjcmlwdC8uLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vdGhyZWFkc0AxLjcuMC9ub2RlX21vZHVsZXMvdGhyZWFkcy9vYnNlcnZhYmxlLmpzPyIpOwoKLyoqKi8gfSksCgovKioqLyAiLi9zcmMvaW5kZXgudHMiOgovKiEqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiAuL3NyYy9pbmRleC50cyAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKiovCi8qKiovIChmdW5jdGlvbihfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKZXZhbCgiXG4vKlxuICogQ29weXJpZ2h0IDIwMjIgRmx1ZW5jZSBMYWJzIExpbWl0ZWRcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xudmFyIF9fZ2VuZXJhdG9yID0gKHRoaXMgJiYgdGhpcy5fX2dlbmVyYXRvcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIGJvZHkpIHtcbiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnO1xuICAgIHJldHVybiBnID0geyBuZXh0OiB2ZXJiKDApLCBcInRocm93XCI6IHZlcmIoMSksIFwicmV0dXJuXCI6IHZlcmIoMikgfSwgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnO1xuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxuICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHtcbiAgICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcbiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IG9wWzBdICYgMiA/IHlbXCJyZXR1cm5cIl0gOiBvcFswXSA/IHlbXCJ0aHJvd1wiXSB8fCAoKHQgPSB5W1wicmV0dXJuXCJdKSAmJiB0LmNhbGwoeSksIDApIDogeS5uZXh0KSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDtcbiAgICAgICAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTtcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9O1xuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xuICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9XG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xuICAgIH1cbn07XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7IHZhbHVlOiB0cnVlIH0pKTtcbnZhciBtYXJpbmVfanNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBmbHVlbmNlbGFicy9tYXJpbmUtanMgKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQGZsdWVuY2VsYWJzK21hcmluZS1qc0AwLjMuMzgvbm9kZV9tb2R1bGVzL0BmbHVlbmNlbGFicy9tYXJpbmUtanMvZGlzdC9pbmRleC5qc1wiKTtcbnZhciBvYnNlcnZhYmxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISB0aHJlYWRzL29ic2VydmFibGUgKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vdGhyZWFkc0AxLjcuMC9ub2RlX21vZHVsZXMvdGhyZWFkcy9vYnNlcnZhYmxlLmpzXCIpO1xudmFyIHRocmVhZHNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIHRocmVhZHMgKi8gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vdGhyZWFkc0AxLjcuMC9ub2RlX21vZHVsZXMvdGhyZWFkcy9kaXN0L2luZGV4LmpzXCIpO1xudmFyIG1hcmluZVNlcnZpY2VzID0gbmV3IE1hcCgpO1xudmFyIGNvbnRyb2xNb2R1bGU7XG52YXIgb25Mb2dNZXNzYWdlID0gbmV3IG9ic2VydmFibGVfMS5TdWJqZWN0KCk7XG52YXIgYXNBcnJheSA9IGZ1bmN0aW9uIChidWYpIHtcbiAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkoYnVmKTtcbn07XG52YXIgdG9FeHBvc2UgPSB7XG4gICAgaW5pdDogZnVuY3Rpb24gKGNvbnRyb2xNb2R1bGVXYXNtKSB7IHJldHVybiBfX2F3YWl0ZXIodm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gWzQgLyp5aWVsZCovLCBXZWJBc3NlbWJseS5jb21waWxlKGFzQXJyYXkoY29udHJvbE1vZHVsZVdhc20pKV07XG4gICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICBjb250cm9sTW9kdWxlID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pOyB9LFxuICAgIGNyZWF0ZVNlcnZpY2U6IGZ1bmN0aW9uICh3YXNtLCBzZXJ2aWNlSWQsIG1hcmluZUNvbmZpZywgZW52cykgeyByZXR1cm4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHNlcnZpY2UsIHNydjtcbiAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjb250cm9sTW9kdWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01hcmluZUpTIGlzIG5vdCBpbml0aWFsaXplZC4gVG8gaW5pdGlhbGl6ZSBjYWxsIGBpbml0YCBmdW5jdGlvbicpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIFdlYkFzc2VtYmx5LmNvbXBpbGUoYXNBcnJheSh3YXNtKSldO1xuICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgc2VydmljZSA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgc3J2ID0gbmV3IG1hcmluZV9qc18xLk1hcmluZVNlcnZpY2UoY29udHJvbE1vZHVsZSwgc2VydmljZSwgc2VydmljZUlkLCBvbkxvZ01lc3NhZ2UubmV4dC5iaW5kKG9uTG9nTWVzc2FnZSksIG1hcmluZUNvbmZpZywgZW52cyk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHNydi5pbml0KCldO1xuICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICBtYXJpbmVTZXJ2aWNlcy5zZXQoc2VydmljZUlkLCBzcnYpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pOyB9LFxuICAgIHRlcm1pbmF0ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICBtYXJpbmVTZXJ2aWNlcy5mb3JFYWNoKGZ1bmN0aW9uICh2YWwsIGtleSkge1xuICAgICAgICAgICAgdmFsLnRlcm1pbmF0ZSgpO1xuICAgICAgICB9KTtcbiAgICAgICAgb25Mb2dNZXNzYWdlLmNvbXBsZXRlKCk7XG4gICAgfSxcbiAgICBjYWxsU2VydmljZTogZnVuY3Rpb24gKHNlcnZpY2VJZCwgZnVuY3Rpb25OYW1lLCBhcmdzLCBjYWxsUGFyYW1zKSB7XG4gICAgICAgIHZhciBzcnYgPSBtYXJpbmVTZXJ2aWNlcy5nZXQoc2VydmljZUlkKTtcbiAgICAgICAgaWYgKCFzcnYpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInNlcnZpY2Ugd2l0aCBpZD1cIi5jb25jYXQoc2VydmljZUlkLCBcIiBub3QgZm91bmRcIikpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzcnYuY2FsbChmdW5jdGlvbk5hbWUsIGFyZ3MsIGNhbGxQYXJhbXMpO1xuICAgIH0sXG4gICAgb25Mb2dNZXNzYWdlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBvYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZS5mcm9tKG9uTG9nTWVzc2FnZSk7XG4gICAgfSxcbn07XG4oMCwgdGhyZWFkc18xLmV4cG9zZSkodG9FeHBvc2UpO1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL0BmbHVlbmNlbGFicy9tYXJpbmUud29ya2VyLXNjcmlwdC8uL3NyYy9pbmRleC50cz8iKTsKCi8qKiovIH0pCgovKioqKioqLyAJfSk7Ci8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKioqKiovIAkvLyBUaGUgbW9kdWxlIGNhY2hlCi8qKioqKiovIAl2YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307Ci8qKioqKiovIAkKLyoqKioqKi8gCS8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uCi8qKioqKiovIAlmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7Ci8qKioqKiovIAkJLy8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlCi8qKioqKiovIAkJdmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07Ci8qKioqKiovIAkJaWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7Ci8qKioqKiovIAkJCXJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0czsKLyoqKioqKi8gCQl9Ci8qKioqKiovIAkJLy8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSkKLyoqKioqKi8gCQl2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHsKLyoqKioqKi8gCQkJLy8gbm8gbW9kdWxlLmlkIG5lZWRlZAovKioqKioqLyAJCQkvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZAovKioqKioqLyAJCQlleHBvcnRzOiB7fQovKioqKioqLyAJCX07Ci8qKioqKiovIAkKLyoqKioqKi8gCQkvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb24KLyoqKioqKi8gCQlfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTsKLyoqKioqKi8gCQovKioqKioqLyAJCS8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlCi8qKioqKiovIAkJcmV0dXJuIG1vZHVsZS5leHBvcnRzOwovKioqKioqLyAJfQovKioqKioqLyAJCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKioqKiovIAkvKiB3ZWJwYWNrL3J1bnRpbWUvZ2xvYmFsICovCi8qKioqKiovIAkoKCkgPT4gewovKioqKioqLyAJCV9fd2VicGFja19yZXF1aXJlX18uZyA9IChmdW5jdGlvbigpIHsKLyoqKioqKi8gCQkJaWYgKHR5cGVvZiBnbG9iYWxUaGlzID09PSAnb2JqZWN0JykgcmV0dXJuIGdsb2JhbFRoaXM7Ci8qKioqKiovIAkJCXRyeSB7Ci8qKioqKiovIAkJCQlyZXR1cm4gdGhpcyB8fCBuZXcgRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTsKLyoqKioqKi8gCQkJfSBjYXRjaCAoZSkgewovKioqKioqLyAJCQkJaWYgKHR5cGVvZiB3aW5kb3cgPT09ICdvYmplY3QnKSByZXR1cm4gd2luZG93OwovKioqKioqLyAJCQl9Ci8qKioqKiovIAkJfSkoKTsKLyoqKioqKi8gCX0pKCk7Ci8qKioqKiovIAkKLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKioqKi8gCQovKioqKioqLyAJLy8gc3RhcnR1cAovKioqKioqLyAJLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzCi8qKioqKiovIAkvLyBUaGlzIGVudHJ5IG1vZHVsZSBpcyByZWZlcmVuY2VkIGJ5IG90aGVyIG1vZHVsZXMgc28gaXQgY2FuJ3QgYmUgaW5saW5lZAovKioqKioqLyAJdmFyIF9fd2VicGFja19leHBvcnRzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCIuL3NyYy9pbmRleC50cyIpOwovKioqKioqLyAJCi8qKioqKiovIH0pKCkKOw=="},948:function(I){I.exports=function(I,g){(null==g||g>I.length)&&(g=I.length);for(var C=0,A=new Array(g);C<g;C++)A[C]=I[C];return A},I.exports.__esModule=!0,I.exports.default=I.exports},8860:function(I){I.exports=function(I){if(Array.isArray(I))return I},I.exports.__esModule=!0,I.exports.default=I.exports},141:function(I,g,C){var A=C(948);I.exports=function(I){if(Array.isArray(I))return A(I)},I.exports.__esModule=!0,I.exports.default=I.exports},36:function(I){I.exports=function(I){if(void 0===I)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return I},I.exports.__esModule=!0,I.exports.default=I.exports},4837:function(I){I.exports=function(I,g){if(!(I instanceof g))throw new TypeError("Cannot call a class as a function")},I.exports.__esModule=!0,I.exports.default=I.exports},1238:function(I,g,C){var A=C(5887),i=C(3496);function c(g,C,G){return i()?(I.exports=c=Reflect.construct.bind(),I.exports.__esModule=!0,I.exports.default=I.exports):(I.exports=c=function(I,g,C){var i=[null];i.push.apply(i,g);var c=new(Function.bind.apply(I,i));return C&&A(c,C.prototype),c},I.exports.__esModule=!0,I.exports.default=I.exports),c.apply(null,arguments)}I.exports=c,I.exports.__esModule=!0,I.exports.default=I.exports},7868:function(I,g,C){var A=C(7803);function i(I,g){for(var C=0;C<g.length;C++){var i=g[C];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(I,A(i.key),i)}}I.exports=function(I,g,C){return g&&i(I.prototype,g),C&&i(I,C),Object.defineProperty(I,"prototype",{writable:!1}),I},I.exports.__esModule=!0,I.exports.default=I.exports},1187:function(I,g,C){var A=C(6306);I.exports=function(I,g){var C="undefined"!==typeof Symbol&&I[Symbol.iterator]||I["@@iterator"];if(!C){if(Array.isArray(I)||(C=A(I))||g&&I&&"number"===typeof I.length){C&&(I=C);var i=0,c=function(){};return{s:c,n:function(){return i>=I.length?{done:!0}:{done:!1,value:I[i++]}},e:function(I){throw I},f:c}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var G,l=!0,b=!1;return{s:function(){C=C.call(I)},n:function(){var I=C.next();return l=I.done,I},e:function(I){b=!0,G=I},f:function(){try{l||null==C.return||C.return()}finally{if(b)throw G}}}},I.exports.__esModule=!0,I.exports.default=I.exports},6982:function(I,g,C){var A=C(9663),i=C(3496),c=C(8998);I.exports=function(I){var g=i();return function(){var C,i=A(I);if(g){var G=A(this).constructor;C=Reflect.construct(i,arguments,G)}else C=i.apply(this,arguments);return c(this,C)}},I.exports.__esModule=!0,I.exports.default=I.exports},8726:function(I,g,C){var A=C(7803);I.exports=function(I,g,C){return(g=A(g))in I?Object.defineProperty(I,g,{value:C,enumerable:!0,configurable:!0,writable:!0}):I[g]=C,I},I.exports.__esModule=!0,I.exports.default=I.exports},8136:function(I,g,C){var A=C(1502);function i(){return"undefined"!==typeof Reflect&&Reflect.get?(I.exports=i=Reflect.get.bind(),I.exports.__esModule=!0,I.exports.default=I.exports):(I.exports=i=function(I,g,C){var i=A(I,g);if(i){var c=Object.getOwnPropertyDescriptor(i,g);return c.get?c.get.call(arguments.length<3?I:C):c.value}},I.exports.__esModule=!0,I.exports.default=I.exports),i.apply(this,arguments)}I.exports=i,I.exports.__esModule=!0,I.exports.default=I.exports},9663:function(I){function g(C){return I.exports=g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(I){return I.__proto__||Object.getPrototypeOf(I)},I.exports.__esModule=!0,I.exports.default=I.exports,g(C)}I.exports=g,I.exports.__esModule=!0,I.exports.default=I.exports},9823:function(I,g,C){var A=C(5887);I.exports=function(I,g){if("function"!==typeof g&&null!==g)throw new TypeError("Super expression must either be null or a function");I.prototype=Object.create(g&&g.prototype,{constructor:{value:I,writable:!0,configurable:!0}}),Object.defineProperty(I,"prototype",{writable:!1}),g&&A(I,g)},I.exports.__esModule=!0,I.exports.default=I.exports},9310:function(I){I.exports=function(I){return-1!==Function.toString.call(I).indexOf("[native code]")},I.exports.__esModule=!0,I.exports.default=I.exports},3496:function(I){I.exports=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(I){return!1}},I.exports.__esModule=!0,I.exports.default=I.exports},4187:function(I){I.exports=function(I){if("undefined"!==typeof Symbol&&null!=I[Symbol.iterator]||null!=I["@@iterator"])return Array.from(I)},I.exports.__esModule=!0,I.exports.default=I.exports},9118:function(I){I.exports=function(I,g){var C=null==I?null:"undefined"!=typeof Symbol&&I[Symbol.iterator]||I["@@iterator"];if(null!=C){var A,i,c,G,l=[],b=!0,Z=!1;try{if(c=(C=C.call(I)).next,0===g){if(Object(C)!==C)return;b=!1}else for(;!(b=(A=c.call(C)).done)&&(l.push(A.value),l.length!==g);b=!0);}catch(t){Z=!0,i=t}finally{try{if(!b&&null!=C.return&&(G=C.return(),Object(G)!==G))return}finally{if(Z)throw i}}return l}},I.exports.__esModule=!0,I.exports.default=I.exports},8677:function(I){I.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},I.exports.__esModule=!0,I.exports.default=I.exports},6006:function(I){I.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},I.exports.__esModule=!0,I.exports.default=I.exports},8998:function(I,g,C){var A=C(3758).default,i=C(36);I.exports=function(I,g){if(g&&("object"===A(g)||"function"===typeof g))return g;if(void 0!==g)throw new TypeError("Derived constructors may only return object or undefined");return i(I)},I.exports.__esModule=!0,I.exports.default=I.exports},6670:function(I,g,C){var A=C(3758).default;function i(){"use strict";I.exports=i=function(){return g},I.exports.__esModule=!0,I.exports.default=I.exports;var g={},C=Object.prototype,c=C.hasOwnProperty,G=Object.defineProperty||function(I,g,C){I[g]=C.value},l="function"==typeof Symbol?Symbol:{},b=l.iterator||"@@iterator",Z=l.asyncIterator||"@@asyncIterator",t=l.toStringTag||"@@toStringTag";function o(I,g,C){return Object.defineProperty(I,g,{value:C,enumerable:!0,configurable:!0,writable:!0}),I[g]}try{o({},"")}catch(H){o=function(I,g,C){return I[g]=C}}function n(I,g,C,A){var i=g&&g.prototype instanceof m?g:m,c=Object.create(i.prototype),l=new p(A||[]);return G(c,"_invoke",{value:r(I,C,l)}),c}function u(I,g,C){try{return{type:"normal",arg:I.call(g,C)}}catch(H){return{type:"throw",arg:H}}}g.wrap=n;var d={};function m(){}function e(){}function B(){}var X={};o(X,b,(function(){return this}));var y=Object.getPrototypeOf,V=y&&y(y(K([])));V&&V!==C&&c.call(V,b)&&(X=V);var h=B.prototype=m.prototype=Object.create(X);function a(I){["next","throw","return"].forEach((function(g){o(I,g,(function(I){return this._invoke(g,I)}))}))}function s(I,g){function C(i,G,l,b){var Z=u(I[i],I,G);if("throw"!==Z.type){var t=Z.arg,o=t.value;return o&&"object"==A(o)&&c.call(o,"__await")?g.resolve(o.__await).then((function(I){C("next",I,l,b)}),(function(I){C("throw",I,l,b)})):g.resolve(o).then((function(I){t.value=I,l(t)}),(function(I){return C("throw",I,l,b)}))}b(Z.arg)}var i;G(this,"_invoke",{value:function(I,A){function c(){return new g((function(g,i){C(I,A,g,i)}))}return i=i?i.then(c,c):c()}})}function r(I,g,C){var A="suspendedStart";return function(i,c){if("executing"===A)throw new Error("Generator is already running");if("completed"===A){if("throw"===i)throw c;return R()}for(C.method=i,C.arg=c;;){var G=C.delegate;if(G){var l=Y(G,C);if(l){if(l===d)continue;return l}}if("next"===C.method)C.sent=C._sent=C.arg;else if("throw"===C.method){if("suspendedStart"===A)throw A="completed",C.arg;C.dispatchException(C.arg)}else"return"===C.method&&C.abrupt("return",C.arg);A="executing";var b=u(I,g,C);if("normal"===b.type){if(A=C.done?"completed":"suspendedYield",b.arg===d)continue;return{value:b.arg,done:C.done}}"throw"===b.type&&(A="completed",C.method="throw",C.arg=b.arg)}}}function Y(I,g){var C=g.method,A=I.iterator[C];if(void 0===A)return g.delegate=null,"throw"===C&&I.iterator.return&&(g.method="return",g.arg=void 0,Y(I,g),"throw"===g.method)||"return"!==C&&(g.method="throw",g.arg=new TypeError("The iterator does not provide a '"+C+"' method")),d;var i=u(A,I.iterator,g.arg);if("throw"===i.type)return g.method="throw",g.arg=i.arg,g.delegate=null,d;var c=i.arg;return c?c.done?(g[I.resultName]=c.value,g.next=I.nextLoc,"return"!==g.method&&(g.method="next",g.arg=void 0),g.delegate=null,d):c:(g.method="throw",g.arg=new TypeError("iterator result is not an object"),g.delegate=null,d)}function W(I){var g={tryLoc:I[0]};1 in I&&(g.catchLoc=I[1]),2 in I&&(g.finallyLoc=I[2],g.afterLoc=I[3]),this.tryEntries.push(g)}function S(I){var g=I.completion||{};g.type="normal",delete g.arg,I.completion=g}function p(I){this.tryEntries=[{tryLoc:"root"}],I.forEach(W,this),this.reset(!0)}function K(I){if(I){var g=I[b];if(g)return g.call(I);if("function"==typeof I.next)return I;if(!isNaN(I.length)){var C=-1,A=function g(){for(;++C<I.length;)if(c.call(I,C))return g.value=I[C],g.done=!1,g;return g.value=void 0,g.done=!0,g};return A.next=A}}return{next:R}}function R(){return{value:void 0,done:!0}}return e.prototype=B,G(h,"constructor",{value:B,configurable:!0}),G(B,"constructor",{value:e,configurable:!0}),e.displayName=o(B,t,"GeneratorFunction"),g.isGeneratorFunction=function(I){var g="function"==typeof I&&I.constructor;return!!g&&(g===e||"GeneratorFunction"===(g.displayName||g.name))},g.mark=function(I){return Object.setPrototypeOf?Object.setPrototypeOf(I,B):(I.__proto__=B,o(I,t,"GeneratorFunction")),I.prototype=Object.create(h),I},g.awrap=function(I){return{__await:I}},a(s.prototype),o(s.prototype,Z,(function(){return this})),g.AsyncIterator=s,g.async=function(I,C,A,i,c){void 0===c&&(c=Promise);var G=new s(n(I,C,A,i),c);return g.isGeneratorFunction(C)?G:G.next().then((function(I){return I.done?I.value:G.next()}))},a(h),o(h,t,"Generator"),o(h,b,(function(){return this})),o(h,"toString",(function(){return"[object Generator]"})),g.keys=function(I){var g=Object(I),C=[];for(var A in g)C.push(A);return C.reverse(),function I(){for(;C.length;){var A=C.pop();if(A in g)return I.value=A,I.done=!1,I}return I.done=!0,I}},g.values=K,p.prototype={constructor:p,reset:function(I){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!I)for(var g in this)"t"===g.charAt(0)&&c.call(this,g)&&!isNaN(+g.slice(1))&&(this[g]=void 0)},stop:function(){this.done=!0;var I=this.tryEntries[0].completion;if("throw"===I.type)throw I.arg;return this.rval},dispatchException:function(I){if(this.done)throw I;var g=this;function C(C,A){return G.type="throw",G.arg=I,g.next=C,A&&(g.method="next",g.arg=void 0),!!A}for(var A=this.tryEntries.length-1;A>=0;--A){var i=this.tryEntries[A],G=i.completion;if("root"===i.tryLoc)return C("end");if(i.tryLoc<=this.prev){var l=c.call(i,"catchLoc"),b=c.call(i,"finallyLoc");if(l&&b){if(this.prev<i.catchLoc)return C(i.catchLoc,!0);if(this.prev<i.finallyLoc)return C(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return C(i.catchLoc,!0)}else{if(!b)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return C(i.finallyLoc)}}}},abrupt:function(I,g){for(var C=this.tryEntries.length-1;C>=0;--C){var A=this.tryEntries[C];if(A.tryLoc<=this.prev&&c.call(A,"finallyLoc")&&this.prev<A.finallyLoc){var i=A;break}}i&&("break"===I||"continue"===I)&&i.tryLoc<=g&&g<=i.finallyLoc&&(i=null);var G=i?i.completion:{};return G.type=I,G.arg=g,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(G)},complete:function(I,g){if("throw"===I.type)throw I.arg;return"break"===I.type||"continue"===I.type?this.next=I.arg:"return"===I.type?(this.rval=this.arg=I.arg,this.method="return",this.next="end"):"normal"===I.type&&g&&(this.next=g),d},finish:function(I){for(var g=this.tryEntries.length-1;g>=0;--g){var C=this.tryEntries[g];if(C.finallyLoc===I)return this.complete(C.completion,C.afterLoc),S(C),d}},catch:function(I){for(var g=this.tryEntries.length-1;g>=0;--g){var C=this.tryEntries[g];if(C.tryLoc===I){var A=C.completion;if("throw"===A.type){var i=A.arg;S(C)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(I,g,C){return this.delegate={iterator:K(I),resultName:g,nextLoc:C},"next"===this.method&&(this.arg=void 0),d}},g}I.exports=i,I.exports.__esModule=!0,I.exports.default=I.exports},5887:function(I){function g(C,A){return I.exports=g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(I,g){return I.__proto__=g,I},I.exports.__esModule=!0,I.exports.default=I.exports,g(C,A)}I.exports=g,I.exports.__esModule=!0,I.exports.default=I.exports},6843:function(I,g,C){var A=C(8860),i=C(9118),c=C(6306),G=C(8677);I.exports=function(I,g){return A(I)||i(I,g)||c(I,g)||G()},I.exports.__esModule=!0,I.exports.default=I.exports},1502:function(I,g,C){var A=C(9663);I.exports=function(I,g){for(;!Object.prototype.hasOwnProperty.call(I,g)&&null!==(I=A(I)););return I},I.exports.__esModule=!0,I.exports.default=I.exports},7329:function(I,g,C){var A=C(141),i=C(4187),c=C(6306),G=C(6006);I.exports=function(I){return A(I)||i(I)||c(I)||G()},I.exports.__esModule=!0,I.exports.default=I.exports},974:function(I,g,C){var A=C(3758).default;I.exports=function(I,g){if("object"!==A(I)||null===I)return I;var C=I[Symbol.toPrimitive];if(void 0!==C){var i=C.call(I,g||"default");if("object"!==A(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===g?String:Number)(I)},I.exports.__esModule=!0,I.exports.default=I.exports},7803:function(I,g,C){var A=C(3758).default,i=C(974);I.exports=function(I){var g=i(I,"string");return"symbol"===A(g)?g:String(g)},I.exports.__esModule=!0,I.exports.default=I.exports},3758:function(I){function g(C){return I.exports=g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(I){return typeof I}:function(I){return I&&"function"==typeof Symbol&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I},I.exports.__esModule=!0,I.exports.default=I.exports,g(C)}I.exports=g,I.exports.__esModule=!0,I.exports.default=I.exports},6306:function(I,g,C){var A=C(948);I.exports=function(I,g){if(I){if("string"===typeof I)return A(I,g);var C=Object.prototype.toString.call(I).slice(8,-1);return"Object"===C&&I.constructor&&(C=I.constructor.name),"Map"===C||"Set"===C?Array.from(I):"Arguments"===C||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(C)?A(I,g):void 0}},I.exports.__esModule=!0,I.exports.default=I.exports},2975:function(I,g,C){var A=C(9663),i=C(5887),c=C(9310),G=C(1238);function l(g){var C="function"===typeof Map?new Map:void 0;return I.exports=l=function(I){if(null===I||!c(I))return I;if("function"!==typeof I)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof C){if(C.has(I))return C.get(I);C.set(I,g)}function g(){return G(I,arguments,A(this).constructor)}return g.prototype=Object.create(I.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),i(g,I)},I.exports.__esModule=!0,I.exports.default=I.exports,l(g)}I.exports=l,I.exports.__esModule=!0,I.exports.default=I.exports},6257:function(I,g,C){"use strict";C.d(g,{Z:function(){return i}});var A=C(2641);function i(){i=function(){return I};var I={},g=Object.prototype,C=g.hasOwnProperty,c=Object.defineProperty||function(I,g,C){I[g]=C.value},G="function"==typeof Symbol?Symbol:{},l=G.iterator||"@@iterator",b=G.asyncIterator||"@@asyncIterator",Z=G.toStringTag||"@@toStringTag";function t(I,g,C){return Object.defineProperty(I,g,{value:C,enumerable:!0,configurable:!0,writable:!0}),I[g]}try{t({},"")}catch(R){t=function(I,g,C){return I[g]=C}}function o(I,g,C,A){var i=g&&g.prototype instanceof d?g:d,G=Object.create(i.prototype),l=new S(A||[]);return c(G,"_invoke",{value:s(I,C,l)}),G}function n(I,g,C){try{return{type:"normal",arg:I.call(g,C)}}catch(R){return{type:"throw",arg:R}}}I.wrap=o;var u={};function d(){}function m(){}function e(){}var B={};t(B,l,(function(){return this}));var X=Object.getPrototypeOf,y=X&&X(X(p([])));y&&y!==g&&C.call(y,l)&&(B=y);var V=e.prototype=d.prototype=Object.create(B);function h(I){["next","throw","return"].forEach((function(g){t(I,g,(function(I){return this._invoke(g,I)}))}))}function a(I,g){function i(c,G,l,b){var Z=n(I[c],I,G);if("throw"!==Z.type){var t=Z.arg,o=t.value;return o&&"object"==(0,A.Z)(o)&&C.call(o,"__await")?g.resolve(o.__await).then((function(I){i("next",I,l,b)}),(function(I){i("throw",I,l,b)})):g.resolve(o).then((function(I){t.value=I,l(t)}),(function(I){return i("throw",I,l,b)}))}b(Z.arg)}var G;c(this,"_invoke",{value:function(I,C){function A(){return new g((function(g,A){i(I,C,g,A)}))}return G=G?G.then(A,A):A()}})}function s(I,g,C){var A="suspendedStart";return function(i,c){if("executing"===A)throw new Error("Generator is already running");if("completed"===A){if("throw"===i)throw c;return K()}for(C.method=i,C.arg=c;;){var G=C.delegate;if(G){var l=r(G,C);if(l){if(l===u)continue;return l}}if("next"===C.method)C.sent=C._sent=C.arg;else if("throw"===C.method){if("suspendedStart"===A)throw A="completed",C.arg;C.dispatchException(C.arg)}else"return"===C.method&&C.abrupt("return",C.arg);A="executing";var b=n(I,g,C);if("normal"===b.type){if(A=C.done?"completed":"suspendedYield",b.arg===u)continue;return{value:b.arg,done:C.done}}"throw"===b.type&&(A="completed",C.method="throw",C.arg=b.arg)}}}function r(I,g){var C=g.method,A=I.iterator[C];if(void 0===A)return g.delegate=null,"throw"===C&&I.iterator.return&&(g.method="return",g.arg=void 0,r(I,g),"throw"===g.method)||"return"!==C&&(g.method="throw",g.arg=new TypeError("The iterator does not provide a '"+C+"' method")),u;var i=n(A,I.iterator,g.arg);if("throw"===i.type)return g.method="throw",g.arg=i.arg,g.delegate=null,u;var c=i.arg;return c?c.done?(g[I.resultName]=c.value,g.next=I.nextLoc,"return"!==g.method&&(g.method="next",g.arg=void 0),g.delegate=null,u):c:(g.method="throw",g.arg=new TypeError("iterator result is not an object"),g.delegate=null,u)}function Y(I){var g={tryLoc:I[0]};1 in I&&(g.catchLoc=I[1]),2 in I&&(g.finallyLoc=I[2],g.afterLoc=I[3]),this.tryEntries.push(g)}function W(I){var g=I.completion||{};g.type="normal",delete g.arg,I.completion=g}function S(I){this.tryEntries=[{tryLoc:"root"}],I.forEach(Y,this),this.reset(!0)}function p(I){if(I){var g=I[l];if(g)return g.call(I);if("function"==typeof I.next)return I;if(!isNaN(I.length)){var A=-1,i=function g(){for(;++A<I.length;)if(C.call(I,A))return g.value=I[A],g.done=!1,g;return g.value=void 0,g.done=!0,g};return i.next=i}}return{next:K}}function K(){return{value:void 0,done:!0}}return m.prototype=e,c(V,"constructor",{value:e,configurable:!0}),c(e,"constructor",{value:m,configurable:!0}),m.displayName=t(e,Z,"GeneratorFunction"),I.isGeneratorFunction=function(I){var g="function"==typeof I&&I.constructor;return!!g&&(g===m||"GeneratorFunction"===(g.displayName||g.name))},I.mark=function(I){return Object.setPrototypeOf?Object.setPrototypeOf(I,e):(I.__proto__=e,t(I,Z,"GeneratorFunction")),I.prototype=Object.create(V),I},I.awrap=function(I){return{__await:I}},h(a.prototype),t(a.prototype,b,(function(){return this})),I.AsyncIterator=a,I.async=function(g,C,A,i,c){void 0===c&&(c=Promise);var G=new a(o(g,C,A,i),c);return I.isGeneratorFunction(C)?G:G.next().then((function(I){return I.done?I.value:G.next()}))},h(V),t(V,Z,"Generator"),t(V,l,(function(){return this})),t(V,"toString",(function(){return"[object Generator]"})),I.keys=function(I){var g=Object(I),C=[];for(var A in g)C.push(A);return C.reverse(),function I(){for(;C.length;){var A=C.pop();if(A in g)return I.value=A,I.done=!1,I}return I.done=!0,I}},I.values=p,S.prototype={constructor:S,reset:function(I){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(W),!I)for(var g in this)"t"===g.charAt(0)&&C.call(this,g)&&!isNaN(+g.slice(1))&&(this[g]=void 0)},stop:function(){this.done=!0;var I=this.tryEntries[0].completion;if("throw"===I.type)throw I.arg;return this.rval},dispatchException:function(I){if(this.done)throw I;var g=this;function A(C,A){return G.type="throw",G.arg=I,g.next=C,A&&(g.method="next",g.arg=void 0),!!A}for(var i=this.tryEntries.length-1;i>=0;--i){var c=this.tryEntries[i],G=c.completion;if("root"===c.tryLoc)return A("end");if(c.tryLoc<=this.prev){var l=C.call(c,"catchLoc"),b=C.call(c,"finallyLoc");if(l&&b){if(this.prev<c.catchLoc)return A(c.catchLoc,!0);if(this.prev<c.finallyLoc)return A(c.finallyLoc)}else if(l){if(this.prev<c.catchLoc)return A(c.catchLoc,!0)}else{if(!b)throw new Error("try statement without catch or finally");if(this.prev<c.finallyLoc)return A(c.finallyLoc)}}}},abrupt:function(I,g){for(var A=this.tryEntries.length-1;A>=0;--A){var i=this.tryEntries[A];if(i.tryLoc<=this.prev&&C.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var c=i;break}}c&&("break"===I||"continue"===I)&&c.tryLoc<=g&&g<=c.finallyLoc&&(c=null);var G=c?c.completion:{};return G.type=I,G.arg=g,c?(this.method="next",this.next=c.finallyLoc,u):this.complete(G)},complete:function(I,g){if("throw"===I.type)throw I.arg;return"break"===I.type||"continue"===I.type?this.next=I.arg:"return"===I.type?(this.rval=this.arg=I.arg,this.method="return",this.next="end"):"normal"===I.type&&g&&(this.next=g),u},finish:function(I){for(var g=this.tryEntries.length-1;g>=0;--g){var C=this.tryEntries[g];if(C.finallyLoc===I)return this.complete(C.completion,C.afterLoc),W(C),u}},catch:function(I){for(var g=this.tryEntries.length-1;g>=0;--g){var C=this.tryEntries[g];if(C.tryLoc===I){var A=C.completion;if("throw"===A.type){var i=A.arg;W(C)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(I,g,C){return this.delegate={iterator:p(I),resultName:g,nextLoc:C},"next"===this.method&&(this.arg=void 0),u}},I}},2641:function(I,g,C){"use strict";function A(I){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(I){return typeof I}:function(I){return I&&"function"==typeof Symbol&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I},A(I)}C.d(g,{Z:function(){return A}})}},g={};function C(A){var i=g[A];if(void 0!==i)return i.exports;var c=g[A]={exports:{}};return I[A].call(c.exports,c,c.exports,C),c.exports}C.d=function(I,g){for(var A in g)C.o(g,A)&&!C.o(I,A)&&Object.defineProperty(I,A,{enumerable:!0,get:g[A]})},C.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(I){if("object"===typeof window)return window}}(),C.o=function(I,g){return Object.prototype.hasOwnProperty.call(I,g)},C.r=function(I){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(I,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(I,"__esModule",{value:!0})},function(){"use strict";var I=C(6257);function g(I,g,C,A,i,c,G){try{var l=I[c](G),b=l.value}catch(Z){return void C(Z)}l.done?g(b):Promise.resolve(b).then(A,i)}var A=C(2064),i=C(5338),c=C(6329),G="function"===typeof atob,l="function"===typeof Buffer,b=("function"===typeof TextDecoder&&new TextDecoder,"function"===typeof TextEncoder&&new TextEncoder,Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=")),Z=function(I){var g={};return I.forEach((function(I,C){return g[I]=C})),g}(b),t=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,o=String.fromCharCode.bind(String),n="function"===typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):function(I){var g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(I){return I};return new Uint8Array(Array.prototype.slice.call(I,0).map(g))},u=function(I){return I.replace(/[^A-Za-z0-9\+\/]/g,"")},d=function(I){if(I=I.replace(/\s+/g,""),!t.test(I))throw new TypeError("malformed base64.");I+="==".slice(2-(3&I.length));for(var g,C,A,i="",c=0;c<I.length;)g=Z[I.charAt(c++)]<<18|Z[I.charAt(c++)]<<12|(C=Z[I.charAt(c++)])<<6|(A=Z[I.charAt(c++)]),i+=64===C?o(g>>16&255):64===A?o(g>>16&255,g>>8&255):o(g>>16&255,g>>8&255,255&g);return i},m=G?function(I){return atob(u(I))}:l?function(I){return Buffer.from(I,"base64").toString("binary")}:d,e=l?function(I){return n(Buffer.from(I,"base64"))}:function(I){return n(m(I),(function(I){return I.charCodeAt(0)}))},B=function(I){return e(X(I))},X=function(I){return u(I.replace(/[-_]/g,(function(I){return"-"==I?"+":"/"})))},y="12D3KooWNzutuy8WHXDKFqFsATvCR6j9cj2FijYbnd47geRKaQZS",V=function(I){return B(I)},h=function(){var C,G=(C=(0,I.Z)().mark((function g(){var C,G,l,b,Z,t,o;return(0,I.Z)().wrap((function(I){for(;;)switch(I.prev=I.next){case 0:return C=new i.WasmWebLoader("avm.wasm"),G=new i.WasmWebLoader("marine-js.wasm"),l=new i.InlinedWorkerLoader,b=new A.MarineBackgroundRunner(l,G,(function(){})),I.next=6,b.start();case 6:return I.next=8,C.start();case 8:return I.next=10,C.getValue();case 10:return Z=I.sent,I.next=13,b.createService(Z,"avm");case 13:return t='(seq\n            (par \n                (call "'.concat(y,'" ("local_service_id" "local_fn_name") [] result_1)\n                (call "remote_peer_id" ("service_id" "fn_name") [] g)\n            )\n            (call "').concat(y,'" ("local_service_id" "local_fn_name") [] result_2)\n        )'),I.next=16,(0,c.callAvm)((function(I){return b.callService("avm","invoke",I,void 0)}),{currentPeerId:y,initPeerId:y,timestamp:Date.now(),ttl:1e4},t,V(""),V(""),[]);case 16:return o=I.sent,I.next=19,b.stop();case 19:return I.abrupt("return",o);case 20:case"end":return I.stop()}}),g)})),function(){var I=this,A=arguments;return new Promise((function(i,c){var G=C.apply(I,A);function l(I){g(G,i,c,l,b,"next",I)}function b(I){g(G,i,c,l,b,"throw",I)}l(void 0)}))});return function(){return G.apply(this,arguments)}}();window.MAIN=h}()}();
//# sourceMappingURL=main.782b7b60.js.map